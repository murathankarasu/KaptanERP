const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-BsQWTpT4.js","assets/vendor-MFOpH_Rh.js","assets/firebase-Dq6vfPGW.js","assets/charts-Djf0nrBi.js"])))=>i.map(i=>d[i]);
var pk=Object.defineProperty;var mk=(e,t,r)=>t in e?pk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Sr=(e,t,r)=>mk(e,typeof t!="symbol"?t+"":t,r);import{r as ue,a as xk,u as $0,b as gk,L as vk,d as yk,c as my,g as bk,e as wk,B as _k,f as kk,h as rr,N as hr,R as Sk}from"./vendor-MFOpH_Rh.js";import{i as Ak,g as Nk,a as jk,G as Tk,s as Ek,b as u0,c as lt,q as Ke,w as ot,d as lr,o as ua,e as ir,u as Xr,T as Ye,f as Or,h as os,j as xy,r as gy,k as ld,l as Ck}from"./firebase-Dq6vfPGW.js";import{R as Wu,B as Fk,C as Th,X as Eh,Y as Ch,T as qu,a as Dk,P as Ik,b as Lk,c as Pk,L as ig,A as Rk,d as Ok,e as Bk,f as sg,r as Mk}from"./charts-Djf0nrBi.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var vy={exports:{}},cd={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zk=ue,Uk=Symbol.for("react.element"),Wk=Symbol.for("react.fragment"),qk=Object.prototype.hasOwnProperty,Hk=zk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$k={key:!0,ref:!0,__self:!0,__source:!0};function yy(e,t,r){var a,n={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)qk.call(t,a)&&!$k.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Uk,type:e,key:i,ref:o,props:n,_owner:Hk.current}}cd.Fragment=Wk;cd.jsx=yy;cd.jsxs=yy;vy.exports=cd;var s=vy.exports,Np={},og=xk;Np.createRoot=og.createRoot,Np.hydrateRoot=og.hydrateRoot;const Vk={apiKey:"AIzaSyD2weZekHR3TCXGa946osyNxvQvCbvXIQ8",authDomain:"kaptanerp.firebaseapp.com",projectId:"kaptanerp",storageBucket:"kaptanerp.firebasestorage.app",messagingSenderId:"322447446982",appId:"1:322447446982:web:7f7c095ad8ea7a4c1018c7"},by=Ak(Vk),Is=Nk(by),qe=jk(by),wy=new Tk,_y=Object.freeze(Object.defineProperty({__proto__:null,auth:Is,db:qe,googleProvider:wy},Symbol.toStringTag,{value:"Module"})),Gk="modulepreload",Kk=function(e){return"/"+e},lg={},xi=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=Kk(c),c in lg)return;lg[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Gk,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((p,d)=>{h.addEventListener("load",p),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Yk=async e=>{try{if(!e)return!1;const t=lt(qe,"users"),r=Ke(t,ot("email","==",e),ot("isActive","==",!0));return!(await lr(r)).empty}catch(t){return console.error("Kullanıcı kontrolü hatası:",t),!1}},Xk=async()=>{try{const t=(await Ek(Is,wy)).user;if(!await Yk(t.email||""))throw await u0(Is),new Error("Bu Google hesabı ile giriş yapma yetkiniz bulunmamaktadır.");return t}catch(e){throw console.error("Google ile giriş hatası:",e),e}},Jk=async()=>{try{Is.currentUser&&await u0(Is),localStorage.removeItem("currentUser")}catch(e){console.error("Çıkış hatası:",e),localStorage.removeItem("currentUser")}},V0="personnel",v1=async e=>{try{const t={...e,createdAt:Ye.now(),updatedAt:Ye.now()};return t.permissions===void 0&&delete t.permissions,(await Or(lt(qe,V0),t)).id}catch(t){throw console.error("Personel eklenirken hata:",t),t}},ud=async e=>{try{let t=Ke(lt(qe,V0),ua("name","asc"));return e!=null&&e.companyId&&(t=Ke(t,ot("companyId","==",e.companyId))),e!=null&&e.department&&(t=Ke(t,ot("department","==",e.department))),e!=null&&e.name&&(t=Ke(t,ot("name",">=",e.name),ot("name","<=",e.name+""))),(await lr(t)).docs.map(a=>{var n,i;return{id:a.id,...a.data(),createdAt:(n=a.data().createdAt)==null?void 0:n.toDate(),updatedAt:(i=a.data().updatedAt)==null?void 0:i.toDate()}})}catch(t){throw console.error("Personel listesi yüklenirken hata:",t),t}},Zk=async(e,t)=>{try{const r=ir(qe,V0,e);await Xr(r,{...t,updatedAt:Ye.now()})}catch(r){throw console.error("Personel güncellenirken hata:",r),r}},Qk=async e=>{try{const t=ir(qe,V0,e);await os(t)}catch(t){throw console.error("Personel silinirken hata:",t),t}},S0=async(e,t)=>{var r,a,n,i;try{let o=Ke(lt(qe,V0),ot("email","==",e));t&&(o=Ke(o,ot("companyId","==",t)));const l=await lr(o);if(l.empty)return null;const c=l.docs[0],u=c.data();return{id:c.id,...u,createdAt:(a=(r=u.createdAt)==null?void 0:r.toDate)==null?void 0:a.call(r),updatedAt:(i=(n=u.updatedAt)==null?void 0:n.toDate)==null?void 0:i.call(n)}}catch(o){return console.error("Personel email ile getirilirken hata:",o),null}},G0="companies",e3=async e=>{var n,i,o,l;const t=ir(qe,G0,e),r=await xy(t);if(!r.exists())return null;const a=r.data();return{id:r.id,...a,createdAt:((i=(n=a.createdAt)==null?void 0:n.toDate)==null?void 0:i.call(n))??a.createdAt,updatedAt:((l=(o=a.updatedAt)==null?void 0:o.toDate)==null?void 0:l.call(o))??a.updatedAt}},t3=async e=>(await Or(lt(qe,G0),{...e,isActive:e.isActive??!0,createdAt:Ye.now(),updatedAt:Ye.now()})).id,y1=async()=>{const e=Ke(lt(qe,G0),ua("name","asc"));return(await lr(e)).docs.map(r=>{var a,n,i,o;return{id:r.id,...r.data(),createdAt:((n=(a=r.data().createdAt)==null?void 0:a.toDate)==null?void 0:n.call(a))??r.data().createdAt,updatedAt:((o=(i=r.data().updatedAt)==null?void 0:i.toDate)==null?void 0:o.call(i))??r.data().updatedAt}})},ky=async e=>{var a,n,i,o;const t=Ke(lt(qe,G0),ot("code","==",e)),r=await lr(t);if(!r.empty){const l=r.docs[0];return{id:l.id,...l.data(),createdAt:((n=(a=l.data().createdAt)==null?void 0:a.toDate)==null?void 0:n.call(a))??l.data().createdAt,updatedAt:((o=(i=l.data().updatedAt)==null?void 0:i.toDate)==null?void 0:o.call(i))??l.data().updatedAt}}return null},r3=async e=>{var a,n,i,o;const t=Ke(lt(qe,G0),ot("name","==",e)),r=await lr(t);if(!r.empty){const l=r.docs[0];return{id:l.id,...l.data(),createdAt:((n=(a=l.data().createdAt)==null?void 0:a.toDate)==null?void 0:n.call(a))??l.data().createdAt,updatedAt:((o=(i=l.data().updatedAt)==null?void 0:i.toDate)==null?void 0:o.call(i))??l.data().updatedAt}}return null},Os="users",b1="errorLogs",w1=e=>btoa(e).split("").reverse().join(""),Sy=async(e,t)=>{var r,a;try{const n=(r=e.email)==null?void 0:r.trim().toLowerCase(),i=((a=e.username)==null?void 0:a.trim())||n,o=w1(e.password),l=await Or(lt(qe,Os),{...e,password:o,username:i,email:n||e.email,createdBy:t||null,createdAt:Ye.now(),updatedAt:Ye.now()});if(e.role!=="admin"&&e.companyId){const c=n||e.email;if(!(c?await S0(c,e.companyId):null)){const f={name:e.fullName||i||"Yeni Kullanıcı",department:"Beyaz Yaka",email:c,phone:"",employeeId:i||void 0,companyId:e.companyId,permissions:["dashboard"]};await v1(f)}}return l.id}catch(n){throw console.error("Kullanıcı eklenirken hata:",n),n}},jp=async e=>{var t;try{let r=e.companyId,a=e.companyCode,n=e.companyName;const i=async()=>{e.id&&(await Xr(ir(qe,Os,e.id),{companyId:r||null,companyCode:a||null,companyName:n||null,updatedAt:Ye.now()}),console.log("[ensurePersonnelForUser] user updated",{userId:e.id,companyId:r,companyCode:a,companyName:n}))};if(r){const l=await e3(r);l&&(a=a||l.code,n=n||l.name,console.log("[ensurePersonnelForUser] resolved from companyId",{companyId:r,companyCode:a,companyName:n}))}if(!r&&a){const l=await ky(a);l!=null&&l.id&&(r=l.id,a=l.code,n=l.name,console.log("[ensurePersonnelForUser] resolved from companyCode",{companyId:r,companyCode:a,companyName:n}))}if(!r&&n){const l=n.trim(),c=await r3(l);c!=null&&c.id&&(r=c.id,a=c.code,n=c.name,console.log("[ensurePersonnelForUser] resolved from companyName",{companyId:r,companyCode:a,companyName:n}))}if(!r){const l=await y1();l.length===1&&(r=l[0].id,a=l[0].code,n=l[0].name,console.log("[ensurePersonnelForUser] resolved from single company fallback",{companyId:r,companyCode:a,companyName:n}))}await i();const o=(t=e.email)==null?void 0:t.toLowerCase();if(r&&o&&!await S0(o,r)){const c={name:e.fullName||e.username||"Kullanıcı",department:"Beyaz Yaka",email:o,phone:"",employeeId:e.username,companyId:r,permissions:["dashboard"]};await v1(c),console.log("[ensurePersonnelForUser] personnel created",{email:o,companyId:r})}if(r&&o){const l=await S0(o,r);console.log("[ensurePersonnelForUser] personnel check after create",{exists:!!l,email:o,companyId:r})}return r||console.warn("[ensurePersonnelForUser] companyId unresolved",{user:e}),{...e,companyId:r,companyCode:a,companyName:n}}catch(r){return console.error("ensurePersonnelForUser hata:",r),e}},a3=async e=>{try{let t;return e?t=Ke(lt(qe,Os),ot("companyId","==",e),ua("createdAt","desc")):t=Ke(lt(qe,Os),ua("createdAt","desc")),(await lr(t)).docs.map(a=>{var n,i,o;return{id:a.id,...a.data(),password:"***",createdAt:(n=a.data().createdAt)==null?void 0:n.toDate(),updatedAt:(i=a.data().updatedAt)==null?void 0:i.toDate(),lastLogin:(o=a.data().lastLogin)==null?void 0:o.toDate()}})}catch(t){throw console.error("Kullanıcı listesi yüklenirken hata:",t),t}},n3=async e=>{var t,r,a;try{const n=Ke(lt(qe,Os),ot("username","==",e)),i=await lr(n);if(!i.empty){const o=i.docs[0];return{id:o.id,...o.data(),createdAt:(t=o.data().createdAt)==null?void 0:t.toDate(),updatedAt:(r=o.data().updatedAt)==null?void 0:r.toDate(),lastLogin:(a=o.data().lastLogin)==null?void 0:a.toDate()}}return null}catch(n){return console.error("Kullanıcı getirilirken hata:",n),null}},Tp=async e=>{var t,r,a;try{const n=Ke(lt(qe,Os),ot("email","==",e)),i=await lr(n);if(!i.empty){const o=i.docs[0];return{id:o.id,...o.data(),createdAt:(t=o.data().createdAt)==null?void 0:t.toDate(),updatedAt:(r=o.data().updatedAt)==null?void 0:r.toDate(),lastLogin:(a=o.data().lastLogin)==null?void 0:a.toDate()}}return null}catch(n){return console.error("Kullanıcı getirilirken hata:",n),null}},Ay=(e,t)=>new Promise(async r=>{try{const a=e.trim(),n=a.includes("@")?a.toLowerCase():void 0;let i=await n3(a);if(!i&&n&&(i=await Tp(n)),i||(i=await Tp(a)),!i){console.warn("[verifyPassword] user not found",{input:a}),r(null);return}const o=w1(t);i.password===o&&i.isActive?(i.id&&await Xr(ir(qe,Os,i.id),{lastLogin:Ye.now(),updatedAt:Ye.now()}),console.log("[verifyPassword] ok",{userId:i.id,username:i.username,companyId:i.companyId,companyCode:i.companyCode}),r(i)):(console.warn("[verifyPassword] wrong password or inactive",{userId:i.id,isActive:i.isActive}),r(null))}catch(a){console.error("Şifre doğrulama hatası:",a),await ur(`Şifre doğrulama hatası: ${a}`,"Login"),r(null)}}),i3=async(e,t)=>{try{const r=ir(qe,Os,e),a={...t,updatedAt:Ye.now()};t.password&&t.password!=="***"?a.password=w1(t.password):delete a.password,await Xr(r,a)}catch(r){throw console.error("Kullanıcı güncellenirken hata:",r),r}},s3=async e=>{try{const t=ir(qe,Os,e);await os(t)}catch(t){throw console.error("Kullanıcı silinirken hata:",t),t}},ur=async(e,t,r,a)=>{try{await Or(lt(qe,b1),{error:e,page:t,userId:r,username:a,timestamp:Ye.now(),resolved:!1})}catch(n){console.error("Hata logu eklenirken hata:",n)}},o3=async e=>{try{let t=Ke(lt(qe,b1),ua("timestamp","desc"));return(e==null?void 0:e.resolved)!==void 0&&(t=Ke(t,ot("resolved","==",e.resolved))),e!=null&&e.userId&&(t=Ke(t,ot("userId","==",e.userId))),(await lr(t)).docs.map(a=>{var n,i;return{id:a.id,...a.data(),timestamp:(n=a.data().timestamp)==null?void 0:n.toDate(),resolvedAt:(i=a.data().resolvedAt)==null?void 0:i.toDate()}})}catch(t){throw console.error("Hata logları yüklenirken hata:",t),t}},l3=async(e,t)=>{try{const r=ir(qe,b1,e);await Xr(r,{resolved:!0,resolvedBy:t,resolvedAt:Ye.now()})}catch(r){throw console.error("Hata logu çözülürken hata:",r),r}};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),vt=(e,t)=>{const r=ue.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},f)=>ue.createElement("svg",{ref:f,...c3,width:n,height:n,stroke:a,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${u3(e)}`,l].join(" "),...u},[...t.map(([h,p])=>ue.createElement(h,p)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=vt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=vt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ep=vt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=vt("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=vt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=vt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=vt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=vt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=vt("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=vt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=vt("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=vt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=vt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=vt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=vt("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=vt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=vt("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=vt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=vt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=vt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=vt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=vt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=vt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=vt("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=vt("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=vt("FilePlus",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"12",x2:"12",y1:"18",y2:"12",key:"1tsf04"}],["line",{x1:"9",x2:"15",y1:"15",y2:"15",key:"110plj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=vt("FileQuestion",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["path",{d:"M10 10.3c.2-.4.5-.8.9-1a2.1 2.1 0 0 1 2.6.4c.3.4.5.8.5 1.3 0 1.3-2 2-2 2",key:"1umxtm"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=vt("FileSignature",[["path",{d:"M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5",key:"kd5d3"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=vt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=vt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=vt("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fp=vt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=vt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=vt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=vt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dp=vt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fy=vt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=vt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=vt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=vt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=vt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=vt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=vt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=vt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=vt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dy=vt("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=vt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=vt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=vt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iy=vt("Tags",[["path",{d:"M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z",key:"gt587u"}],["path",{d:"M6 9.01V9",key:"1flxpt"}],["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=vt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=vt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=vt("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=vt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=vt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=vt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ly=vt("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dd=vt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=vt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=vt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function F3(){const[e,t]=ue.useState(!1),[r,a]=ue.useState(null),[n,i]=ue.useState("google"),[o,l]=ue.useState(""),[c,u]=ue.useState(""),f=async()=>{t(!0),a(null);try{const p=await Xk();if(p!=null&&p.email){const d=await Tp(p.email);if(!d){await u0(Is),a("Bu email adresi ile kayıtlı bir kullanıcı bulunamadı. Lütfen admin panelden hesabınızın oluşturulduğundan emin olun."),t(!1);return}if(d.role==="admin"){await u0(Is),a("Admin kullanıcıları için admin panel girişi kullanılmalıdır."),t(!1);return}if(!d.isActive){await u0(Is),a("Hesabınız aktif değil. Lütfen admin ile iletişime geçin."),t(!1);return}const v=await jp(d);let m="",y=[];if(v.companyId&&v.email){const _=await S0(v.email,v.companyId);_&&(m=_.id||"",y=_.permissions||[])}if(localStorage.setItem("currentUser",JSON.stringify({id:v.id,username:v.username||p.email,email:v.email||p.email,fullName:v.fullName||p.displayName||"",role:v.role||"user",companyId:v.companyId,companyCode:v.companyCode,personnelId:m,permissions:y})),d.id){const{updateDoc:_,doc:k,Timestamp:g}=await xi(async()=>{const{updateDoc:C,doc:E,Timestamp:A}=await import("./firebase-Dq6vfPGW.js").then(I=>I.m);return{updateDoc:C,doc:E,Timestamp:A}},[]),{db:w}=await xi(async()=>{const{db:C}=await Promise.resolve().then(()=>_y);return{db:C}},void 0);await _(k(w,"users",d.id),{lastLogin:g.now(),updatedAt:g.now()})}}window.location.href="/dashboard"}catch(p){a(p.message||"Giriş yapılırken bir hata oluştu")}finally{t(!1)}},h=async p=>{if(p.preventDefault(),t(!0),a(null),!o||!c){a("E-posta veya kullanıcı adı ve şifre gereklidir"),t(!1);return}try{console.log("[login-password] input",{identifier:o});const d=await Ay(o,c);if(console.log("[login-password] verify result",d),d){if(d.role==="admin"){a("Admin kullanıcıları buradan giriş yapamaz. Lütfen Admin Login sayfasını kullanın.");return}const v=await jp(d);let m="",y=[];if(v.companyId&&v.email){const _=await S0(v.email,v.companyId);_&&(m=_.id||"",y=_.permissions||[])}localStorage.setItem("currentUser",JSON.stringify({id:v.id,username:v.username,email:v.email,fullName:v.fullName,role:v.role,companyId:v.companyId,companyCode:v.companyCode,personnelId:m,permissions:y})),window.location.href="/dashboard"}else a("Kullanıcı adı veya şifre hatalı")}catch(d){a(d.message||"Giriş yapılırken bir hata oluştu")}finally{t(!1)}};return s.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#ffffff",overflow:"hidden"},children:[s.jsxs("div",{className:"login-animation-container",style:{flex:"1",background:"#ffffff",position:"relative",overflow:"hidden",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`
            linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px)
          `,backgroundSize:"50px 50px",animation:"gridMove 20s linear infinite",opacity:.5}}),s.jsx("div",{style:{position:"absolute",width:"120px",height:"120px",border:"2px solid rgba(0,0,0,0.1)",top:"15%",left:"10%",animation:"floatBox 8s ease-in-out infinite",borderRadius:"8px"}}),s.jsx("div",{style:{position:"absolute",width:"80px",height:"80px",border:"2px solid rgba(0,0,0,0.08)",top:"60%",left:"15%",animation:"floatBox 10s ease-in-out infinite 2s",borderRadius:"8px"}}),s.jsx("div",{style:{position:"absolute",width:"100px",height:"100px",border:"2px solid rgba(0,0,0,0.12)",top:"35%",left:"25%",animation:"floatBox 12s ease-in-out infinite 4s",borderRadius:"8px"}}),s.jsx("div",{style:{position:"absolute",top:"20%",left:"20%",animation:"floatIcon 6s ease-in-out infinite",opacity:.15},children:s.jsx(Ls,{size:60,color:"#000"})}),s.jsx("div",{style:{position:"absolute",top:"50%",left:"12%",animation:"floatIcon 8s ease-in-out infinite 2s",opacity:.12},children:s.jsx(If,{size:50,color:"#000"})}),s.jsx("div",{style:{position:"absolute",top:"70%",left:"22%",animation:"floatIcon 7s ease-in-out infinite 3s",opacity:.1},children:s.jsx(A1,{size:45,color:"#000"})}),s.jsx("div",{style:{position:"absolute",top:"40%",left:"8%",animation:"floatIcon 9s ease-in-out infinite 1s",opacity:.13},children:s.jsx(h3,{size:55,color:"#000"})}),s.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:.08,pointerEvents:"none"},children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"lineGradient1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#000",stopOpacity:"0"}),s.jsx("stop",{offset:"50%",stopColor:"#000",stopOpacity:"0.3"}),s.jsx("stop",{offset:"100%",stopColor:"#000",stopOpacity:"0"})]}),s.jsxs("linearGradient",{id:"lineGradient2",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#000",stopOpacity:"0"}),s.jsx("stop",{offset:"50%",stopColor:"#000",stopOpacity:"0.25"}),s.jsx("stop",{offset:"100%",stopColor:"#000",stopOpacity:"0"})]})]}),s.jsx("line",{x1:"0",y1:"30%",x2:"100%",y2:"70%",stroke:"url(#lineGradient1)",strokeWidth:"1",className:"animated-line-1"}),s.jsx("line",{x1:"0",y1:"70%",x2:"100%",y2:"30%",stroke:"url(#lineGradient2)",strokeWidth:"1",className:"animated-line-2"})]}),s.jsx("div",{style:{position:"absolute",width:"200px",height:"200px",border:"1px solid rgba(0,0,0,0.05)",borderRadius:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",animation:"pulseCircle 4s ease-in-out infinite"}}),s.jsx("div",{style:{position:"absolute",width:"150px",height:"150px",border:"1px solid rgba(0,0,0,0.06)",borderRadius:"50%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",animation:"pulseCircle 4s ease-in-out infinite 1s"}}),s.jsx("style",{children:`
          @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
          }
          
          @keyframes floatBox {
            0%, 100% { 
              transform: translateY(0px) rotate(0deg);
              opacity: 0.1;
            }
            50% { 
              transform: translateY(-30px) rotate(5deg);
              opacity: 0.2;
            }
          }
          
          @keyframes floatIcon {
            0%, 100% { 
              transform: translateY(0px) translateX(0px) rotate(0deg);
            }
            25% { 
              transform: translateY(-20px) translateX(10px) rotate(5deg);
            }
            50% { 
              transform: translateY(-10px) translateX(-5px) rotate(-3deg);
            }
            75% { 
              transform: translateY(-25px) translateX(8px) rotate(4deg);
            }
          }
          
          .animated-line-1 {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: lineDraw 15s ease-in-out infinite;
          }
          
          .animated-line-2 {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: lineDraw 18s ease-in-out infinite 5s;
          }
          
          @keyframes lineDraw {
            0% { 
              stroke-dashoffset: 1000;
              opacity: 0;
            }
            50% { 
              opacity: 0.15;
            }
            100% { 
              stroke-dashoffset: 0;
              opacity: 0;
            }
          }
          
          @keyframes pulseCircle {
            0%, 100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0.05;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 0.1;
            }
          }
        `})]}),s.jsxs("div",{style:{flex:"1",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"40px",background:"#ffffff",position:"relative",minHeight:"100vh"},children:[s.jsxs("div",{style:{position:"absolute",top:"30px",left:"40px",display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx("img",{src:"/Kaptan.png",alt:"Kaptan Logo",style:{width:"50px",height:"50px"}}),s.jsxs("div",{children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#000",margin:0,letterSpacing:"-0.5px"},children:"Kaptan"}),s.jsx("p",{style:{fontSize:"10px",color:"#666",margin:0,letterSpacing:"0.5px",textTransform:"uppercase"},children:"ERP Sistemleri"})]})]}),s.jsxs("div",{style:{maxWidth:"450px",width:"100%",textAlign:"center"},children:[s.jsxs("div",{style:{marginBottom:"50px"},children:[s.jsx("h1",{style:{fontSize:"48px",fontWeight:"700",color:"#000",marginBottom:"16px",letterSpacing:"-2px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"Hoş Geldiniz"}),s.jsxs("p",{style:{color:"#666",fontSize:"18px",lineHeight:"1.8",fontWeight:"400",maxWidth:"400px",margin:"0 auto"},children:["Modern ERP çözümü ile stok ve personel yönetimini kolaylaştırın.",s.jsx("br",{}),s.jsx("span",{style:{fontSize:"16px",color:"#999",fontStyle:"italic"},children:"Akıllı takip, hızlı kararlar, güvenilir sonuçlar."})]})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"30px",border:"2px solid #000",padding:"4px",background:"white"},children:[s.jsx("button",{type:"button",onClick:()=>i("password"),style:{flex:1,padding:"12px",background:n==="password"?"#000":"transparent",color:n==="password"?"#fff":"#000",border:"none",borderRadius:"0",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},children:"Şifre ile Giriş"}),s.jsx("button",{type:"button",onClick:()=>i("google"),style:{flex:1,padding:"12px",background:n==="google"?"#000":"transparent",color:n==="google"?"#fff":"#000",border:"none",borderRadius:"0",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},children:"Google ile Giriş"})]}),r&&s.jsx("div",{style:{background:"#fff",color:"#000",padding:"16px",borderRadius:"0",marginBottom:"30px",fontSize:"14px",border:"2px solid #000",fontWeight:"500"},children:r}),n==="password"&&s.jsxs("form",{onSubmit:h,style:{marginBottom:"24px"},children:[s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("input",{type:"text",value:o,onChange:p=>l(p.target.value),placeholder:"E-posta veya Kullanıcı Adı",required:!0,style:{width:"100%",padding:"16px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",marginBottom:"15px",background:"white",color:"#000"}}),s.jsx("input",{type:"password",value:c,onChange:p=>u(p.target.value),placeholder:"Şifre",required:!0,style:{width:"100%",padding:"16px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white",color:"#000"}})]}),s.jsxs("button",{type:"submit",disabled:e,style:{width:"100%",padding:"18px 24px",background:e?"#ccc":"#000",color:"white",border:"2px solid #000",borderRadius:"0",fontSize:"16px",fontWeight:"600",cursor:e?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",transition:"all 0.2s",letterSpacing:"0.5px",textTransform:"uppercase"},onMouseEnter:p=>{e||(p.currentTarget.style.background="#333",p.currentTarget.style.borderColor="#333")},onMouseLeave:p=>{e||(p.currentTarget.style.background="#000",p.currentTarget.style.borderColor="#000")},children:[s.jsx(Dp,{size:22}),e?"Giriş yapılıyor...":"Giriş Yap"]})]}),n==="google"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:f,disabled:e,style:{width:"100%",padding:"18px 24px",background:e?"#ccc":"#000",color:"white",border:"2px solid #000",borderRadius:"0",fontSize:"16px",fontWeight:"600",cursor:e?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",transition:"all 0.2s",letterSpacing:"0.5px",textTransform:"uppercase",marginBottom:"24px"},onMouseEnter:p=>{e||(p.currentTarget.style.background="#333",p.currentTarget.style.borderColor="#333")},onMouseLeave:p=>{e||(p.currentTarget.style.background="#000",p.currentTarget.style.borderColor="#000")},children:[s.jsx(Dp,{size:22}),e?"Giriş yapılıyor...":"Google ile Giriş Yap"]}),s.jsx("p",{style:{fontSize:"12px",color:"#999",lineHeight:"1.6",letterSpacing:"0.3px",maxWidth:"400px",margin:"0 auto"},children:"Sadece yetkili Google hesapları ile giriş yapabilirsiniz."})]})]})]})]})}function D3(){const[e,t]=ue.useState(!1),[r,a]=ue.useState(null),[n,i]=ue.useState(""),[o,l]=ue.useState(""),c=$0(),u=async f=>{if(f.preventDefault(),t(!0),a(null),!n||!o){a("Kullanıcı adı ve şifre gereklidir"),t(!1);return}try{const h=await Ay(n,o);h&&h.role==="admin"?(localStorage.setItem("currentUser",JSON.stringify({id:h.id,username:h.username,email:h.email,fullName:h.fullName,role:h.role})),c("/admin-panel")):a("Admin yetkisi bulunmamaktadır")}catch(h){a(h.message||"Giriş yapılırken bir hata oluştu")}finally{t(!1)}};return s.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#ffffff",overflow:"hidden"},children:[s.jsxs("div",{className:"login-animation-container",style:{flex:"1",background:"#ffffff",position:"relative",overflow:"hidden",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`
            linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px)
          `,backgroundSize:"50px 50px",animation:"gridMove 20s linear infinite",opacity:.5}}),s.jsx("div",{style:{position:"absolute",width:"120px",height:"120px",border:"2px solid rgba(0,0,0,0.1)",top:"15%",left:"10%",animation:"floatBox 8s ease-in-out infinite",borderRadius:"8px"}}),s.jsx("div",{style:{position:"absolute",width:"80px",height:"80px",border:"2px solid rgba(0,0,0,0.08)",top:"60%",left:"15%",animation:"floatBox 10s ease-in-out infinite 2s",borderRadius:"8px"}}),s.jsx("div",{style:{position:"absolute",top:"20%",left:"20%",animation:"floatIcon 6s ease-in-out infinite",opacity:.15},children:s.jsx(rl,{size:60,color:"#000"})}),s.jsx("style",{children:`
          @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
          }
          
          @keyframes floatBox {
            0%, 100% { 
              transform: translateY(0px) rotate(0deg);
              opacity: 0.1;
            }
            50% { 
              transform: translateY(-30px) rotate(5deg);
              opacity: 0.2;
            }
          }
          
          @keyframes floatIcon {
            0%, 100% { 
              transform: translateY(0px) translateX(0px) rotate(0deg);
            }
            25% { 
              transform: translateY(-20px) translateX(10px) rotate(5deg);
            }
            50% { 
              transform: translateY(-10px) translateX(-5px) rotate(-3deg);
            }
            75% { 
              transform: translateY(-25px) translateX(8px) rotate(4deg);
            }
          }
        `})]}),s.jsxs("div",{style:{flex:"1",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"40px",background:"#ffffff",position:"relative",minHeight:"100vh"},children:[s.jsxs("div",{style:{position:"absolute",top:"30px",left:"40px",display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx("img",{src:"/Kaptan.png",alt:"Kaptan Logo",style:{width:"50px",height:"50px"}}),s.jsxs("div",{children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#000",margin:0,letterSpacing:"-0.5px"},children:"Kaptan"}),s.jsx("p",{style:{fontSize:"10px",color:"#666",margin:0,letterSpacing:"0.5px",textTransform:"uppercase"},children:"Admin Panel"})]})]}),s.jsxs("div",{style:{maxWidth:"450px",width:"100%",textAlign:"center"},children:[s.jsxs("div",{style:{marginBottom:"50px"},children:[s.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"16px"},children:s.jsx(rl,{size:48,color:"#000"})}),s.jsx("h1",{style:{fontSize:"48px",fontWeight:"700",color:"#000",marginBottom:"16px",letterSpacing:"-2px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:"Admin Girişi"}),s.jsx("p",{style:{color:"#666",fontSize:"18px",lineHeight:"1.8",fontWeight:"400",maxWidth:"400px",margin:"0 auto"},children:"Admin paneline erişmek için admin bilgilerinizle giriş yapın."})]}),r&&s.jsx("div",{style:{background:"#fff",color:"#000",padding:"16px",borderRadius:"0",marginBottom:"30px",fontSize:"14px",border:"2px solid #000",fontWeight:"500"},children:r}),s.jsxs("form",{onSubmit:u,children:[s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("input",{type:"text",value:n,onChange:f=>i(f.target.value),placeholder:"Admin Kullanıcı Adı",required:!0,style:{width:"100%",padding:"16px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",marginBottom:"15px",background:"white",color:"#000"}}),s.jsx("input",{type:"password",value:o,onChange:f=>l(f.target.value),placeholder:"Admin Şifre",required:!0,style:{width:"100%",padding:"16px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white",color:"#000"}})]}),s.jsxs("button",{type:"submit",disabled:e,style:{width:"100%",padding:"18px 24px",background:e?"#ccc":"#000",color:"white",border:"2px solid #000",borderRadius:"0",fontSize:"16px",fontWeight:"600",cursor:e?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",transition:"all 0.2s",letterSpacing:"0.5px",textTransform:"uppercase"},onMouseEnter:f=>{e||(f.currentTarget.style.background="#333",f.currentTarget.style.borderColor="#333")},onMouseLeave:f=>{e||(f.currentTarget.style.background="#000",f.currentTarget.style.borderColor="#000")},children:[s.jsx(Dp,{size:22}),e?"Giriş yapılıyor...":"Admin Girişi Yap"]})]}),s.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f5f5f5",border:"1px solid #e0e0e0",fontSize:"13px",color:"#666",lineHeight:"1.8"},children:[s.jsx("strong",{style:{color:"#000",display:"block",marginBottom:"8px"},children:"Bilgi:"}),s.jsx("p",{style:{margin:0},children:"Admin kullanıcıları Admin Panel'den oluşturulur. İlk admin kullanıcısı oluşturmak için sistem yöneticisine başvurun."})]})]})]})]})}const ml=()=>{try{const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null}catch(e){return console.error("Kullanıcı bilgisi alınırken hata:",e),null}},xo={stock_entry:{label:"Stok Giriş",description:"Stok giriş işlemlerini yapabilir"},stock_output:{label:"Personel Çıkış",description:"Personellere malzeme çıkışı yapabilir"},stock_status:{label:"Stok Durumu",description:"Stok durumunu görüntüleyebilir"},personnel:{label:"Personel Yönetimi",description:"Personel kayıtlarını yönetebilir"},orders:{label:"Sipariş Takip",description:"Sipariş işlemlerini yönetebilir"},warehouse:{label:"Depo Yönetimi",description:"Depo işlemlerini yönetebilir"},customer:{label:"Müşteri Yönetimi",description:"Müşteri kayıtlarını yönetebilir"},shipment:{label:"Sevkiyat Yönetimi",description:"Sevkiyat işlemlerini yönetebilir"},finance:{label:"Finans",description:"Finans/GL işlemlerini yönetebilir"},dashboard:{label:"Dashboard",description:"Dashboard'u görüntüleyebilir"}},I3=[{title:"Genel",items:["dashboard"]},{title:"Stok / Depo",items:["stock_entry","stock_output","stock_status","warehouse"]},{title:"Satış / CRM",items:["orders","customer","shipment"]},{title:"Finans / GL",items:["finance"]},{title:"İK / Personel",items:["personnel"]}],L3=(e,t)=>!e||e.length===0?!1:e.includes(t),P3=()=>Object.keys(xo);function nr({children:e}){const t=gk(),r=async()=>{try{await Jk()}catch(p){console.error("Firebase çıkış hatası:",p)}finally{localStorage.removeItem("currentUser"),window.location.href="/login"}},a=ml(),n=a==null?void 0:a.role,i=n==="admin",o=n==="manager",l=o?P3():(a==null?void 0:a.permissions)||[],c=[{title:"Genel",items:[{path:"/dashboard",label:"Yönetim Paneli",icon:_3,permission:"dashboard"},{path:"/about",label:"Hakkında",icon:Fp,permission:"dashboard"}]},{title:"Stok / Depo",items:[{path:"/stock-entry",label:"Stok Giriş",icon:Ls,permission:"stock_entry"},{path:"/stock-output",label:"Personel Çıkış",icon:f3,permission:"stock_output"},{path:"/stock-status",label:"Stok Durumu",icon:If,permission:"stock_status"},{path:"/warehouse-management",label:"Depo Yönetimi",icon:Ly,permission:"warehouse"},{path:"/product-management",label:"Ürün Kartları",icon:Ls,permission:"stock_entry"},{path:"/shipment-management",label:"Sevkiyat Takip",icon:Of,permission:"shipment"}]},{title:"Satınalma / SCM",items:[{path:"/requisition-management",label:"Satınalma Talepleri",icon:Xo,permission:"orders"},{path:"/rfq-management",label:"Teklif Toplama (RFQ)",icon:Ey,permission:"orders"},{path:"/purchase-orders",label:"Satınalma Siparişleri",icon:Rf,permission:"orders"},{path:"/goods-receipts",label:"Mal Kabul (GRN)",icon:Cy,permission:"orders"},{path:"/price-lists",label:"Fiyat Listeleri",icon:Iy,permission:"orders"}]},{title:"Satış / CRM",items:[{path:"/customer-management",label:"Müşteri Kayıtları",icon:g3,permission:"customer"},{path:"/customer-payments",label:"Tahsilat",icon:Pf,permission:"customer"},{path:"/customer-aging",label:"Cari Yaşlandırma",icon:Lf,permission:"customer"},{path:"/customer-insights",label:"Müşteri Görünümü",icon:Ty,permission:"customer"},{path:"/order-management",label:"Sipariş Yönetimi",icon:S1,permission:"orders"},{path:"/quotes",label:"Teklifler",icon:Xo,permission:"orders"}]},{title:"Üretim",items:[{path:"/bom",label:"BOM Yönetimi",icon:Ls,permission:"orders"},{path:"/mrp",label:"MRP Planlama",icon:If,permission:"orders"},{path:"/shop-floor",label:"Shop Floor",icon:Xo,permission:"orders"}]},{title:"Finans / e-Belge",items:[{path:"/journal-entries",label:"Hareket Kayıtları",icon:jy,permission:"finance"},{path:"/edocs-local",label:"e-Belge PDF/UBL",icon:fg,permission:"finance"},{path:"/sales-invoices",label:"Satış Faturaları",icon:fg,permission:"finance"}]},{title:"İK",items:[{path:"/personnel-management",label:"Personel Yönetimi",icon:fc,permission:"personnel"},{path:"/leave-management",label:"İzin Yönetimi",icon:Lf,permission:"personnel"},{path:"/payroll",label:"Bordro Hesaplama",icon:Rf,permission:"personnel"}]},{title:"Kayıt / Admin",items:[...o?[{path:"/activity-logs",label:"Kullanıcı İşlemleri",icon:_1,permission:null}]:[],...i?[{path:"/transaction-orders",label:"İşlem Kayıtları",icon:Bs,permission:null},{path:"/admin-panel",label:"Yönetici Paneli",icon:rl,permission:null},{path:"/settings",label:"Ayarlar",icon:rl,permission:null}]:[]]}],u=p=>p.filter(d=>d.permission?L3(l,d.permission):!0),f=ue.useRef(null);ue.useEffect(()=>{const p=sessionStorage.getItem("sidebarScroll");p&&f.current&&(f.current.scrollTop=parseInt(p,10))},[]);const h=()=>{f.current&&sessionStorage.setItem("sidebarScroll",String(f.current.scrollTop))};return s.jsxs("div",{style:{display:"flex",height:"100vh",overflow:"hidden"},children:[s.jsxs("aside",{style:{width:"250px",background:"#000000",color:"white",padding:"20px 0",display:"flex",flexDirection:"column",boxShadow:"2px 0 5px rgba(0,0,0,0.1)",overflowY:"auto"},children:[s.jsxs("div",{style:{padding:"0 20px 20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[s.jsx("img",{src:"/Kaptan.png",alt:"Kaptan Logo",style:{width:"40px",height:"40px"}}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:"700",margin:0,letterSpacing:"-0.5px"},children:"Kaptan"})]}),s.jsx("p",{style:{fontSize:"11px",color:"#999",marginTop:"2px",letterSpacing:"0.5px",textTransform:"uppercase"},children:"İş Yönetim Sistemi"})]}),s.jsx("nav",{ref:f,onScroll:h,style:{flex:1,padding:"12px 0",overflowY:"auto",maxHeight:"calc(100vh - 140px)"},children:c.map(p=>{const d=u(p.items);return d.length===0?null:s.jsxs("div",{style:{marginBottom:"12px"},children:[s.jsx("div",{style:{padding:"8px 20px",fontSize:"11px",letterSpacing:"1px",color:"#aaa",textTransform:"uppercase"},children:p.title}),d.map(v=>{const m=v.icon,y=t.pathname===v.path;return s.jsxs(vk,{to:v.path,style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 20px",color:y?"#fff":"#999",background:y?"#1a1a1a":"transparent",textDecoration:"none",borderLeft:y?"3px solid #fff":"3px solid transparent",transition:"all 0.2s"},onMouseEnter:_=>{y||(_.currentTarget.style.background="#1a1a1a",_.currentTarget.style.color="#fff")},onMouseLeave:_=>{y||(_.currentTarget.style.background="transparent",_.currentTarget.style.color="#999")},children:[s.jsx(m,{size:18}),s.jsx("span",{children:v.label})]},v.path)})]},p.title)})}),s.jsx("div",{style:{padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:s.jsxs("button",{onClick:r,style:{width:"100%",display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"transparent",border:"1px solid rgba(255,255,255,0.2)",color:"#fff",borderRadius:"4px",cursor:"pointer",fontSize:"14px",transition:"all 0.2s"},onMouseEnter:p=>{p.currentTarget.style.background="rgba(255,255,255,0.1)"},onMouseLeave:p=>{p.currentTarget.style.background="transparent"},children:[s.jsx(Fy,{size:20}),s.jsx("span",{children:"Çıkış Yap"})]})})]}),s.jsx("main",{style:{flex:1,overflow:"auto",background:"#ffffff"},children:e})]})}const bf=async e=>{try{return(await Or(lt(qe,"stockEntries"),{...e,arrivalDate:Ye.fromDate(e.arrivalDate),expiryDate:e.expiryDate?Ye.fromDate(e.expiryDate):void 0,createdAt:Ye.now()})).id}catch(t){throw console.error("Stok girişi ekleme hatası:",t),t}},Py=async e=>{try{let t=Ke(lt(qe,"stockEntries"),ua("arrivalDate","desc"));e!=null&&e.companyId&&(t=Ke(t,ot("companyId","==",e.companyId))),e!=null&&e.materialName&&(t=Ke(t,ot("materialName","==",e.materialName))),e!=null&&e.category&&(t=Ke(t,ot("category","==",e.category))),e!=null&&e.supplier&&(t=Ke(t,ot("supplier","==",e.supplier)));const r=await lr(t),a=[];return r.forEach(n=>{var l,c;const i=n.data(),o={id:n.id,arrivalDate:i.arrivalDate.toDate(),sku:i.sku,materialName:i.materialName,category:i.category,variant:i.variant,unit:i.unit,baseUnit:i.baseUnit,conversionFactor:i.conversionFactor,quantity:i.quantity,unitPrice:i.unitPrice,supplier:i.supplier,warehouse:i.warehouse,binCode:i.binCode,serialLot:i.serialLot,expiryDate:(l=i.expiryDate)!=null&&l.toDate?i.expiryDate.toDate():void 0,note:i.note,companyId:i.companyId,createdAt:(c=i.createdAt)==null?void 0:c.toDate()};e!=null&&e.startDate&&o.arrivalDate<e.startDate||e!=null&&e.endDate&&o.arrivalDate>e.endDate||a.push(o)}),a}catch(t){throw console.error("Stok girişleri getirme hatası:",t),t}},R3=async e=>{try{const t=await N1(e.materialName,e.companyId,e.warehouse);if(!t||t.currentStock<e.quantity){const a=e.warehouse?` (${e.warehouse} deposunda)`:"";throw new Error(`Yetersiz stok${a}! Mevcut stok: ${(t==null?void 0:t.currentStock)||0} ${(t==null?void 0:t.unit)||""}`)}const r=await Or(lt(qe,"stockOutputs"),{...e,issueDate:Ye.fromDate(e.issueDate),expiryDate:e.expiryDate?Ye.fromDate(e.expiryDate):void 0,createdAt:Ye.now()});return await O3(e.materialName,-e.quantity,e.companyId,e.warehouse),r.id}catch(t){throw console.error("Stok çıkışı ekleme hatası:",t),t}},Ry=async e=>{try{let t=Ke(lt(qe,"stockOutputs"),ua("issueDate","desc"));e!=null&&e.companyId&&(t=Ke(t,ot("companyId","==",e.companyId))),e!=null&&e.employee&&(t=Ke(t,ot("employee","==",e.employee))),e!=null&&e.department&&(t=Ke(t,ot("department","==",e.department))),e!=null&&e.materialName&&(t=Ke(t,ot("materialName","==",e.materialName)));const r=await lr(t),a=[];return r.forEach(n=>{var l,c;const i=n.data(),o={id:n.id,issueDate:i.issueDate.toDate(),sku:i.sku,employee:i.employee,department:i.department,personnelId:i.personnelId,variant:i.variant,materialName:i.materialName,quantity:i.quantity,issuedBy:i.issuedBy,binCode:i.binCode,serialLot:i.serialLot,expiryDate:(l=i.expiryDate)!=null&&l.toDate?i.expiryDate.toDate():void 0,warehouse:i.warehouse,description:i.description,companyId:i.companyId,createdAt:(c=i.createdAt)==null?void 0:c.toDate()};e!=null&&e.startDate&&o.issueDate<e.startDate||e!=null&&e.endDate&&o.issueDate>e.endDate||a.push(o)}),a}catch(t){throw console.error("Stok çıkışları getirme hatası:",t),t}},N1=async(e,t,r)=>{try{let a=Ke(lt(qe,"stockStatus"),ot("materialName","==",e));t&&(a=Ke(a,ot("companyId","==",t))),r?a=Ke(a,ot("warehouse","==",r)):a=Ke(a,ot("warehouse","==",null));const n=await lr(a);if(n.empty)return null;const i=n.docs[0],o=i.data();return{id:i.id,...o}}catch(a){return console.error("Stok durumu getirme hatası:",a),null}},O3=async(e,t,r,a)=>{try{const n=await N1(e,r,a);if(!n)throw new Error("Stok durumu bulunamadı!");const i=n.totalOutput+Math.abs(t),o=n.currentStock+t;let l="green";o<=0||o<=n.criticalLevel?l="red":o<=n.criticalLevel*1.5&&(l="orange"),await Xr(ir(qe,"stockStatus",n.id),{totalOutput:i,currentStock:o,status:l})}catch(n){throw console.error("Stok durumu güncelleme hatası:",n),n}},gc=async(e,t,r,a,n)=>{try{let i=e?Ke(lt(qe,"stockStatus"),ot("companyId","==",e)):Ke(lt(qe,"stockStatus"));t&&(i=Ke(i,ot("warehouse","==",t))),r&&(i=Ke(i,ot("sku","==",r))),a&&(i=Ke(i,ot("variant","==",a))),n&&(i=Ke(i,ot("binCode","==",n)));const o=await lr(i),l=[];return o.forEach(c=>{const u=c.data();l.push({id:c.id,...u})}),l.sort((c,u)=>{const f=(c.warehouse||"").localeCompare(u.warehouse||"");return f!==0?f:c.materialName.localeCompare(u.materialName)})}catch(i){throw console.error("Tüm stok durumları getirme hatası:",i),i}},Fh=async(e,t,r,a,n,i)=>{try{const o=await N1(e,n,i);if(o){const l=o.totalEntry+t,c=o.currentStock+t,u=a>0?a:o.criticalLevel;let f="green";c<=0||u>0&&c<=u?f="red":u>0&&c<=u*1.5&&(f="orange"),await Xr(ir(qe,"stockStatus",o.id),{totalEntry:l,currentStock:c,criticalLevel:u,status:f})}else{const l=a>0?a:t*.2;let c="green";t<=0||t<=l?c="red":t<=l*1.5&&(c="orange");const u={materialName:e,warehouse:i,totalEntry:t,totalOutput:0,currentStock:t,criticalLevel:l,status:c,unit:r,companyId:n};await Or(lt(qe,"stockStatus"),u)}}catch(o){throw console.error("Stok durumu güncelleme hatası:",o),o}},Ip="RFC3986",Lp={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},B3="RFC1738",M3=Array.isArray,Ki=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),Dh=1024,z3=(e,t,r,a,n)=>{if(e.length===0)return e;let i=e;if(typeof e=="symbol"?i=Symbol.prototype.toString.call(e):typeof e!="string"&&(i=String(e)),r==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=Dh){const c=i.length>=Dh?i.slice(l,l+Dh):i,u=[];for(let f=0;f<c.length;++f){let h=c.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===B3&&(h===40||h===41)){u[u.length]=c.charAt(f);continue}if(h<128){u[u.length]=Ki[h];continue}if(h<2048){u[u.length]=Ki[192|h>>6]+Ki[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=Ki[224|h>>12]+Ki[128|h>>6&63]+Ki[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|c.charCodeAt(f)&1023),u[u.length]=Ki[240|h>>18]+Ki[128|h>>12&63]+Ki[128|h>>6&63]+Ki[128|h&63]}o+=u.join("")}return o};function U3(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function hg(e,t){if(M3(e)){const r=[];for(let a=0;a<e.length;a+=1)r.push(t(e[a]));return r}return t(e)}const W3=Object.prototype.hasOwnProperty,Oy={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},es=Array.isArray,q3=Array.prototype.push,By=function(e,t){q3.apply(e,es(t)?t:[t])},H3=Date.prototype.toISOString,Ra={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:z3,encodeValuesOnly:!1,format:Ip,formatter:Lp[Ip],indices:!1,serializeDate(e){return H3.call(e)},skipNulls:!1,strictNullHandling:!1};function $3(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Ih={};function My(e,t,r,a,n,i,o,l,c,u,f,h,p,d,v,m,y,_){let k=e,g=_,w=0,C=!1;for(;(g=g.get(Ih))!==void 0&&!C;){const B=g.get(e);if(w+=1,typeof B<"u"){if(B===w)throw new RangeError("Cyclic object value");C=!0}typeof g.get(Ih)>"u"&&(w=0)}if(typeof u=="function"?k=u(t,k):k instanceof Date?k=p==null?void 0:p(k):r==="comma"&&es(k)&&(k=hg(k,function(B){return B instanceof Date?p==null?void 0:p(B):B})),k===null){if(i)return c&&!m?c(t,Ra.encoder,y,"key",d):t;k=""}if($3(k)||U3(k)){if(c){const B=m?t:c(t,Ra.encoder,y,"key",d);return[(v==null?void 0:v(B))+"="+(v==null?void 0:v(c(k,Ra.encoder,y,"value",d)))]}return[(v==null?void 0:v(t))+"="+(v==null?void 0:v(String(k)))]}const E=[];if(typeof k>"u")return E;let A;if(r==="comma"&&es(k))m&&c&&(k=hg(k,c)),A=[{value:k.length>0?k.join(",")||null:void 0}];else if(es(u))A=u;else{const B=Object.keys(k);A=f?B.sort(f):B}const I=l?String(t).replace(/\./g,"%2E"):String(t),D=a&&es(k)&&k.length===1?I+"[]":I;if(n&&es(k)&&k.length===0)return D+"[]";for(let B=0;B<A.length;++B){const L=A[B],F=typeof L=="object"&&typeof L.value<"u"?L.value:k[L];if(o&&F===null)continue;const z=h&&l?L.replace(/\./g,"%2E"):L,M=es(k)?typeof r=="function"?r(D,z):D:D+(h?"."+z:"["+z+"]");_.set(e,w);const q=new WeakMap;q.set(Ih,_),By(E,My(F,M,r,a,n,i,o,l,r==="comma"&&m&&es(k)?null:c,u,f,h,p,d,v,m,y,q))}return E}function V3(e=Ra){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||Ra.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=Ip;if(typeof e.format<"u"){if(!W3.call(Lp,e.format))throw new TypeError("Unknown format option provided.");r=e.format}const a=Lp[r];let n=Ra.filter;(typeof e.filter=="function"||es(e.filter))&&(n=e.filter);let i;if(e.arrayFormat&&e.arrayFormat in Oy?i=e.arrayFormat:"indices"in e?i=e.indices?"indices":"repeat":i=Ra.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:Ra.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ra.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:Ra.allowEmptyArrays,arrayFormat:i,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ra.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?Ra.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ra.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:Ra.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:Ra.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ra.encodeValuesOnly,filter:n,format:r,formatter:a,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ra.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ra.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ra.strictNullHandling}}function G3(e,t={}){let r=e;const a=V3(t);let n,i;typeof a.filter=="function"?(i=a.filter,r=i("",r)):es(a.filter)&&(i=a.filter,n=i);const o=[];if(typeof r!="object"||r===null)return"";const l=Oy[a.arrayFormat],c=l==="comma"&&a.commaRoundTrip;n||(n=Object.keys(r)),a.sort&&n.sort(a.sort);const u=new WeakMap;for(let p=0;p<n.length;++p){const d=n[p];a.skipNulls&&r[d]===null||By(o,My(r[d],d,l,c,a.allowEmptyArrays,a.strictNullHandling,a.skipNulls,a.encodeDotInKeys,a.encode?a.encoder:null,a.filter,a.sort,a.allowDots,a.serializeDate,a.format,a.formatter,a.encodeValuesOnly,a.charset,u))}const f=o.join(a.delimiter);let h=a.addQueryPrefix===!0?"?":"";return a.charsetSentinel&&(a.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),f.length>0?h+f:""}const $l="4.104.0";let pg=!1,f0,zy,Uy,Pp,Wy,qy,Hy,$y,Vy;function K3(e,t={auto:!1}){if(pg)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(f0)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${f0}'\``);pg=t.auto,f0=e.kind,zy=e.fetch,Uy=e.FormData,Pp=e.File,Wy=e.ReadableStream,qy=e.getMultipartRequestOptions,Hy=e.getDefaultAgent,$y=e.fileFromPath,Vy=e.isFsReadStream}class Y3{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function X3({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,a,n,i;try{r=fetch,a=Request,n=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${t}`)}return{kind:"web",fetch:r,Request:a,Response:n,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new Y3(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const Gy=()=>{f0||K3(X3(),{auto:!0})};Gy();class Dt extends Error{}class rn extends Dt{constructor(t,r,a,n){super(`${rn.makeMessage(t,r,a)}`),this.status=t,this.headers=n,this.request_id=n==null?void 0:n["x-request-id"],this.error=r;const i=r;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(t,r,a){const n=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):a;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,r,a,n){if(!t||!n)return new hd({message:a,cause:Op(r)});const i=r==null?void 0:r.error;return t===400?new Ky(t,i,a,n):t===401?new Yy(t,i,a,n):t===403?new Xy(t,i,a,n):t===404?new Jy(t,i,a,n):t===409?new Zy(t,i,a,n):t===422?new Qy(t,i,a,n):t===429?new e5(t,i,a,n):t>=500?new t5(t,i,a,n):new rn(t,i,a,n)}}class pi extends rn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class hd extends rn{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class j1 extends hd{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Ky extends rn{}class Yy extends rn{}class Xy extends rn{}class Jy extends rn{}class Zy extends rn{}class Qy extends rn{}class e5 extends rn{}class t5 extends rn{}class r5 extends Dt{constructor(){super("Could not parse response content as the length limit was reached")}}class a5 extends Dt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Hu=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},Ho=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},$n;class pd{constructor(){$n.set(this,void 0),this.buffer=new Uint8Array,Hu(this,$n,null,"f")}decode(t){if(t==null)return[];const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(this.buffer.length+r.length);a.set(this.buffer),a.set(r,this.buffer.length),this.buffer=a;const n=[];let i;for(;(i=J3(this.buffer,Ho(this,$n,"f")))!=null;){if(i.carriage&&Ho(this,$n,"f")==null){Hu(this,$n,i.index,"f");continue}if(Ho(this,$n,"f")!=null&&(i.index!==Ho(this,$n,"f")+1||i.carriage)){n.push(this.decodeText(this.buffer.slice(0,Ho(this,$n,"f")-1))),this.buffer=this.buffer.slice(Ho(this,$n,"f")),Hu(this,$n,null,"f");continue}const o=Ho(this,$n,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));n.push(l),this.buffer=this.buffer.slice(i.index),Hu(this,$n,null,"f")}return n}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof Buffer<"u"){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new Dt(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new Dt(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new Dt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}$n=new WeakMap;pd.NEWLINE_CHARS=new Set([`
`,"\r"]);pd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function J3(e,t){for(let n=t??0;n<e.length;n++){if(e[n]===10)return{preceding:n,index:n+1,carriage:!1};if(e[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function Z3(e){for(let a=0;a<e.length-1;a++){if(e[a]===10&&e[a+1]===10||e[a]===13&&e[a+1]===13)return a+2;if(e[a]===13&&e[a+1]===10&&a+3<e.length&&e[a+2]===13&&e[a+3]===10)return a+4}return-1}function n5(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class rs{constructor(t,r){this.iterator=t,this.controller=r}static fromSSEResponse(t,r){let a=!1;async function*n(){if(a)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let i=!1;try{for await(const o of Q3(t,r))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new rn(void 0,l.error,void 0,f5(t.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new rn(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||r.abort()}}return new rs(n,r)}static fromReadableStream(t,r){let a=!1;async function*n(){const o=new pd,l=n5(t);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(a)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let o=!1;try{for await(const l of n())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||r.abort()}}return new rs(i,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],a=this.iterator(),n=i=>({next:()=>{if(i.length===0){const o=a.next();t.push(o),r.push(o)}return i.shift()}});return[new rs(()=>n(t),this.controller),new rs(()=>n(r),this.controller)]}toReadableStream(){const t=this;let r;const a=new TextEncoder;return new Wy({async start(){r=t[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:o}=await r.next();if(o)return n.close();const l=a.encode(JSON.stringify(i)+`
`);n.enqueue(l)}catch(i){n.error(i)}},async cancel(){var n;await((n=r.return)==null?void 0:n.call(r))}})}}async function*Q3(e,t){if(!e.body)throw t.abort(),new Dt("Attempted to iterate over a response with no body");const r=new tS,a=new pd,n=n5(e.body);for await(const i of eS(n))for(const o of a.decode(i)){const l=r.decode(o);l&&(yield l)}for(const i of a.flush()){const o=r.decode(i);o&&(yield o)}}async function*eS(e){let t=new Uint8Array;for await(const r of e){if(r==null)continue;const a=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let n=new Uint8Array(t.length+a.length);n.set(t),n.set(a,t.length),t=n;let i;for(;(i=Z3(t))!==-1;)yield t.slice(0,i),t=t.slice(i)}t.length>0&&(yield t)}class tS{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,a,n]=rS(t,":");return n.startsWith(" ")&&(n=n.substring(1)),r==="event"?this.event=n:r==="data"&&this.data.push(n),null}}function rS(e,t){const r=e.indexOf(t);return r!==-1?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}const i5=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",s5=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&md(e),md=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",aS=e=>s5(e)||i5(e)||Vy(e);async function o5(e,t,r){var n;if(e=await e,s5(e))return e;if(i5(e)){const i=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=md(i)?[await i.arrayBuffer()]:[i];return new Pp(o,t,r)}const a=await nS(e);if(t||(t=sS(e)??"unknown_file"),!(r!=null&&r.type)){const i=(n=a[0])==null?void 0:n.type;typeof i=="string"&&(r={...r,type:i})}return new Pp(a,t,r)}async function nS(e){var r;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(md(e))t.push(await e.arrayBuffer());else if(oS(e))for await(const a of e)t.push(a);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(r=e==null?void 0:e.constructor)==null?void 0:r.name}; props: ${iS(e)}`);return t}function iS(e){return`[${Object.getOwnPropertyNames(e).map(r=>`"${r}"`).join(", ")}]`}function sS(e){var t;return Lh(e.name)||Lh(e.filename)||((t=Lh(e.path))==null?void 0:t.split(/[\\/]/).pop())}const Lh=e=>{if(typeof e=="string")return e;if(typeof Buffer<"u"&&e instanceof Buffer)return String(e)},oS=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",mg=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",al=async e=>{const t=await lS(e.body);return qy(t,e)},lS=async e=>{const t=new Uy;return await Promise.all(Object.entries(e||{}).map(([r,a])=>Rp(t,r,a))),t},Rp=async(e,t,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")e.append(t,String(r));else if(aS(r)){const a=await o5(r);e.append(t,a)}else if(Array.isArray(r))await Promise.all(r.map(a=>Rp(e,t+"[]",a)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([a,n])=>Rp(e,`${t}[${a}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var ec={},cS=function(e,t,r,a,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r},uS=function(e,t,r,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},$u;Gy();async function l5(e){var o;const{response:t}=e;if(e.options.stream)return go("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):rs.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const r=t.headers.get("content-type"),a=(o=r==null?void 0:r.split(";")[0])==null?void 0:o.trim();if((a==null?void 0:a.includes("application/json"))||(a==null?void 0:a.endsWith("+json"))){const l=await t.json();return go("response",t.status,t.url,t.headers,l),c5(l,t)}const i=await t.text();return go("response",t.status,t.url,t.headers,i),i}function c5(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class xd extends Promise{constructor(t,r=l5){super(a=>{a(null)}),this.responsePromise=t,this.parseResponse=r}_thenUnwrap(t){return new xd(this.responsePromise,async r=>c5(t(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r,request_id:r.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class fS{constructor({baseURL:t,maxRetries:r=2,timeout:a=6e5,httpAgent:n,fetch:i}){this.baseURL=t,this.maxRetries=Ph("maxRetries",r),this.timeout=Ph("timeout",a),this.httpAgent=n,this.fetch=i??zy}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...xS(),...this.authHeaders(t)}}validateHeaders(t,r){}defaultIdempotencyKey(){return`stainless-node-retry-${bS()}`}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,a){return this.request(Promise.resolve(a).then(async n=>{const i=n&&md(n==null?void 0:n.body)?new DataView(await n.body.arrayBuffer()):(n==null?void 0:n.body)instanceof DataView?n.body:(n==null?void 0:n.body)instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n==null?void 0:n.body)?new DataView(n.body.buffer):n==null?void 0:n.body;return{method:t,path:r,...n,body:i}}))}getAPIList(t,r,a){return this.requestAPIList(r,{method:"get",path:t,...a})}calculateContentLength(t){if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:r=0}={}){var m;const a={...t},{method:n,path:i,query:o,headers:l={}}=a,c=ArrayBuffer.isView(a.body)||a.__binaryRequest&&typeof a.body=="string"?a.body:mg(a.body)?a.body.body:a.body?JSON.stringify(a.body,null,2):null,u=this.calculateContentLength(c),f=this.buildURL(i,o);"timeout"in a&&Ph("timeout",a.timeout),a.timeout=a.timeout??this.timeout;const h=a.httpAgent??this.httpAgent??Hy(f),p=a.timeout+1e3;typeof((m=h==null?void 0:h.options)==null?void 0:m.timeout)=="number"&&p>(h.options.timeout??0)&&(h.options.timeout=p),this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=t.idempotencyKey);const d=this.buildHeaders({options:a,headers:l,contentLength:u,retryCount:r});return{req:{method:n,...c&&{body:c},headers:d,...h&&{agent:h},signal:a.signal??null},url:f,timeout:a.timeout}}buildHeaders({options:t,headers:r,contentLength:a,retryCount:n}){const i={};a&&(i["content-length"]=a);const o=this.defaultHeaders(t);return yg(i,o),yg(i,r),mg(t.body)&&f0!=="node"&&delete i["content-type"],Gu(o,"x-stainless-retry-count")===void 0&&Gu(r,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(n)),Gu(o,"x-stainless-timeout")===void 0&&Gu(r,"x-stainless-timeout")===void 0&&t.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(t.timeout/1e3))),this.validateHeaders(i,r),i}async prepareOptions(t){}async prepareRequest(t,{url:r,options:a}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(r=>[...r])):{...t}:{}}makeStatusError(t,r,a,n){return rn.generate(t,r,a,n)}request(t,r=null){return new xd(this.makeRequest(t,r))}async makeRequest(t,r){var h,p;const a=await t,n=a.maxRetries??this.maxRetries;r==null&&(r=n),await this.prepareOptions(a);const{req:i,url:o,timeout:l}=this.buildRequest(a,{retryCount:n-r});if(await this.prepareRequest(i,{url:o,options:a}),go("request",o,a,i.headers),(h=a.signal)!=null&&h.aborted)throw new pi;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(Op);if(u instanceof Error){if((p=a.signal)!=null&&p.aborted)throw new pi;if(r)return this.retryRequest(a,r);throw u.name==="AbortError"?new j1:new hd({cause:u})}const f=f5(u.headers);if(!u.ok){if(r&&this.shouldRetry(u)){const k=`retrying, ${r} attempts remaining`;return go(`response (error; ${k})`,u.status,o,f),this.retryRequest(a,r,f)}const d=await u.text().catch(k=>Op(k).message),v=gS(d),m=v?void 0:d;throw go(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,f,m),this.makeStatusError(u.status,v,m,f)}return{response:u,options:a,controller:c}}requestAPIList(t,r){const a=this.makeRequest(r,null);return new dS(this,a,t)}buildURL(t,r){const a=yS(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),n=this.defaultQuery();return d5(n)||(r={...n,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(a.search=this.stringifyQuery(r)),a.toString()}stringifyQuery(t){return Object.entries(t).filter(([r,a])=>typeof a<"u").map(([r,a])=>{if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(a)}`;if(a===null)return`${encodeURIComponent(r)}=`;throw new Dt(`Cannot stringify type ${typeof a}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,r,a,n){const{signal:i,...o}=r||{};i&&i.addEventListener("abort",()=>n.abort());const l=setTimeout(()=>n.abort(),a),c={signal:n.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,t,c).finally(()=>{clearTimeout(l)})}shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,a){let n;const i=a==null?void 0:a["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(n=l)}const o=a==null?void 0:a["retry-after"];if(o&&!n){const l=parseFloat(o);Number.isNaN(l)?n=Date.parse(o)-Date.now():n=l*1e3}if(!(n&&0<=n&&n<60*1e3)){const l=t.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(r,l)}return await K0(n),this.makeRequest(t,r-1)}calculateDefaultRetryTimeoutMillis(t,r){const i=r-t,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${$l}`}}class u5{constructor(t,r,a,n){$u.set(this,void 0),cS(this,$u,t),this.options=n,this.response=r,this.body=a}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new Dt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in t&&typeof r.query=="object")r.query={...r.query,...t.params};else if("url"in t){const a=[...Object.entries(r.query||{}),...t.url.searchParams.entries()];for(const[n,i]of a)t.url.searchParams.set(n,i);r.query=void 0,r.path=t.url.toString()}return await uS(this,$u,"f").requestAPIList(this.constructor,r)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[($u=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const r of t.getPaginatedItems())yield r}}class dS extends xd{constructor(t,r,a){super(r,async n=>new a(t,n.response,await l5(n),n.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const r of t)yield r}}const f5=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,r){const a=r.toString();return t[a.toLowerCase()]||t[a]}}),hS={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ta=e=>typeof e=="object"&&e!==null&&!d5(e)&&Object.keys(e).every(t=>h5(hS,t)),pS=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$l,"X-Stainless-OS":gg(Deno.build.os),"X-Stainless-Arch":xg(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$l,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$l,"X-Stainless-OS":gg(process.platform),"X-Stainless-Arch":xg(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=mS();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$l,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$l,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function mS(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const a=r.exec(navigator.userAgent);if(a){const n=a[1]||0,i=a[2]||0,o=a[3]||0;return{browser:t,version:`${n}.${i}.${o}`}}}return null}const xg=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",gg=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let vg;const xS=()=>vg??(vg=pS()),gS=e=>{try{return JSON.parse(e)}catch{return}},vS=/^[a-z][a-z0-9+.-]*:/i,yS=e=>vS.test(e),K0=e=>new Promise(t=>setTimeout(t,e)),Ph=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Dt(`${e} must be an integer`);if(t<0)throw new Dt(`${e} must be a positive integer`);return t},Op=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Vu=e=>{var t,r,a,n;if(typeof process<"u")return((t=ec==null?void 0:ec[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(n=(a=(r=Deno.env)==null?void 0:r.get)==null?void 0:a.call(r,e))==null?void 0:n.trim()};function d5(e){if(!e)return!0;for(const t in e)return!1;return!0}function h5(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function yg(e,t){for(const r in t){if(!h5(t,r))continue;const a=r.toLowerCase();if(!a)continue;const n=t[r];n===null?delete e[a]:n!==void 0&&(e[a]=n)}}const bg=new Set(["authorization","api-key"]);function go(e,...t){if(typeof process<"u"&&(ec==null?void 0:ec.DEBUG)==="true"){const r=t.map(a=>{if(!a)return a;if(a.headers){const i={...a,headers:{...a.headers}};for(const o in a.headers)bg.has(o.toLowerCase())&&(i.headers[o]="REDACTED");return i}let n=null;for(const i in a)bg.has(i.toLowerCase())&&(n??(n={...a}),n[i]="REDACTED");return n??a});console.log(`OpenAI:DEBUG:${e}`,...r)}}const bS=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),wS=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",_S=e=>typeof(e==null?void 0:e.get)=="function",Gu=(e,t)=>{var a;const r=t.toLowerCase();if(_S(e)){const n=((a=t[0])==null?void 0:a.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[t,r,t.toUpperCase(),n]){const o=e.get(i);if(o)return o}}for(const[n,i]of Object.entries(e))if(n.toLowerCase()===r)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${t} header, using the first entry.`),i[0]):i},kS=e=>{if(typeof Buffer<"u"){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}else{const t=atob(e),r=t.length,a=new Uint8Array(r);for(let n=0;n<r;n++)a[n]=t.charCodeAt(n);return Array.from(new Float32Array(a.buffer))}};function Rh(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class gd extends u5{constructor(t,r,a,n){super(t,r,a,n),this.data=a.data||[],this.object=a.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ma extends u5{constructor(t,r,a,n){super(t,r,a,n),this.data=a.data||[],this.has_more=a.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const r=Object.fromEntries(t.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var a;const t=this.getPaginatedItems();if(!t.length)return null;const r=(a=t[t.length-1])==null?void 0:a.id;return r?{params:{after:r}}:null}}class Rt{constructor(t){this._client=t}}let p5=class extends Rt{list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/chat/completions/${t}/messages`,SS,{query:r,...a})}},vd=class extends Rt{constructor(){super(...arguments),this.messages=new p5(this._client)}create(t,r){return this._client.post("/chat/completions",{body:t,...r,stream:t.stream??!1})}retrieve(t,r){return this._client.get(`/chat/completions/${t}`,r)}update(t,r,a){return this._client.post(`/chat/completions/${t}`,{body:r,...a})}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/chat/completions",yd,{query:t,...r})}del(t,r){return this._client.delete(`/chat/completions/${t}`,r)}};class yd extends Ma{}class SS extends Ma{}vd.ChatCompletionsPage=yd;vd.Messages=p5;let bd=class extends Rt{constructor(){super(...arguments),this.completions=new vd(this._client)}};bd.Completions=vd;bd.ChatCompletionsPage=yd;class m5 extends Rt{create(t,r){return this._client.post("/audio/speech",{body:t,...r,headers:{Accept:"application/octet-stream",...r==null?void 0:r.headers},__binaryResponse:!0})}}class x5 extends Rt{create(t,r){return this._client.post("/audio/transcriptions",al({body:t,...r,stream:t.stream??!1,__metadata:{model:t.model}}))}}class g5 extends Rt{create(t,r){return this._client.post("/audio/translations",al({body:t,...r,__metadata:{model:t.model}}))}}class Y0 extends Rt{constructor(){super(...arguments),this.transcriptions=new x5(this._client),this.translations=new g5(this._client),this.speech=new m5(this._client)}}Y0.Transcriptions=x5;Y0.Translations=g5;Y0.Speech=m5;class T1 extends Rt{create(t,r){return this._client.post("/batches",{body:t,...r})}retrieve(t,r){return this._client.get(`/batches/${t}`,r)}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/batches",E1,{query:t,...r})}cancel(t,r){return this._client.post(`/batches/${t}/cancel`,r)}}class E1 extends Ma{}T1.BatchesPage=E1;var Fi=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},Zr=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},Bp,wf,_f,t0,r0,kf,a0,Cs,n0,Bf,Mf,Vl,v5;class C1{constructor(){Bp.add(this),this.controller=new AbortController,wf.set(this,void 0),_f.set(this,()=>{}),t0.set(this,()=>{}),r0.set(this,void 0),kf.set(this,()=>{}),a0.set(this,()=>{}),Cs.set(this,{}),n0.set(this,!1),Bf.set(this,!1),Mf.set(this,!1),Vl.set(this,!1),Fi(this,wf,new Promise((t,r)=>{Fi(this,_f,t,"f"),Fi(this,t0,r,"f")}),"f"),Fi(this,r0,new Promise((t,r)=>{Fi(this,kf,t,"f"),Fi(this,a0,r,"f")}),"f"),Zr(this,wf,"f").catch(()=>{}),Zr(this,r0,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},Zr(this,Bp,"m",v5).bind(this))},0)}_connected(){this.ended||(Zr(this,_f,"f").call(this),this._emit("connect"))}get ended(){return Zr(this,n0,"f")}get errored(){return Zr(this,Bf,"f")}get aborted(){return Zr(this,Mf,"f")}abort(){this.controller.abort()}on(t,r){return(Zr(this,Cs,"f")[t]||(Zr(this,Cs,"f")[t]=[])).push({listener:r}),this}off(t,r){const a=Zr(this,Cs,"f")[t];if(!a)return this;const n=a.findIndex(i=>i.listener===r);return n>=0&&a.splice(n,1),this}once(t,r){return(Zr(this,Cs,"f")[t]||(Zr(this,Cs,"f")[t]=[])).push({listener:r,once:!0}),this}emitted(t){return new Promise((r,a)=>{Fi(this,Vl,!0,"f"),t!=="error"&&this.once("error",a),this.once(t,r)})}async done(){Fi(this,Vl,!0,"f"),await Zr(this,r0,"f")}_emit(t,...r){if(Zr(this,n0,"f"))return;t==="end"&&(Fi(this,n0,!0,"f"),Zr(this,kf,"f").call(this));const a=Zr(this,Cs,"f")[t];if(a&&(Zr(this,Cs,"f")[t]=a.filter(n=>!n.once),a.forEach(({listener:n})=>n(...r))),t==="abort"){const n=r[0];!Zr(this,Vl,"f")&&!(a!=null&&a.length)&&Promise.reject(n),Zr(this,t0,"f").call(this,n),Zr(this,a0,"f").call(this,n),this._emit("end");return}if(t==="error"){const n=r[0];!Zr(this,Vl,"f")&&!(a!=null&&a.length)&&Promise.reject(n),Zr(this,t0,"f").call(this,n),Zr(this,a0,"f").call(this,n),this._emit("end")}}_emitFinal(){}}wf=new WeakMap,_f=new WeakMap,t0=new WeakMap,r0=new WeakMap,kf=new WeakMap,a0=new WeakMap,Cs=new WeakMap,n0=new WeakMap,Bf=new WeakMap,Mf=new WeakMap,Vl=new WeakMap,Bp=new WeakSet,v5=function(t){if(Fi(this,Bf,!0,"f"),t instanceof Error&&t.name==="AbortError"&&(t=new pi),t instanceof pi)return Fi(this,Mf,!0,"f"),this._emit("abort",t);if(t instanceof Dt)return this._emit("error",t);if(t instanceof Error){const r=new Dt(t.message);return r.cause=t,this._emit("error",r)}return this._emit("error",new Dt(String(t)))};var _t=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},qn=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},Qa,Mp,ts,Sf,Di,Yo,Xl,Vo,zf,Vn,Af,Nf,d0,i0,s0,wg,_g,kg,Sg,Ag,Ng,jg;class Ii extends C1{constructor(){super(...arguments),Qa.add(this),Mp.set(this,[]),ts.set(this,{}),Sf.set(this,{}),Di.set(this,void 0),Yo.set(this,void 0),Xl.set(this,void 0),Vo.set(this,void 0),zf.set(this,void 0),Vn.set(this,void 0),Af.set(this,void 0),Nf.set(this,void 0),d0.set(this,void 0)}[(Mp=new WeakMap,ts=new WeakMap,Sf=new WeakMap,Di=new WeakMap,Yo=new WeakMap,Xl=new WeakMap,Vo=new WeakMap,zf=new WeakMap,Vn=new WeakMap,Af=new WeakMap,Nf=new WeakMap,d0=new WeakMap,Qa=new WeakSet,Symbol.asyncIterator)](){const t=[],r=[];let a=!1;return this.on("event",n=>{const i=r.shift();i?i.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of r)n.resolve(void 0);r.length=0}),this.on("abort",n=>{a=!0;for(const i of r)i.reject(n);r.length=0}),this.on("error",n=>{a=!0;for(const i of r)i.reject(n);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((i,o)=>r.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const r=new Ii;return r._run(()=>r._fromReadableStream(t)),r}async _fromReadableStream(t,r){var i;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=rs.fromReadableStream(t,this.controller);for await(const o of n)_t(this,Qa,"m",i0).call(this,o);if((i=n.controller.signal)!=null&&i.aborted)throw new pi;return this._addRun(_t(this,Qa,"m",s0).call(this))}toReadableStream(){return new rs(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,r,a,n,i){const o=new Ii;return o._run(()=>o._runToolAssistantStream(t,r,a,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(t,r,a,n,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await t.submitToolOutputs(r,a,l,{...i,signal:this.controller.signal});this._connected();for await(const f of c)_t(this,Qa,"m",i0).call(this,f);if((u=c.controller.signal)!=null&&u.aborted)throw new pi;return this._addRun(_t(this,Qa,"m",s0).call(this))}static createThreadAssistantStream(t,r,a){const n=new Ii;return n._run(()=>n._threadAssistantStream(t,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(t,r,a,n){const i=new Ii;return i._run(()=>i._runAssistantStream(t,r,a,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return _t(this,Af,"f")}currentRun(){return _t(this,Nf,"f")}currentMessageSnapshot(){return _t(this,Di,"f")}currentRunStepSnapshot(){return _t(this,d0,"f")}async finalRunSteps(){return await this.done(),Object.values(_t(this,ts,"f"))}async finalMessages(){return await this.done(),Object.values(_t(this,Sf,"f"))}async finalRun(){if(await this.done(),!_t(this,Yo,"f"))throw Error("Final run was not received.");return _t(this,Yo,"f")}async _createThreadAssistantStream(t,r,a){var l;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const i={...r,stream:!0},o=await t.createAndRun(i,{...a,signal:this.controller.signal});this._connected();for await(const c of o)_t(this,Qa,"m",i0).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new pi;return this._addRun(_t(this,Qa,"m",s0).call(this))}async _createAssistantStream(t,r,a,n){var c;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...a,stream:!0},l=await t.create(r,o,{...n,signal:this.controller.signal});this._connected();for await(const u of l)_t(this,Qa,"m",i0).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new pi;return this._addRun(_t(this,Qa,"m",s0).call(this))}static accumulateDelta(t,r){for(const[a,n]of Object.entries(r)){if(!t.hasOwnProperty(a)){t[a]=n;continue}let i=t[a];if(i==null){t[a]=n;continue}if(a==="index"||a==="type"){t[a]=n;continue}if(typeof i=="string"&&typeof n=="string")i+=n;else if(typeof i=="number"&&typeof n=="number")i+=n;else if(Rh(i)&&Rh(n))i=this.accumulateDelta(i,n);else if(Array.isArray(i)&&Array.isArray(n)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...n);continue}for(const o of n){if(!Rh(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${a}, deltaValue: ${n}, accValue: ${i}`);t[a]=i}return t}_addRun(t){return t}async _threadAssistantStream(t,r,a){return await this._createThreadAssistantStream(r,t,a)}async _runAssistantStream(t,r,a,n){return await this._createAssistantStream(r,t,a,n)}async _runToolAssistantStream(t,r,a,n,i){return await this._createToolAssistantStream(a,t,r,n,i)}}i0=function(t){if(!this.ended)switch(qn(this,Af,t,"f"),_t(this,Qa,"m",kg).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":_t(this,Qa,"m",jg).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_t(this,Qa,"m",_g).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":_t(this,Qa,"m",wg).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},s0=function(){if(this.ended)throw new Dt("stream has ended, this shouldn't happen");if(!_t(this,Yo,"f"))throw Error("Final run has not been received");return _t(this,Yo,"f")},wg=function(t){const[r,a]=_t(this,Qa,"m",Ag).call(this,t,_t(this,Di,"f"));qn(this,Di,r,"f"),_t(this,Sf,"f")[r.id]=r;for(const n of a){const i=r.content[n.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,r),t.data.delta.content)for(const n of t.data.delta.content){if(n.type=="text"&&n.text){let i=n.text,o=r.content[n.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=_t(this,Xl,"f")){if(_t(this,Vo,"f"))switch(_t(this,Vo,"f").type){case"text":this._emit("textDone",_t(this,Vo,"f").text,_t(this,Di,"f"));break;case"image_file":this._emit("imageFileDone",_t(this,Vo,"f").image_file,_t(this,Di,"f"));break}qn(this,Xl,n.index,"f")}qn(this,Vo,r.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(_t(this,Xl,"f")!==void 0){const n=t.data.content[_t(this,Xl,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,_t(this,Di,"f"));break;case"text":this._emit("textDone",n.text,_t(this,Di,"f"));break}}_t(this,Di,"f")&&this._emit("messageDone",t.data),qn(this,Di,void 0,"f")}},_g=function(t){const r=_t(this,Qa,"m",Sg).call(this,t);switch(qn(this,d0,r,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const a=t.data.delta;if(a.step_details&&a.step_details.type=="tool_calls"&&a.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const i of a.step_details.tool_calls)i.index==_t(this,zf,"f")?this._emit("toolCallDelta",i,r.step_details.tool_calls[i.index]):(_t(this,Vn,"f")&&this._emit("toolCallDone",_t(this,Vn,"f")),qn(this,zf,i.index,"f"),qn(this,Vn,r.step_details.tool_calls[i.index],"f"),_t(this,Vn,"f")&&this._emit("toolCallCreated",_t(this,Vn,"f")));this._emit("runStepDelta",t.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":qn(this,d0,void 0,"f"),t.data.step_details.type=="tool_calls"&&_t(this,Vn,"f")&&(this._emit("toolCallDone",_t(this,Vn,"f")),qn(this,Vn,void 0,"f")),this._emit("runStepDone",t.data,r);break}},kg=function(t){_t(this,Mp,"f").push(t),this._emit("event",t)},Sg=function(t){switch(t.event){case"thread.run.step.created":return _t(this,ts,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let r=_t(this,ts,"f")[t.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let a=t.data;if(a.delta){const n=Ii.accumulateDelta(r,a.delta);_t(this,ts,"f")[t.data.id]=n}return _t(this,ts,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":_t(this,ts,"f")[t.data.id]=t.data;break}if(_t(this,ts,"f")[t.data.id])return _t(this,ts,"f")[t.data.id];throw new Error("No snapshot available")},Ag=function(t,r){let a=[];switch(t.event){case"thread.message.created":return[t.data,a];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=t.data;if(n.delta.content)for(const i of n.delta.content)if(i.index in r.content){let o=r.content[i.index];r.content[i.index]=_t(this,Qa,"m",Ng).call(this,i,o)}else r.content[i.index]=i,a.push(i);return[r,a];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,a];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ng=function(t,r){return Ii.accumulateDelta(r,t)},jg=function(t){switch(qn(this,Nf,t.data,"f"),t.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":qn(this,Yo,t.data,"f"),_t(this,Vn,"f")&&(this._emit("toolCallDone",_t(this,Vn,"f")),qn(this,Vn,void 0,"f"));break}};class F1 extends Rt{create(t,r){return this._client.post("/assistants",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/assistants/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,a){return this._client.post(`/assistants/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/assistants",D1,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,r){return this._client.delete(`/assistants/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class D1 extends Ma{}F1.AssistantsPage=D1;function Tg(e){return typeof e.parse=="function"}const tc=e=>(e==null?void 0:e.role)==="assistant",y5=e=>(e==null?void 0:e.role)==="function",b5=e=>(e==null?void 0:e.role)==="tool";function I1(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function X0(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function AS(e,t){return!t||!w5(t)?{...e,choices:e.choices.map(r=>({...r,message:{...r.message,parsed:null,...r.message.tool_calls?{tool_calls:r.message.tool_calls}:void 0}}))}:L1(e,t)}function L1(e,t){const r=e.choices.map(a=>{var n;if(a.finish_reason==="length")throw new r5;if(a.finish_reason==="content_filter")throw new a5;return{...a,message:{...a.message,...a.message.tool_calls?{tool_calls:((n=a.message.tool_calls)==null?void 0:n.map(i=>jS(t,i)))??void 0}:void 0,parsed:a.message.content&&!a.message.refusal?NS(t,a.message.content):null}}});return{...e,choices:r}}function NS(e,t){var r,a;return((r=e.response_format)==null?void 0:r.type)!=="json_schema"?null:((a=e.response_format)==null?void 0:a.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function jS(e,t){var a;const r=(a=e.tools)==null?void 0:a.find(n=>{var i;return((i=n.function)==null?void 0:i.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:X0(r)?r.$parseRaw(t.function.arguments):r!=null&&r.function.strict?JSON.parse(t.function.arguments):null}}}function TS(e,t){var a;if(!e)return!1;const r=(a=e.tools)==null?void 0:a.find(n=>{var i;return((i=n.function)==null?void 0:i.name)===t.function.name});return X0(r)||(r==null?void 0:r.function.strict)||!1}function w5(e){var t;return I1(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(r=>X0(r)||r.type==="function"&&r.function.strict===!0))??!1}function ES(e){for(const t of e??[]){if(t.type!=="function")throw new Dt(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new Dt(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Fn=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},fn,zp,Uf,Up,Wp,qp,_5,Hp;const Eg=10;class k5 extends C1{constructor(){super(...arguments),fn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var a;this._chatCompletions.push(t),this._emit("chatCompletion",t);const r=(a=t.choices[0])==null?void 0:a.message;return r&&this._addMessage(r),t}_addMessage(t,r=!0){if("content"in t||(t.content=null),this.messages.push(t),r){if(this._emit("message",t),(y5(t)||b5(t))&&t.content)this._emit("functionCallResult",t.content);else if(tc(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(tc(t)&&t.tool_calls)for(const a of t.tool_calls)a.type==="function"&&this._emit("functionCall",a.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new Dt("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Fn(this,fn,"m",zp).call(this)}async finalMessage(){return await this.done(),Fn(this,fn,"m",Uf).call(this)}async finalFunctionCall(){return await this.done(),Fn(this,fn,"m",Up).call(this)}async finalFunctionCallResult(){return await this.done(),Fn(this,fn,"m",Wp).call(this)}async totalUsage(){return await this.done(),Fn(this,fn,"m",qp).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const r=Fn(this,fn,"m",Uf).call(this);r&&this._emit("finalMessage",r);const a=Fn(this,fn,"m",zp).call(this);a&&this._emit("finalContent",a);const n=Fn(this,fn,"m",Up).call(this);n&&this._emit("finalFunctionCall",n);const i=Fn(this,fn,"m",Wp).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",Fn(this,fn,"m",qp).call(this))}async _createChatCompletion(t,r,a){const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Fn(this,fn,"m",_5).call(this,r);const i=await t.chat.completions.create({...r,stream:!1},{...a,signal:this.controller.signal});return this._connected(),this._addChatCompletion(L1(i,r))}async _runChatCompletion(t,r,a){for(const n of r.messages)this._addMessage(n,!1);return await this._createChatCompletion(t,r,a)}async _runFunctions(t,r,a){var p;const n="function",{function_call:i="auto",stream:o,...l}=r,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=Eg}=a||{},f={};for(const d of r.functions)f[d.name||d.function.name]=d;const h=r.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of r.messages)this._addMessage(d,!1);for(let d=0;d<u;++d){const m=(p=(await this._createChatCompletion(t,{...l,function_call:i,functions:h,messages:[...this.messages]},a)).choices[0])==null?void 0:p.message;if(!m)throw new Dt("missing message in ChatCompletion response");if(!m.function_call)return;const{name:y,arguments:_}=m.function_call,k=f[y];if(k){if(c&&c!==y){const E=`Invalid function_call: ${JSON.stringify(y)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:n,name:y,content:E});continue}}else{const E=`Invalid function_call: ${JSON.stringify(y)}. Available options are: ${h.map(A=>JSON.stringify(A.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:y,content:E});continue}let g;try{g=Tg(k)?await k.parse(_):_}catch(E){this._addMessage({role:n,name:y,content:E instanceof Error?E.message:String(E)});continue}const w=await k.function(g,this),C=Fn(this,fn,"m",Hp).call(this,w);if(this._addMessage({role:n,name:y,content:C}),c)return}}async _runTools(t,r,a){var d,v,m;const n="tool",{tool_choice:i="auto",stream:o,...l}=r,c=typeof i!="string"&&((d=i==null?void 0:i.function)==null?void 0:d.name),{maxChatCompletions:u=Eg}=a||{},f=r.tools.map(y=>{if(X0(y)){if(!y.$callback)throw new Dt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:y.$callback,name:y.function.name,description:y.function.description||"",parameters:y.function.parameters,parse:y.$parseRaw,strict:!0}}}return y}),h={};for(const y of f)y.type==="function"&&(h[y.function.name||y.function.function.name]=y.function);const p="tools"in r?f.map(y=>y.type==="function"?{type:"function",function:{name:y.function.name||y.function.function.name,parameters:y.function.parameters,description:y.function.description,strict:y.function.strict}}:y):void 0;for(const y of r.messages)this._addMessage(y,!1);for(let y=0;y<u;++y){const k=(v=(await this._createChatCompletion(t,{...l,tool_choice:i,tools:p,messages:[...this.messages]},a)).choices[0])==null?void 0:v.message;if(!k)throw new Dt("missing message in ChatCompletion response");if(!((m=k.tool_calls)!=null&&m.length))return;for(const g of k.tool_calls){if(g.type!=="function")continue;const w=g.id,{name:C,arguments:E}=g.function,A=h[C];if(A){if(c&&c!==C){const L=`Invalid tool_call: ${JSON.stringify(C)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:n,tool_call_id:w,content:L});continue}}else{const L=`Invalid tool_call: ${JSON.stringify(C)}. Available options are: ${Object.keys(h).map(F=>JSON.stringify(F)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:w,content:L});continue}let I;try{I=Tg(A)?await A.parse(E):E}catch(L){const F=L instanceof Error?L.message:String(L);this._addMessage({role:n,tool_call_id:w,content:F});continue}const D=await A.function(I,this),B=Fn(this,fn,"m",Hp).call(this,D);if(this._addMessage({role:n,tool_call_id:w,content:B}),c)return}}}}fn=new WeakSet,zp=function(){return Fn(this,fn,"m",Uf).call(this).content??null},Uf=function(){let t=this.messages.length;for(;t-- >0;){const r=this.messages[t];if(tc(r)){const{function_call:a,...n}=r,i={...n,content:r.content??null,refusal:r.refusal??null};return a&&(i.function_call=a),i}}throw new Dt("stream ended without producing a ChatCompletionMessage with role=assistant")},Up=function(){var t,r;for(let a=this.messages.length-1;a>=0;a--){const n=this.messages[a];if(tc(n)&&(n!=null&&n.function_call))return n.function_call;if(tc(n)&&((t=n==null?void 0:n.tool_calls)!=null&&t.length))return(r=n.tool_calls.at(-1))==null?void 0:r.function}},Wp=function(){for(let t=this.messages.length-1;t>=0;t--){const r=this.messages[t];if(y5(r)&&r.content!=null||b5(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(a=>{var n;return a.role==="assistant"&&((n=a.tool_calls)==null?void 0:n.some(i=>i.type==="function"&&i.id===r.tool_call_id))}))return r.content}},qp=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(t.completion_tokens+=r.completion_tokens,t.prompt_tokens+=r.prompt_tokens,t.total_tokens+=r.total_tokens);return t},_5=function(t){if(t.n!=null&&t.n>1)throw new Dt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Hp=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};class A0 extends k5{static runFunctions(t,r,a){const n=new A0,i={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(t,r,i)),n}static runTools(t,r,a){const n=new A0,i={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(t,r,i)),n}_addMessage(t,r=!0){super._addMessage(t,r),tc(t)&&t.content&&this._emit("content",t.content)}}const S5=1,A5=2,N5=4,j5=8,T5=16,E5=32,C5=64,F5=128,D5=256,I5=F5|D5,L5=T5|E5|I5|C5,P5=S5|A5|L5,R5=N5|j5,CS=P5|R5,Ua={STR:S5,NUM:A5,ARR:N5,OBJ:j5,NULL:T5,BOOL:E5,NAN:C5,INFINITY:F5,MINUS_INFINITY:D5,INF:I5,SPECIAL:L5,ATOM:P5,COLLECTION:R5,ALL:CS};class FS extends Error{}class DS extends Error{}function IS(e,t=Ua.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return LS(e.trim(),t)}const LS=(e,t)=>{const r=e.length;let a=0;const n=p=>{throw new FS(`${p} at position ${a}`)},i=p=>{throw new DS(`${p} at position ${a}`)},o=()=>(h(),a>=r&&n("Unexpected end of input"),e[a]==='"'?l():e[a]==="{"?c():e[a]==="["?u():e.substring(a,a+4)==="null"||Ua.NULL&t&&r-a<4&&"null".startsWith(e.substring(a))?(a+=4,null):e.substring(a,a+4)==="true"||Ua.BOOL&t&&r-a<4&&"true".startsWith(e.substring(a))?(a+=4,!0):e.substring(a,a+5)==="false"||Ua.BOOL&t&&r-a<5&&"false".startsWith(e.substring(a))?(a+=5,!1):e.substring(a,a+8)==="Infinity"||Ua.INFINITY&t&&r-a<8&&"Infinity".startsWith(e.substring(a))?(a+=8,1/0):e.substring(a,a+9)==="-Infinity"||Ua.MINUS_INFINITY&t&&1<r-a&&r-a<9&&"-Infinity".startsWith(e.substring(a))?(a+=9,-1/0):e.substring(a,a+3)==="NaN"||Ua.NAN&t&&r-a<3&&"NaN".startsWith(e.substring(a))?(a+=3,NaN):f()),l=()=>{const p=a;let d=!1;for(a++;a<r&&(e[a]!=='"'||d&&e[a-1]==="\\");)d=e[a]==="\\"?!d:!1,a++;if(e.charAt(a)=='"')try{return JSON.parse(e.substring(p,++a-Number(d)))}catch(v){i(String(v))}else if(Ua.STR&t)try{return JSON.parse(e.substring(p,a-Number(d))+'"')}catch{return JSON.parse(e.substring(p,e.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},c=()=>{a++,h();const p={};try{for(;e[a]!=="}";){if(h(),a>=r&&Ua.OBJ&t)return p;const d=l();h(),a++;try{const v=o();Object.defineProperty(p,d,{value:v,writable:!0,enumerable:!0,configurable:!0})}catch(v){if(Ua.OBJ&t)return p;throw v}h(),e[a]===","&&a++}}catch{if(Ua.OBJ&t)return p;n("Expected '}' at end of object")}return a++,p},u=()=>{a++;const p=[];try{for(;e[a]!=="]";)p.push(o()),h(),e[a]===","&&a++}catch{if(Ua.ARR&t)return p;n("Expected ']' at end of array")}return a++,p},f=()=>{if(a===0){e==="-"&&Ua.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e)}catch(d){if(Ua.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}i(String(d))}}const p=a;for(e[a]==="-"&&a++;e[a]&&!",]}".includes(e[a]);)a++;a==r&&!(Ua.NUM&t)&&n("Unterminated number literal");try{return JSON.parse(e.substring(p,a))}catch{e.substring(p,a)==="-"&&Ua.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e.substring(p,e.lastIndexOf("e")))}catch(v){i(String(v))}}},h=()=>{for(;a<r&&` 
\r	`.includes(e[a]);)a++};return o()},Cg=e=>IS(e,Ua.ALL^Ua.NUM);var Pl=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},Cr=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},Pa,js,Rl,no,Oh,Ku,Bh,Mh,zh,Yu,Uh,Fg;class N0 extends k5{constructor(t){super(),Pa.add(this),js.set(this,void 0),Rl.set(this,void 0),no.set(this,void 0),Pl(this,js,t,"f"),Pl(this,Rl,[],"f")}get currentChatCompletionSnapshot(){return Cr(this,no,"f")}static fromReadableStream(t){const r=new N0(null);return r._run(()=>r._fromReadableStream(t)),r}static createChatCompletion(t,r,a){const n=new N0(r);return n._run(()=>n._runChatCompletion(t,{...r,stream:!0},{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(t,r,a){var o;super._createChatCompletion;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Cr(this,Pa,"m",Oh).call(this);const i=await t.chat.completions.create({...r,stream:!0},{...a,signal:this.controller.signal});this._connected();for await(const l of i)Cr(this,Pa,"m",Bh).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new pi;return this._addChatCompletion(Cr(this,Pa,"m",Yu).call(this))}async _fromReadableStream(t,r){var o;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Cr(this,Pa,"m",Oh).call(this),this._connected();const n=rs.fromReadableStream(t,this.controller);let i;for await(const l of n)i&&i!==l.id&&this._addChatCompletion(Cr(this,Pa,"m",Yu).call(this)),Cr(this,Pa,"m",Bh).call(this,l),i=l.id;if((o=n.controller.signal)!=null&&o.aborted)throw new pi;return this._addChatCompletion(Cr(this,Pa,"m",Yu).call(this))}[(js=new WeakMap,Rl=new WeakMap,no=new WeakMap,Pa=new WeakSet,Oh=function(){this.ended||Pl(this,no,void 0,"f")},Ku=function(r){let a=Cr(this,Rl,"f")[r.index];return a||(a={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Cr(this,Rl,"f")[r.index]=a,a)},Bh=function(r){var n,i,o,l,c,u,f,h,p,d,v,m,y,_,k;if(this.ended)return;const a=Cr(this,Pa,"m",Fg).call(this,r);this._emit("chunk",r,a);for(const g of r.choices){const w=a.choices[g.index];g.delta.content!=null&&((n=w.message)==null?void 0:n.role)==="assistant"&&((i=w.message)!=null&&i.content)&&(this._emit("content",g.delta.content,w.message.content),this._emit("content.delta",{delta:g.delta.content,snapshot:w.message.content,parsed:w.message.parsed})),g.delta.refusal!=null&&((o=w.message)==null?void 0:o.role)==="assistant"&&((l=w.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:g.delta.refusal,snapshot:w.message.refusal}),((c=g.logprobs)==null?void 0:c.content)!=null&&((u=w.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=g.logprobs)==null?void 0:f.content,snapshot:((h=w.logprobs)==null?void 0:h.content)??[]}),((p=g.logprobs)==null?void 0:p.refusal)!=null&&((d=w.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(v=g.logprobs)==null?void 0:v.refusal,snapshot:((m=w.logprobs)==null?void 0:m.refusal)??[]});const C=Cr(this,Pa,"m",Ku).call(this,w);w.finish_reason&&(Cr(this,Pa,"m",zh).call(this,w),C.current_tool_call_index!=null&&Cr(this,Pa,"m",Mh).call(this,w,C.current_tool_call_index));for(const E of g.delta.tool_calls??[])C.current_tool_call_index!==E.index&&(Cr(this,Pa,"m",zh).call(this,w),C.current_tool_call_index!=null&&Cr(this,Pa,"m",Mh).call(this,w,C.current_tool_call_index)),C.current_tool_call_index=E.index;for(const E of g.delta.tool_calls??[]){const A=(y=w.message.tool_calls)==null?void 0:y[E.index];A!=null&&A.type&&((A==null?void 0:A.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(_=A.function)==null?void 0:_.name,index:E.index,arguments:A.function.arguments,parsed_arguments:A.function.parsed_arguments,arguments_delta:((k=E.function)==null?void 0:k.arguments)??""}):(A==null||A.type,void 0))}}},Mh=function(r,a){var o,l,c;if(Cr(this,Pa,"m",Ku).call(this,r).done_tool_calls.has(a))return;const i=(o=r.message.tool_calls)==null?void 0:o[a];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=Cr(this,js,"f"))==null?void 0:l.tools)==null?void 0:c.find(f=>f.type==="function"&&f.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:a,arguments:i.function.arguments,parsed_arguments:X0(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},zh=function(r){var n,i;const a=Cr(this,Pa,"m",Ku).call(this,r);if(r.message.content&&!a.content_done){a.content_done=!0;const o=Cr(this,Pa,"m",Uh).call(this);this._emit("content.done",{content:r.message.content,parsed:o?o.$parseRaw(r.message.content):null})}r.message.refusal&&!a.refusal_done&&(a.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),(n=r.logprobs)!=null&&n.content&&!a.logprobs_content_done&&(a.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),(i=r.logprobs)!=null&&i.refusal&&!a.logprobs_refusal_done&&(a.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},Yu=function(){if(this.ended)throw new Dt("stream has ended, this shouldn't happen");const r=Cr(this,no,"f");if(!r)throw new Dt("request ended without sending any chunks");return Pl(this,no,void 0,"f"),Pl(this,Rl,[],"f"),PS(r,Cr(this,js,"f"))},Uh=function(){var a;const r=(a=Cr(this,js,"f"))==null?void 0:a.response_format;return I1(r)?r:null},Fg=function(r){var a,n,i,o;let l=Cr(this,no,"f");const{choices:c,...u}=r;l?Object.assign(l,u):l=Pl(this,no,{...u,choices:[]},"f");for(const{delta:f,finish_reason:h,index:p,logprobs:d=null,...v}of r.choices){let m=l.choices[p];if(m||(m=l.choices[p]={finish_reason:h,index:p,message:{},logprobs:d,...v}),d)if(!m.logprobs)m.logprobs=Object.assign({},d);else{const{content:E,refusal:A,...I}=d;Object.assign(m.logprobs,I),E&&((a=m.logprobs).content??(a.content=[]),m.logprobs.content.push(...E)),A&&((n=m.logprobs).refusal??(n.refusal=[]),m.logprobs.refusal.push(...A))}if(h&&(m.finish_reason=h,Cr(this,js,"f")&&w5(Cr(this,js,"f")))){if(h==="length")throw new r5;if(h==="content_filter")throw new a5}if(Object.assign(m,v),!f)continue;const{content:y,refusal:_,function_call:k,role:g,tool_calls:w,...C}=f;if(Object.assign(m.message,C),_&&(m.message.refusal=(m.message.refusal||"")+_),g&&(m.message.role=g),k&&(m.message.function_call?(k.name&&(m.message.function_call.name=k.name),k.arguments&&((i=m.message.function_call).arguments??(i.arguments=""),m.message.function_call.arguments+=k.arguments)):m.message.function_call=k),y&&(m.message.content=(m.message.content||"")+y,!m.message.refusal&&Cr(this,Pa,"m",Uh).call(this)&&(m.message.parsed=Cg(m.message.content))),w){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:E,id:A,type:I,function:D,...B}of w){const L=(o=m.message.tool_calls)[E]??(o[E]={});Object.assign(L,B),A&&(L.id=A),I&&(L.type=I),D&&(L.function??(L.function={name:D.name??"",arguments:""})),D!=null&&D.name&&(L.function.name=D.name),D!=null&&D.arguments&&(L.function.arguments+=D.arguments,TS(Cr(this,js,"f"),L)&&(L.function.parsed_arguments=Cg(L.function.arguments)))}}}return l},Symbol.asyncIterator)](){const t=[],r=[];let a=!1;return this.on("chunk",n=>{const i=r.shift();i?i.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of r)n.resolve(void 0);r.length=0}),this.on("abort",n=>{a=!0;for(const i of r)i.reject(n);r.length=0}),this.on("error",n=>{a=!0;for(const i of r)i.reject(n);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((i,o)=>r.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new rs(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function PS(e,t){const{id:r,choices:a,created:n,model:i,system_fingerprint:o,...l}=e,c={...l,id:r,choices:a.map(({message:u,finish_reason:f,index:h,logprobs:p,...d})=>{if(!f)throw new Dt(`missing finish_reason for choice ${h}`);const{content:v=null,function_call:m,tool_calls:y,..._}=u,k=u.role;if(!k)throw new Dt(`missing role for choice ${h}`);if(m){const{arguments:g,name:w}=m;if(g==null)throw new Dt(`missing function_call.arguments for choice ${h}`);if(!w)throw new Dt(`missing function_call.name for choice ${h}`);return{...d,message:{content:v,function_call:{arguments:g,name:w},role:k,refusal:u.refusal??null},finish_reason:f,index:h,logprobs:p}}return y?{...d,index:h,finish_reason:f,logprobs:p,message:{..._,role:k,content:v,refusal:u.refusal??null,tool_calls:y.map((g,w)=>{const{function:C,type:E,id:A,...I}=g,{arguments:D,name:B,...L}=C||{};if(A==null)throw new Dt(`missing choices[${h}].tool_calls[${w}].id
${Xu(e)}`);if(E==null)throw new Dt(`missing choices[${h}].tool_calls[${w}].type
${Xu(e)}`);if(B==null)throw new Dt(`missing choices[${h}].tool_calls[${w}].function.name
${Xu(e)}`);if(D==null)throw new Dt(`missing choices[${h}].tool_calls[${w}].function.arguments
${Xu(e)}`);return{...I,id:A,type:E,function:{...L,name:B,arguments:D}}})}}:{...d,message:{..._,content:v,role:k,refusal:u.refusal??null},finish_reason:f,index:h,logprobs:p}}),created:n,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return AS(c,t)}function Xu(e){return JSON.stringify(e)}class rc extends N0{static fromReadableStream(t){const r=new rc(null);return r._run(()=>r._fromReadableStream(t)),r}static runFunctions(t,r,a){const n=new rc(null),i={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(t,r,i)),n}static runTools(t,r,a){const n=new rc(r),i={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(t,r,i)),n}}let O5=class extends Rt{parse(t,r){return ES(t.tools),this._client.chat.completions.create(t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(a=>L1(a,t))}runFunctions(t,r){return t.stream?rc.runFunctions(this._client,t,r):A0.runFunctions(this._client,t,r)}runTools(t,r){return t.stream?rc.runTools(this._client,t,r):A0.runTools(this._client,t,r)}stream(t,r){return N0.createChatCompletion(this._client,t,r)}};class $p extends Rt{constructor(){super(...arguments),this.completions=new O5(this._client)}}(function(e){e.Completions=O5})($p||($p={}));class B5 extends Rt{create(t,r){return this._client.post("/realtime/sessions",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class M5 extends Rt{create(t,r){return this._client.post("/realtime/transcription_sessions",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class wd extends Rt{constructor(){super(...arguments),this.sessions=new B5(this._client),this.transcriptionSessions=new M5(this._client)}}wd.Sessions=B5;wd.TranscriptionSessions=M5;class P1 extends Rt{create(t,r,a){return this._client.post(`/threads/${t}/messages`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}retrieve(t,r,a){return this._client.get(`/threads/${t}/messages/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}update(t,r,a,n){return this._client.post(`/threads/${t}/messages/${r}`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/threads/${t}/messages`,R1,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}del(t,r,a){return this._client.delete(`/threads/${t}/messages/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class R1 extends Ma{}P1.MessagesPage=R1;class O1 extends Rt{retrieve(t,r,a,n={},i){return ta(n)?this.retrieve(t,r,a,{},n):this._client.get(`/threads/${t}/runs/${r}/steps/${a}`,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(t,r,a={},n){return ta(a)?this.list(t,r,{},a):this._client.getAPIList(`/threads/${t}/runs/${r}/steps`,B1,{query:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class B1 extends Ma{}O1.RunStepsPage=B1;let J0=class extends Rt{constructor(){super(...arguments),this.steps=new O1(this._client)}create(t,r,a){const{include:n,...i}=r;return this._client.post(`/threads/${t}/runs`,{query:{include:n},body:i,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}retrieve(t,r,a){return this._client.get(`/threads/${t}/runs/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}update(t,r,a,n){return this._client.post(`/threads/${t}/runs/${r}`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/threads/${t}/runs`,M1,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}cancel(t,r,a){return this._client.post(`/threads/${t}/runs/${r}/cancel`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async createAndPoll(t,r,a){const n=await this.create(t,r,a);return await this.poll(t,n.id,a)}createAndStream(t,r,a){return Ii.createAssistantStream(t,this._client.beta.threads.runs,r,a)}async poll(t,r,a){const n={...a==null?void 0:a.headers,"X-Stainless-Poll-Helper":"true"};for(a!=null&&a.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=a.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(t,r,{...a,headers:{...a==null?void 0:a.headers,...n}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(a!=null&&a.pollIntervalMs)l=a.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await K0(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(t,r,a){return Ii.createAssistantStream(t,this._client.beta.threads.runs,r,a)}submitToolOutputs(t,r,a,n){return this._client.post(`/threads/${t}/runs/${r}/submit_tool_outputs`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:a.stream??!1})}async submitToolOutputsAndPoll(t,r,a,n){const i=await this.submitToolOutputs(t,r,a,n);return await this.poll(t,i.id,n)}submitToolOutputsStream(t,r,a,n){return Ii.createToolAssistantStream(t,r,this._client.beta.threads.runs,a,n)}};class M1 extends Ma{}J0.RunsPage=M1;J0.Steps=O1;J0.RunStepsPage=B1;class vc extends Rt{constructor(){super(...arguments),this.runs=new J0(this._client),this.messages=new P1(this._client)}create(t={},r){return ta(t)?this.create({},t):this._client.post("/threads",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/threads/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,a){return this._client.post(`/threads/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}del(t,r){return this._client.delete(`/threads/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(t,r){return this._client.post("/threads/runs",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}async createAndRunPoll(t,r){const a=await this.createAndRun(t,r);return await this.runs.poll(a.thread_id,a.id,r)}createAndRunStream(t,r){return Ii.createThreadAssistantStream(t,this._client.beta.threads,r)}}vc.Runs=J0;vc.RunsPage=M1;vc.Messages=P1;vc.MessagesPage=R1;class yc extends Rt{constructor(){super(...arguments),this.realtime=new wd(this._client),this.chat=new $p(this._client),this.assistants=new F1(this._client),this.threads=new vc(this._client)}}yc.Realtime=wd;yc.Assistants=F1;yc.AssistantsPage=D1;yc.Threads=vc;class z5 extends Rt{create(t,r){return this._client.post("/completions",{body:t,...r,stream:t.stream??!1})}}class U5 extends Rt{retrieve(t,r,a){return this._client.get(`/containers/${t}/files/${r}/content`,{...a,headers:{Accept:"application/binary",...a==null?void 0:a.headers},__binaryResponse:!0})}}let _d=class extends Rt{constructor(){super(...arguments),this.content=new U5(this._client)}create(t,r,a){return this._client.post(`/containers/${t}/files`,al({body:r,...a}))}retrieve(t,r,a){return this._client.get(`/containers/${t}/files/${r}`,a)}list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/containers/${t}/files`,z1,{query:r,...a})}del(t,r,a){return this._client.delete(`/containers/${t}/files/${r}`,{...a,headers:{Accept:"*/*",...a==null?void 0:a.headers}})}};class z1 extends Ma{}_d.FileListResponsesPage=z1;_d.Content=U5;class Z0 extends Rt{constructor(){super(...arguments),this.files=new _d(this._client)}create(t,r){return this._client.post("/containers",{body:t,...r})}retrieve(t,r){return this._client.get(`/containers/${t}`,r)}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/containers",U1,{query:t,...r})}del(t,r){return this._client.delete(`/containers/${t}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}}class U1 extends Ma{}Z0.ContainerListResponsesPage=U1;Z0.Files=_d;Z0.FileListResponsesPage=z1;class W5 extends Rt{create(t,r){const a=!!t.encoding_format;let n=a?t.encoding_format:"base64";a&&go("Request","User defined encoding_format:",t.encoding_format);const i=this._client.post("/embeddings",{body:{...t,encoding_format:n},...r});return a?i:(go("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=kS(c)}),o)))}}class W1 extends Rt{retrieve(t,r,a,n){return this._client.get(`/evals/${t}/runs/${r}/output_items/${a}`,n)}list(t,r,a={},n){return ta(a)?this.list(t,r,{},a):this._client.getAPIList(`/evals/${t}/runs/${r}/output_items`,q1,{query:a,...n})}}class q1 extends Ma{}W1.OutputItemListResponsesPage=q1;class Q0 extends Rt{constructor(){super(...arguments),this.outputItems=new W1(this._client)}create(t,r,a){return this._client.post(`/evals/${t}/runs`,{body:r,...a})}retrieve(t,r,a){return this._client.get(`/evals/${t}/runs/${r}`,a)}list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/evals/${t}/runs`,H1,{query:r,...a})}del(t,r,a){return this._client.delete(`/evals/${t}/runs/${r}`,a)}cancel(t,r,a){return this._client.post(`/evals/${t}/runs/${r}`,a)}}class H1 extends Ma{}Q0.RunListResponsesPage=H1;Q0.OutputItems=W1;Q0.OutputItemListResponsesPage=q1;class eu extends Rt{constructor(){super(...arguments),this.runs=new Q0(this._client)}create(t,r){return this._client.post("/evals",{body:t,...r})}retrieve(t,r){return this._client.get(`/evals/${t}`,r)}update(t,r,a){return this._client.post(`/evals/${t}`,{body:r,...a})}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/evals",$1,{query:t,...r})}del(t,r){return this._client.delete(`/evals/${t}`,r)}}class $1 extends Ma{}eu.EvalListResponsesPage=$1;eu.Runs=Q0;eu.RunListResponsesPage=H1;let V1=class extends Rt{create(t,r){return this._client.post("/files",al({body:t,...r}))}retrieve(t,r){return this._client.get(`/files/${t}`,r)}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/files",G1,{query:t,...r})}del(t,r){return this._client.delete(`/files/${t}`,r)}content(t,r){return this._client.get(`/files/${t}/content`,{...r,headers:{Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})}retrieveContent(t,r){return this._client.get(`/files/${t}/content`,r)}async waitForProcessing(t,{pollInterval:r=5e3,maxWait:a=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(t);for(;!o.status||!n.has(o.status);)if(await K0(r),o=await this.retrieve(t),Date.now()-i>a)throw new j1({message:`Giving up on waiting for file ${t} to finish processing after ${a} milliseconds.`});return o}};class G1 extends Ma{}V1.FileObjectsPage=G1;class q5 extends Rt{}let H5=class extends Rt{run(t,r){return this._client.post("/fine_tuning/alpha/graders/run",{body:t,...r})}validate(t,r){return this._client.post("/fine_tuning/alpha/graders/validate",{body:t,...r})}};class K1 extends Rt{constructor(){super(...arguments),this.graders=new H5(this._client)}}K1.Graders=H5;class Y1 extends Rt{create(t,r,a){return this._client.getAPIList(`/fine_tuning/checkpoints/${t}/permissions`,X1,{body:r,method:"post",...a})}retrieve(t,r={},a){return ta(r)?this.retrieve(t,{},r):this._client.get(`/fine_tuning/checkpoints/${t}/permissions`,{query:r,...a})}del(t,r,a){return this._client.delete(`/fine_tuning/checkpoints/${t}/permissions/${r}`,a)}}class X1 extends gd{}Y1.PermissionCreateResponsesPage=X1;let kd=class extends Rt{constructor(){super(...arguments),this.permissions=new Y1(this._client)}};kd.Permissions=Y1;kd.PermissionCreateResponsesPage=X1;class J1 extends Rt{list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Z1,{query:r,...a})}}class Z1 extends Ma{}J1.FineTuningJobCheckpointsPage=Z1;class bc extends Rt{constructor(){super(...arguments),this.checkpoints=new J1(this._client)}create(t,r){return this._client.post("/fine_tuning/jobs",{body:t,...r})}retrieve(t,r){return this._client.get(`/fine_tuning/jobs/${t}`,r)}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",Q1,{query:t,...r})}cancel(t,r){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,r)}listEvents(t,r={},a){return ta(r)?this.listEvents(t,{},r):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,em,{query:r,...a})}pause(t,r){return this._client.post(`/fine_tuning/jobs/${t}/pause`,r)}resume(t,r){return this._client.post(`/fine_tuning/jobs/${t}/resume`,r)}}class Q1 extends Ma{}class em extends Ma{}bc.FineTuningJobsPage=Q1;bc.FineTuningJobEventsPage=em;bc.Checkpoints=J1;bc.FineTuningJobCheckpointsPage=Z1;class ko extends Rt{constructor(){super(...arguments),this.methods=new q5(this._client),this.jobs=new bc(this._client),this.checkpoints=new kd(this._client),this.alpha=new K1(this._client)}}ko.Methods=q5;ko.Jobs=bc;ko.FineTuningJobsPage=Q1;ko.FineTuningJobEventsPage=em;ko.Checkpoints=kd;ko.Alpha=K1;class $5 extends Rt{}class tm extends Rt{constructor(){super(...arguments),this.graderModels=new $5(this._client)}}tm.GraderModels=$5;class V5 extends Rt{createVariation(t,r){return this._client.post("/images/variations",al({body:t,...r}))}edit(t,r){return this._client.post("/images/edits",al({body:t,...r}))}generate(t,r){return this._client.post("/images/generations",{body:t,...r})}}class rm extends Rt{retrieve(t,r){return this._client.get(`/models/${t}`,r)}list(t){return this._client.getAPIList("/models",am,t)}del(t,r){return this._client.delete(`/models/${t}`,r)}}class am extends gd{}rm.ModelsPage=am;class G5 extends Rt{create(t,r){return this._client.post("/moderations",{body:t,...r})}}function RS(e,t){return!t||!BS(t)?{...e,output_parsed:null,output:e.output.map(r=>r.type==="function_call"?{...r,parsed_arguments:null}:r.type==="message"?{...r,content:r.content.map(a=>({...a,parsed:null}))}:r)}:K5(e,t)}function K5(e,t){const r=e.output.map(n=>{if(n.type==="function_call")return{...n,parsed_arguments:US(t,n)};if(n.type==="message"){const i=n.content.map(o=>o.type==="output_text"?{...o,parsed:OS(t,o.text)}:o);return{...n,content:i}}return n}),a=Object.assign({},e,{output:r});return Object.getOwnPropertyDescriptor(e,"output_text")||Y5(a),Object.defineProperty(a,"output_parsed",{enumerable:!0,get(){for(const n of a.output)if(n.type==="message"){for(const i of n.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),a}function OS(e,t){var r,a,n,i;return((a=(r=e.text)==null?void 0:r.format)==null?void 0:a.type)!=="json_schema"?null:"$parseRaw"in((n=e.text)==null?void 0:n.format)?((i=e.text)==null?void 0:i.format).$parseRaw(t):JSON.parse(t)}function BS(e){var t;return!!I1((t=e.text)==null?void 0:t.format)}function MS(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function zS(e,t){return e.find(r=>r.type==="function"&&r.name===t)}function US(e,t){const r=zS(e.tools??[],t.name);return{...t,...t,parsed_arguments:MS(r)?r.$parseRaw(t.arguments):r!=null&&r.strict?JSON.parse(t.arguments):null}}function Y5(e){const t=[];for(const r of e.output)if(r.type==="message")for(const a of r.content)a.type==="output_text"&&t.push(a.text);e.output_text=t.join("")}class X5 extends Rt{list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/responses/${t}/input_items`,qS,{query:r,...a})}}var Ol=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},io=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},Bl,Ju,so,Zu,Dg,Ig,Lg,Pg;class nm extends C1{constructor(t){super(),Bl.add(this),Ju.set(this,void 0),so.set(this,void 0),Zu.set(this,void 0),Ol(this,Ju,t,"f")}static createResponse(t,r,a){const n=new nm(r);return n._run(()=>n._createOrRetrieveResponse(t,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createOrRetrieveResponse(t,r,a){var l;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),io(this,Bl,"m",Dg).call(this);let i,o=null;"response_id"in r?(i=await t.responses.retrieve(r.response_id,{stream:!0},{...a,signal:this.controller.signal,stream:!0}),o=r.starting_after??null):i=await t.responses.create({...r,stream:!0},{...a,signal:this.controller.signal}),this._connected();for await(const c of i)io(this,Bl,"m",Ig).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new pi;return io(this,Bl,"m",Lg).call(this)}[(Ju=new WeakMap,so=new WeakMap,Zu=new WeakMap,Bl=new WeakSet,Dg=function(){this.ended||Ol(this,so,void 0,"f")},Ig=function(r,a){if(this.ended)return;const n=(o,l)=>{(a==null||l.sequence_number>a)&&this._emit(o,l)},i=io(this,Bl,"m",Pg).call(this,r);switch(n("event",r),r.type){case"response.output_text.delta":{const o=i.output[r.output_index];if(!o)throw new Dt(`missing output at index ${r.output_index}`);if(o.type==="message"){const l=o.content[r.content_index];if(!l)throw new Dt(`missing content at index ${r.content_index}`);if(l.type!=="output_text")throw new Dt(`expected content to be 'output_text', got ${l.type}`);n("response.output_text.delta",{...r,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[r.output_index];if(!o)throw new Dt(`missing output at index ${r.output_index}`);o.type==="function_call"&&n("response.function_call_arguments.delta",{...r,snapshot:o.arguments});break}default:n(r.type,r);break}},Lg=function(){if(this.ended)throw new Dt("stream has ended, this shouldn't happen");const r=io(this,so,"f");if(!r)throw new Dt("request ended without sending any events");Ol(this,so,void 0,"f");const a=WS(r,io(this,Ju,"f"));return Ol(this,Zu,a,"f"),a},Pg=function(r){let a=io(this,so,"f");if(!a){if(r.type!=="response.created")throw new Dt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${r.type}`);return a=Ol(this,so,r.response,"f"),a}switch(r.type){case"response.output_item.added":{a.output.push(r.item);break}case"response.content_part.added":{const n=a.output[r.output_index];if(!n)throw new Dt(`missing output at index ${r.output_index}`);n.type==="message"&&n.content.push(r.part);break}case"response.output_text.delta":{const n=a.output[r.output_index];if(!n)throw new Dt(`missing output at index ${r.output_index}`);if(n.type==="message"){const i=n.content[r.content_index];if(!i)throw new Dt(`missing content at index ${r.content_index}`);if(i.type!=="output_text")throw new Dt(`expected content to be 'output_text', got ${i.type}`);i.text+=r.delta}break}case"response.function_call_arguments.delta":{const n=a.output[r.output_index];if(!n)throw new Dt(`missing output at index ${r.output_index}`);n.type==="function_call"&&(n.arguments+=r.delta);break}case"response.completed":{Ol(this,so,r.response,"f");break}}return a},Symbol.asyncIterator)](){const t=[],r=[];let a=!1;return this.on("event",n=>{const i=r.shift();i?i.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of r)n.resolve(void 0);r.length=0}),this.on("abort",n=>{a=!0;for(const i of r)i.reject(n);r.length=0}),this.on("error",n=>{a=!0;for(const i of r)i.reject(n);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((i,o)=>r.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=io(this,Zu,"f");if(!t)throw new Dt("stream ended without producing a ChatCompletion");return t}}function WS(e,t){return RS(e,t)}class im extends Rt{constructor(){super(...arguments),this.inputItems=new X5(this._client)}create(t,r){return this._client.post("/responses",{body:t,...r,stream:t.stream??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&Y5(a),a))}retrieve(t,r={},a){return this._client.get(`/responses/${t}`,{query:r,...a,stream:(r==null?void 0:r.stream)??!1})}del(t,r){return this._client.delete(`/responses/${t}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}parse(t,r){return this._client.responses.create(t,r)._thenUnwrap(a=>K5(a,t))}stream(t,r){return nm.createResponse(this._client,t,r)}cancel(t,r){return this._client.post(`/responses/${t}/cancel`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}}class qS extends Ma{}im.InputItems=X5;class J5 extends Rt{create(t,r,a){return this._client.post(`/uploads/${t}/parts`,al({body:r,...a}))}}class sm extends Rt{constructor(){super(...arguments),this.parts=new J5(this._client)}create(t,r){return this._client.post("/uploads",{body:t,...r})}cancel(t,r){return this._client.post(`/uploads/${t}/cancel`,r)}complete(t,r,a){return this._client.post(`/uploads/${t}/complete`,{body:r,...a})}}sm.Parts=J5;const HS=async e=>{const t=await Promise.allSettled(e),r=t.filter(n=>n.status==="rejected");if(r.length){for(const n of r)console.error(n.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const a=[];for(const n of t)n.status==="fulfilled"&&a.push(n.value);return a};class Sd extends Rt{create(t,r,a){return this._client.post(`/vector_stores/${t}/files`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}retrieve(t,r,a){return this._client.get(`/vector_stores/${t}/files/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}update(t,r,a,n){return this._client.post(`/vector_stores/${t}/files/${r}`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t,r={},a){return ta(r)?this.list(t,{},r):this._client.getAPIList(`/vector_stores/${t}/files`,Ad,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}del(t,r,a){return this._client.delete(`/vector_stores/${t}/files/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async createAndPoll(t,r,a){const n=await this.create(t,r,a);return await this.poll(t,n.id,a)}async poll(t,r,a){const n={...a==null?void 0:a.headers,"X-Stainless-Poll-Helper":"true"};for(a!=null&&a.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=a.pollIntervalMs.toString());;){const i=await this.retrieve(t,r,{...a,headers:n}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(a!=null&&a.pollIntervalMs)l=a.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await K0(l);break;case"failed":case"completed":return o}}}async upload(t,r,a){const n=await this._client.files.create({file:r,purpose:"assistants"},a);return this.create(t,{file_id:n.id},a)}async uploadAndPoll(t,r,a){const n=await this.upload(t,r,a);return await this.poll(t,n.id,a)}content(t,r,a){return this._client.getAPIList(`/vector_stores/${t}/files/${r}/content`,om,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class Ad extends Ma{}class om extends gd{}Sd.VectorStoreFilesPage=Ad;Sd.FileContentResponsesPage=om;class Z5 extends Rt{create(t,r,a){return this._client.post(`/vector_stores/${t}/file_batches`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}retrieve(t,r,a){return this._client.get(`/vector_stores/${t}/file_batches/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}cancel(t,r,a){return this._client.post(`/vector_stores/${t}/file_batches/${r}/cancel`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async createAndPoll(t,r,a){const n=await this.create(t,r);return await this.poll(t,n.id,a)}listFiles(t,r,a={},n){return ta(a)?this.listFiles(t,r,{},a):this._client.getAPIList(`/vector_stores/${t}/file_batches/${r}/files`,Ad,{query:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async poll(t,r,a){const n={...a==null?void 0:a.headers,"X-Stainless-Poll-Helper":"true"};for(a!=null&&a.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=a.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(t,r,{...a,headers:n}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(a!=null&&a.pollIntervalMs)l=a.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await K0(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(t,{files:r,fileIds:a=[]},n){if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(n==null?void 0:n.maxConcurrency)??5,o=Math.min(i,r.length),l=this._client,c=r.values(),u=[...a];async function f(p){for(let d of p){const v=await l.files.create({file:d,purpose:"assistants"},n);u.push(v.id)}}const h=Array(o).fill(c).map(f);return await HS(h),await this.createAndPoll(t,{file_ids:u})}}class So extends Rt{constructor(){super(...arguments),this.files=new Sd(this._client),this.fileBatches=new Z5(this._client)}create(t,r){return this._client.post("/vector_stores",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/vector_stores/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,a){return this._client.post(`/vector_stores/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t={},r){return ta(t)?this.list({},t):this._client.getAPIList("/vector_stores",lm,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,r){return this._client.delete(`/vector_stores/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}search(t,r,a){return this._client.getAPIList(`/vector_stores/${t}/search`,cm,{body:r,method:"post",...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class lm extends Ma{}class cm extends gd{}So.VectorStoresPage=lm;So.VectorStoreSearchResponsesPage=cm;So.Files=Sd;So.VectorStoreFilesPage=Ad;So.FileContentResponsesPage=om;So.FileBatches=Z5;var Q5;class $t extends fS{constructor({baseURL:t=Vu("OPENAI_BASE_URL"),apiKey:r=Vu("OPENAI_API_KEY"),organization:a=Vu("OPENAI_ORG_ID")??null,project:n=Vu("OPENAI_PROJECT_ID")??null,...i}={}){if(r===void 0)throw new Dt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:r,organization:a,project:n,...i,baseURL:t||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&wS())throw new Dt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new z5(this),this.chat=new bd(this),this.embeddings=new W5(this),this.files=new V1(this),this.images=new V5(this),this.audio=new Y0(this),this.moderations=new G5(this),this.models=new rm(this),this.fineTuning=new ko(this),this.graders=new tm(this),this.vectorStores=new So(this),this.beta=new yc(this),this.batches=new T1(this),this.uploads=new sm(this),this.responses=new im(this),this.evals=new eu(this),this.containers=new Z0(this),this._options=o,this.apiKey=r,this.organization=a,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return G3(t,{arrayFormat:"brackets"})}}Q5=$t;$t.OpenAI=Q5;$t.DEFAULT_TIMEOUT=6e5;$t.OpenAIError=Dt;$t.APIError=rn;$t.APIConnectionError=hd;$t.APIConnectionTimeoutError=j1;$t.APIUserAbortError=pi;$t.NotFoundError=Jy;$t.ConflictError=Zy;$t.RateLimitError=e5;$t.BadRequestError=Ky;$t.AuthenticationError=Yy;$t.InternalServerError=t5;$t.PermissionDeniedError=Xy;$t.UnprocessableEntityError=Qy;$t.toFile=o5;$t.fileFromPath=$y;$t.Completions=z5;$t.Chat=bd;$t.ChatCompletionsPage=yd;$t.Embeddings=W5;$t.Files=V1;$t.FileObjectsPage=G1;$t.Images=V5;$t.Audio=Y0;$t.Moderations=G5;$t.Models=rm;$t.ModelsPage=am;$t.FineTuning=ko;$t.Graders=tm;$t.VectorStores=So;$t.VectorStoresPage=lm;$t.VectorStoreSearchResponsesPage=cm;$t.Beta=yc;$t.Batches=T1;$t.BatchesPage=E1;$t.Uploads=sm;$t.Responses=im;$t.Evals=eu;$t.EvalListResponsesPage=$1;$t.Containers=Z0;$t.ContainerListResponsesPage=U1;const nl="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",um=new $t({apiKey:nl,dangerouslyAllowBrowser:!0}),$S=async(e,t)=>{var r,a;try{const n=`Aşağıdaki Excel verilerini analiz et ve düzelt. Beklenen format:
Gerekli alanlar: ${t.requiredFields.join(", ")}
Alan tipleri: ${JSON.stringify(t.fieldTypes)}

Ham veri:
${JSON.stringify(e.slice(0,5),null,2)}

Lütfen:
1. Eksik alanları tespit et
2. Yanlış formatlı verileri düzelt
3. Tarih formatlarını standartlaştır (YYYY-MM-DD)
4. Sayısal değerleri temizle
5. Düzeltilmiş veriyi JSON formatında döndür

Sadece JSON döndür, açıklama yapma.`,o=((a=(r=(await um.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"system",content:"Sen bir veri düzenleme uzmanısın. Excel verilerini analiz edip düzeltiyorsun."},{role:"user",content:n}],temperature:.3,max_tokens:2e3})).choices[0])==null?void 0:r.message)==null?void 0:a.content)||"";try{const l=JSON.parse(o);return{success:!0,fixedData:Array.isArray(l)?l:[l],suggestions:["Veriler AI tarafından düzeltildi"]}}catch{return{success:!1,error:"AI yanıtı parse edilemedi",suggestions:[o]}}}catch(n){return console.error("AI format düzeltme hatası:",n),{success:!1,error:n.message||"AI servisi hatası"}}},VS=async(e,t,r)=>{var a,n;try{const i={totalMaterials:e.length,criticalMaterials:e.filter(u=>u.status==="red").length,warningMaterials:e.filter(u=>u.status==="orange").length,recentEntries:t.length,recentOutputs:r.length,topCritical:e.filter(u=>u.status==="red").slice(0,5).map(u=>({name:u.materialName,stock:u.currentStock,critical:u.criticalLevel}))},o=`Aşağıdaki stok durumu verilerini analiz et ve Türkçe bir rapor oluştur:

Toplam Malzeme: ${i.totalMaterials}
Kritik Durumda: ${i.criticalMaterials}
Uyarı Durumunda: ${i.warningMaterials}
Son Girişler: ${i.recentEntries}
Son Çıkışlar: ${i.recentOutputs}

En Kritik Malzemeler:
${JSON.stringify(i.topCritical,null,2)}

Lütfen şu formatta JSON döndür:
{
  "summary": "Genel özet (2-3 cümle)",
  "criticalIssues": ["Kritik sorun 1", "Kritik sorun 2"],
  "recommendations": ["Öneri 1", "Öneri 2"],
  "trends": ["Trend 1", "Trend 2"]
}`,c=((n=(a=(await um.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"system",content:"Sen bir stok yönetimi uzmanısın. Stok verilerini analiz edip öneriler sunuyorsun."},{role:"user",content:o}],temperature:.5,max_tokens:1500})).choices[0])==null?void 0:a.message)==null?void 0:n.content)||"";try{const u=JSON.parse(c);return{summary:u.summary||"Rapor oluşturulamadı",criticalIssues:u.criticalIssues||[],recommendations:u.recommendations||[],trends:u.trends||[]}}catch{return{summary:c.substring(0,200),criticalIssues:[],recommendations:[],trends:[]}}}catch(i){return console.error("AI rapor hatası:",i),{summary:"Rapor oluşturulurken hata oluştu: "+i.message,criticalIssues:[],recommendations:[],trends:[]}}},GS=async(e,t,r)=>{var a,n;try{const i=new Date,o=t.filter(p=>new Date(p.arrivalDate).toDateString()===i.toDateString()),l=r.filter(p=>new Date(p.issueDate).toDateString()===i.toDateString()),c={date:i.toLocaleDateString("tr-TR"),totalMaterials:e.length,criticalCount:e.filter(p=>p.status==="red").length,warningCount:e.filter(p=>p.status==="orange").length,todayEntries:o.length,todayOutputs:l.length,totalEntryValue:o.reduce((p,d)=>p+d.quantity*d.unitPrice,0),criticalMaterials:e.filter(p=>p.status==="red").slice(0,3).map(p=>p.materialName)},u=`Bugün (${c.date}) için stok yönetimi günlük raporu oluştur:

Toplam Malzeme: ${c.totalMaterials}
Kritik Durumda: ${c.criticalCount}
Uyarı Durumunda: ${c.warningCount}
Bugünkü Girişler: ${c.todayEntries}
Bugünkü Çıkışlar: ${c.todayOutputs}
Bugünkü Giriş Değeri: ${c.totalEntryValue.toFixed(2)} TL
Kritik Malzemeler: ${c.criticalMaterials.join(", ")}

Lütfen şu formatta JSON döndür:
{
  "summary": "Günün özeti (3-4 cümle)",
  "highlights": ["Önemli nokta 1", "Önemli nokta 2"],
  "warnings": ["Uyarı 1", "Uyarı 2"],
  "recommendations": ["Öneri 1", "Öneri 2"]
}`,h=((n=(a=(await um.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"system",content:"Sen bir ERP sistem uzmanısın. Günlük stok raporları oluşturuyorsun."},{role:"user",content:u}],temperature:.6,max_tokens:1500})).choices[0])==null?void 0:a.message)==null?void 0:n.content)||"";try{const p=JSON.parse(h);return{date:c.date,summary:p.summary||"Rapor oluşturulamadı",highlights:p.highlights||[],warnings:p.warnings||[],recommendations:p.recommendations||[]}}catch{return{date:c.date,summary:h.substring(0,300),highlights:[],warnings:[],recommendations:[]}}}catch(i){return console.error("Günlük AI rapor hatası:",i),{date:new Date().toLocaleDateString("tr-TR"),summary:"Rapor oluşturulurken hata oluştu: "+i.message,highlights:[],warnings:[],recommendations:[]}}},gt=()=>{try{const e=localStorage.getItem("currentUser");if(e){const t=JSON.parse(e);return{companyId:t.companyId,companyCode:t.companyCode}}return null}catch(e){return console.error("Şirket bilgisi alınırken hata:",e),null}};function KS(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState(!0),[c,u]=ue.useState(null),[f,h]=ue.useState(null),[p,d]=ue.useState(!1);ue.useEffect(()=>{v()},[]);const v=async()=>{try{const w=gt(),C=w==null?void 0:w.companyId,[E,A,I]=await Promise.all([gc(C),Py(C?{companyId:C}:void 0),Ry(C?{companyId:C}:void 0)]);t(E),a(A.slice(0,5)),i(I.slice(0,5)),y(E,A,I)}catch(w){console.error("Dashboard verileri yüklenirken hata:",w);const C=localStorage.getItem("currentUser"),E=C?JSON.parse(C):null;await ur(`Dashboard verileri yüklenirken hata: ${w.message||w}`,"Dashboard",E==null?void 0:E.id,E==null?void 0:E.username)}finally{l(!1)}},m=async()=>{try{d(!0);const w=await VS(e,r,n);u(w)}catch(w){console.error("AI rapor yüklenirken hata:",w);const C=localStorage.getItem("currentUser"),E=C?JSON.parse(C):null;await ur(`AI rapor yüklenirken hata: ${w.message||w}`,"Dashboard",E==null?void 0:E.id,E==null?void 0:E.username)}finally{d(!1)}},y=async(w,C,E)=>{try{const A=await GS(w,C,E);h(A)}catch(A){console.error("Günlük AI rapor yüklenirken hata:",A);const I=localStorage.getItem("currentUser"),D=I?JSON.parse(I):null;await ur(`Günlük AI rapor yüklenirken hata: ${A.message||A}`,"Dashboard",D==null?void 0:D.id,D==null?void 0:D.username)}},_={green:e.filter(w=>w.status==="green").length,orange:e.filter(w=>w.status==="orange").length,red:e.filter(w=>w.status==="red").length},k=e.slice(0,10).map(w=>({name:w.materialName.length>15?w.materialName.substring(0,15)+"...":w.materialName,stok:w.currentStock})),g=[{name:"Yeşil",value:_.green,color:"#28a745"},{name:"Turuncu",value:_.orange,color:"#ffc107"},{name:"Kırmızı",value:_.red,color:"#dc3545"}].filter(w=>w.value>0);return o?s.jsx(nr,{children:s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."})}):s.jsx(nr,{children:s.jsxs("div",{style:{padding:"40px"},children:[s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",marginBottom:"40px",color:"#000",letterSpacing:"-1px"},children:"Dashboard"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",marginBottom:"30px"},children:[s.jsx("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",borderLeft:"6px solid #000"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("div",{children:[s.jsx("p",{style:{color:"#666",fontSize:"12px",marginBottom:"10px",letterSpacing:"0.5px",textTransform:"uppercase",fontWeight:"600"},children:"Toplam Malzeme"}),s.jsx("h2",{style:{fontSize:"42px",fontWeight:"700",color:"#000",margin:0,letterSpacing:"-1px"},children:e.length})]}),s.jsx(Ls,{size:48,color:"#000"})]})}),s.jsx("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",borderLeft:"6px solid #000"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("div",{children:[s.jsx("p",{style:{color:"#666",fontSize:"12px",marginBottom:"10px",letterSpacing:"0.5px",textTransform:"uppercase",fontWeight:"600"},children:"Yeşil Durum"}),s.jsx("h2",{style:{fontSize:"42px",fontWeight:"700",color:"#000",margin:0,letterSpacing:"-1px"},children:_.green})]}),s.jsx(A1,{size:48,color:"#000"})]})}),s.jsx("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",borderLeft:"6px solid #000"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("div",{children:[s.jsx("p",{style:{color:"#666",fontSize:"12px",marginBottom:"10px",letterSpacing:"0.5px",textTransform:"uppercase",fontWeight:"600"},children:"Turuncu Durum"}),s.jsx("h2",{style:{fontSize:"42px",fontWeight:"700",color:"#000",margin:0,letterSpacing:"-1px"},children:_.orange})]}),s.jsx(Ep,{size:48,color:"#000"})]})}),s.jsx("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",borderLeft:"6px solid #000"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("div",{children:[s.jsx("p",{style:{color:"#666",fontSize:"12px",marginBottom:"10px",letterSpacing:"0.5px",textTransform:"uppercase",fontWeight:"600"},children:"Kırmızı Durum"}),s.jsx("h2",{style:{fontSize:"42px",fontWeight:"700",color:"#000",margin:0,letterSpacing:"-1px"},children:_.red})]}),s.jsx(Ep,{size:48,color:"#000"})]})})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(450px, 1fr))",gap:"20px",marginBottom:"20px"},children:[s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",minHeight:"400px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"24px",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Stok Durumu (İlk 10 Malzeme)"}),s.jsx(Wu,{width:"100%",height:350,children:s.jsxs(Fk,{data:k,margin:{top:5,right:20,left:0,bottom:60},children:[s.jsx(Th,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),s.jsx(Eh,{dataKey:"name",angle:-45,textAnchor:"end",height:80,tick:{fontSize:11},interval:0}),s.jsx(Ch,{tick:{fontSize:12}}),s.jsx(qu,{contentStyle:{backgroundColor:"#fff",border:"2px solid #000",borderRadius:"0"}}),s.jsx(Dk,{dataKey:"stok",fill:"#4a90e2",radius:[0,0,0,0]})]})})]}),s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",minHeight:"400px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"24px",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Durum Dağılımı"}),g.length===0?s.jsx("div",{style:{height:"350px",display:"flex",alignItems:"center",justifyContent:"center",color:"#666",fontSize:"14px"},children:"Henüz stok durumu verisi bulunmamaktadır."}):s.jsx(Wu,{width:"100%",height:350,children:s.jsxs(Ik,{children:[s.jsx(Lk,{data:g,cx:"50%",cy:"50%",labelLine:!1,label:({name:w,value:C,percent:E})=>C===0?"":`${w}: ${C} (${(E*100).toFixed(0)}%)`,outerRadius:110,innerRadius:40,fill:"#8884d8",dataKey:"value",paddingAngle:2,children:g.map((w,C)=>s.jsx(Pk,{fill:w.color},`cell-${C}`))}),s.jsx(qu,{contentStyle:{backgroundColor:"#fff",border:"2px solid #000",borderRadius:"0"},formatter:w=>[`${w} adet`,"Miktar"]}),s.jsx(ig,{verticalAlign:"bottom",height:36,formatter:w=>{const C=g.find(E=>E.name===w);return C?`${w} (${C.value})`:w}})]})})]})]}),r.length>0&&s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(450px, 1fr))",gap:"20px",marginBottom:"20px"},children:[s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",minHeight:"350px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"24px",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Son Girişler Trendi"}),s.jsx(Wu,{width:"100%",height:300,children:s.jsxs(Rk,{data:r.map(w=>({name:w.materialName.substring(0,10),miktar:w.quantity,tarih:w.arrivalDate.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit"})})),children:[s.jsx(Th,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),s.jsx(Eh,{dataKey:"name",tick:{fontSize:11}}),s.jsx(Ch,{tick:{fontSize:12}}),s.jsx(qu,{contentStyle:{backgroundColor:"#fff",border:"2px solid #000",borderRadius:"0"}}),s.jsx(Ok,{type:"monotone",dataKey:"miktar",stroke:"#4a90e2",fill:"#4a90e2",fillOpacity:.3})]})})]}),s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000",minHeight:"350px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"24px",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Stok Giriş/Çıkış Karşılaştırması"}),s.jsx(Wu,{width:"100%",height:300,children:s.jsxs(Bk,{data:e.slice(0,8).map(w=>({name:w.materialName.substring(0,10),giriş:w.totalEntry,çıkış:w.totalOutput})),children:[s.jsx(Th,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),s.jsx(Eh,{dataKey:"name",tick:{fontSize:11}}),s.jsx(Ch,{tick:{fontSize:12}}),s.jsx(qu,{contentStyle:{backgroundColor:"#fff",border:"2px solid #000",borderRadius:"0"}}),s.jsx(ig,{}),s.jsx(sg,{type:"monotone",dataKey:"giriş",stroke:"#28a745",strokeWidth:2}),s.jsx(sg,{type:"monotone",dataKey:"çıkış",stroke:"#dc3545",strokeWidth:2})]})})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(500px, 1fr))",gap:"20px",marginBottom:"30px"},children:[f&&s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px"},children:[s.jsx(p3,{size:20,color:"#000"}),s.jsxs("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase",margin:0},children:["Günlük AI Raporu - ",f.date]})]}),s.jsxs("div",{style:{fontSize:"14px",lineHeight:"1.8",color:"#000"},children:[s.jsx("p",{style:{marginBottom:"16px",fontWeight:"500"},children:f.summary}),f.highlights&&f.highlights.length>0&&s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsx("strong",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Öne Çıkanlar:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px"},children:f.highlights.map((w,C)=>s.jsx("li",{style:{marginBottom:"4px"},children:w},C))})]}),f.warnings&&f.warnings.length>0&&s.jsxs("div",{style:{marginBottom:"16px",color:"#dc3545"},children:[s.jsx("strong",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Uyarılar:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px"},children:f.warnings.map((w,C)=>s.jsx("li",{style:{marginBottom:"4px"},children:w},C))})]}),f.recommendations&&f.recommendations.length>0&&s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsx("strong",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Öneriler:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px"},children:f.recommendations.map((w,C)=>s.jsx("li",{style:{marginBottom:"4px"},children:w},C))})]})]})]}),s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Bs,{size:20,color:"#000"}),s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase",margin:0},children:"AI Durum Raporu"})]}),s.jsx("button",{onClick:m,disabled:p,className:"btn btn-secondary",style:{padding:"8px 16px",fontSize:"12px"},children:p?"Yükleniyor...":"Rapor Oluştur"})]}),c?s.jsxs("div",{style:{fontSize:"14px",lineHeight:"1.8",color:"#000"},children:[s.jsx("p",{style:{marginBottom:"16px",fontWeight:"500"},children:c.summary}),c.criticalIssues&&c.criticalIssues.length>0&&s.jsxs("div",{style:{marginBottom:"16px",color:"#dc3545"},children:[s.jsx("strong",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Kritik Sorunlar:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px"},children:c.criticalIssues.map((w,C)=>s.jsx("li",{style:{marginBottom:"4px"},children:w},C))})]}),c.recommendations&&c.recommendations.length>0&&s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsx("strong",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Öneriler:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px"},children:c.recommendations.map((w,C)=>s.jsx("li",{style:{marginBottom:"4px"},children:w},C))})]}),c.trends&&c.trends.length>0&&s.jsxs("div",{children:[s.jsx("strong",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Trendler:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px"},children:c.trends.map((w,C)=>s.jsx("li",{style:{marginBottom:"4px"},children:w},C))})]})]}):s.jsx("p",{style:{color:"#666",fontSize:"13px",fontStyle:"italic"},children:'Rapor oluşturmak için "Rapor Oluştur" butonuna tıklayın.'})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"20px"},children:[s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"20px",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Son Stok Girişleri"}),r.length===0?s.jsx("p",{style:{color:"#666",fontSize:"13px"},children:"Henüz stok girişi yapılmamış"}):s.jsx("div",{style:{fontSize:"14px"},children:r.map((w,C)=>s.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #000",display:"flex",justifyContent:"space-between"},children:s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#000",fontWeight:"600"},children:w.materialName}),s.jsxs("div",{style:{color:"#666",fontSize:"12px",marginTop:"4px"},children:[w.arrivalDate.toLocaleDateString("tr-TR")," - ",w.quantity," ",w.unit]})]})},C))})]}),s.jsxs("div",{style:{background:"white",padding:"24px",borderRadius:"0",border:"2px solid #000"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"20px",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Son Personel Çıkışları"}),n.length===0?s.jsx("p",{style:{color:"#666",fontSize:"13px"},children:"Henüz çıkış yapılmamış"}):s.jsx("div",{style:{fontSize:"14px"},children:n.map((w,C)=>s.jsx("div",{style:{padding:"12px",borderBottom:"1px solid #000",display:"flex",justifyContent:"space-between"},children:s.jsxs("div",{children:[s.jsx("strong",{style:{color:"#000",fontWeight:"600"},children:w.materialName}),s.jsxs("div",{style:{color:"#666",fontSize:"12px",marginTop:"4px"},children:[w.employee," - ",w.issueDate.toLocaleDateString("tr-TR")]})]})},C))})]})]})]})})}const Nd="warehouses",YS=async e=>{try{return(await Or(lt(qe,Nd),{...e,createdAt:Ye.now(),updatedAt:Ye.now()})).id}catch(t){throw console.error("Depo eklenirken hata:",t),t}},tu=async e=>{try{let t=Ke(lt(qe,Nd),ua("name","asc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var n,i;return{id:a.id,...a.data(),createdAt:(n=a.data().createdAt)==null?void 0:n.toDate(),updatedAt:(i=a.data().updatedAt)==null?void 0:i.toDate()}})}catch(t){throw console.error("Depo listesi yüklenirken hata:",t),t}},XS=async(e,t)=>{try{const r=ir(qe,Nd,e);await Xr(r,{...t,updatedAt:Ye.now()})}catch(r){throw console.error("Depo güncellenirken hata:",r),r}},JS=async e=>{try{const t=ir(qe,Nd,e);await os(t)}catch(t){throw console.error("Depo silinirken hata:",t),t}},eb="activityLogs",tb=async e=>{try{const t={action:e.action,module:e.module,timestamp:Ye.now()};return e.userId!==void 0&&(t.userId=e.userId),e.username!==void 0&&(t.username=e.username),e.userEmail!==void 0&&(t.userEmail=e.userEmail),e.personnelId!==void 0&&(t.personnelId=e.personnelId),e.personnelName!==void 0&&(t.personnelName=e.personnelName),e.details!==void 0&&(t.details=e.details),e.companyId!==void 0&&(t.companyId=e.companyId),e.ipAddress!==void 0&&(t.ipAddress=e.ipAddress),(await Or(lt(qe,eb),t)).id}catch(t){throw console.error("Aktivite logu eklenirken hata:",t),t}},rb=async e=>{try{let t=Ke(lt(qe,eb),ua("timestamp","desc"));e!=null&&e.companyId&&(t=Ke(t,ot("companyId","==",e.companyId))),e!=null&&e.userId&&(t=Ke(t,ot("userId","==",e.userId))),e!=null&&e.personnelId&&(t=Ke(t,ot("personnelId","==",e.personnelId))),e!=null&&e.module&&(t=Ke(t,ot("module","==",e.module))),e!=null&&e.startDate&&(t=Ke(t,ot("timestamp",">=",Ye.fromDate(e.startDate)))),e!=null&&e.endDate&&(t=Ke(t,ot("timestamp","<=",Ye.fromDate(e.endDate))));let a=(await lr(t)).docs.map(n=>{var i;return{id:n.id,...n.data(),timestamp:(i=n.data().timestamp)==null?void 0:i.toDate()}});return e!=null&&e.limit&&(a=a.slice(0,e.limit)),a}catch(t){throw console.error("Aktivite logları yüklenirken hata:",t),t}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var j0={};j0.version="0.18.5";var Jn=1200,il=1252,ZS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},jd=function(e){ZS.indexOf(e)!=-1&&(il=fm[0]=e)};function QS(){jd(1252)}var mi=function(e){Jn=e,jd(e)};function Td(){mi(1200),QS()}function Wf(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function e6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ab(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Jl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?e6(e.slice(2)):t==254&&r==255?ab(e.slice(2)):t==65279?e.slice(1):e},o0=function(t){return String.fromCharCode(t)},Vp=function(t){return String.fromCharCode(t)},pr;function t6(e){pr=e,mi=function(t){Jn=t,jd(t)},Jl=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?pr.utils.decode(1200,Wf(t.slice(2))):t},o0=function(r){return Jn===1200?String.fromCharCode(r):pr.utils.decode(Jn,[r&255,r>>8])[0]},Vp=function(r){return pr.utils.decode(il,[r])[0]},Db()}var uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function T0(e){for(var t="",r=0,a=0,n=0,i=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,a=e.charCodeAt(u++),o=(r&3)<<4|a>>4,n=e.charCodeAt(u++),l=(a&15)<<2|n>>6,c=n&63,isNaN(a)?l=c=64:isNaN(n)&&(c=64),t+=uo.charAt(i)+uo.charAt(o)+uo.charAt(l)+uo.charAt(c);return t}function Qn(e){var t="",r=0,a=0,n=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=uo.indexOf(e.charAt(u++)),o=uo.indexOf(e.charAt(u++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=uo.indexOf(e.charAt(u++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=uo.indexOf(e.charAt(u++)),n=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var tr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ms=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function vo(e){return tr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Rg(e){return tr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Kn=function(t){return tr?Ms(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ru(e){if(typeof ArrayBuffer>"u")return Kn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Ao(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function r6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function dm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return dm(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var $a=tr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ms(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function a6(e){for(var t=[],r=0,a=e.length+250,n=vo(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|l>>6&15|(o&3)<<4,n[r++]=128|l&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=vo(65535),a=65530)}return t.push(n.slice(0,r)),$a(t)}var xn=/\u0000/g,l0=/[\u0001-\u0006]/g;function ac(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Li(e,t){var r=""+e;return r.length>=t?r:sa("0",t-r.length)+r}function hm(e,t){var r=""+e;return r.length>=t?r:sa(" ",t-r.length)+r}function qf(e,t){var r=""+e;return r.length>=t?r:r+sa(" ",t-r.length)}function n6(e,t){var r=""+Math.round(e);return r.length>=t?r:sa("0",t-r.length)+r}function i6(e,t){var r=""+e;return r.length>=t?r:sa("0",t-r.length)+r}var Og=Math.pow(2,32);function Ml(e,t){if(e>Og||e<-Og)return n6(e,t);var r=Math.round(e);return i6(r,t)}function Hf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Bg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Wh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Mg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $f(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,o=1,l=0,c=1,u=0,f=0,h=Math.floor(n);u<t&&(h=Math.floor(n),l=h*o+i,f=h*u+c,!(n-h<5e-8));)n=1/(n-h),i=o,o=l,c=u,u=f;if(f>t&&(u>t?(f=c,l=i):(f=u,l=o)),!r)return[0,a*l,f];var p=Math.floor(a*l/f);return[p,a*l-p*f,f]}function fo(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=h6(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var nb=new Date(1899,11,31,0,0,0),l6=nb.getTime(),c6=new Date(1900,2,1,0,0,0);function ib(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=c6&&(r+=24*60*60*1e3),(r-(l6+(e.getTimezoneOffset()-nb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function pm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f6(e){var t=e<0?12:11,r=pm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function d6(e){var t=pm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function E0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=f6(e):t===10?r=e.toFixed(10).substr(0,12):r=d6(e),pm(u6(r.toUpperCase()))}function sl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):E0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ei(14,ib(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function h6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function p6(e,t,r,a){var n="",i=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Wh[r.m-1][1];case 5:return Wh[r.m-1][0];default:return Wh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Bg[r.q][0];default:return Bg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Li(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=Li(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var f=u>0?Li(c,u):"";return f}function ho(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var sb=/%/g;function m6(e,t,r){var a=t.replace(sb,""),n=t.length-a.length;return Ps(e,a,r*Math.pow(10,2*n))+sa("%",n)}function x6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Ps(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function ob(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ob(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,f){return c+u+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lb=/# (\?+)( ?)\/( ?)(\d+)/;function g6(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),o=n-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?sa(" ",e[1].length+1+e[4].length):hm(o,e[1].length)+e[2]+"/"+e[3]+Li(l,e[4].length))}function v6(e,t,r){return r+(t===0?"":""+t)+sa(" ",e[1].length+2+e[4].length)}var cb=/^#*0*\.([0#]+)/,ub=/\).*[0#]/,fb=/\(###\) ###\\?-####/;function Sn(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function zg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ug(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function y6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function b6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ci(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ub)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ci("n",a,r):"("+ci("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return x6(e,t,r);if(t.indexOf("%")!==-1)return m6(e,t,r);if(t.indexOf("E")!==-1)return ob(t,r);if(t.charCodeAt(0)===36)return"$"+ci(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ml(c,t.length);if(t.match(/^[#?]+$/))return n=Ml(r,0),n==="0"&&(n=""),n.length>t.length?n:Sn(t.substr(0,t.length-n.length))+n;if(i=t.match(lb))return g6(i,c,u);if(t.match(/^#+0+$/))return u+Ml(c,t.length-t.indexOf("0"));if(i=t.match(cb))return n=zg(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Sn(i[1])).replace(/\.$/,"."+Sn(i[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+sa("0",Sn(i[1]).length-m.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+zg(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ho(Ml(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ci(e,t,-r):ho(""+(Math.floor(r)+y6(r,i[1].length)))+"."+Li(Ug(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ci(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ac(ci(e,t.replace(/[\\-]/g,""),r)),o=0,ac(ac(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<n.length?n.charAt(o++):v==="0"?"0":""}));if(t.match(fb))return n=ci(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=$f(c,Math.pow(10,o)-1,!1),n=""+u,f=Ps("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=qf(l[2],o),f.length<i[4].length&&(f=Sn(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=$f(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?hm(l[1],o)+i[2]+"/"+i[3]+qf(l[2],o):sa(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=Ml(r,0),t.length<=n.length?n:Sn(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=t.indexOf(".")-o,p=t.length-n.length-h;return Sn(t.substr(0,h)+n+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=Ug(r,i[1].length),r<0?"-"+ci(e,t,-r):ho(b6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Li(0,3-v.length):"")+v})+"."+Li(o,i[1].length);switch(t){case"###,##0.00":return ci(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=ho(Ml(c,0));return d!=="0"?u+d:"";case"###,###.00":return ci(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ci(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function w6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Ps(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function _6(e,t,r){var a=t.replace(sb,""),n=t.length-a.length;return Ps(e,a,r*Math.pow(10,2*n))+sa("%",n)}function db(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+db(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,f){return c+u+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ji(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ub)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ji("n",a,r):"("+Ji("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return w6(e,t,r);if(t.indexOf("%")!==-1)return _6(e,t,r);if(t.indexOf("E")!==-1)return db(t,r);if(t.charCodeAt(0)===36)return"$"+Ji(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Li(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Sn(t.substr(0,t.length-n.length))+n;if(i=t.match(lb))return v6(i,c,u);if(t.match(/^#+0+$/))return u+Li(c,t.length-t.indexOf("0"));if(i=t.match(cb))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Sn(i[1])).replace(/\.$/,"."+Sn(i[1])),n=n.replace(/\.(\d*)$/,function(v,m){return"."+m+sa("0",Sn(i[1]).length-m.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+ho(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ji(e,t,-r):ho(""+r)+"."+sa("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ji(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ac(Ji(e,t.replace(/[\\-]/g,""),r)),o=0,ac(ac(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<n.length?n.charAt(o++):v==="0"?"0":""}));if(t.match(fb))return n=Ji(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=$f(c,Math.pow(10,o)-1,!1),n=""+u,f=Ps("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=qf(l[2],o),f.length<i[4].length&&(f=Sn(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=$f(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?hm(l[1],o)+i[2]+"/"+i[3]+qf(l[2],o):sa(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Sn(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=t.indexOf(".")-o,p=t.length-n.length-h;return Sn(t.substr(0,h)+n+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ji(e,t,-r):ho(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Li(0,3-v.length):"")+v})+"."+Li(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=ho(""+c);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return Ji(e,t.slice(0,t.lastIndexOf(".")),r)+Sn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ps(e,t,r){return(r|0)===r?Ji(e,t,r):ci(e,t,r)}function k6(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var hb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xl(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Hf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(hb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function S6(e,t,r,a){for(var n=[],i="",o=0,l="",c="t",u,f,h,p="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Hf(e,o))throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++o;break;case"\\":var d=e.charAt(++o),v=d==="("||d===")"?d:"t";n[n.length]={t:v,v:d},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=fo(t,r,e.charAt(o+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=fo(t,r),u==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var m={t:l,v:l};if(u==null&&(u=fo(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",o+=5,p="h"):(m.t="t",++o),u==null&&m.t==="T")return"";n[n.length]=m,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(hb)){if(u==null&&(u=fo(t,r),u==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",xl(e)||(n[n.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);n[n.length]={t:"t",v:l},++o;break}var y=0,_=0,k;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=p,c="h",y<1&&(y=1);break;case"s":(k=n[o].v.match(/\.0+$/))&&(_=Math.max(_,k[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&n[o].v.match(/[Hh]/)&&(y=1),y<2&&n[o].v.match(/[Mm]/)&&(y=2),y<3&&n[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",w;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=p6(n[o].t.charCodeAt(0),n[o].v,u,_),n[o].t="t";break;case"n":case"?":for(w=o+1;n[w]!=null&&((l=n[w].t)==="?"||l==="D"||(l===" "||l==="t")&&n[w+1]!=null&&(n[w+1].t==="?"||n[w+1].t==="t"&&n[w+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[w].v==="/"||n[w].v===" "&&n[w+1]!=null&&n[w+1].t=="?"));)n[o].v+=n[w].v,n[w]={v:"",t:";"},++w;g+=n[o].v,o=w-1;break;case"G":n[o].t="t",n[o].v=sl(t,r);break}var C="",E,A;if(g.length>0){g.charCodeAt(0)==40?(E=t<0&&g.charCodeAt(0)===45?-t:t,A=Ps("n",g,E)):(E=t<0&&a>1?-t:t,A=Ps("n",g,E),E<0&&n[0]&&n[0].t=="t"&&(A=A.substr(1),n[0].v="-"+n[0].v)),w=A.length-1;var I=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){I=o;break}var D=n.length;if(I===n.length&&A.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(w>=n[o].v.length-1?(w-=n[o].v.length,n[o].v=A.substr(w+1,n[o].v.length)):w<0?n[o].v="":(n[o].v=A.substr(0,w+1),w=-1),n[o].t="t",D=o);w>=0&&D<n.length&&(n[D].v=A.substr(0,w+1)+n[D].v)}else if(I!==n.length&&A.indexOf("E")===-1){for(w=A.indexOf(".")-1,o=I;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(f=n[o].v.indexOf(".")>-1&&o===I?n[o].v.indexOf(".")-1:n[o].v.length-1,C=n[o].v.substr(f+1);f>=0;--f)w>=0&&(n[o].v.charAt(f)==="0"||n[o].v.charAt(f)==="#")&&(C=A.charAt(w--)+C);n[o].v=C,n[o].t="t",D=o}for(w>=0&&D<n.length&&(n[D].v=A.substr(0,w+1)+n[D].v),w=A.indexOf(".")+1,o=I;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==I)){for(f=n[o].v.indexOf(".")>-1&&o===I?n[o].v.indexOf(".")+1:0,C=n[o].v.substr(0,f);f<n[o].v.length;++f)w<A.length&&(C+=A.charAt(w++));n[o].v=C,n[o].t="t",D=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(E=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Ps(n[o].t,n[o].v,E),n[o].t="t");var B="";for(o=0;o!==n.length;++o)n[o]!=null&&(B+=n[o].v);return B}var Wg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function A6(e,t){var r=k6(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Wg),l=r[1].match(Wg);return qg(t,o)?[a,r[0]]:qg(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function ei(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ft)[e],a==null&&(a=r.table&&r.table[Mg[e]]||Ft[Mg[e]]),a==null&&(a=o6[e]||"General");break}if(Hf(a,0))return sl(t,r);t instanceof Date&&(t=ib(t,r.date1904));var n=A6(a,t);if(Hf(n[1]))return sl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return S6(n[1],t,r,n[0])}function is(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ft[r]==null){t<0&&(t=r);continue}if(Ft[r]==e){t=r;break}}t<0&&(t=391)}return Ft[t]=e,t}function au(e){for(var t=0;t!=392;++t)e[t]!==void 0&&is(e[t],t)}function wc(){Ft=s6()}var pb={format:ei,load:is,_table:Ft,load_table:au,parse_date_code:fo,is_date:xl,get_table:function(){return pb._table=Ft}},N6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},mb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function j6(e){var t=typeof e=="number"?Ft[e]:e;return t=t.replace(mb,"(\\d+)"),new RegExp("^"+t+"$")}function T6(e,t,r){var a=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(t.match(mb)||[]).forEach(function(h,p){var d=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":a=d;break;case"d":i=d;break;case"h":o=d;break;case"s":c=d;break;case"m":o>=0?l=d:n=d;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:a==-1&&n==-1&&i==-1?f:u+"T"+f}var E6=function(){var e={};e.version="1.2.0";function t(){for(var A=0,I=new Array(256),D=0;D!=256;++D)A=D,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,I[D]=A;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function a(A){var I=0,D=0,B=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)L[B]=A[B];for(B=0;B!=256;++B)for(D=A[B],I=256+B;I<4096;I+=256)D=L[I]=D>>>8^A[D&255];var F=[];for(B=1;B!=16;++B)F[B-1]=typeof Int32Array<"u"?L.subarray(B*256,B*256+256):L.slice(B*256,B*256+256);return F}var n=a(r),i=n[0],o=n[1],l=n[2],c=n[3],u=n[4],f=n[5],h=n[6],p=n[7],d=n[8],v=n[9],m=n[10],y=n[11],_=n[12],k=n[13],g=n[14];function w(A,I){for(var D=I^-1,B=0,L=A.length;B<L;)D=D>>>8^r[(D^A.charCodeAt(B++))&255];return~D}function C(A,I){for(var D=I^-1,B=A.length-15,L=0;L<B;)D=g[A[L++]^D&255]^k[A[L++]^D>>8&255]^_[A[L++]^D>>16&255]^y[A[L++]^D>>>24]^m[A[L++]]^v[A[L++]]^d[A[L++]]^p[A[L++]]^h[A[L++]]^f[A[L++]]^u[A[L++]]^c[A[L++]]^l[A[L++]]^o[A[L++]]^i[A[L++]]^r[A[L++]];for(B+=15;L<B;)D=D>>>8^r[(D^A[L++])&255];return~D}function E(A,I){for(var D=I^-1,B=0,L=A.length,F=0,z=0;B<L;)F=A.charCodeAt(B++),F<128?D=D>>>8^r[(D^F)&255]:F<2048?(D=D>>>8^r[(D^(192|F>>6&31))&255],D=D>>>8^r[(D^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,z=A.charCodeAt(B++)&1023,D=D>>>8^r[(D^(240|F>>8&7))&255],D=D>>>8^r[(D^(128|F>>2&63))&255],D=D>>>8^r[(D^(128|z>>6&15|(F&3)<<4))&255],D=D>>>8^r[(D^(128|z&63))&255]):(D=D>>>8^r[(D^(224|F>>12&15))&255],D=D>>>8^r[(D^(128|F>>6&63))&255],D=D>>>8^r[(D^(128|F&63))&255]);return~D}return e.table=r,e.bstr=w,e.buf=C,e.str=E,e}(),kt=function(){var t={};t.version="1.2.1";function r(V,se){for(var ee=V.split("/"),re=se.split("/"),oe=0,ce=0,ke=Math.min(ee.length,re.length);oe<ke;++oe){if(ce=ee[oe].length-re[oe].length)return ce;if(ee[oe]!=re[oe])return ee[oe]<re[oe]?-1:1}return ee.length-re.length}function a(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:a(V.slice(0,-1));var se=V.lastIndexOf("/");return se===-1?V:V.slice(0,se+1)}function n(V){if(V.charAt(V.length-1)=="/")return n(V.slice(0,-1));var se=V.lastIndexOf("/");return se===-1?V:V.slice(se+1)}function i(V,se){typeof se=="string"&&(se=new Date(se));var ee=se.getHours();ee=ee<<6|se.getMinutes(),ee=ee<<5|se.getSeconds()>>>1,V.write_shift(2,ee);var re=se.getFullYear()-1980;re=re<<4|se.getMonth()+1,re=re<<5|se.getDate(),V.write_shift(2,re)}function o(V){var se=V.read_shift(2)&65535,ee=V.read_shift(2)&65535,re=new Date,oe=ee&31;ee>>>=5;var ce=ee&15;ee>>>=4,re.setMilliseconds(0),re.setFullYear(ee+1980),re.setMonth(ce-1),re.setDate(oe);var ke=se&31;se>>>=5;var Ce=se&63;return se>>>=6,re.setHours(se),re.setMinutes(Ce),re.setSeconds(ke<<1),re}function l(V){en(V,0);for(var se={},ee=0;V.l<=V.length-4;){var re=V.read_shift(2),oe=V.read_shift(2),ce=V.l+oe,ke={};switch(re){case 21589:ee=V.read_shift(1),ee&1&&(ke.mtime=V.read_shift(4)),oe>5&&(ee&2&&(ke.atime=V.read_shift(4)),ee&4&&(ke.ctime=V.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}V.l=ce,se[re]=ke}return se}var c;function u(){return c||(c={})}function f(V,se){if(V[0]==80&&V[1]==75)return zt(V,se);if((V[0]|32)==109&&(V[1]|32)==105)return Ct(V,se);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var ee=3,re=512,oe=0,ce=0,ke=0,Ce=0,Ae=0,Ne=[],Ee=V.slice(0,512);en(Ee,0);var He=h(Ee);switch(ee=He[0],ee){case 3:re=512;break;case 4:re=4096;break;case 0:if(He[1]==0)return zt(V,se);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}re!==512&&(Ee=V.slice(0,re),en(Ee,28));var Xe=V.slice(0,re);p(Ee,ee);var nt=Ee.read_shift(4,"i");if(ee===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Ee.l+=4,ke=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),Ce=Ee.read_shift(4,"i"),oe=Ee.read_shift(4,"i"),Ae=Ee.read_shift(4,"i"),ce=Ee.read_shift(4,"i");for(var Ge=-1,rt=0;rt<109&&(Ge=Ee.read_shift(4,"i"),!(Ge<0));++rt)Ne[rt]=Ge;var Lt=d(V,re);y(Ae,ce,Lt,re,Ne);var Er=k(Lt,ke,Ne,re);Er[ke].name="!Directory",oe>0&&Ce!==z&&(Er[Ce].name="!MiniFAT"),Er[Ne[0]].name="!FAT",Er.fat_addrs=Ne,Er.ssz=re;var sr={},ra=[],Ui=[],ki=[];g(ke,Er,Lt,ra,oe,sr,Ui,Ce),v(Ui,ki,ra),ra.shift();var Wi={FileIndex:Ui,FullPaths:ki};return se&&se.raw&&(Wi.raw={header:Xe,sectors:Lt}),Wi}function h(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(M,"Header Signature: "),V.l+=16;var se=V.read_shift(2,"u");return[V.read_shift(2,"u"),se]}function p(V,se){var ee=9;switch(V.l+=2,ee=V.read_shift(2)){case 9:if(se!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(se!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function d(V,se){for(var ee=Math.ceil(V.length/se)-1,re=[],oe=1;oe<ee;++oe)re[oe-1]=V.slice(oe*se,(oe+1)*se);return re[ee-1]=V.slice(ee*se),re}function v(V,se,ee){for(var re=0,oe=0,ce=0,ke=0,Ce=0,Ae=ee.length,Ne=[],Ee=[];re<Ae;++re)Ne[re]=Ee[re]=re,se[re]=ee[re];for(;Ce<Ee.length;++Ce)re=Ee[Ce],oe=V[re].L,ce=V[re].R,ke=V[re].C,Ne[re]===re&&(oe!==-1&&Ne[oe]!==oe&&(Ne[re]=Ne[oe]),ce!==-1&&Ne[ce]!==ce&&(Ne[re]=Ne[ce])),ke!==-1&&(Ne[ke]=re),oe!==-1&&re!=Ne[re]&&(Ne[oe]=Ne[re],Ee.lastIndexOf(oe)<Ce&&Ee.push(oe)),ce!==-1&&re!=Ne[re]&&(Ne[ce]=Ne[re],Ee.lastIndexOf(ce)<Ce&&Ee.push(ce));for(re=1;re<Ae;++re)Ne[re]===re&&(ce!==-1&&Ne[ce]!==ce?Ne[re]=Ne[ce]:oe!==-1&&Ne[oe]!==oe&&(Ne[re]=Ne[oe]));for(re=1;re<Ae;++re)if(V[re].type!==0){if(Ce=re,Ce!=Ne[Ce])do Ce=Ne[Ce],se[re]=se[Ce]+"/"+se[re];while(Ce!==0&&Ne[Ce]!==-1&&Ce!=Ne[Ce]);Ne[re]=-1}for(se[0]+="/",re=1;re<Ae;++re)V[re].type!==2&&(se[re]+="/")}function m(V,se,ee){for(var re=V.start,oe=V.size,ce=[],ke=re;ee&&oe>0&&ke>=0;)ce.push(se.slice(ke*F,ke*F+F)),oe-=F,ke=Go(ee,ke*4);return ce.length===0?De(0):$a(ce).slice(0,V.size)}function y(V,se,ee,re,oe){var ce=z;if(V===z){if(se!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var ke=ee[V],Ce=(re>>>2)-1;if(!ke)return;for(var Ae=0;Ae<Ce&&(ce=Go(ke,Ae*4))!==z;++Ae)oe.push(ce);y(Go(ke,re-4),se-1,ee,re,oe)}}function _(V,se,ee,re,oe){var ce=[],ke=[];oe||(oe=[]);var Ce=re-1,Ae=0,Ne=0;for(Ae=se;Ae>=0;){oe[Ae]=!0,ce[ce.length]=Ae,ke.push(V[Ae]);var Ee=ee[Math.floor(Ae*4/re)];if(Ne=Ae*4&Ce,re<4+Ne)throw new Error("FAT boundary crossed: "+Ae+" 4 "+re);if(!V[Ee])break;Ae=Go(V[Ee],Ne)}return{nodes:ce,data:t2([ke])}}function k(V,se,ee,re){var oe=V.length,ce=[],ke=[],Ce=[],Ae=[],Ne=re-1,Ee=0,He=0,Xe=0,nt=0;for(Ee=0;Ee<oe;++Ee)if(Ce=[],Xe=Ee+se,Xe>=oe&&(Xe-=oe),!ke[Xe]){Ae=[];var Ge=[];for(He=Xe;He>=0;){Ge[He]=!0,ke[He]=!0,Ce[Ce.length]=He,Ae.push(V[He]);var rt=ee[Math.floor(He*4/re)];if(nt=He*4&Ne,re<4+nt)throw new Error("FAT boundary crossed: "+He+" 4 "+re);if(!V[rt]||(He=Go(V[rt],nt),Ge[He]))break}ce[Xe]={nodes:Ce,data:t2([Ae])}}return ce}function g(V,se,ee,re,oe,ce,ke,Ce){for(var Ae=0,Ne=re.length?2:0,Ee=se[V].data,He=0,Xe=0,nt;He<Ee.length;He+=128){var Ge=Ee.slice(He,He+128);en(Ge,64),Xe=Ge.read_shift(2),nt=Dd(Ge,0,Xe-Ne),re.push(nt);var rt={name:nt,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},Lt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Lt!==0&&(rt.ct=w(Ge,Ge.l-8));var Er=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Er!==0&&(rt.mt=w(Ge,Ge.l-8)),rt.start=Ge.read_shift(4,"i"),rt.size=Ge.read_shift(4,"i"),rt.size<0&&rt.start<0&&(rt.size=rt.type=0,rt.start=z,rt.name=""),rt.type===5?(Ae=rt.start,oe>0&&Ae!==z&&(se[Ae].name="!StreamData")):rt.size>=4096?(rt.storage="fat",se[rt.start]===void 0&&(se[rt.start]=_(ee,rt.start,se.fat_addrs,se.ssz)),se[rt.start].name=rt.name,rt.content=se[rt.start].data.slice(0,rt.size)):(rt.storage="minifat",rt.size<0?rt.size=0:Ae!==z&&rt.start!==z&&se[Ae]&&(rt.content=m(rt,se[Ae].data,(se[Ce]||{}).data))),rt.content&&en(rt.content,0),ce[nt]=rt,ke.push(rt)}}function w(V,se){return new Date((Ha(V,se+4)/1e7*Math.pow(2,32)+Ha(V,se)/1e7-11644473600)*1e3)}function C(V,se){return u(),f(c.readFileSync(V),se)}function E(V,se){var ee=se&&se.type;switch(ee||tr&&Buffer.isBuffer(V)&&(ee="buffer"),ee||"base64"){case"file":return C(V,se);case"base64":return f(Kn(Qn(V)),se);case"binary":return f(Kn(V),se)}return f(V,se)}function A(V,se){var ee=se||{},re=ee.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=re+"/",V.FileIndex[0]={name:re,type:5}),ee.CLSID&&(V.FileIndex[0].clsid=ee.CLSID),I(V)}function I(V){var se="Sh33tJ5";if(!kt.find(V,"/"+se)){var ee=De(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,V.FileIndex.push({name:se,type:2,content:ee,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+se),D(V)}}function D(V,se){A(V);for(var ee=!1,re=!1,oe=V.FullPaths.length-1;oe>=0;--oe){var ce=V.FileIndex[oe];switch(ce.type){case 0:re?ee=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:re=!0,isNaN(ce.R*ce.L*ce.C)&&(ee=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!se)){var ke=new Date(1987,1,19),Ce=0,Ae=Object.create?Object.create(null):{},Ne=[];for(oe=0;oe<V.FullPaths.length;++oe)Ae[V.FullPaths[oe]]=!0,V.FileIndex[oe].type!==0&&Ne.push([V.FullPaths[oe],V.FileIndex[oe]]);for(oe=0;oe<Ne.length;++oe){var Ee=a(Ne[oe][0]);re=Ae[Ee],re||(Ne.push([Ee,{name:n(Ee).replace("/",""),type:1,clsid:fe,ct:ke,mt:ke,content:null}]),Ae[Ee]=!0)}for(Ne.sort(function(nt,Ge){return r(nt[0],Ge[0])}),V.FullPaths=[],V.FileIndex=[],oe=0;oe<Ne.length;++oe)V.FullPaths[oe]=Ne[oe][0],V.FileIndex[oe]=Ne[oe][1];for(oe=0;oe<Ne.length;++oe){var He=V.FileIndex[oe],Xe=V.FullPaths[oe];if(He.name=n(Xe).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||fe,oe===0)He.C=Ne.length>1?1:-1,He.size=0,He.type=5;else if(Xe.slice(-1)=="/"){for(Ce=oe+1;Ce<Ne.length&&a(V.FullPaths[Ce])!=Xe;++Ce);for(He.C=Ce>=Ne.length?-1:Ce,Ce=oe+1;Ce<Ne.length&&a(V.FullPaths[Ce])!=a(Xe);++Ce);He.R=Ce>=Ne.length?-1:Ce,He.type=1}else a(V.FullPaths[oe+1]||"")==a(Xe)&&(He.R=oe+1),He.type=2}}}function B(V,se){var ee=se||{};if(ee.fileType=="mad")return wi(V,ee);switch(D(V),ee.fileType){case"zip":return er(V,ee)}var re=function(nt){for(var Ge=0,rt=0,Lt=0;Lt<nt.FileIndex.length;++Lt){var Er=nt.FileIndex[Lt];if(Er.content){var sr=Er.content.length;sr>0&&(sr<4096?Ge+=sr+63>>6:rt+=sr+511>>9)}}for(var ra=nt.FullPaths.length+3>>2,Ui=Ge+7>>3,ki=Ge+127>>7,Wi=Ui+rt+ra+ki,ri=Wi+127>>7,Ws=ri<=109?0:Math.ceil((ri-109)/127);Wi+ri+Ws+127>>7>ri;)Ws=++ri<=109?0:Math.ceil((ri-109)/127);var _a=[1,Ws,ri,ki,ra,rt,Ge,0];return nt.FileIndex[0].size=Ge<<6,_a[7]=(nt.FileIndex[0].start=_a[0]+_a[1]+_a[2]+_a[3]+_a[4]+_a[5])+(_a[6]+7>>3),_a}(V),oe=De(re[7]<<9),ce=0,ke=0;{for(ce=0;ce<8;++ce)oe.write_shift(1,q[ce]);for(ce=0;ce<8;++ce)oe.write_shift(2,0);for(oe.write_shift(2,62),oe.write_shift(2,3),oe.write_shift(2,65534),oe.write_shift(2,9),oe.write_shift(2,6),ce=0;ce<3;++ce)oe.write_shift(2,0);for(oe.write_shift(4,0),oe.write_shift(4,re[2]),oe.write_shift(4,re[0]+re[1]+re[2]+re[3]-1),oe.write_shift(4,0),oe.write_shift(4,4096),oe.write_shift(4,re[3]?re[0]+re[1]+re[2]-1:z),oe.write_shift(4,re[3]),oe.write_shift(-4,re[1]?re[0]-1:z),oe.write_shift(4,re[1]),ce=0;ce<109;++ce)oe.write_shift(-4,ce<re[2]?re[1]+ce:-1)}if(re[1])for(ke=0;ke<re[1];++ke){for(;ce<236+ke*127;++ce)oe.write_shift(-4,ce<re[2]?re[1]+ce:-1);oe.write_shift(-4,ke===re[1]-1?z:ke+1)}var Ce=function(nt){for(ke+=nt;ce<ke-1;++ce)oe.write_shift(-4,ce+1);nt&&(++ce,oe.write_shift(-4,z))};for(ke=ce=0,ke+=re[1];ce<ke;++ce)oe.write_shift(-4,he.DIFSECT);for(ke+=re[2];ce<ke;++ce)oe.write_shift(-4,he.FATSECT);Ce(re[3]),Ce(re[4]);for(var Ae=0,Ne=0,Ee=V.FileIndex[0];Ae<V.FileIndex.length;++Ae)Ee=V.FileIndex[Ae],Ee.content&&(Ne=Ee.content.length,!(Ne<4096)&&(Ee.start=ke,Ce(Ne+511>>9)));for(Ce(re[6]+7>>3);oe.l&511;)oe.write_shift(-4,he.ENDOFCHAIN);for(ke=ce=0,Ae=0;Ae<V.FileIndex.length;++Ae)Ee=V.FileIndex[Ae],Ee.content&&(Ne=Ee.content.length,!(!Ne||Ne>=4096)&&(Ee.start=ke,Ce(Ne+63>>6)));for(;oe.l&511;)oe.write_shift(-4,he.ENDOFCHAIN);for(ce=0;ce<re[4]<<2;++ce){var He=V.FullPaths[ce];if(!He||He.length===0){for(Ae=0;Ae<17;++Ae)oe.write_shift(4,0);for(Ae=0;Ae<3;++Ae)oe.write_shift(4,-1);for(Ae=0;Ae<12;++Ae)oe.write_shift(4,0);continue}Ee=V.FileIndex[ce],ce===0&&(Ee.start=Ee.size?Ee.start-1:z);var Xe=ce===0&&ee.root||Ee.name;if(Ne=2*(Xe.length+1),oe.write_shift(64,Xe,"utf16le"),oe.write_shift(2,Ne),oe.write_shift(1,Ee.type),oe.write_shift(1,Ee.color),oe.write_shift(-4,Ee.L),oe.write_shift(-4,Ee.R),oe.write_shift(-4,Ee.C),Ee.clsid)oe.write_shift(16,Ee.clsid,"hex");else for(Ae=0;Ae<4;++Ae)oe.write_shift(4,0);oe.write_shift(4,Ee.state||0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,Ee.start),oe.write_shift(4,Ee.size),oe.write_shift(4,0)}for(ce=1;ce<V.FileIndex.length;++ce)if(Ee=V.FileIndex[ce],Ee.size>=4096)if(oe.l=Ee.start+1<<9,tr&&Buffer.isBuffer(Ee.content))Ee.content.copy(oe,oe.l,0,Ee.size),oe.l+=Ee.size+511&-512;else{for(Ae=0;Ae<Ee.size;++Ae)oe.write_shift(1,Ee.content[Ae]);for(;Ae&511;++Ae)oe.write_shift(1,0)}for(ce=1;ce<V.FileIndex.length;++ce)if(Ee=V.FileIndex[ce],Ee.size>0&&Ee.size<4096)if(tr&&Buffer.isBuffer(Ee.content))Ee.content.copy(oe,oe.l,0,Ee.size),oe.l+=Ee.size+63&-64;else{for(Ae=0;Ae<Ee.size;++Ae)oe.write_shift(1,Ee.content[Ae]);for(;Ae&63;++Ae)oe.write_shift(1,0)}if(tr)oe.l=oe.length;else for(;oe.l<oe.length;)oe.write_shift(1,0);return oe}function L(V,se){var ee=V.FullPaths.map(function(Ae){return Ae.toUpperCase()}),re=ee.map(function(Ae){var Ne=Ae.split("/");return Ne[Ne.length-(Ae.slice(-1)=="/"?2:1)]}),oe=!1;se.charCodeAt(0)===47?(oe=!0,se=ee[0].slice(0,-1)+se):oe=se.indexOf("/")!==-1;var ce=se.toUpperCase(),ke=oe===!0?ee.indexOf(ce):re.indexOf(ce);if(ke!==-1)return V.FileIndex[ke];var Ce=!ce.match(l0);for(ce=ce.replace(xn,""),Ce&&(ce=ce.replace(l0,"!")),ke=0;ke<ee.length;++ke)if((Ce?ee[ke].replace(l0,"!"):ee[ke]).replace(xn,"")==ce||(Ce?re[ke].replace(l0,"!"):re[ke]).replace(xn,"")==ce)return V.FileIndex[ke];return null}var F=64,z=-2,M="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(V,se,ee){u();var re=B(V,ee);c.writeFileSync(se,re)}function Q(V){for(var se=new Array(V.length),ee=0;ee<V.length;++ee)se[ee]=String.fromCharCode(V[ee]);return se.join("")}function we(V,se){var ee=B(V,se);switch(se&&se.type||"buffer"){case"file":return u(),c.writeFileSync(se.filename,ee),ee;case"binary":return typeof ee=="string"?ee:Q(ee);case"base64":return T0(typeof ee=="string"?ee:Q(ee));case"buffer":if(tr)return Buffer.isBuffer(ee)?ee:Ms(ee);case"array":return typeof ee=="string"?Kn(ee):ee}return ee}var Y;function T(V){try{var se=V.InflateRaw,ee=new se;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)Y=V;else throw new Error("zlib does not expose bytesRead")}catch(re){console.error("cannot use native zlib: "+(re.message||re))}}function R(V,se){if(!Y)return wr(V,se);var ee=Y.InflateRaw,re=new ee,oe=re._processChunk(V.slice(V.l),re._finishFlushFlag);return V.l+=re.bytesRead,oe}function N(V){return Y?Y.deflateRawSync(V):Qe(V)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(V){var se=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(se>>16|se>>8|se)&255}for(var me=typeof Uint8Array<"u",xe=me?new Uint8Array(256):[],Se=0;Se<256;++Se)xe[Se]=de(Se);function Z(V,se){var ee=xe[V&255];return se<=8?ee>>>8-se:(ee=ee<<8|xe[V>>8&255],se<=16?ee>>>16-se:(ee=ee<<8|xe[V>>16&255],ee>>>24-se))}function Fe(V,se){var ee=se&7,re=se>>>3;return(V[re]|(ee<=6?0:V[re+1]<<8))>>>ee&3}function $e(V,se){var ee=se&7,re=se>>>3;return(V[re]|(ee<=5?0:V[re+1]<<8))>>>ee&7}function J(V,se){var ee=se&7,re=se>>>3;return(V[re]|(ee<=4?0:V[re+1]<<8))>>>ee&15}function Oe(V,se){var ee=se&7,re=se>>>3;return(V[re]|(ee<=3?0:V[re+1]<<8))>>>ee&31}function Be(V,se){var ee=se&7,re=se>>>3;return(V[re]|(ee<=1?0:V[re+1]<<8))>>>ee&127}function it(V,se,ee){var re=se&7,oe=se>>>3,ce=(1<<ee)-1,ke=V[oe]>>>re;return ee<8-re||(ke|=V[oe+1]<<8-re,ee<16-re)||(ke|=V[oe+2]<<16-re,ee<24-re)||(ke|=V[oe+3]<<24-re),ke&ce}function Me(V,se,ee){var re=se&7,oe=se>>>3;return re<=5?V[oe]|=(ee&7)<<re:(V[oe]|=ee<<re&255,V[oe+1]=(ee&7)>>8-re),se+3}function pt(V,se,ee){var re=se&7,oe=se>>>3;return ee=(ee&1)<<re,V[oe]|=ee,se+1}function at(V,se,ee){var re=se&7,oe=se>>>3;return ee<<=re,V[oe]|=ee&255,ee>>>=8,V[oe+1]=ee,se+8}function bt(V,se,ee){var re=se&7,oe=se>>>3;return ee<<=re,V[oe]|=ee&255,ee>>>=8,V[oe+1]=ee&255,V[oe+2]=ee>>>8,se+16}function ft(V,se){var ee=V.length,re=2*ee>se?2*ee:se+5,oe=0;if(ee>=se)return V;if(tr){var ce=Rg(re);if(V.copy)V.copy(ce);else for(;oe<V.length;++oe)ce[oe]=V[oe];return ce}else if(me){var ke=new Uint8Array(re);if(ke.set)ke.set(V);else for(;oe<ee;++oe)ke[oe]=V[oe];return ke}return V.length=re,V}function qt(V){for(var se=new Array(V),ee=0;ee<V;++ee)se[ee]=0;return se}function Mt(V,se,ee){var re=1,oe=0,ce=0,ke=0,Ce=0,Ae=V.length,Ne=me?new Uint16Array(32):qt(32);for(ce=0;ce<32;++ce)Ne[ce]=0;for(ce=Ae;ce<ee;++ce)V[ce]=0;Ae=V.length;var Ee=me?new Uint16Array(Ae):qt(Ae);for(ce=0;ce<Ae;++ce)Ne[oe=V[ce]]++,re<oe&&(re=oe),Ee[ce]=0;for(Ne[0]=0,ce=1;ce<=re;++ce)Ne[ce+16]=Ce=Ce+Ne[ce-1]<<1;for(ce=0;ce<Ae;++ce)Ce=V[ce],Ce!=0&&(Ee[ce]=Ne[Ce+16]++);var He=0;for(ce=0;ce<Ae;++ce)if(He=V[ce],He!=0)for(Ce=Z(Ee[ce],re)>>re-He,ke=(1<<re+4-He)-1;ke>=0;--ke)se[Ce|ke<<He]=He&15|ce<<4;return re}var jt=me?new Uint16Array(512):qt(512),Xt=me?new Uint16Array(32):qt(32);if(!me){for(var Tt=0;Tt<512;++Tt)jt[Tt]=0;for(Tt=0;Tt<32;++Tt)Xt[Tt]=0}(function(){for(var V=[],se=0;se<32;se++)V.push(5);Mt(V,Xt,32);var ee=[];for(se=0;se<=143;se++)ee.push(8);for(;se<=255;se++)ee.push(9);for(;se<=279;se++)ee.push(7);for(;se<=287;se++)ee.push(8);Mt(ee,jt,288)})();var st=function(){for(var se=me?new Uint8Array(32768):[],ee=0,re=0;ee<ae.length-1;++ee)for(;re<ae[ee+1];++re)se[re]=ee;for(;re<32768;++re)se[re]=29;var oe=me?new Uint8Array(259):[];for(ee=0,re=0;ee<H.length-1;++ee)for(;re<H[ee+1];++re)oe[re]=ee;function ce(Ce,Ae){for(var Ne=0;Ne<Ce.length;){var Ee=Math.min(65535,Ce.length-Ne),He=Ne+Ee==Ce.length;for(Ae.write_shift(1,+He),Ae.write_shift(2,Ee),Ae.write_shift(2,~Ee&65535);Ee-- >0;)Ae[Ae.l++]=Ce[Ne++]}return Ae.l}function ke(Ce,Ae){for(var Ne=0,Ee=0,He=me?new Uint16Array(32768):[];Ee<Ce.length;){var Xe=Math.min(65535,Ce.length-Ee);if(Xe<10){for(Ne=Me(Ae,Ne,+(Ee+Xe==Ce.length)),Ne&7&&(Ne+=8-(Ne&7)),Ae.l=Ne/8|0,Ae.write_shift(2,Xe),Ae.write_shift(2,~Xe&65535);Xe-- >0;)Ae[Ae.l++]=Ce[Ee++];Ne=Ae.l*8;continue}Ne=Me(Ae,Ne,+(Ee+Xe==Ce.length)+2);for(var nt=0;Xe-- >0;){var Ge=Ce[Ee];nt=(nt<<5^Ge)&32767;var rt=-1,Lt=0;if((rt=He[nt])&&(rt|=Ee&-32768,rt>Ee&&(rt-=32768),rt<Ee))for(;Ce[rt+Lt]==Ce[Ee+Lt]&&Lt<250;)++Lt;if(Lt>2){Ge=oe[Lt],Ge<=22?Ne=at(Ae,Ne,xe[Ge+1]>>1)-1:(at(Ae,Ne,3),Ne+=5,at(Ae,Ne,xe[Ge-23]>>5),Ne+=3);var Er=Ge<8?0:Ge-4>>2;Er>0&&(bt(Ae,Ne,Lt-H[Ge]),Ne+=Er),Ge=se[Ee-rt],Ne=at(Ae,Ne,xe[Ge]>>3),Ne-=3;var sr=Ge<4?0:Ge-2>>1;sr>0&&(bt(Ae,Ne,Ee-rt-ae[Ge]),Ne+=sr);for(var ra=0;ra<Lt;++ra)He[nt]=Ee&32767,nt=(nt<<5^Ce[Ee])&32767,++Ee;Xe-=Lt-1}else Ge<=143?Ge=Ge+48:Ne=pt(Ae,Ne,1),Ne=at(Ae,Ne,xe[Ge]),He[nt]=Ee&32767,++Ee}Ne=at(Ae,Ne,0)-1}return Ae.l=(Ne+7)/8|0,Ae.l}return function(Ae,Ne){return Ae.length<8?ce(Ae,Ne):ke(Ae,Ne)}}();function Qe(V){var se=De(50+Math.floor(V.length*1.1)),ee=st(V,se);return se.slice(0,ee)}var et=me?new Uint16Array(32768):qt(32768),fr=me?new Uint16Array(32768):qt(32768),Nt=me?new Uint16Array(128):qt(128),Ot=1,Gt=1;function Br(V,se){var ee=Oe(V,se)+257;se+=5;var re=Oe(V,se)+1;se+=5;var oe=J(V,se)+4;se+=4;for(var ce=0,ke=me?new Uint8Array(19):qt(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ae=1,Ne=me?new Uint8Array(8):qt(8),Ee=me?new Uint8Array(8):qt(8),He=ke.length,Xe=0;Xe<oe;++Xe)ke[O[Xe]]=ce=$e(V,se),Ae<ce&&(Ae=ce),Ne[ce]++,se+=3;var nt=0;for(Ne[0]=0,Xe=1;Xe<=Ae;++Xe)Ee[Xe]=nt=nt+Ne[Xe-1]<<1;for(Xe=0;Xe<He;++Xe)(nt=ke[Xe])!=0&&(Ce[Xe]=Ee[nt]++);var Ge=0;for(Xe=0;Xe<He;++Xe)if(Ge=ke[Xe],Ge!=0){nt=xe[Ce[Xe]]>>8-Ge;for(var rt=(1<<7-Ge)-1;rt>=0;--rt)Nt[nt|rt<<Ge]=Ge&7|Xe<<3}var Lt=[];for(Ae=1;Lt.length<ee+re;)switch(nt=Nt[Be(V,se)],se+=nt&7,nt>>>=3){case 16:for(ce=3+Fe(V,se),se+=2,nt=Lt[Lt.length-1];ce-- >0;)Lt.push(nt);break;case 17:for(ce=3+$e(V,se),se+=3;ce-- >0;)Lt.push(0);break;case 18:for(ce=11+Be(V,se),se+=7;ce-- >0;)Lt.push(0);break;default:Lt.push(nt),Ae<nt&&(Ae=nt);break}var Er=Lt.slice(0,ee),sr=Lt.slice(ee);for(Xe=ee;Xe<286;++Xe)Er[Xe]=0;for(Xe=re;Xe<30;++Xe)sr[Xe]=0;return Ot=Mt(Er,et,286),Gt=Mt(sr,fr,30),se}function St(V,se){if(V[0]==3&&!(V[1]&3))return[vo(se),2];for(var ee=0,re=0,oe=Rg(se||1<<18),ce=0,ke=oe.length>>>0,Ce=0,Ae=0;!(re&1);){if(re=$e(V,ee),ee+=3,re>>>1)re>>1==1?(Ce=9,Ae=5):(ee=Br(V,ee),Ce=Ot,Ae=Gt);else{ee&7&&(ee+=8-(ee&7));var Ne=V[ee>>>3]|V[(ee>>>3)+1]<<8;if(ee+=32,Ne>0)for(!se&&ke<ce+Ne&&(oe=ft(oe,ce+Ne),ke=oe.length);Ne-- >0;)oe[ce++]=V[ee>>>3],ee+=8;continue}for(;;){!se&&ke<ce+32767&&(oe=ft(oe,ce+32767),ke=oe.length);var Ee=it(V,ee,Ce),He=re>>>1==1?jt[Ee]:et[Ee];if(ee+=He&15,He>>>=4,!(He>>>8&255))oe[ce++]=He;else{if(He==256)break;He-=257;var Xe=He<8?0:He-4>>2;Xe>5&&(Xe=0);var nt=ce+H[He];Xe>0&&(nt+=it(V,ee,Xe),ee+=Xe),Ee=it(V,ee,Ae),He=re>>>1==1?Xt[Ee]:fr[Ee],ee+=He&15,He>>>=4;var Ge=He<4?0:He-2>>1,rt=ae[He];for(Ge>0&&(rt+=it(V,ee,Ge),ee+=Ge),!se&&ke<nt&&(oe=ft(oe,nt+100),ke=oe.length);ce<nt;)oe[ce]=oe[ce-rt],++ce}}}return se?[oe,ee+7>>>3]:[oe.slice(0,ce),ee+7>>>3]}function wr(V,se){var ee=V.slice(V.l||0),re=St(ee,se);return V.l+=re[1],re[0]}function Et(V,se){if(V)typeof console<"u"&&console.error(se);else throw new Error(se)}function zt(V,se){var ee=V;en(ee,0);var re=[],oe=[],ce={FileIndex:re,FullPaths:oe};A(ce,{root:se.root});for(var ke=ee.length-4;(ee[ke]!=80||ee[ke+1]!=75||ee[ke+2]!=5||ee[ke+3]!=6)&&ke>=0;)--ke;ee.l=ke+4,ee.l+=4;var Ce=ee.read_shift(2);ee.l+=6;var Ae=ee.read_shift(4);for(ee.l=Ae,ke=0;ke<Ce;++ke){ee.l+=20;var Ne=ee.read_shift(4),Ee=ee.read_shift(4),He=ee.read_shift(2),Xe=ee.read_shift(2),nt=ee.read_shift(2);ee.l+=8;var Ge=ee.read_shift(4),rt=l(ee.slice(ee.l+He,ee.l+He+Xe));ee.l+=He+Xe+nt;var Lt=ee.l;ee.l=Ge+4,Mr(ee,Ne,Ee,ce,rt),ee.l=Lt}return ce}function Mr(V,se,ee,re,oe){V.l+=2;var ce=V.read_shift(2),ke=V.read_shift(2),Ce=o(V);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ae=V.read_shift(4),Ne=V.read_shift(4),Ee=V.read_shift(4),He=V.read_shift(2),Xe=V.read_shift(2),nt="",Ge=0;Ge<He;++Ge)nt+=String.fromCharCode(V[V.l++]);if(Xe){var rt=l(V.slice(V.l,V.l+Xe));(rt[21589]||{}).mt&&(Ce=rt[21589].mt),((oe||{})[21589]||{}).mt&&(Ce=oe[21589].mt)}V.l+=Xe;var Lt=V.slice(V.l,V.l+Ne);switch(ke){case 8:Lt=R(V,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Er=!1;ce&8&&(Ae=V.read_shift(4),Ae==134695760&&(Ae=V.read_shift(4),Er=!0),Ne=V.read_shift(4),Ee=V.read_shift(4)),Ne!=se&&Et(Er,"Bad compressed size: "+se+" != "+Ne),Ee!=ee&&Et(Er,"Bad uncompressed size: "+ee+" != "+Ee),an(re,nt,Lt,{unsafe:!0,mt:Ce})}function er(V,se){var ee=se||{},re=[],oe=[],ce=De(1),ke=ee.compression?8:0,Ce=0,Ae=0,Ne=0,Ee=0,He=0,Xe=V.FullPaths[0],nt=Xe,Ge=V.FileIndex[0],rt=[],Lt=0;for(Ae=1;Ae<V.FullPaths.length;++Ae)if(nt=V.FullPaths[Ae].slice(Xe.length),Ge=V.FileIndex[Ae],!(!Ge.size||!Ge.content||nt=="Sh33tJ5")){var Er=Ee,sr=De(nt.length);for(Ne=0;Ne<nt.length;++Ne)sr.write_shift(1,nt.charCodeAt(Ne)&127);sr=sr.slice(0,sr.l),rt[He]=E6.buf(Ge.content,0);var ra=Ge.content;ke==8&&(ra=N(ra)),ce=De(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Ce),ce.write_shift(2,ke),Ge.mt?i(ce,Ge.mt):ce.write_shift(4,0),ce.write_shift(-4,rt[He]),ce.write_shift(4,ra.length),ce.write_shift(4,Ge.content.length),ce.write_shift(2,sr.length),ce.write_shift(2,0),Ee+=ce.length,re.push(ce),Ee+=sr.length,re.push(sr),Ee+=ra.length,re.push(ra),ce=De(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Ce),ce.write_shift(2,ke),ce.write_shift(4,0),ce.write_shift(-4,rt[He]),ce.write_shift(4,ra.length),ce.write_shift(4,Ge.content.length),ce.write_shift(2,sr.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,Er),Lt+=ce.l,oe.push(ce),Lt+=sr.length,oe.push(sr),++He}return ce=De(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,He),ce.write_shift(2,He),ce.write_shift(4,Lt),ce.write_shift(4,Ee),ce.write_shift(2,0),$a([$a(re),$a(oe),ce])}var At={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vr(V,se){if(V.ctype)return V.ctype;var ee=V.name||"",re=ee.match(/\.([^\.]+)$/);return re&&At[re[1]]||se&&(re=(ee=se).match(/[\.\\]([^\.\\])+$/),re&&At[re[1]])?At[re[1]]:"application/octet-stream"}function fs(V){for(var se=T0(V),ee=[],re=0;re<se.length;re+=76)ee.push(se.slice(re,re+76));return ee.join(`\r
`)+`\r
`}function za(V){var se=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var Ee=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});se=se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),se.charAt(0)==`
`&&(se="=0D"+se.slice(1)),se=se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],re=se.split(`\r
`),oe=0;oe<re.length;++oe){var ce=re[oe];if(ce.length==0){ee.push("");continue}for(var ke=0;ke<ce.length;){var Ce=76,Ae=ce.slice(ke,ke+Ce);Ae.charAt(Ce-1)=="="?Ce--:Ae.charAt(Ce-2)=="="?Ce-=2:Ae.charAt(Ce-3)=="="&&(Ce-=3),Ae=ce.slice(ke,ke+Ce),ke+=Ce,ke<ce.length&&(Ae+="="),ee.push(Ae)}}return ee.join(`\r
`)}function bi(V){for(var se=[],ee=0;ee<V.length;++ee){for(var re=V[ee];ee<=V.length&&re.charAt(re.length-1)=="=";)re=re.slice(0,re.length-1)+V[++ee];se.push(re)}for(var oe=0;oe<se.length;++oe)se[oe]=se[oe].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return Kn(se.join(`\r
`))}function ti(V,se,ee){for(var re="",oe="",ce="",ke,Ce=0;Ce<10;++Ce){var Ae=se[Ce];if(!Ae||Ae.match(/^\s*$/))break;var Ne=Ae.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":re=Ne[2].trim();break;case"content-type":ce=Ne[2].trim();break;case"content-transfer-encoding":oe=Ne[2].trim();break}}switch(++Ce,oe.toLowerCase()){case"base64":ke=Kn(Qn(se.slice(Ce).join("")));break;case"quoted-printable":ke=bi(se.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+oe)}var Ee=an(V,re.slice(ee.length),ke,{unsafe:!0});ce&&(Ee.ctype=ce)}function Ct(V,se){if(Q(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=se&&se.root||"",re=(tr&&Buffer.isBuffer(V)?V.toString("binary"):Q(V)).split(`\r
`),oe=0,ce="";for(oe=0;oe<re.length;++oe)if(ce=re[oe],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),ee||(ee=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),ce.slice(0,ee.length)!=ee););var ke=(re[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Ce="--"+(ke[1]||""),Ae=[],Ne=[],Ee={FileIndex:Ae,FullPaths:Ne};A(Ee);var He,Xe=0;for(oe=0;oe<re.length;++oe){var nt=re[oe];nt!==Ce&&nt!==Ce+"--"||(Xe++&&ti(Ee,re.slice(He,oe),ee),He=oe)}return Ee}function wi(V,se){var ee=se||{},re=ee.boundary||"SheetJS";re="------="+re;for(var oe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+re.slice(2)+'"',"","",""],ce=V.FullPaths[0],ke=ce,Ce=V.FileIndex[0],Ae=1;Ae<V.FullPaths.length;++Ae)if(ke=V.FullPaths[Ae].slice(ce.length),Ce=V.FileIndex[Ae],!(!Ce.size||!Ce.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Lt){return"_x"+Lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Lt){return"_u"+Lt.charCodeAt(0).toString(16)+"_"});for(var Ne=Ce.content,Ee=tr&&Buffer.isBuffer(Ne)?Ne.toString("binary"):Q(Ne),He=0,Xe=Math.min(1024,Ee.length),nt=0,Ge=0;Ge<=Xe;++Ge)(nt=Ee.charCodeAt(Ge))>=32&&nt<128&&++He;var rt=He>=Xe*4/5;oe.push(re),oe.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+ke),oe.push("Content-Transfer-Encoding: "+(rt?"quoted-printable":"base64")),oe.push("Content-Type: "+vr(Ce,ke)),oe.push(""),oe.push(rt?za(Ee):fs(Ee))}return oe.push(re+`--\r
`),oe.join(`\r
`)}function _i(V){var se={};return A(se,V),se}function an(V,se,ee,re){var oe=re&&re.unsafe;oe||A(V);var ce=!oe&&kt.find(V,se);if(!ce){var ke=V.FullPaths[0];se.slice(0,ke.length)==ke?ke=se:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+se).replace("//","/")),ce={name:n(se),type:2},V.FileIndex.push(ce),V.FullPaths.push(ke),oe||kt.utils.cfb_gc(V)}return ce.content=ee,ce.size=ee?ee.length:0,re&&(re.CLSID&&(ce.clsid=re.CLSID),re.mt&&(ce.mt=re.mt),re.ct&&(ce.ct=re.ct)),ce}function Tn(V,se){A(V);var ee=kt.find(V,se);if(ee){for(var re=0;re<V.FileIndex.length;++re)if(V.FileIndex[re]==ee)return V.FileIndex.splice(re,1),V.FullPaths.splice(re,1),!0}return!1}function Gr(V,se,ee){A(V);var re=kt.find(V,se);if(re){for(var oe=0;oe<V.FileIndex.length;++oe)if(V.FileIndex[oe]==re)return V.FileIndex[oe].name=n(ee),V.FullPaths[oe]=ee,!0}return!1}function wa(V){D(V,!0)}return t.find=L,t.read=E,t.parse=f,t.write=we,t.writeFile=pe,t.utils={cfb_new:_i,cfb_add:an,cfb_del:Tn,cfb_mov:Gr,cfb_gc:wa,ReadShift:h0,CheckField:Ib,prep_blob:en,bconcat:$a,use_zlib:T,_deflateRaw:Qe,_inflateRaw:wr,consts:he},t}();let po;function C6(e){po=e}function F6(e){return typeof e=="string"?ru(e):Array.isArray(e)?r6(e):e}function nu(e,t,r){if(typeof po<"u"&&po.writeFileSync)return r?po.writeFileSync(e,t,r):po.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ru(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?as(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([F6(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Ao(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function D6(e){if(typeof po<"u")return po.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function fa(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Hg(e,t){for(var r=[],a=fa(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Ed(e){for(var t=[],r=fa(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Cd(e){for(var t=[],r=fa(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function I6(e){for(var t=[],r=fa(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Vf=new Date(1899,11,30,0,0,0);function Ba(e,t){var r=e.getTime(),a=Vf.getTime()+(e.getTimezoneOffset()-Vf.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var xb=new Date,L6=Vf.getTime()+(xb.getTimezoneOffset()-Vf.getTimezoneOffset())*6e4,$g=xb.getTimezoneOffset();function Fd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+L6),t.getTimezoneOffset()!==$g&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$g)*6e4),t}function P6(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var Vg=new Date("2017-02-19T19:06:09.000Z"),gb=isNaN(Vg.getFullYear())?new Date("2/19/17"):Vg,R6=gb.getFullYear()==2017;function Vr(e,t){var r=new Date(e);if(R6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gb.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ol(e,t){if(tr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return as(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return as(ab(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return as(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return as(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Pr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Pr(e[r]));return t}function sa(e,t){for(var r="";r.length<t;)r+=e;return r}function Pi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var O6=["january","february","march","april","may","june","july","august","september","october","november","december"];function dc(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&O6.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var B6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(n),o.push(i[l]);return o}}();function vb(e){return e?e.content&&e.type?ol(e.content,!0):e.data?Jl(e.data):e.asNodeBuffer&&tr?Jl(e.asNodeBuffer().toString("binary")):e.asBinary?Jl(e.asBinary()):e._data&&e._data.getContent?Jl(ol(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function yb(e){if(!e)return null;if(e.data)return Wf(e.data);if(e.asNodeBuffer&&tr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Wf(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function M6(e){return e&&e.name.slice(-4)===".bin"?yb(e):vb(e)}function di(e,t){for(var r=e.FullPaths||fa(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function mm(e,t){var r=di(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ja(e,t,r){if(!r)return M6(mm(e,t));if(!t)return null;try{return ja(e,t)}catch{return null}}function Yn(e,t,r){if(!r)return vb(mm(e,t));if(!t)return null;try{return Yn(e,t)}catch{return null}}function z6(e,t,r){return yb(mm(e,t))}function Gg(e){for(var t=e.FullPaths||fa(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Qt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return tr?a=Ms(r):a=a6(r),kt.utils.cfb_add(e,t,a)}kt.utils.cfb_add(e,t,r)}else e.file(t,r)}function xm(){return kt.utils.cfb_new()}function bb(e,t){switch(t.type){case"base64":return kt.read(e,{type:"base64"});case"binary":return kt.read(e,{type:"binary"});case"buffer":case"array":return kt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function c0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var ba=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,U6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Kg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,W6=/<[^>]*>/g,yn=ba.match(Kg)?Kg:W6,q6=/<\w*:/,H6=/<(\/?)\w+:/;function Pt(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(U6),l=0,c="",u=0,f="",h="",p=1;if(o)for(u=0;u!=o.length;++u){for(h=o[u],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(f=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(p=(n=h.charCodeAt(i+1))==34||n==39?1:0,c=h.slice(i+1+p,h.length-p),l=0;l!=f.length&&f.charCodeAt(l)!==58;++l);if(l===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=c,a[f.toLowerCase()]=c;else{var d=(l===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(l+1);if(a[d]&&f.slice(l-3,l)=="ext")continue;a[d]=c,a[d.toLowerCase()]=c}}return a}function ls(e){return e.replace(H6,"<$1")}var wb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gm=Ed(wb),gr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(l,c){return wb[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}}(),vm=/[&<>'"]/g,$6=/[\u0000-\u0008\u000b-\u001f]/g;function Tr(e){var t=e+"";return t.replace(vm,function(r){return gm[r]}).replace($6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Yg(e){return Tr(e).replace(/ /g,"_x0020_")}var _b=/[\u0000-\u001f]/g;function ym(e){var t=e+"";return t.replace(vm,function(r){return gm[r]}).replace(/\n/g,"<br/>").replace(_b,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function V6(e){var t=e+"";return t.replace(vm,function(r){return gm[r]}).replace(_b,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Xg=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function G6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function qr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function qh(e){for(var t="",r=0,a=0,n=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Jg(e){var t=vo(2*e.length),r,a,n=1,i=0,o=0,l;for(a=0;a<e.length;a+=n)n=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),n=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Zg(e){return Ms(e,"binary").toString("utf8")}var Qu="foo bar bazâð£",Fr=tr&&(Zg(Qu)==qh(Qu)&&Zg||Jg(Qu)==qh(Qu)&&Jg)||qh,as=tr?function(e){return Ms(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},C0=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),kb=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),K6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Y6=/<\/?(?:vt:)?variant>/g,X6=/<(?:vt:)([^>]*)>([\s\S]*)</;function Qg(e,t){var r=Pt(e),a=e.match(K6(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var o=i.replace(Y6,"").match(X6);o&&n.push({v:Fr(o[2]),t:o[1]})}),n}var Sb=/(^\s|\s$|\n)/;function tn(e,t){return"<"+e+(t.match(Sb)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function F0(e){return fa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Je(e,t,r){return"<"+e+(r!=null?F0(r):"")+(t!=null?(t.match(Sb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Gp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function J6(e,t){switch(typeof e){case"string":var r=Je("vt:lpwstr",Tr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Je((e|0)==e?"vt:i4":"vt:r8",Tr(String(e)));case"boolean":return Je("vt:bool",e?"true":"false")}if(e instanceof Date)return Je("vt:filetime",Gp(e));throw new Error("Unable to serialize "+e)}function bm(e){if(tr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Fr(Ao(dm(e)));throw new Error("Bad input format: expected Buffer or string")}var D0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Oa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Gn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Z6(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function Q6(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=a?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var e2=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},t2=tr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ms(t)})):e2(e)}:e2,r2=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Ds(e,n)));return a.join("").replace(xn,"")},Dd=tr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(xn,""):r2(e,t,r)}:r2,a2=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},Ab=tr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):a2(e,t,r)}:a2,n2=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Gl(e,n)));return a.join("")},_c=tr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):n2(t,r,a)}:n2,Nb=function(e,t){var r=Ha(e,t);return r>0?_c(e,t+4,t+4+r-1):""},wm=Nb,jb=function(e,t){var r=Ha(e,t);return r>0?_c(e,t+4,t+4+r-1):""},_m=jb,Tb=function(e,t){var r=2*Ha(e,t);return r>0?_c(e,t+4,t+4+r-1):""},km=Tb,Eb=function(t,r){var a=Ha(t,r);return a>0?Dd(t,r+4,r+4+a):""},Sm=Eb,Cb=function(e,t){var r=Ha(e,t);return r>0?_c(e,t+4,t+4+r):""},Am=Cb,Fb=function(e,t){return Z6(e,t)},Gf=Fb,Nm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};tr&&(wm=function(t,r){if(!Buffer.isBuffer(t))return Nb(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},_m=function(t,r){if(!Buffer.isBuffer(t))return jb(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},km=function(t,r){if(!Buffer.isBuffer(t))return Tb(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Sm=function(t,r){if(!Buffer.isBuffer(t))return Eb(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Am=function(t,r){if(!Buffer.isBuffer(t))return Cb(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Gf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Fb(t,r)},Nm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Db(){Dd=function(e,t,r){return pr.utils.decode(1200,e.slice(t,r)).replace(xn,"")},_c=function(e,t,r){return pr.utils.decode(65001,e.slice(t,r))},wm=function(e,t){var r=Ha(e,t);return r>0?pr.utils.decode(il,e.slice(t+4,t+4+r-1)):""},_m=function(e,t){var r=Ha(e,t);return r>0?pr.utils.decode(Jn,e.slice(t+4,t+4+r-1)):""},km=function(e,t){var r=2*Ha(e,t);return r>0?pr.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Sm=function(e,t){var r=Ha(e,t);return r>0?pr.utils.decode(1200,e.slice(t+4,t+4+r)):""},Am=function(e,t){var r=Ha(e,t);return r>0?pr.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof pr<"u"&&Db();var Gl=function(e,t){return e[t]},Ds=function(e,t){return e[t+1]*256+e[t]},eA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ha=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Go=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function h0(e,t){var r="",a,n,i=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,tr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ds(this,u)),u+=2;e*=2;break;case"utf8":r=_c(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Dd(this,this.l,this.l+e);break;case"wstr":if(typeof pr<"u")r=pr.utils.decode(Jn,this.slice(this.l,this.l+2*e));else return h0.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=wm(this,this.l),e=4+Ha(this,this.l);break;case"lpstr-cp":r=_m(this,this.l),e=4+Ha(this,this.l);break;case"lpwstr":r=km(this,this.l),e=4+2*Ha(this,this.l);break;case"lpp4":e=4+Ha(this,this.l),r=Sm(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ha(this,this.l),r=Am(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Gl(this,this.l+e++))!==0;)i.push(o0(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Ds(this,this.l+e))!==0;)i.push(o0(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Gl(this,u),this.l=u+1,l=h0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(o0(Ds(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof pr<"u"){r=pr.utils.decode(Jn,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Gl(this,u),this.l=u+1,l=h0.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(o0(Gl(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return a=Gl(this,this.l),this.l++,a;case 2:return a=(t==="i"?eA:Ds)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Go:tA)(this,this.l),this.l+=4,a):(n=Ha(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Gf(this,this.l):n=Gf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=Ab(this,this.l,e);break}}return this.l+=e,r}var rA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},aA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},nA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function iA(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)nA(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){if(typeof pr<"u"&&il==874)for(n=0;n!=t.length;++n){var i=pr.utils.encode(il,t.charAt(n));this[this.l+n]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,rA(this,t,this.l);break;case 8:if(a=8,r==="f"){Q6(this,t,this.l);break}case 16:break;case-4:a=4,aA(this,t,this.l);break}return this.l+=a,this}function Ib(e,t){var r=Ab(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function en(e,t){e.l=t,e.read_shift=h0,e.chk=Ib,e.write_shift=iA}function vn(e,t){e.l+=t}function De(e){var t=vo(e);return en(t,0),t}function zs(e,t,r){if(e){var a,n,i;en(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=B0[l]||B0[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;c=e.l+i;var f=u.f&&u.f(e,i,r);if(e.l=c,t(f,u,l))return}}}function In(){var e=[],t=tr?256:2048,r=function(u){var f=De(u);return en(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(u){return a&&u<a.length-a.l?a:(n(),a=r(Math.max(u+1,t)))},o=function(){return n(),$a(e)},l=function(u){n(),a=u,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function ze(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=B0[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Nm(r)&&e.push(r)}}function p0(e,t,r){var a=Pr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function i2(e,t,r){var a=Pr(e);return a.s=p0(a.s,t.s,r),a.e=p0(a.e,t.s,r),a}function m0(e,t){if(e.cRel&&e.c<0)for(e=Pr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Pr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=It(e);return!e.cRel&&e.cRel!=null&&(r=lA(r)),!e.rRel&&e.rRel!=null&&(r=sA(r)),r}function Hh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$r(e.s.c)+":"+(e.e.cRel?"":"$")+$r(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+la(e.s.r)+":"+(e.e.rRel?"":"$")+la(e.e.r):m0(e.s,t.biff)+":"+m0(e.e,t.biff)}function jm(e){return parseInt(oA(e),10)-1}function la(e){return""+(e+1)}function sA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oA(e){return e.replace(/\$(\d+)$/,"$1")}function Tm(e){for(var t=cA(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function $r(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function lA(e){return e.replace(/^([A-Z])/,"$$$1")}function cA(e){return e.replace(/^\$([A-Z])/,"$1")}function uA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function It(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Nn(e){var t=e.indexOf(":");return t==-1?{s:Qr(e),e:Qr(e)}:{s:Qr(e.slice(0,t)),e:Qr(e.slice(t+1))}}function Yt(e,t){return typeof t>"u"||typeof t=="number"?Yt(e.s,e.e):(typeof e!="string"&&(e=It(e)),typeof t!="string"&&(t=It(t)),e==t?e:e+":"+t)}function or(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function s2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ei(e.z,r?Ba(t):t)}catch{}try{return e.w=ei((e.XF||{}).numFmtId||(r?14:0),r?Ba(t):t)}catch{return""+t}}function ss(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Us[e.v]||e.v:t==null?s2(e,e.v):s2(e,t))}function No(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Lb(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Qr(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=or(i["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var d={v:t[h][p]},v=o+h,m=l+p;if(u.s.r>v&&(u.s.r=v),u.s.c>m&&(u.s.c=m),u.e.r<v&&(u.e.r=v),u.e.c<m&&(u.e.c=m),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))d=t[h][p];else if(Array.isArray(d.v)&&(d.f=t[h][p][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(a.nullError)d.t="e",d.v=0;else if(a.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=a.dateNF||Ft[14],a.cellDates?(d.t="d",d.w=ei(d.z,Ba(d.v))):(d.t="n",d.v=Ba(d.v),d.w=ei(d.z,d.v))):d.t="s";if(n)i[v]||(i[v]=[]),i[v][m]&&i[v][m].z&&(d.z=i[v][m].z),i[v][m]=d;else{var y=It({c:m,r:v});i[y]&&i[y].z&&(d.z=i[y].z),i[y]=d}}}return u.s.c<1e7&&(i["!ref"]=Yt(u)),i}function kc(e,t){return Lb(null,e,t)}function fA(e){return e.read_shift(4,"i")}function Ri(e,t){return t||(t=De(4)),t.write_shift(4,e),t}function gn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Va(e,t){var r=!1;return t==null&&(r=!0,t=De(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hA(e,t){return t||(t=De(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Em(e,t){var r=e.l,a=e.read_shift(1),n=gn(e),i=[],o={t:n,h:n};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(dA(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function pA(e,t){var r=!1;return t==null&&(r=!0,t=De(15+4*e.t.length)),t.write_shift(1,0),Va(e.t,t),r?t.slice(0,t.l):t}var mA=Em;function xA(e,t){var r=!1;return t==null&&(r=!0,t=De(23+4*e.t.length)),t.write_shift(1,1),Va(e.t,t),t.write_shift(4,1),hA({},t),r?t.slice(0,t.l):t}function yi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vl(e,t){return t==null&&(t=De(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function yl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bl(e,t){return t==null&&(t=De(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var gA=gn,Pb=Va;function Cm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Kf(e,t){var r=!1;return t==null&&(r=!0,t=De(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var vA=gn,Kp=Cm,Fm=Kf;function Dm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Gf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Go(t,0)>>2;return r?n/100:n}function Rb(e,t){t==null&&(t=De(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ob(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function yA(e,t){return t||(t=De(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var wl=Ob,Sc=yA;function mn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ll(e,t){return(t||De(8)).write_shift(8,e,"f")}function bA(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var u=Jo[n];u&&(t.rgb=L0(u));break;case 2:t.rgb=L0([o,l,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Yf(e,t){if(t||(t=De(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function wA(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _A(e,t){t||(t=De(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Bb(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function kA(e){return Bb(e,1)}function SA(e){return Bb(e,2)}var Im=2,Dn=3,ef=11,o2=12,Xf=19,tf=64,AA=65,NA=71,jA=4108,TA=4126,Wa=80,Mb=81,EA=[Wa,Mb],Yp={1:{n:"CodePage",t:Im},2:{n:"Category",t:Wa},3:{n:"PresentationFormat",t:Wa},4:{n:"ByteCount",t:Dn},5:{n:"LineCount",t:Dn},6:{n:"ParagraphCount",t:Dn},7:{n:"SlideCount",t:Dn},8:{n:"NoteCount",t:Dn},9:{n:"HiddenCount",t:Dn},10:{n:"MultimediaClipCount",t:Dn},11:{n:"ScaleCrop",t:ef},12:{n:"HeadingPairs",t:jA},13:{n:"TitlesOfParts",t:TA},14:{n:"Manager",t:Wa},15:{n:"Company",t:Wa},16:{n:"LinksUpToDate",t:ef},17:{n:"CharacterCount",t:Dn},19:{n:"SharedDoc",t:ef},22:{n:"HyperlinksChanged",t:ef},23:{n:"AppVersion",t:Dn,p:"version"},24:{n:"DigSig",t:AA},26:{n:"ContentType",t:Wa},27:{n:"ContentStatus",t:Wa},28:{n:"Language",t:Wa},29:{n:"Version",t:Wa},255:{},2147483648:{n:"Locale",t:Xf},2147483651:{n:"Behavior",t:Xf},1919054434:{}},Xp={1:{n:"CodePage",t:Im},2:{n:"Title",t:Wa},3:{n:"Subject",t:Wa},4:{n:"Author",t:Wa},5:{n:"Keywords",t:Wa},6:{n:"Comments",t:Wa},7:{n:"Template",t:Wa},8:{n:"LastAuthor",t:Wa},9:{n:"RevNumber",t:Wa},10:{n:"EditTime",t:tf},11:{n:"LastPrinted",t:tf},12:{n:"CreatedDate",t:tf},13:{n:"ModifiedDate",t:tf},14:{n:"PageCount",t:Dn},15:{n:"WordCount",t:Dn},16:{n:"CharCount",t:Dn},17:{n:"Thumbnail",t:NA},18:{n:"Application",t:Wa},19:{n:"DocSecurity",t:Dn},255:{},2147483648:{n:"Locale",t:Xf},2147483651:{n:"Behavior",t:Xf},1919054434:{}},l2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CA=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function FA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var DA=FA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jo=Pr(DA),Us={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},rf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Lm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IA(e){var t=Lm();if(!e||!e.match)return t;var r={};if((e.match(yn)||[]).forEach(function(a){var n=Pt(a);switch(n[0].replace(q6,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Jp[n.ContentType]]!==void 0&&t[Jp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Oa.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Ub(e,t){var r=I6(Jp),a=[],n;a[a.length]=ba,a[a.length]=Je("Types",null,{xmlns:Oa.CT,"xmlns:xsd":Oa.xsd,"xmlns:xsi":Oa.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Je("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],a[a.length]=Je("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:rf[c][t.bookType]||rf[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){a[a.length]=Je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:rf[c][t.bookType]||rf[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){a[a.length]=Je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ar={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function I0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function x0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(yn)||[]).forEach(function(n){var i=Pt(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:c0(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function nc(e){var t=[ba,Je("Relationships",null,{xmlns:Oa.RELS})];return fa(e["!id"]).forEach(function(r){t[t.length]=Je("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Nr(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[ar.HLINK,ar.XPATH,ar.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var LA="application/vnd.oasis.opendocument.spreadsheet";function PA(e,t){for(var r=bm(e),a,n;a=D0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Pt(a[0],!1),n.path=="/"&&n.type!==LA)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function RA(e){var t=[ba];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function c2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function OA(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function BA(e){var t=[ba];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(c2(e[r][0],e[r][1])),t.push(OA("",e[r][0]));return t.push(c2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Wb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+j0.version+"</meta:generator></office:meta></office:document-meta>"}var gi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MA=function(){for(var e=new Array(gi.length),t=0;t<gi.length;++t){var r=gi[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function qb(e){var t={};e=Fr(e);for(var r=0;r<gi.length;++r){var a=gi[r],n=e.match(MA[r]);n!=null&&n.length>0&&(t[a[1]]=gr(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Vr(t[a[1]]))}return t}function $h(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Tr(t),a[a.length]=r?Je(e,t,r):tn(e,t))}function Hb(e,t){var r=t||{},a=[ba,Je("cp:coreProperties",null,{"xmlns:cp":Oa.CORE_PROPS,"xmlns:dc":Oa.dc,"xmlns:dcterms":Oa.dcterms,"xmlns:dcmitype":Oa.dcmitype,"xmlns:xsi":Oa.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&$h("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Gp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&$h("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Gp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=gi.length;++i){var o=gi[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&$h(o[0],l,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Zo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],$b=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Vb(e,t,r,a){var n=[];if(typeof e=="string")n=Qg(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(f){return{v:f}}));var o=typeof t=="string"?Qg(t,a).map(function(f){return f.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function zA(e,t,r){var a={};return t||(t={}),e=Fr(e),Zo.forEach(function(n){var i=(e.match(C0(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=gr(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Vb(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Gb(e){var t=[],r=Je;return e||(e={}),e.Application="SheetJS",t[t.length]=ba,t[t.length]=Je("Properties",null,{xmlns:Oa.EXT_PROPS,"xmlns:vt":Oa.vt}),Zo.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Tr(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Tr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var UA=/<[^>]+>[^<]*/g;function WA(e,t){var r={},a="",n=e.match(UA);if(n)for(var i=0;i!=n.length;++i){var o=n[i],l=Pt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=gr(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=gr(f);break;case"bool":r[a]=qr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(f);break;case"filetime":case"date":r[a]=Vr(f);break;case"cy":case"error":r[a]=gr(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function Kb(e){var t=[ba,Je("Properties",null,{xmlns:Oa.CUST_PROPS,"xmlns:vt":Oa.vt})];if(!e)return t.join("");var r=1;return fa(e).forEach(function(n){++r,t[t.length]=Je("property",J6(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Tr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vh;function qA(e,t,r){Vh||(Vh=Ed(Zp)),t=Vh[t]||t,e[t]=r}function HA(e,t){var r=[];return fa(Zp).map(function(a){for(var n=0;n<gi.length;++n)if(gi[n][1]==a)return gi[n];for(n=0;n<Zo.length;++n)if(Zo[n][1]==a)return Zo[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(tn(Zp[a[1]]||a[1],n))}}),Je("DocumentProperties",r.join(""),{xmlns:Gn.o})}function $A(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&fa(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<gi.length;++o)if(i==gi[o][1])return;for(o=0;o<Zo.length;++o)if(i==Zo[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(Je(Yg(i),l,{"dt:dt":c}))}}),t&&fa(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Je(Yg(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+Gn.o+'">'+n.join("")+"</"+a+">"}function Pm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function VA(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var o=De(8);return o.write_shift(4,a),o.write_shift(4,n),o}function Yb(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function Xb(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Jb(e,t,r){return t===31?Xb(e):Yb(e,t,r)}function Qp(e,t,r){return Jb(e,t,r===!1?0:4)}function GA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Jb(e,t,0)}function KA(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(xn,""),e.l-n&2&&(e.l+=2)}return r}function YA(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(xn,"");return r}function XA(e){var t=e.l,r=Jf(e,Mb);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Jf(e,Dn);return[r,a]}function JA(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(XA(e));return r}function u2(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(xn,"").replace(l0,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Zb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ZA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Jf(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==o2&&a!==t&&EA.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===o2?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Yb(e,a,4).replace(xn,"");case 31:return Xb(e);case 64:return Pm(e);case 65:return Zb(e);case 71:return ZA(e);case 80:return Qp(e,a,!i.raw).replace(xn,"");case 81:return GA(e,a).replace(xn,"");case 4108:return JA(e);case 4126:case 4127:return a==4127?KA(e):YA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function f2(e,t){var r=De(4),a=De(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=De(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=VA(t);break;case 31:case 80:for(a=De(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return $a([r,a])}function d2(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],o=0,l=0,c=-1,u={};for(o=0;o!=n;++o){var f=e.read_shift(4),h=e.read_shift(4);i[o]=[f,h+r]}i.sort(function(k,g){return k[1]-g[1]});var p={};for(o=0;o!=n;++o){if(e.l!==i[o][1]){var d=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],d=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],d=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(d=!1,e.l=i[o][1]),d)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[i[o][0]];if(p[v.n]=Jf(e,v.t,{raw:!0}),v.p==="version"&&(p[v.n]=String(p[v.n]>>16)+"."+("0000"+String(p[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(p[v.n]){case 0:p[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:mi(l=p[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[v.n])}}else if(i[o][0]===1){if(l=p.CodePage=Jf(e,Im),mi(l),c!==-1){var m=e.l;e.l=i[c][1],u=u2(e,l),e.l=m}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}u=u2(e,l)}else{var y=u[i[o][0]],_;switch(e[e.l]){case 65:e.l+=4,_=Zb(e);break;case 30:e.l+=4,_=Qp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Qp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=xa(e,4);break;case 64:e.l+=4,_=Vr(Pm(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[y]=_}}return e.l=r+a,p}var Qb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function QA(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function h2(e,t,r){var a=De(8),n=[],i=[],o=8,l=0,c=De(8),u=De(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),n.push(u),o+=8+c.length,!t){u=De(8),u.write_shift(4,0),n.unshift(u);var f=[De(4)];for(f[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(c=De(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=$a(f),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Qb.indexOf(e[l][0])>-1||$b.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],d=0;if(t){d=+t[e[l][0]];var v=r[d];if(v.p=="version"&&typeof p=="string"){var m=p.split(".");p=(+m[0]<<16)+(+m[1]||0)}c=f2(v.t,p)}else{var y=QA(p);y==-1&&(y=31,p=String(p)),c=f2(y,p)}i.push(c),u=De(8),u.write_shift(4,t?d:2+l),n.push(u),o+=8+c.length}var _=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,_),_+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),$a([a].concat(n).concat(i))}function p2(e,t,r){var a=e.content;if(!a)return{};en(a,0);var n,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),f=a.read_shift(16);if(f!==kt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),l=a.read_shift(4),n===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);n===2&&(o=a.read_shift(16),c=a.read_shift(4));var h=d2(a,t),p={SystemIdentifier:u};for(var d in h)p[d]=h[d];if(p.FMTID=i,n===1)return p;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var v;try{v=d2(a,null)}catch{}for(d in v)p[d]=v[d];return p.FMTID=[i,o],p}function m2(e,t,r,a,n,i){var o=De(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,kt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var c=h2(e,r,a);if(l.push(c),n){var u=h2(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(u)}return $a(l)}function oo(e,t){return e.read_shift(t),null}function eN(e,t){t||(t=De(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function tN(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function xa(e,t){return e.read_shift(t)===1}function An(e,t){return t||(t=De(2)),t.write_shift(2,+!!e),t}function Ta(e){return e.read_shift(2,"u")}function hi(e,t){return t||(t=De(2)),t.write_shift(2,e),t}function ew(e,t){return tN(e,t,Ta)}function rN(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tw(e,t,r){return r||(r=De(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function iu(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",i=Jn;if(r&&r.biff>=8&&(Jn=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return Jn=i,l}function aN(e){var t=Jn;Jn=1200;var r=e.read_shift(2),a=e.read_shift(1),n=a&4,i=a&8,o=1+(a&1),l=0,c,u={};i&&(l=e.read_shift(2)),n&&(c=e.read_shift(4));var f=o==2?"dbcs-cont":"sbcs-cont",h=r===0?"":e.read_shift(r,f);return i&&(e.l+=4*l),n&&(e.l+=c),u.t=h,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Jn=t,u}function nN(e){var t=e.t||"",r=De(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=De(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return $a(n)}function cl(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function su(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):cl(e,a,r)}function _l(e,t,r){if(r.biff>5)return su(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rw(e,t,r){return r||(r=De(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function iN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sN(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(xn,"");return a&&(e.l+=24),n}function oN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(xn,"");return r+o}function lN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sN(e);case"0303000000000000c000000000000046":return oN(e);default:throw new Error("Unsupported Moniker "+r)}}function af(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(xn,""):"";return r}function x2(e,t){t||(t=De(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cN(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,o,l,c,u="",f,h;n&16&&(i=af(e,r-e.l)),n&128&&(o=af(e,r-e.l)),(n&257)===257&&(l=af(e,r-e.l)),(n&257)===1&&(c=lN(e,r-e.l)),n&8&&(u=af(e,r-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(h=Pm(e)),e.l=r;var p=o||l||c||"";p&&u&&(p+="#"+u),p||(p="#"+u),n&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var d={Target:p};return f&&(d.guid=f),h&&(d.time=h),i&&(d.Tooltip=i),d}function uN(e){var t=De(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),x2(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&x2(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function aw(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function nw(e,t){var r=aw(e);return r[3]=0,r}function cs(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function ul(e,t,r,a){return a||(a=De(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function fN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function dN(e,t,r){return t===0?"":_l(e,t,r)}function hN(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,i,o]}function iw(e){var t=e.read_shift(2),r=Dm(e);return[t,r]}function pN(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=iu(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function Id(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function sw(e,t){return t||(t=De(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ow(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var mN=ow;function lw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function xN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function gN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function sn(e){e.l+=2,e.l+=e.read_shift(2)}var vN={0:sn,4:sn,5:sn,6:sn,7:gN,8:sn,9:sn,10:sn,11:sn,12:sn,13:xN,14:sn,15:sn,16:sn,17:sn,18:sn,19:sn,20:sn,21:lw};function yN(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(vN[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function nf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Rm(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=De(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function bN(e,t){return t===0||e.read_shift(2),1200}function wN(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=_l(e,0,r);return e.read_shift(t+a-e.l),n}function _N(e,t){var r=!t||t.biff==8,a=De(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function kN(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function SN(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=iu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:i,name:o}}function AN(e,t){var r=!t||t.biff>=8?2:1,a=De(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function NN(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],o=0;o!=n&&e.l<r;++o)i.push(aN(e));return i.Count=a,i.Unique=n,i}function jN(e,t){var r=De(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=nN(e[n]);var i=$a([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function TN(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function EN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function CN(e){var t=fN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function FN(e){return e.read_shift(2),e.read_shift(4)}function g2(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function DN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function IN(){var e=De(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function LN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function PN(e){var t=De(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function RN(){}function ON(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=iu(e,0,r),a}function BN(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=De(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function MN(e){var t=cs(e);return t.isst=e.read_shift(4),t}function zN(e,t,r,a){var n=De(10);return ul(e,t,a,n),n.write_shift(4,r),n}function UN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=cs(e);r.biff==2&&e.l++;var i=su(e,a-e.l,r);return n.val=i,n}function WN(e,t,r,a,n){var i=!n||n.biff==8,o=De(8+ +i+(1+i)*r.length);return ul(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function qN(e,t,r){var a=e.read_shift(2),n=_l(e,0,r);return[a,n]}function HN(e,t,r,a){var n=r&&r.biff==5;a||(a=De(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var $N=_l;function v2(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function VN(e,t){var r=t.biff==8||!t.biff?4:2,a=De(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function GN(e){var t=e.read_shift(2),r=e.read_shift(2),a=iw(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function KN(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(iw(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:i}}function YN(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:i}}function XN(e,t,r,a){var n={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return n.patternType=CA[l>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function JN(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=XN(e,t,a.fStyle,r),a}function y2(e,t,r,a){var n=r&&r.biff==5;a||(a=De(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function ZN(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function QN(e){var t=De(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function b2(e,t,r){var a=cs(e);(r.biff==2||t==9)&&++e.l;var n=rN(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function e8(e,t,r,a,n,i){var o=De(8);return ul(e,t,a,o),tw(r,i,o),o}function t8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=cs(e),n=mn(e);return a.val=n,a}function r8(e,t,r,a){var n=De(14);return ul(e,t,a,n),ll(r,n),n}var w2=dN;function a8(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=cl(e,i),l=[];a>e.l;)l.push(su(e));return[i,n,o,l]}function _2(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=pN(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var n8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function k2(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=cl(e,o,r);n&32&&(u=n8[u.charCodeAt(0)]);var f=a-e.l;r&&r.biff==2&&--f;var h=a==e.l||l===0||!(f>0)?[]:yC(e,f,r,l);return{chKey:i,Name:u,itab:c,rgce:h}}function cw(e,t,r){if(r.biff<8)return i8(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(hN(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function i8(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=iu(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function s8(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=cl(e,a,r),o=cl(e,n,r);return[i,o]}function o8(e,t,r){var a=ow(e);e.l++;var n=e.read_shift(1);return t-=8,[bC(e,t,r),n,a]}function S2(e,t,r){var a=mN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,gC(e,t,r)]}function l8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function c8(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=_l(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},l,o,i]}}function u8(e,t,r){return c8(e,t,r)}function f8(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Id(e));return r}function d8(e){var t=De(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sw(e[r],t);return t}function h8(e,t,r){if(r&&r.biff<8)return m8(e,t,r);var a=lw(e),n=yN(e,t-22,a[1]);return{cmo:a,ft:n}}var p8={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function m8(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((p8[a]||vn)(e,t,r)),{cmo:[n,a,i],ft:o}}function x8(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=iN(e,6,r);var l=e.read_shift(2);e.read_shift(2),Ta(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],h=cl(e,e.lens[u+1]-e.lens[u]-1);if(n+=h,n.length>=(f?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function g8(e,t){var r=Id(e);e.l+=16;var a=cN(e,t-24);return[r,a]}function v8(e){var t=De(24),r=Qr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return $a([t,uN(e[1])])}function y8(e,t){e.read_shift(2);var r=Id(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(xn,""),[r,a]}function b8(e){var t=e[1].Tooltip,r=De(10+2*(t.length+1));r.write_shift(2,2048);var a=Qr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function w8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=l2[r]||r,r=e.read_shift(2),t[1]=l2[r]||r,t}function _8(e){return e||(e=De(4)),e.write_shift(2,1),e.write_shift(2,1),e}function k8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nw(e));return r}function S8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nw(e));return r}function A8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function uw(e,t,r){if(!r.cellStyles)return vn(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var u={s:n,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function N8(e,t){var r=De(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function j8(e,t){var r={};return t<32||(e.l+=16,r.header=mn(e),r.footer=mn(e),e.l+=2),r}function T8(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function E8(e){for(var t=De(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var C8=cs,F8=ew,D8=su;function I8(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function L8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=cs(e);++e.l;var n=_l(e,t-7,r);return a.t="str",a.val=n,a}function P8(e){var t=cs(e);++e.l;var r=mn(e);return t.t="n",t.val=r,t}function R8(e,t,r){var a=De(15);return uu(a,e,t),a.write_shift(8,r,"f"),a}function O8(e){var t=cs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function B8(e,t,r){var a=De(9);return uu(a,e,t),a.write_shift(2,r),a}function M8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function z8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function U8(e,t,r){var a=e.l+t,n=cs(e),i=e.read_shift(2),o=cl(e,i,r);return e.l=a,n.t="str",n.val=o,n}var W8=[2,3,48,49,131,139,140,245],e1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ed({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],f=vo(1);switch(c.type){case"base64":f=Kn(Qn(l));break;case"binary":f=Kn(l);break;case"buffer":case"array":f=l;break}en(f,0);var h=f.read_shift(1),p=!!(h&136),d=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,p=!0;break;case 49:d=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,y=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(y=f.read_shift(2));var _=f.read_shift(2),k=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var g=[],w={},C=Math.min(f.length,h==2?521:y-10-(d?264:0)),E=v?32:11;f.l<C&&f[f.l]!=13;)switch(w={},w.name=pr.utils.decode(k,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,w.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(w.offset=f.read_shift(4)),w.len=f.read_shift(1),h==2&&(w.offset=f.read_shift(2)),w.dec=f.read_shift(1),w.name.length&&g.push(w),h!=2&&(f.l+=v?13:14),w.type){case"B":(!d||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var A=0,I=0;for(u[0]=[],I=0;I!=g.length;++I)u[0][I]=g[I].name;for(;m-- >0;){if(f[f.l]===42){f.l+=_;continue}for(++f.l,u[++A]=[],I=0,I=0;I!=g.length;++I){var D=f.slice(f.l,f.l+g[I].len);f.l+=g[I].len,en(D,0);var B=pr.utils.decode(k,D);switch(g[I].type){case"C":B.trim().length&&(u[A][I]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[A][I]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[A][I]=B;break;case"F":u[A][I]=parseFloat(B.trim());break;case"+":case"I":u[A][I]=v?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[A][I]=!0;break;case"N":case"F":u[A][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[A][I]="##MEMO##"+(v?parseInt(B.trim(),10):D.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[A][I]=+B||0);break;case"@":u[A][I]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":u[A][I]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":u[A][I]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][I]=-D.read_shift(-8,"f");break;case"B":if(d&&g[I].len==8){u[A][I]=D.read_shift(8,"f");break}case"G":case"P":D.l+=g[I].len;break;case"0":if(g[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[I].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=g,u}function a(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=kc(r(l,u),u);return f["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,f}function n(l,c){try{return No(a(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&mi(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=In(),h=ed(l,{header:1,raw:!0,cellDates:!0}),p=h[0],d=h.slice(1),v=l["!cols"]||[],m=0,y=0,_=0,k=1;for(m=0;m<p.length;++m){if(((v[m]||{}).DBF||{}).name){p[m]=v[m].DBF.name,++_;continue}if(p[m]!=null){if(++_,typeof p[m]=="number"&&(p[m]=p[m].toString(10)),typeof p[m]!="string")throw new Error("DBF Invalid column name "+p[m]+" |"+typeof p[m]+"|");if(p.indexOf(p[m])!==m){for(y=0;y<1024;++y)if(p.indexOf(p[m]+"_"+y)==-1){p[m]+="_"+y;break}}}}var g=or(l["!ref"]),w=[],C=[],E=[];for(m=0;m<=g.e.c-g.s.c;++m){var A="",I="",D=0,B=[];for(y=0;y<d.length;++y)d[y][m]!=null&&B.push(d[y][m]);if(B.length==0||p[m]==null){w[m]="?";continue}for(y=0;y<B.length;++y){switch(typeof B[y]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=B[y]instanceof Date?"D":"C";break;default:I="C"}D=Math.max(D,String(B[y]).length),A=A&&A!=I?"C":I}D>250&&(D=250),I=((v[m]||{}).DBF||{}).type,I=="C"&&v[m].DBF.len>D&&(D=v[m].DBF.len),A=="B"&&I=="N"&&(A="N",E[m]=v[m].DBF.dec,D=v[m].DBF.len),C[m]=A=="C"||I=="N"?D:i[A]||0,k+=C[m],w[m]=A}var L=f.next(32);for(L.write_shift(4,318902576),L.write_shift(4,d.length),L.write_shift(2,296+32*_),L.write_shift(2,k),m=0;m<4;++m)L.write_shift(4,0);for(L.write_shift(4,0|(+t[il]||3)<<8),m=0,y=0;m<p.length;++m)if(p[m]!=null){var F=f.next(32),z=(p[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,z,"sbcs"),F.write_shift(1,w[m]=="?"?"C":w[m],"sbcs"),F.write_shift(4,y),F.write_shift(1,C[m]||i[w[m]]||0),F.write_shift(1,E[m]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),y+=C[m]||i[w[m]]||0}var M=f.next(264);for(M.write_shift(4,13),m=0;m<65;++m)M.write_shift(4,0);for(m=0;m<d.length;++m){var q=f.next(k);for(q.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(w[y]){case"L":q.write_shift(1,d[m][y]==null?63:d[m][y]?84:70);break;case"B":q.write_shift(8,d[m][y]||0,"f");break;case"N":var fe="0";for(typeof d[m][y]=="number"&&(fe=d[m][y].toFixed(E[y]||0)),_=0;_<C[y]-fe.length;++_)q.write_shift(1,32);q.write_shift(1,fe,"sbcs");break;case"D":d[m][y]?(q.write_shift(4,("0000"+d[m][y].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(d[m][y].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+d[m][y].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var he=String(d[m][y]!=null?d[m][y]:"").slice(0,C[y]);for(q.write_shift(1,he,"sbcs"),_=0;_<C[y]-he.length;++_)q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),fw=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+fa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,d){var v=e[d];return typeof v=="number"?Vp(v):v},a=function(p,d,v){var m=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?p:Vp(m)};e["|"]=254;function n(p,d){switch(d.type){case"base64":return i(Qn(p),d);case"binary":return i(p,d);case"buffer":return i(tr&&Buffer.isBuffer(p)?p.toString("binary"):Ao(p),d);case"array":return i(ol(p),d)}throw new Error("Unrecognized type "+d.type)}function i(p,d){var v=p.split(/[\n\r]+/),m=-1,y=-1,_=0,k=0,g=[],w=[],C=null,E={},A=[],I=[],D=[],B=0,L;for(+d.codepage>=0&&mi(+d.codepage);_!==v.length;++_){B=0;var F=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),z=F.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),M=z[0],q;if(F.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&w.push(F.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,he=!1,pe=!1,Q=!1,we=-1,Y=-1;for(k=1;k<z.length;++k)switch(z[k].charAt(0)){case"A":break;case"X":y=parseInt(z[k].slice(1))-1,he=!0;break;case"Y":for(m=parseInt(z[k].slice(1))-1,he||(y=0),L=g.length;L<=m;++L)g[L]=[];break;case"K":q=z[k].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(Pi(q))?isNaN(dc(q).getDate())||(q=Vr(q)):(q=Pi(q),C!==null&&xl(C)&&(q=Fd(q))),typeof pr<"u"&&typeof q=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(q=pr.utils.decode(d.codepage,q)),fe=!0;break;case"E":Q=!0;var T=ic(z[k].slice(1),{r:m,c:y});g[m][y]=[g[m][y],T];break;case"S":pe=!0,g[m][y]=[g[m][y],"S5S"];break;case"G":break;case"R":we=parseInt(z[k].slice(1))-1;break;case"C":Y=parseInt(z[k].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+F)}if(fe&&(g[m][y]&&g[m][y].length==2?g[m][y][0]=q:g[m][y]=q,C=null),pe){if(Q)throw new Error("SYLK shared formula cannot have own formula");var R=we>-1&&g[we][Y];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");g[m][y][1]=Ew(R[1],{r:m-we,c:y-Y})}break;case"F":var N=0;for(k=1;k<z.length;++k)switch(z[k].charAt(0)){case"X":y=parseInt(z[k].slice(1))-1,++N;break;case"Y":for(m=parseInt(z[k].slice(1))-1,L=g.length;L<=m;++L)g[L]=[];break;case"M":B=parseInt(z[k].slice(1))/20;break;case"F":break;case"G":break;case"P":C=w[parseInt(z[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=z[k].slice(1).split(" "),L=parseInt(D[0],10);L<=parseInt(D[1],10);++L)B=parseInt(D[2],10),I[L-1]=B===0?{hidden:!0}:{wch:B},yo(I[L-1]);break;case"C":y=parseInt(z[k].slice(1))-1,I[y]||(I[y]={});break;case"R":m=parseInt(z[k].slice(1))-1,A[m]||(A[m]={}),B>0?(A[m].hpt=B,A[m].hpx=pc(B)):B===0&&(A[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+F)}N<1&&(C=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+F)}}return A.length>0&&(E["!rows"]=A),I.length>0&&(E["!cols"]=I),d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),[g,E]}function o(p,d){var v=n(p,d),m=v[0],y=v[1],_=kc(m,d);return fa(y).forEach(function(k){_[k]=y[k]}),_}function l(p,d){return No(o(p,d),d)}function c(p,d,v,m){var y="C;Y"+(v+1)+";X"+(m+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+Wm(p.f,{r:v,c:m}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,d){d.forEach(function(v,m){var y="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=P0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=R0(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function f(p,d){d.forEach(function(v,m){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*O0(v.hpx)+";"),y.length>2&&p.push(y+"R"+(m+1))})}function h(p,d){var v=["ID;PWXL;N;E"],m=[],y=or(p["!ref"]),_,k=Array.isArray(p),g=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&u(v,p["!cols"]),p["!rows"]&&f(v,p["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var w=y.s.r;w<=y.e.r;++w)for(var C=y.s.c;C<=y.e.c;++C){var E=It({r:w,c:C});_=k?(p[w]||[])[C]:p[E],!(!_||_.v==null&&(!_.f||_.F))&&m.push(c(_,p,w,C))}return v.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),dw=function(){function e(i,o){switch(o.type){case"base64":return t(Qn(i),o);case"binary":return t(i,o);case"buffer":return t(tr&&Buffer.isBuffer(i)?i.toString("binary"):Ao(i),o);case"array":return t(ol(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,u=-1,f=0,h=[];f!==l.length;++f){if(l[f].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var p=l[f].trim().split(","),d=p[0],v=p[1];++f;for(var m=l[f]||"";(m.match(/["]/g)||[]).length&1&&f<l.length-1;)m+=`
`+l[++f];switch(m=m.trim(),+d){case-1:if(m==="BOT"){h[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[c][u]=!0:m==="FALSE"?h[c][u]=!1:isNaN(Pi(v))?isNaN(dc(v).getDate())?h[c][u]=v:h[c][u]=Vr(v):h[c][u]=Pi(v),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(i,o){return kc(e(i,o),o)}function a(i,o){return No(r(i,o),o)}var n=function(){var i=function(c,u,f,h,p){c.push(u),c.push(f+","+h),c.push('"'+p.replace(/"/g,'""')+'"')},o=function(c,u,f,h){c.push(u+","+f),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],f=or(c["!ref"]),h,p=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,f.e.r-f.s.r+1,""),i(u,"TUPLES",0,f.e.c-f.s.c+1,""),i(u,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){o(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var m=It({r:d,c:v});if(h=p?(c[d]||[])[v]:c[m],!h){o(u,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?o(u,1,0,"="+h.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ei(h.z||Ft[14],Ba(Vr(h.v)))),o(u,0,h.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var _=`\r
`,k=u.join(_);return k}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),hw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var d=h.split(`
`),v=-1,m=-1,y=0,_=[];y!==d.length;++y){var k=d[y].trim().split(":");if(k[0]==="cell"){var g=Qr(k[1]);if(_.length<=g.r)for(v=_.length;v<=g.r;++v)_[v]||(_[v]=[]);switch(v=g.r,m=g.c,k[2]){case"t":_[v][m]=e(k[3]);break;case"v":_[v][m]=+k[3];break;case"vtf":var w=k[k.length-1];case"vtc":switch(k[3]){case"nl":_[v][m]=!!+k[4];break;default:_[v][m]=+k[4];break}k[2]=="vtf"&&(_[v][m]=[_[v][m],w])}}}return p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),_}function a(h,p){return kc(r(h,p),p)}function n(h,p){return No(a(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],d=[],v,m="",y=Nn(h["!ref"]),_=Array.isArray(h),k=y.s.r;k<=y.e.r;++k)for(var g=y.s.c;g<=y.e.c;++g)if(m=It({r:k,c:g}),v=_?(h[k]||[])[g]:h[m],!(!v||v.v==null||v.t==="z")){switch(d=["cell",m,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var w=Ba(Vr(v.v));d[2]="vtc",d[3]="nd",d[4]=""+w,d[5]=v.w||ei(v.z||Ft[14],w);break;case"e":continue}p.push(d.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(h){return[i,o,l,o,u(h),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}}(),hc=function(){function e(f,h,p,d,v){v.raw?h[p][d]=f:f===""||(f==="TRUE"?h[p][d]=!0:f==="FALSE"?h[p][d]=!1:isNaN(Pi(f))?isNaN(dc(f).getDate())?h[p][d]=f:h[p][d]=Vr(f):h[p][d]=Pi(f))}function t(f,h){var p=h||{},d=[];if(!f||f.length===0)return d;for(var v=f.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var y=10,_=0,k=0;k<=m;++k)_=v[k].indexOf(" "),_==-1?_=v[k].length:_++,y=Math.max(y,_);for(k=0;k<=m;++k){d[k]=[];var g=0;for(e(v[k].slice(0,y).trim(),d,k,g,p),g=1;g<=(v[k].length-y)/10+1;++g)e(v[k].slice(y+(g-1)*10,y+g*10).trim(),d,k,g,p)}return p.sheetRows&&(d=d.slice(0,p.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var h={},p=!1,d=0,v=0;d<f.length;++d)(v=f.charCodeAt(d))==34?p=!p:!p&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&v.push([h[d],d]);if(!v.length){h=a;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&v.push([h[d],d])}return v.sort(function(m,y){return m[0]-y[0]||a[m[1]]-a[y[1]]}),r[v.pop()[1]]||44}function i(f,h){var p=h||{},d="",v=p.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=n(f.slice(0,1024)):p&&p.FS?d=p.FS:d=n(f.slice(0,1024));var y=0,_=0,k=0,g=0,w=0,C=d.charCodeAt(0),E=!1,A=0,I=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var D=p.dateNF!=null?j6(p.dateNF):null;function B(){var L=f.slice(g,w),F={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)F.t="z";else if(p.raw)F.t="s",F.v=L;else if(L.trim().length===0)F.t="s",F.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(F.t="s",F.v=L.slice(2,-1).replace(/""/g,'"')):aE(L)?(F.t="n",F.f=L.slice(1)):(F.t="s",F.v=L);else if(L=="TRUE")F.t="b",F.v=!0;else if(L=="FALSE")F.t="b",F.v=!1;else if(!isNaN(k=Pi(L)))F.t="n",p.cellText!==!1&&(F.w=L),F.v=k;else if(!isNaN(dc(L).getDate())||D&&L.match(D)){F.z=p.dateNF||Ft[14];var z=0;D&&L.match(D)&&(L=T6(L,p.dateNF,L.match(D)||[]),z=1),p.cellDates?(F.t="d",F.v=Vr(L,z)):(F.t="n",F.v=Ba(Vr(L,z))),p.cellText!==!1&&(F.w=ei(F.z,F.v instanceof Date?Ba(F.v):F.v)),p.cellNF||delete F.z}else F.t="s",F.v=L;if(F.t=="z"||(p.dense?(v[y]||(v[y]=[]),v[y][_]=F):v[It({c:_,r:y})]=F),g=w+1,I=f.charCodeAt(g),m.e.c<_&&(m.e.c=_),m.e.r<y&&(m.e.r=y),A==C)++_;else if(_=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;w<f.length;++w)switch(A=f.charCodeAt(w)){case 34:I===34&&(E=!E);break;case C:case 10:case 13:if(!E&&B())break e;break}return w-g>0&&B(),v["!ref"]=Yt(m),v}function o(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):kc(t(f,h),h)}function l(f,h){var p="",d=h.type=="string"?[0,0,0,0]:Jm(f,h);switch(h.type){case"base64":p=Qn(f);break;case"binary":p=f;break;case"buffer":h.codepage==65001?p=f.toString("utf8"):h.codepage&&typeof pr<"u"?p=pr.utils.decode(h.codepage,f):p=tr&&Buffer.isBuffer(f)?f.toString("binary"):Ao(f);break;case"array":p=ol(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?p=Fr(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Fr(p):h.type=="binary"&&typeof pr<"u"&&h.codepage&&(p=pr.utils.decode(h.codepage,pr.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?hw.to_sheet(h.type=="string"?p:Fr(p),h):o(p,h)}function c(f,h){return No(l(f,h),h)}function u(f){for(var h=[],p=or(f["!ref"]),d,v=Array.isArray(f),m=p.s.r;m<=p.e.r;++m){for(var y=[],_=p.s.c;_<=p.e.c;++_){var k=It({r:m,c:_});if(d=v?(f[m]||[])[_]:f[k],!d||d.v==null){y.push("          ");continue}for(var g=(d.w||(ss(d),d.w)||"").slice(0,10);g.length<10;)g+=" ";y.push(g+(_===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function q8(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=fw.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return hc.to_workbook(e,t)}}var Qo=function(){function e(T,R,N){if(T){en(T,T.l||0);for(var O=N.Enum||we;T.l<T.length;){var H=T.read_shift(2),ae=O[H]||O[65535],de=T.read_shift(2),me=T.l+de,xe=ae.f&&ae.f(T,de,N);if(T.l=me,R(xe,ae,H))return}}}function t(T,R){switch(R.type){case"base64":return r(Kn(Qn(T)),R);case"binary":return r(Kn(T),R);case"buffer":case"array":return r(T,R)}throw"Unsupported type "+R.type}function r(T,R){if(!T)return T;var N=R||{},O=N.dense?[]:{},H="Sheet1",ae="",de=0,me={},xe=[],Se=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Fe=N.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)N.Enum=we,e(T,function(Be,it,Me){switch(Me){case 0:N.vers=Be,Be>=4096&&(N.qpro=!0);break;case 6:Z=Be;break;case 204:Be&&(ae=Be);break;case 222:ae=Be;break;case 15:case 51:N.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:Me==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=N.dateNF||Ft[14],N.cellDates&&(Be[1].t="d",Be[1].v=Fd(Be[1].v))),N.qpro&&Be[3]>de&&(O["!ref"]=Yt(Z),me[H]=O,xe.push(H),O=N.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},de=Be[3],H=ae||"Sheet"+(de+1),ae="");var pt=N.dense?(O[Be[0].r]||[])[Be[0].c]:O[It(Be[0])];if(pt){pt.t=Be[1].t,pt.v=Be[1].v,Be[1].z!=null&&(pt.z=Be[1].z),Be[1].f!=null&&(pt.f=Be[1].f);break}N.dense?(O[Be[0].r]||(O[Be[0].r]=[]),O[Be[0].r][Be[0].c]=Be[1]):O[It(Be[0])]=Be[1];break}},N);else if(T[2]==26||T[2]==14)N.Enum=Y,T[2]==14&&(N.qpro=!0,T.l=0),e(T,function(Be,it,Me){switch(Me){case 204:H=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>de&&(O["!ref"]=Yt(Z),me[H]=O,xe.push(H),O=N.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},de=Be[3],H="Sheet"+(de+1)),Fe>0&&Be[0].r>=Fe)break;N.dense?(O[Be[0].r]||(O[Be[0].r]=[]),O[Be[0].r][Be[0].c]=Be[1]):O[It(Be[0])]=Be[1],Z.e.c<Be[0].c&&(Z.e.c=Be[0].c),Z.e.r<Be[0].r&&(Z.e.r=Be[0].r);break;case 27:Be[14e3]&&(Se[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Se[Be[0]]=Be[1],Be[0]==de&&(H=Be[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(O["!ref"]=Yt(Z),me[ae||H]=O,xe.push(ae||H),!Se.length)return{SheetNames:xe,Sheets:me};for(var $e={},J=[],Oe=0;Oe<Se.length;++Oe)me[xe[Oe]]?(J.push(Se[Oe]||xe[Oe]),$e[Se[Oe]]=me[Se[Oe]]||me[xe[Oe]]):(J.push(Se[Oe]),$e[Se[Oe]]={"!ref":"A1"});return{SheetNames:J,Sheets:$e}}function a(T,R){var N=R||{};if(+N.codepage>=0&&mi(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var O=In(),H=or(T["!ref"]),ae=Array.isArray(T),de=[];Ze(O,0,i(1030)),Ze(O,6,c(H));for(var me=Math.min(H.e.r,8191),xe=H.s.r;xe<=me;++xe)for(var Se=la(xe),Z=H.s.c;Z<=H.e.c;++Z){xe===H.s.r&&(de[Z]=$r(Z));var Fe=de[Z]+Se,$e=ae?(T[xe]||[])[Z]:T[Fe];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Ze(O,13,d(xe,Z,$e.v)):Ze(O,14,m(xe,Z,$e.v));else{var J=ss($e);Ze(O,15,h(xe,Z,J.slice(0,239)))}}return Ze(O,1),O.end()}function n(T,R){var N=R||{};if(+N.codepage>=0&&mi(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var O=In();Ze(O,0,o(T));for(var H=0,ae=0;H<T.SheetNames.length;++H)(T.Sheets[T.SheetNames[H]]||{})["!ref"]&&Ze(O,27,Q(T.SheetNames[H],ae++));var de=0;for(H=0;H<T.SheetNames.length;++H){var me=T.Sheets[T.SheetNames[H]];if(!(!me||!me["!ref"])){for(var xe=or(me["!ref"]),Se=Array.isArray(me),Z=[],Fe=Math.min(xe.e.r,8191),$e=xe.s.r;$e<=Fe;++$e)for(var J=la($e),Oe=xe.s.c;Oe<=xe.e.c;++Oe){$e===xe.s.r&&(Z[Oe]=$r(Oe));var Be=Z[Oe]+J,it=Se?(me[$e]||[])[Oe]:me[Be];if(!(!it||it.t=="z"))if(it.t=="n")Ze(O,23,B($e,Oe,de,it.v));else{var Me=ss(it);Ze(O,22,A($e,Oe,de,Me.slice(0,239)))}}++de}}return Ze(O,1),O.end()}function i(T){var R=De(2);return R.write_shift(2,T),R}function o(T){var R=De(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var N=0,O=0,H=0,ae=0;ae<T.SheetNames.length;++ae){var de=T.SheetNames[ae],me=T.Sheets[de];if(!(!me||!me["!ref"])){++H;var xe=Nn(me["!ref"]);N<xe.e.r&&(N=xe.e.r),O<xe.e.c&&(O=xe.e.c)}}return N>8191&&(N=8191),R.write_shift(2,N),R.write_shift(1,H),R.write_shift(1,O),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function l(T,R,N){var O={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&N.qpro?(O.s.c=T.read_shift(1),T.l++,O.s.r=T.read_shift(2),O.e.c=T.read_shift(1),T.l++,O.e.r=T.read_shift(2),O):(O.s.c=T.read_shift(2),O.s.r=T.read_shift(2),R==12&&N.qpro&&(T.l+=2),O.e.c=T.read_shift(2),O.e.r=T.read_shift(2),R==12&&N.qpro&&(T.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(T){var R=De(8);return R.write_shift(2,T.s.c),R.write_shift(2,T.s.r),R.write_shift(2,T.e.c),R.write_shift(2,T.e.r),R}function u(T,R,N){var O=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(O[0].c=T.read_shift(1),O[3]=T.read_shift(1),O[0].r=T.read_shift(2),T.l+=2):(O[2]=T.read_shift(1),O[0].c=T.read_shift(2),O[0].r=T.read_shift(2)),O}function f(T,R,N){var O=T.l+R,H=u(T,R,N);if(H[1].t="s",N.vers==20768){T.l++;var ae=T.read_shift(1);return H[1].v=T.read_shift(ae,"utf8"),H}return N.qpro&&T.l++,H[1].v=T.read_shift(O-T.l,"cstr"),H}function h(T,R,N){var O=De(7+N.length);O.write_shift(1,255),O.write_shift(2,R),O.write_shift(2,T),O.write_shift(1,39);for(var H=0;H<O.length;++H){var ae=N.charCodeAt(H);O.write_shift(1,ae>=128?95:ae)}return O.write_shift(1,0),O}function p(T,R,N){var O=u(T,R,N);return O[1].v=T.read_shift(2,"i"),O}function d(T,R,N){var O=De(7);return O.write_shift(1,255),O.write_shift(2,R),O.write_shift(2,T),O.write_shift(2,N,"i"),O}function v(T,R,N){var O=u(T,R,N);return O[1].v=T.read_shift(8,"f"),O}function m(T,R,N){var O=De(13);return O.write_shift(1,255),O.write_shift(2,R),O.write_shift(2,T),O.write_shift(8,N,"f"),O}function y(T,R,N){var O=T.l+R,H=u(T,R,N);if(H[1].v=T.read_shift(8,"f"),N.qpro)T.l=O;else{var ae=T.read_shift(2);w(T.slice(T.l,T.l+ae),H),T.l+=ae}return H}function _(T,R,N){var O=R&32768;return R&=-32769,R=(O?T:0)+(R>=8192?R-16384:R),(O?"":"$")+(N?$r(R):la(R))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(T,R){en(T,0);for(var N=[],O=0,H="",ae="",de="",me="";T.l<T.length;){var xe=T[T.l++];switch(xe){case 0:N.push(T.read_shift(8,"f"));break;case 1:ae=_(R[0].c,T.read_shift(2),!0),H=_(R[0].r,T.read_shift(2),!1),N.push(ae+H);break;case 2:{var Se=_(R[0].c,T.read_shift(2),!0),Z=_(R[0].r,T.read_shift(2),!1);ae=_(R[0].c,T.read_shift(2),!0),H=_(R[0].r,T.read_shift(2),!1),N.push(Se+Z+":"+ae+H)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(T.read_shift(2));break;case 6:{for(var Fe="";xe=T[T.l++];)Fe+=String.fromCharCode(xe);N.push('"'+Fe.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:me=N.pop(),de=N.pop(),N.push(["AND","OR"][xe-20]+"("+de+","+me+")");break;default:if(xe<32&&g[xe])me=N.pop(),de=N.pop(),N.push(de+g[xe]+me);else if(k[xe]){if(O=k[xe][1],O==69&&(O=T[T.l++]),O>N.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+N.join("|")+"|");return}var $e=N.slice(-O);N.length-=O,N.push(k[xe][0]+"("+$e.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}N.length==1?R[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function C(T){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=T.read_shift(2),R[3]=T[T.l++],R[0].c=T[T.l++],R}function E(T,R){var N=C(T);return N[1].t="s",N[1].v=T.read_shift(R-4,"cstr"),N}function A(T,R,N,O){var H=De(6+O.length);H.write_shift(2,T),H.write_shift(1,N),H.write_shift(1,R),H.write_shift(1,39);for(var ae=0;ae<O.length;++ae){var de=O.charCodeAt(ae);H.write_shift(1,de>=128?95:de)}return H.write_shift(1,0),H}function I(T,R){var N=C(T);N[1].v=T.read_shift(2);var O=N[1].v>>1;if(N[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return N[1].v=O,N}function D(T,R){var N=C(T),O=T.read_shift(4),H=T.read_shift(4),ae=T.read_shift(2);if(ae==65535)return O===0&&H===3221225472?(N[1].t="e",N[1].v=15):O===0&&H===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var de=ae&32768;return ae=(ae&32767)-16446,N[1].v=(1-de*2)*(H*Math.pow(2,ae+32)+O*Math.pow(2,ae)),N}function B(T,R,N,O){var H=De(14);if(H.write_shift(2,T),H.write_shift(1,N),H.write_shift(1,R),O==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var ae=0,de=0,me=0,xe=0;return O<0&&(ae=1,O=-O),de=Math.log2(O)|0,O/=Math.pow(2,de-31),xe=O>>>0,xe&2147483648||(O/=2,++de,xe=O>>>0),O-=xe,xe|=2147483648,xe>>>=0,O*=Math.pow(2,32),me=O>>>0,H.write_shift(4,me),H.write_shift(4,xe),de+=16383+(ae?32768:0),H.write_shift(2,de),H}function L(T,R){var N=D(T);return T.l+=R-14,N}function F(T,R){var N=C(T),O=T.read_shift(4);return N[1].v=O>>6,N}function z(T,R){var N=C(T),O=T.read_shift(8,"f");return N[1].v=O,N}function M(T,R){var N=z(T);return T.l+=R-10,N}function q(T,R){return T[T.l+R-1]==0?T.read_shift(R,"cstr"):""}function fe(T,R){var N=T[T.l++];N>R-1&&(N=R-1);for(var O="";O.length<N;)O+=String.fromCharCode(T[T.l++]);return O}function he(T,R,N){if(!(!N.qpro||R<21)){var O=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var H=T.read_shift(R-21,"cstr");return[O,H]}}function pe(T,R){for(var N={},O=T.l+R;T.l<O;){var H=T.read_shift(2);if(H==14e3){for(N[H]=[0,""],N[H][0]=T.read_shift(2);T[T.l];)N[H][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return N}function Q(T,R){var N=De(5+T.length);N.write_shift(2,14e3),N.write_shift(2,R);for(var O=0;O<T.length;++O){var H=T.charCodeAt(O);N[N.l++]=H>127?95:H}return N[N.l++]=0,N}var we={0:{n:"BOF",f:Ta},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function H8(e){var t={},r=e.match(yn),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=Pt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=fm[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var $8=function(){var e=C0("t"),t=C0("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:gr(o[1])},c=i.match(t);return c&&(l.s=H8(c[1])),l}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(l){return l.v})}}(),V8=function(){var t=/(\r\n|\n)/g;function r(n,i,o){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),G8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,K8=/<(?:\w+:)?r>/,Y8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Om(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=gr(Fr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Fr(e),r&&(a.h=ym(a.t))):e.match(K8)&&(a.r=Fr(e),a.t=gr(Fr((e.replace(Y8,"").match(G8)||[]).join("").replace(yn,""))),r&&(a.h=V8($8(a.r)))),a):{t:""}}var X8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,J8=/<(?:\w+:)?(?:si|sstItem)>/g,Z8=/<\/(?:\w+:)?(?:si|sstItem)>/;function Q8(e,t){var r=[],a="";if(!e)return r;var n=e.match(X8);if(n){a=n[2].replace(J8,"").split(Z8);for(var i=0;i!=a.length;++i){var o=Om(a[i].trim(),t);o!=null&&(r[r.length]=o)}n=Pt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var ej=/^\s|\s$|[\t\n\r]/;function pw(e,t){if(!t.bookSST)return"";var r=[ba];r[r.length]=Je("sst",null,{xmlns:gl[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(ej)&&(i+=' xml:space="preserve"'),i+=">"+Tr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function tj(e){return[e.read_shift(4),e.read_shift(4)]}function rj(e,t){var r=[],a=!1;return zs(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function aj(e,t){return t||(t=De(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var nj=pA;function ij(e){var t=In();ze(t,159,aj(e));for(var r=0;r<e.length;++r)ze(t,19,nj(e[r]));return ze(t,160),t.end()}function mw(e){if(typeof pr<"u")return pr.utils.encode(il,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Rs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function sj(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Rs(e,4),t.U=Rs(e,4),t.W=Rs(e,4),t}function oj(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function lj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(oj(e));return t}function cj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function uj(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Rs(e,4),t.U=Rs(e,4),t.W=Rs(e,4),t}function fj(e){var t=uj(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function xw(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function gw(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function dj(e){var t=Rs(e);switch(t.Minor){case 2:return[t.Minor,hj(e)];case 3:return[t.Minor,pj()];case 4:return[t.Minor,mj(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function hj(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=xw(e,r),n=gw(e,e.length-e.l);return{t:"Std",h:a,v:n}}function pj(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mj(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(yn,function(i){var o=Pt(i);switch(ls(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function xj(e,t){var r={},a=r.EncryptionVersionInfo=Rs(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=xw(e,n),t-=n,r.EncryptionVerifier=gw(e,t),r}function gj(e){var t={},r=t.EncryptionVersionInfo=Rs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Bm(e){var t=0,r,a=mw(e),n=a.length+1,i,o,l,c,u;for(r=vo(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var vw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var f=o[u],h=0;h!=7;++h)f&64&&(l^=r[c]),f*=2,--c;return l};return function(o){for(var l=mw(o),c=i(l),u=l.length,f=vo(16),h=0;h!=16;++h)f[h]=0;var p,d,v;for((u&1)===1&&(p=c>>8,f[u]=n(e[0],p),--u,p=c&255,d=l[l.length-1],f[u]=n(d,p));u>0;)--u,p=c>>8,f[u]=n(l[u],p),--u,p=c&255,f[u]=n(l[u],p);for(u=15,v=15-l.length;v>0;)p=c>>8,f[u]=n(e[v],p),--u,--v,p=c&255,f[u]=n(l[u],p),--u,--v;return f}}(),vj=function(e,t,r,a,n){n||(n=t),a||(a=vw(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,a]},yj=function(e){var t=0,r=vw(e);return function(a){var n=vj("",a,t,r);return t=n[1],n[0]}};function bj(e,t,r,a){var n={key:Ta(e),verificationBytes:Ta(e)};return r.password&&(n.verifier=Bm(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=yj(r.password)),n}function wj(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=gj(e):a.Data=xj(e,t),a}function _j(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?wj(e,t-2,a):bj(e,r.biff>=8?t:t-2,r,a),a}var yw=function(){function e(n,i){switch(i.type){case"base64":return t(Qn(n),i);case"binary":return t(n,i);case"buffer":return t(tr&&Buffer.isBuffer(n)?n.toString("binary"):Ao(n),i);case"array":return t(ol(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(l)&&(l[h]=[]);for(var p=/\\\w+\b/g,d=0,v,m=-1;v=p.exec(f);){switch(v[0]){case"\\cell":var y=f.slice(d,p.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var _={v:y,t:"s"};Array.isArray(l)?l[h][m]=_:l[It({r:h,c:m})]=_}break}d=p.lastIndex}m>u.e.c&&(u.e.c=m)}),l["!ref"]=Yt(u),l}function r(n,i){return No(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],o=or(n["!ref"]),l,c=Array.isArray(n),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var h=It({r:u,c:f});l=c?(n[u]||[])[f]:n[h],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(ss(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function kj(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function L0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Sj(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),o=n-i;if(o===0)return[0,0,t];var l=0,c=0,u=n+i;switch(c=o/(u>1?2-u:u),n){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Aj(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=n*l,o[0]+=n,o[1]+=c;break;case 1:c=n*(2-l),o[0]+=c,o[1]+=n;break;case 2:c=n*(l-2),o[1]+=n,o[2]+=c;break;case 3:c=n*(4-l),o[1]+=c,o[2]+=n;break;case 4:c=n*(l-4),o[2]+=n,o[0]+=c;break;case 5:c=n*(6-l),o[2]+=c,o[0]+=n;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function Zf(e,t){if(t===0)return e;var r=Sj(kj(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),L0(Aj(r))}var bw=6,Nj=15,jj=1,pn=bw;function P0(e){return Math.floor((e+Math.round(128/pn)/256)*pn)}function R0(e){return Math.floor((e-5)/pn*100+.5)/100}function Qf(e){return Math.round((e*pn+5)/pn*256)/256}function Gh(e){return Qf(R0(P0(e)))}function Mm(e){var t=Math.abs(e-Gh(e)),r=pn;if(t>.005)for(pn=jj;pn<Nj;++pn)Math.abs(e-Gh(e))<=t&&(t=Math.abs(e-Gh(e)),r=pn);pn=r}function yo(e){e.width?(e.wpx=P0(e.width),e.wch=R0(e.wpx),e.MDW=pn):e.wpx?(e.wch=R0(e.wpx),e.width=Qf(e.wch),e.MDW=pn):typeof e.wch=="number"&&(e.width=Qf(e.wch),e.wpx=P0(e.width),e.MDW=pn),e.customWidth&&delete e.customWidth}var Tj=96,ww=Tj;function O0(e){return e*96/ww}function pc(e){return e*ww/96}var Ej={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Cj(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(yn)||[]).forEach(function(o){var l=Pt(o);switch(ls(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=qr(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=qr(l.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function Fj(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(yn)||[]).forEach(function(o){var l=Pt(o);switch(ls(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function Dj(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(yn)||[]).forEach(function(o){var l=Pt(o);switch(ls(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=Fr(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?qr(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?qr(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?qr(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?qr(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?qr(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?qr(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?qr(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=fm[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=qr(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Jo[n.color.index];n.color.index==81&&(c=Jo[1]),c||(c=Jo[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Zf(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Ij(e,t,r){t.NumberFmt=[];for(var a=fa(Ft),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Ft[a[n]];var i=e[0].match(yn);if(i)for(n=0;n<i.length;++n){var o=Pt(i[n]);switch(ls(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=gr(Fr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}is(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Lj(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Je("numFmt",null,{numFmtId:a,formatCode:Tr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Je("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var sf=["numFmtId","fillId","fontId","borderId","xfId"],of=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Pj(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(yn)||[]).forEach(function(i){var o=Pt(i),l=0;switch(ls(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<sf.length;++l)a[sf[l]]&&(a[sf[l]]=parseInt(a[sf[l]],10));for(l=0;l<of.length;++l)a[of[l]]&&(a[of[l]]=qr(a[of[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=qr(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Rj(e){var t=[];return t[t.length]=Je("cellXfs",null),e.forEach(function(r){t[t.length]=Je("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Je("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Oj=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var f={};if(!l)return f;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=l.match(t))&&Ij(h,f,u),(h=l.match(n))&&Dj(h,f,c,u),(h=l.match(a))&&Fj(h,f,c,u),(h=l.match(i))&&Cj(h,f,c,u),(h=l.match(r))&&Pj(h,f,u),f}}();function _w(e,t){var r=[ba,Je("styleSheet",null,{xmlns:gl[0],"xmlns:vt":Oa.vt})],a;return e.SSF&&(a=Lj(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Rj(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Bj(e,t){var r=e.read_shift(2),a=gn(e);return[r,a]}function Mj(e,t,r){r||(r=De(6+4*t.length)),r.write_shift(2,e),Va(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function zj(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=wA(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=bA(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=gn(e),a}function Uj(e,t){t||(t=De(25+4*32)),t.write_shift(2,e.sz*20),_A(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Yf(e.color,t);var a=0;return a=2,t.write_shift(1,a),Va(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Wj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Kh,qj=vn;function A2(e,t){t||(t=De(4*3+8*7+16*1)),Kh||(Kh=Ed(Wj));var r=Kh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Yf({auto:1},t),Yf({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Hj(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function kw(e,t,r){r||(r=De(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Jc(e,t){return t||(t=De(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var $j=vn;function Vj(e,t){return t||(t=De(51)),t.write_shift(1,0),Jc(null,t),Jc(null,t),Jc(null,t),Jc(null,t),Jc(null,t),t.length>t.l?t.slice(0,t.l):t}function Gj(e,t){return t||(t=De(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Kf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Kj(e,t,r){var a=De(2052);return a.write_shift(4,e),Kf(t,a),Kf(r,a),a.length>a.l?a.slice(0,a.l):a}function Yj(e,t,r){var a={};a.NumberFmt=[];for(var n in Ft)a.NumberFmt[n]=Ft[n];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return zs(e,function(c,u,f){switch(f){case 44:a.NumberFmt[c[0]]=c[1],is(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Zf(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(f),o=!0;break;case 38:i.pop(),o=!1;break;default:if(u.T>0)i.push(f);else if(u.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function Xj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(ze(e,615,Ri(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&ze(e,44,Mj(n,t[n]))}),ze(e,616))}}function Jj(e){var t=1;ze(e,611,Ri(t)),ze(e,43,Uj({sz:12,color:{theme:1},name:"Calibri",family:2})),ze(e,612)}function Zj(e){var t=2;ze(e,603,Ri(t)),ze(e,45,A2({patternType:"none"})),ze(e,45,A2({patternType:"gray125"})),ze(e,604)}function Qj(e){var t=1;ze(e,613,Ri(t)),ze(e,46,Vj()),ze(e,614)}function eT(e){var t=1;ze(e,626,Ri(t)),ze(e,47,kw({numFmtId:0},65535)),ze(e,627)}function tT(e,t){ze(e,617,Ri(t.length)),t.forEach(function(r){ze(e,47,kw(r,0))}),ze(e,618)}function rT(e){var t=1;ze(e,619,Ri(t)),ze(e,48,Gj({xfId:0,name:"Normal"})),ze(e,620)}function aT(e){var t=0;ze(e,505,Ri(t)),ze(e,506)}function nT(e){var t=0;ze(e,508,Kj(t,"TableStyleMedium9","PivotStyleMedium4")),ze(e,509)}function iT(e,t){var r=In();return ze(r,278),Xj(r,e.SSF),Jj(r),Zj(r),Qj(r),eT(r),tT(r,t.cellXfs),rT(r),aT(r),nT(r),ze(r,279),r.end()}var sT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oT(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(yn)||[]).forEach(function(n){var i=Pt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[sT.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function lT(){}function cT(){}var uT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hT(e,t,r){t.themeElements={};var a;[["clrScheme",uT,oT],["fontScheme",fT,lT],["fmtScheme",dT,cT]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var pT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sw(e,t){(!e||e.length===0)&&(e=zm());var r,a={};if(!(r=e.match(pT)))throw new Error("themeElements not found in theme");return hT(r[0],a,t),a.raw=e,a}function zm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ba];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function mT(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=bb(i,{type:"array"})}catch{return}var l=Yn(o,"theme/theme/theme1.xml",!0);if(l)return Sw(l,r)}}function xT(e){return e.read_shift(4)}function gT(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=vT(e,4);break;case 2:t.xclrValue=aw(e);break;case 3:t.xclrValue=xT(e);break;case 4:e.l+=4;break}return e.l+=8,t}function vT(e,t){return vn(e,t)}function yT(e,t){return vn(e,t)}function bT(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=gT(e);break;case 6:a[1]=yT(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function wT(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(bT(e,r-e.l));return{ixfe:a,ext:i}}function _T(e,t){t.forEach(function(r){switch(r[0]){}})}function kT(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:gn(e)}}function ST(e){var t=De(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Va(e.name,t),t.slice(0,t.l)}function AT(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function NT(e){var t=De(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function jT(e,t){var r=De(8+2*t.length);return r.write_shift(4,e),Va(t,r),r.slice(0,r.l)}function TT(e){return e.l+=4,e.read_shift(4)!=0}function ET(e,t){var r=De(8);return r.write_shift(4,e),r.write_shift(4,1),r}function CT(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,l=2;return zs(e,function(c,u,f){switch(f){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(h){l==1?a.Cell.push({type:a.Types[h[0]-1].name,index:h[1]}):l==0&&a.Value.push({type:a.Types[h[0]-1].name,index:h[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(f),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!u.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function FT(){var e=In();return ze(e,332),ze(e,334,Ri(1)),ze(e,335,ST({name:"XLDAPR",version:12e4,flags:3496657072})),ze(e,336),ze(e,339,jT(1,"XLDAPR")),ze(e,52),ze(e,35,Ri(514)),ze(e,4096,Ri(0)),ze(e,4097,hi(1)),ze(e,36),ze(e,53),ze(e,340),ze(e,337,ET(1)),ze(e,51,NT([[1,0]])),ze(e,338),ze(e,333),e.end()}function DT(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,o;return e.replace(yn,function(l){var c=Pt(l);switch(ls(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==c.name&&(o=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function Aw(){var e=[ba];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function IT(e){var t=[];if(!e)return t;var r=1;return(e.match(yn)||[]).forEach(function(a){var n=Pt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function LT(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=It(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function PT(e,t,r){var a=[];return zs(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function RT(e,t,r,a){if(!e)return e;var n=a||{},i=!1;zs(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function OT(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Zl=1024;function Nw(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Je("xml",null,{"xmlns:v":Gn.v,"xmlns:o":Gn.o,"xmlns:x":Gn.x,"xmlns:mv":Gn.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Zl<e*1e3;)Zl+=1e3;return t.forEach(function(i){var o=Qr(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Je("v:fill",c,l),f={on:"t",obscured:"t"};++Zl,n=n.concat(["<v:shape"+F0({id:"_x0000_s"+Zl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Je("v:shadow",null,f),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",tn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),tn("x:AutoFill","False"),tn("x:Row",String(o.r)),tn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function N2(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(o){var l=Qr(o.ref);if(n?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},n?e[l.r][l.c]=i:e[o.ref]=i;var c=or(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Yt(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var f={a:o.author,t:o.t,r:o.r,T:r};o.h&&(f.h=o.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&a){for(h=0;h<a.length;++h)if(f.a==a[h].id){f.a=a[h].name||f.a;break}}i.c.push(f)})}function BT(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Pt(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Qr(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&Om(h[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),a.push(u)}}}}),a}function jw(e){var t=[ba,Je("comments",null,{xmlns:gl[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Tr(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(n=r.indexOf(Tr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(tn("t",Tr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(tn("t",Tr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function MT(e,t){var r=[],a=!1,n={},i=0;return e.replace(yn,function(l,c){var u=Pt(l);switch(ls(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function zT(e,t,r){var a=[ba,Je("ThreadedComments",null,{xmlns:Oa.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Je("threadedComment",tn("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function UT(e,t){var r=[],a=!1;return e.replace(yn,function(i){var o=Pt(i);switch(ls(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function WT(e){var t=[ba,Je("personList",null,{xmlns:Oa.TCMNT,"xmlns:x":gl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function qT(e){var t={};t.iauthor=e.read_shift(4);var r=wl(e);return t.rfx=r.s,t.ref=It(r.s),e.l+=16,t}function HT(e,t){return t==null&&(t=De(36)),t.write_shift(4,e[1].iauthor),Sc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var $T=gn;function VT(e){return Va(e.slice(0,54))}function GT(e,t){var r=[],a=[],n={},i=!1;return zs(e,function(l,c,u){switch(u){case 632:a.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function KT(e){var t=In(),r=[];return ze(t,628),ze(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),ze(t,632,VT(n.a)))})}),ze(t,631),ze(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:Qr(a[0]),e:Qr(a[0])};ze(t,635,HT([i,n])),n.t&&n.t.length>0&&ze(t,637,xA(n)),ze(t,636),delete n.iauthor})}),ze(t,634),ze(t,629),t.end()}var YT="application/vnd.ms-office.vbaProject";function XT(e){var t=kt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");kt.utils.cfb_add(t,n,e.FileIndex[a].content)}}),kt.write(t)}function JT(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&kt.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var Tw=["xlsb","xlsm","xlam","biff8","xla"];function ZT(){return{"!type":"dialog"}}function QT(){return{"!type":"dialog"}}function eE(){return{"!type":"macro"}}function tE(){return{"!type":"macro"}}var ic=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return l?f+=t.c:--f,c?u+=t.r:--u,n+(l?"":"$")+$r(f)+(c?"":"$")+la(u)}return function(n,i){return t=i,n.replace(e,r)}}(),Um=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Wm=function(){return function(t,r){return t.replace(Um,function(a,n,i,o,l,c){var u=Tm(o)-(i?0:r.c),f=jm(c)-(l?0:r.r),h=f==0?"":l?f+1:"["+f+"]",p=u==0?"":i?u+1:"["+u+"]";return n+"R"+h+"C"+p})}}();function Ew(e,t){return e.replace(Um,function(r,a,n,i,o,l){return a+(n=="$"?n+i:$r(Tm(i)+t.c))+(o=="$"?o+l:la(jm(l)+t.r))})}function rE(e,t,r){var a=Nn(t),n=a.s,i=Qr(r),o={r:i.r-n.r,c:i.c-n.c};return Ew(e,o)}function aE(e){return e.length!=1}function j2(e){return e.replace(/_xlfn\./g,"")}function Na(e){e.l+=1}function bo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Cw(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Fw(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),o=bo(e),l=bo(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Fw(e){var t=bo(e),r=bo(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function nE(e,t,r){if(r.biff<8)return Fw(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=bo(e),o=bo(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function Dw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return iE(e);var a=e.read_shift(r&&r.biff==12?4:2),n=bo(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function iE(e){var t=bo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function sE(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oE(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return lE(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function lE(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function cE(e,t,r){var a=(e[e.l++]&96)>>5,n=Cw(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function uE(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Cw(e,i,r);return[a,n,o]}function fE(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function dE(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function hE(e,t,r){var a=(e[e.l++]&96)>>5,n=nE(e,t-1,r);return[a,n]}function pE(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function T2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function mE(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function xE(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function gE(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function vE(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function yE(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Iw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function bE(e){return e.read_shift(2),Iw(e)}function wE(e){return e.read_shift(2),Iw(e)}function _E(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Dw(e,0,r);return[a,n]}function kE(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=oE(e,0,r);return[a,n]}function SE(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Dw(e,0,r);return[a,n,i]}function AE(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[TC[n],Rw[n],a]}function NE(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:jE(e);return[n,(i[0]===0?Rw:jC)[i[1]]]}function jE(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function TE(e,t,r){e.l+=r&&r.biff==2?3:4}function EE(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function CE(e){return e.l++,Us[e.read_shift(1)]}function FE(e){return e.l++,e.read_shift(2)}function DE(e){return e.l++,e.read_shift(1)!==0}function IE(e){return e.l++,mn(e)}function LE(e,t,r){return e.l++,iu(e,t-1,r)}function PE(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xa(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Us[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=mn(e);break;case 2:r[1]=_l(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function RE(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?wl:Id)(e));return n}function OE(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=PE(e,r.biff);return o}function BE(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function ME(e,t,r){if(r.biff==5)return zE(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function zE(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function UE(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function WE(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function qE(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function HE(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var $E=vn,VE=vn,GE=vn;function ou(e,t,r){return e.l+=2,[sE(e)]}function qm(e){return e.l+=6,[]}var KE=ou,YE=qm,XE=qm,JE=ou;function Lw(e){return e.l+=2,[Ta(e),e.read_shift(2)&1]}var ZE=ou,QE=Lw,eC=qm,tC=ou,rC=ou,aC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function nC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=aC[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:i}}function iC(e){return e.l+=2,[e.read_shift(4)]}function sC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function oC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function lC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uC(e){return e.l+=4,[0,0]}var E2={1:{n:"PtgExp",f:EE},2:{n:"PtgTbl",f:GE},3:{n:"PtgAdd",f:Na},4:{n:"PtgSub",f:Na},5:{n:"PtgMul",f:Na},6:{n:"PtgDiv",f:Na},7:{n:"PtgPower",f:Na},8:{n:"PtgConcat",f:Na},9:{n:"PtgLt",f:Na},10:{n:"PtgLe",f:Na},11:{n:"PtgEq",f:Na},12:{n:"PtgGe",f:Na},13:{n:"PtgGt",f:Na},14:{n:"PtgNe",f:Na},15:{n:"PtgIsect",f:Na},16:{n:"PtgUnion",f:Na},17:{n:"PtgRange",f:Na},18:{n:"PtgUplus",f:Na},19:{n:"PtgUminus",f:Na},20:{n:"PtgPercent",f:Na},21:{n:"PtgParen",f:Na},22:{n:"PtgMissArg",f:Na},23:{n:"PtgStr",f:LE},26:{n:"PtgSheet",f:sC},27:{n:"PtgEndSheet",f:oC},28:{n:"PtgErr",f:CE},29:{n:"PtgBool",f:DE},30:{n:"PtgInt",f:FE},31:{n:"PtgNum",f:IE},32:{n:"PtgArray",f:pE},33:{n:"PtgFunc",f:AE},34:{n:"PtgFuncVar",f:NE},35:{n:"PtgName",f:BE},36:{n:"PtgRef",f:_E},37:{n:"PtgArea",f:cE},38:{n:"PtgMemArea",f:UE},39:{n:"PtgMemErr",f:$E},40:{n:"PtgMemNoMem",f:VE},41:{n:"PtgMemFunc",f:WE},42:{n:"PtgRefErr",f:qE},43:{n:"PtgAreaErr",f:fE},44:{n:"PtgRefN",f:kE},45:{n:"PtgAreaN",f:hE},46:{n:"PtgMemAreaN",f:lC},47:{n:"PtgMemNoMemN",f:cC},57:{n:"PtgNameX",f:ME},58:{n:"PtgRef3d",f:SE},59:{n:"PtgArea3d",f:uE},60:{n:"PtgRefErr3d",f:HE},61:{n:"PtgAreaErr3d",f:dE},255:{}},fC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dC={1:{n:"PtgElfLel",f:Lw},2:{n:"PtgElfRw",f:tC},3:{n:"PtgElfCol",f:KE},6:{n:"PtgElfRwV",f:rC},7:{n:"PtgElfColV",f:JE},10:{n:"PtgElfRadical",f:ZE},11:{n:"PtgElfRadicalS",f:eC},13:{n:"PtgElfColS",f:YE},15:{n:"PtgElfColSV",f:XE},16:{n:"PtgElfRadicalLel",f:QE},25:{n:"PtgList",f:nC},29:{n:"PtgSxName",f:iC},255:{}},hC={0:{n:"PtgAttrNoop",f:uC},1:{n:"PtgAttrSemi",f:yE},2:{n:"PtgAttrIf",f:gE},4:{n:"PtgAttrChoose",f:mE},8:{n:"PtgAttrGoto",f:xE},16:{n:"PtgAttrSum",f:TE},32:{n:"PtgAttrBaxcel",f:T2},33:{n:"PtgAttrBaxcel",f:T2},64:{n:"PtgAttrSpace",f:bE},65:{n:"PtgAttrSpaceSemi",f:wE},128:{n:"PtgAttrIfError",f:vE},255:{}};function lu(e,t,r,a){if(a.biff<8)return vn(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=OE(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=RE(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(vn(e,t)),i}function cu(e,t,r){for(var a=e.l+t,n,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],n=E2[i]||E2[fC[i]],(i===24||i===25)&&(n=(i===24?dC:hC)[e[e.l+1]]),!n||!n.f?vn(e,t):o.push([n.n,n.f(e,t,r)]);return o}function pC(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var mC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Pw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function C2(e,t,r){var a=Pw(e,t,r);return a=="#REF"?a:xC(a,r)}function hn(e,t,r,a,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,u,f,h=0,p=0,d,v="";if(!e[0]||!e[0][0])return"";for(var m=-1,y="",_=0,k=e[0].length;_<k;++_){var g=e[0][_];switch(g[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),m>=0){switch(e[0][m][1][0]){case 0:y=sa(" ",e[0][m][1][1]);break;case 1:y=sa("\r",e[0][m][1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+y,m=-1}l.push(u+mC[g[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=p0(g[1][1],o,n),l.push(m0(f,i));break;case"PtgRefN":f=r?p0(g[1][1],r,n):g[1][1],l.push(m0(f,i));break;case"PtgRef3d":h=g[1][1],f=p0(g[1][2],o,n),v=C2(a,h,n),l.push(v+"!"+m0(f,i));break;case"PtgFunc":case"PtgFuncVar":var w=g[1][0],C=g[1][1];w||(w=0),w&=127;var E=w==0?[]:l.slice(-w);l.length-=w,C==="User"&&(C=E.shift()),l.push(C+"("+E.join(",")+")");break;case"PtgBool":l.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(g[1]);break;case"PtgNum":l.push(String(g[1]));break;case"PtgStr":l.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(g[1]);break;case"PtgAreaN":d=i2(g[1][1],r?{s:r}:o,n),l.push(Hh(d,n));break;case"PtgArea":d=i2(g[1][1],o,n),l.push(Hh(d,n));break;case"PtgArea3d":h=g[1][1],d=g[1][2],v=C2(a,h,n),l.push(v+"!"+Hh(d,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=g[1][2];var A=(a.names||[])[p-1]||(a[0]||[])[p],I=A?A.Name:"SH33TJSNAME"+String(p);I&&I.slice(0,6)=="_xlfn."&&!n.xlfn&&(I=I.slice(6)),l.push(I);break;case"PtgNameX":var D=g[1][1];p=g[1][2];var B;if(n.biff<=5)D<0&&(D=-D),a[D]&&(B=a[D][p]);else{var L="";if(((a[D]||[])[0]||[])[0]==14849||(((a[D]||[])[0]||[])[0]==1025?a[D][p]&&a[D][p].itab>0&&(L=a.SheetNames[a[D][p].itab-1]+"!"):L=a.SheetNames[p-1]+"!"),a[D]&&a[D][p])L+=a[D][p].Name;else if(a[0]&&a[0][p])L+=a[0][p].Name;else{var F=(Pw(a,D,n)||"").split(";;");F[p-1]?L=F[p-1]:L+="SH33TJSERRX"}l.push(L);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var z="(",M=")";if(m>=0){switch(y="",e[0][m][1][0]){case 2:z=sa(" ",e[0][m][1][1])+z;break;case 3:z=sa("\r",e[0][m][1][1])+z;break;case 4:M=sa(" ",e[0][m][1][1])+M;break;case 5:M=sa("\r",e[0][m][1][1])+M;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}l.push(z+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var q={c:r.c,r:r.r};if(a.sharedf[It(f)]){var fe=a.sharedf[It(f)];l.push(hn(fe,o,q,a,n))}else{var he=!1;for(c=0;c!=a.arrayf.length;++c)if(u=a.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){l.push(hn(u[1],o,q,a,n)),he=!0;break}he||l.push(g[1])}break;case"PtgArray":l.push("{"+pC(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&m>=0&&pe.indexOf(e[0][_][0])==-1){g=e[0][m];var Q=!0;switch(g[1][0]){case 4:Q=!1;case 0:y=sa(" ",g[1][1]);break;case 5:Q=!1;case 1:y=sa("\r",g[1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}l.push((Q?y:"")+l.pop()+(Q?"":y)),m=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function gC(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],vn(e,t-2)];var l=cu(e,o,r);return t!==o+n&&(i=lu(e,t-o-n,l,r)),e.l=a,[l,i]}function vC(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],vn(e,t-2)];var l=cu(e,o,r);return t!==o+n&&(i=lu(e,t-o-n,l,r)),e.l=a,[l,i]}function yC(e,t,r,a){var n=e.l+t,i=cu(e,a,r),o;return n!==e.l&&(o=lu(e,n-e.l,i,r)),[i,o]}function bC(e,t,r){var a=e.l+t,n,i=e.read_shift(2),o=cu(e,i,r);return i==65535?[[],vn(e,t-2)]:(t!==i+2&&(n=lu(e,a-i-2,o,r)),[o,n])}function wC(e){var t;if(Ds(e,e.l+6)!==65535)return[mn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function _C(e){if(e==null){var t=De(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ll(e);return ll(0)}function Yh(e,t,r){var a=e.l+t,n=cs(e);r.biff==2&&++e.l;var i=wC(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=vC(e,a-e.l,r);return{cell:n,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function kC(e,t,r,a,n){var i=ul(t,r,n),o=_C(e.v),l=De(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=De(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var h=$a([i,o,l,u]);return h}function Ld(e,t,r){var a=e.read_shift(4),n=cu(e,a,r),i=e.read_shift(4),o=i>0?lu(e,i,n,r):null;return[n,o]}var SC=Ld,Pd=Ld,AC=Ld,NC=Ld,jC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Rw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function F2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function EC(e){var t="of:="+e.replace(Um,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Xh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function CC(e){return e.replace(/\./,"!")}var g0={},sc={},v0=typeof Map<"u";function Hm(e,t,r){var a=0,n=e.length;if(r){if(v0?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=v0?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(v0?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Rd(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(pn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=R0(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Qf(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function el(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function jo(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){is(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Ow(e,t,r,a,n,i){try{a.cellNF&&(e.z=Ft[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Vr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ft[t]==null&&is(N6[t]||"General",t),e.t==="e")e.w=e.w||Us[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=E0(e.v);else if(e.t==="d"){var o=Ba(e.v);(o|0)===o?e.w=o.toString(10):e.w=E0(o)}else{if(e.v===void 0)return"";e.w=sl(e.v,sc)}else e.t==="d"?e.w=ei(t,Ba(e.v),sc):e.w=ei(t,e.v,sc)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zf(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zf(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function FC(e,t,r){if(e&&e["!ref"]){var a=or(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function DC(e,t){var r=or(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Yt(r))}var IC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,LC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,PC=/<(?:\w:)?hyperlink [^>]*>/mg,RC=/"(\w*:\w*)"/,OC=/<(?:\w:)?col\b[^>]*[\/]?>/g,BC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MC=/<(?:\w:)?pageMargins[^>]*\/>/g,Bw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,zC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,UC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function WC(e,t,r,a,n,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",h=e.match(LC);h?(u=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):u=f=e;var p=u.match(Bw);p?$m(p[0],l,n,r):(p=u.match(zC))&&HC(p[0],p[1]||"",l,n,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=u.slice(d,d+50).match(RC);v&&DC(l,v[1])}var m=u.match(UC);m&&m[1]&&aF(m[1],n);var y=[];if(t.cellStyles){var _=u.match(OC);_&&ZC(y,_)}h&&sF(h[1],l,t,c,i,o);var k=f.match(BC);k&&(l["!autofilter"]=eF(k[0]));var g=[],w=f.match(IC);if(w)for(d=0;d!=w.length;++d)g[d]=or(w[d].slice(w[d].indexOf('"')+1));var C=f.match(PC);C&&YC(l,C,a);var E=f.match(MC);if(E&&(l["!margins"]=XC(Pt(E[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Yt(c)),t.sheetRows>0&&l["!ref"]){var A=or(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Yt(A))}return y.length>0&&(l["!cols"]=y),g.length>0&&(l["!merges"]=g),l}function qC(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Yt(e[r])+'"/>';return t+"</mergeCells>"}function $m(e,t,r,a){var n=Pt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=gr(Fr(n.codeName)))}function HC(e,t,r,a,n){$m(e.slice(0,e.indexOf(">")),r,a,n)}function $C(e,t,r,a,n){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=as(Tr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Je("outlinePr",null,u)}!i&&!l||(n[n.length]=Je("sheetPr",l,o))}var VC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],GC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function KC(e){var t={sheet:1};return VC.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),GC.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Bm(e.password).toString(16).toUpperCase()),Je("sheetProtection",null,t)}function YC(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=Pt(Fr(t[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+gr(i.location))):(i.Target="#"+gr(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=or(i.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var f=It({c:u,r:c});a?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function XC(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function JC(e){return el(e),Je("pageMargins",null,e)}function ZC(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=Pt(t[a],!0);n.hidden&&(n.hidden=qr(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Mm(n.width)),yo(n);i<=o;)e[i++]=Pr(n)}}function QC(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Je("col",null,Rd(n,a)));return r[r.length]="</cols>",r.join("")}function eF(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function tF(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Yt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Nn(n);o.s.r==o.e.r&&(o.e.r=Nn(t["!ref"]).e.r,n=Yt(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Je("autoFilter",null,{ref:n})}var rF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function aF(e,t){t.Views||(t.Views=[{}]),(e.match(rF)||[]).forEach(function(r,a){var n=Pt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),qr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function nF(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,n),{})}function iF(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Us[e.v];break;case"d":a&&a.cellDates?n=Vr(e.v,-1).toISOString():(e=Pr(e),e.t="n",n=""+(e.v=Ba(Vr(e.v)))),typeof e.z>"u"&&(e.z=Ft[14]);break;default:n=e.v;break}var l=tn("v",Tr(n)),c={r:t},u=jo(a.cellXfs,e,a);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=tn("v",""+Hm(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Je("f",Tr(e.f),f)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Je("c",l,c)}var sF=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=C0("v"),o=C0("f");return function(c,u,f,h,p,d){for(var v=0,m="",y=[],_=[],k=0,g=0,w=0,C="",E,A,I=0,D=0,B,L,F=0,z=0,M=Array.isArray(d.CellXf),q,fe=[],he=[],pe=Array.isArray(u),Q=[],we={},Y=!1,T=!!f.sheetStubs,R=c.split(t),N=0,O=R.length;N!=O;++N){m=R[N].trim();var H=m.length;if(H!==0){var ae=0;e:for(v=0;v<H;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(A=Pt(m.slice(ae,v),!0),I=A.r!=null?parseInt(A.r,10):I+1,D=-1,f.sheetRows&&f.sheetRows<I)continue;we={},Y=!1,A.ht&&(Y=!0,we.hpt=parseFloat(A.ht),we.hpx=pc(we.hpt)),A.hidden=="1"&&(Y=!0,we.hidden=!0),A.outlineLevel!=null&&(Y=!0,we.level=+A.outlineLevel),Y&&(Q[I-1]=we)}break;case"<":ae=v;break}if(ae>=v)break;if(A=Pt(m.slice(ae,v),!0),I=A.r!=null?parseInt(A.r,10):I+1,D=-1,!(f.sheetRows&&f.sheetRows<I)){h.s.r>I-1&&(h.s.r=I-1),h.e.r<I-1&&(h.e.r=I-1),f&&f.cellStyles&&(we={},Y=!1,A.ht&&(Y=!0,we.hpt=parseFloat(A.ht),we.hpx=pc(we.hpt)),A.hidden=="1"&&(Y=!0,we.hidden=!0),A.outlineLevel!=null&&(Y=!0,we.level=+A.outlineLevel),Y&&(Q[I-1]=we)),y=m.slice(v).split(e);for(var de=0;de!=y.length&&y[de].trim().charAt(0)=="<";++de);for(y=y.slice(de),v=0;v!=y.length;++v)if(m=y[v].trim(),m.length!==0){if(_=m.match(r),k=v,g=0,w=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,_!=null&&_.length===2){for(k=0,C=_[1],g=0;g!=C.length&&!((w=C.charCodeAt(g)-64)<1||w>26);++g)k=26*k+w;--k,D=k}else++D;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,A=Pt(m.slice(0,g),!0),A.r||(A.r=It({r:I-1,c:D})),C=m.slice(g),E={t:""},(_=C.match(i))!=null&&_[1]!==""&&(E.v=gr(_[1])),f.cellFormula){if((_=C.match(o))!=null&&_[1]!==""){if(E.f=gr(Fr(_[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=j2(E.f)),_[0].indexOf('t="array"')>-1)E.F=(C.match(n)||[])[1],E.F.indexOf(":")>-1&&fe.push([or(E.F),E.F]);else if(_[0].indexOf('t="shared"')>-1){L=Pt(_[0]);var me=gr(Fr(_[1]));f.xlfn||(me=j2(me)),he[parseInt(L.si,10)]=[L,me,A.r]}}else(_=C.match(/<f[^>]*\/>/))&&(L=Pt(_[0]),he[L.si]&&(E.f=rE(he[L.si][1],he[L.si][2],A.r)));var xe=Qr(A.r);for(g=0;g<fe.length;++g)xe.r>=fe[g][0].s.r&&xe.r<=fe[g][0].e.r&&xe.c>=fe[g][0].s.c&&xe.c<=fe[g][0].e.c&&(E.F=fe[g][1])}if(A.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(T)E.t="z";else continue;else E.t=A.t||"n";switch(h.s.c>D&&(h.s.c=D),h.e.c<D&&(h.e.c=D),E.t){case"n":if(E.v==""||E.v==null){if(!T)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!T)continue;E.t="z"}else B=g0[parseInt(E.v,10)],E.v=B.t,E.r=B.r,f.cellHTML&&(E.h=B.h);break;case"str":E.t="s",E.v=E.v!=null?Fr(E.v):"",f.cellHTML&&(E.h=ym(E.v));break;case"inlineStr":_=C.match(a),E.t="s",_!=null&&(B=Om(_[1]))?(E.v=B.t,f.cellHTML&&(E.h=B.h)):E.v="";break;case"b":E.v=qr(E.v);break;case"d":f.cellDates?E.v=Vr(E.v,1):(E.v=Ba(Vr(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=zb[E.v];break}if(F=z=0,q=null,M&&A.s!==void 0&&(q=d.CellXf[A.s],q!=null&&(q.numFmtId!=null&&(F=q.numFmtId),f.cellStyles&&q.fillId!=null&&(z=q.fillId))),Ow(E,F,z,f,p,d),f.cellDates&&M&&E.t=="n"&&xl(Ft[F])&&(E.t="d",E.v=Fd(E.v)),A.cm&&f.xlmeta){var Se=(f.xlmeta.Cell||[])[+A.cm-1];Se&&Se.type=="XLDAPR"&&(E.D=!0)}if(pe){var Z=Qr(A.r);u[Z.r]||(u[Z.r]=[]),u[Z.r][Z.c]=E}else u[A.r]=E}}}}Q.length>0&&(u["!rows"]=Q)}}();function oF(e,t,r,a){var n=[],i=[],o=or(e["!ref"]),l="",c,u="",f=[],h=0,p=0,d=e["!rows"],v=Array.isArray(e),m={r:u},y,_=-1;for(p=o.s.c;p<=o.e.c;++p)f[p]=$r(p);for(h=o.s.r;h<=o.e.r;++h){for(i=[],u=la(h),p=o.s.c;p<=o.e.c;++p){c=f[p]+u;var k=v?(e[h]||[])[p]:e[c];k!==void 0&&(l=iF(k,c,e,t))!=null&&i.push(l)}(i.length>0||d&&d[h])&&(m={r:u},d&&d[h]&&(y=d[h],y.hidden&&(m.hidden=1),_=-1,y.hpx?_=O0(y.hpx):y.hpt&&(_=y.hpt),_>-1&&(m.ht=_,m.customHeight=1),y.level&&(m.outlineLevel=y.level)),n[n.length]=Je("row",i.join(""),m))}if(d)for(;h<d.length;++h)d&&d[h]&&(m={r:h+1},y=d[h],y.hidden&&(m.hidden=1),_=-1,y.hpx?_=O0(y.hpx):y.hpt&&(_=y.hpt),_>-1&&(m.ht=_,m.customHeight=1),y.level&&(m.outlineLevel=y.level),n[n.length]=Je("row","",m));return n.join("")}function Mw(e,t,r,a){var n=[ba,Je("worksheet",null,{xmlns:gl[0],"xmlns:r":Oa.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",f=or(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Yt(f)}a||(a={}),c["!comments"]=[];var h=[];$C(c,r,e,t,n),n[n.length]=Je("dimension",null,{ref:u}),n[n.length]=nF(c,t,e,r),t.sheetFormat&&(n[n.length]=Je("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=QC(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=oF(c,t),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=KC(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=tF(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=qC(c["!merges"]));var p=-1,d,v=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(d={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=Nr(a,-1,Tr(m[1].Target).replace(/#.*$/,""),ar.HLINK),d["r:id"]="rId"+v),(p=m[1].Target.indexOf("#"))>-1&&(d.location=Tr(m[1].Target.slice(p+1))),m[1].Tooltip&&(d.tooltip=Tr(m[1].Tooltip)),n[n.length]=Je("hyperlink",null,d))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=JC(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=tn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(v=Nr(a,-1,"../drawings/drawing"+(e+1)+".xml",ar.DRAW),n[n.length]=Je("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=h),c["!comments"].length>0&&(v=Nr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ar.VML),n[n.length]=Je("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function lF(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function cF(e,t,r){var a=De(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=O0(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,p=-1,d=f<<10;d<f+1<<10;++d){u.c=d;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[It(u)];v&&(h<0&&(h=d),p=d)}h<0||(++l,a.write_shift(4,h),a.write_shift(4,p))}var m=a.l;return a.l=c,a.write_shift(4,l),a.l=m,a.length>a.l?a.slice(0,a.l):a}function uF(e,t,r,a){var n=cF(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&ze(e,0,n)}var fF=wl,dF=Sc;function hF(){}function pF(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=gA(e),r}function mF(e,t,r){r==null&&(r=De(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Yf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Pb(e,r),r.slice(0,r.l)}function xF(e){var t=yi(e);return[t]}function gF(e,t,r){return r==null&&(r=De(8)),vl(t,r)}function vF(e){var t=yl(e);return[t]}function yF(e,t,r){return r==null&&(r=De(4)),bl(t,r)}function bF(e){var t=yi(e),r=e.read_shift(1);return[t,r,"b"]}function wF(e,t,r){return r==null&&(r=De(9)),vl(t,r),r.write_shift(1,e.v?1:0),r}function _F(e){var t=yl(e),r=e.read_shift(1);return[t,r,"b"]}function kF(e,t,r){return r==null&&(r=De(5)),bl(t,r),r.write_shift(1,e.v?1:0),r}function SF(e){var t=yi(e),r=e.read_shift(1);return[t,r,"e"]}function AF(e,t,r){return r==null&&(r=De(9)),vl(t,r),r.write_shift(1,e.v),r}function NF(e){var t=yl(e),r=e.read_shift(1);return[t,r,"e"]}function jF(e,t,r){return r==null&&(r=De(8)),bl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function TF(e){var t=yi(e),r=e.read_shift(4);return[t,r,"s"]}function EF(e,t,r){return r==null&&(r=De(12)),vl(t,r),r.write_shift(4,t.v),r}function CF(e){var t=yl(e),r=e.read_shift(4);return[t,r,"s"]}function FF(e,t,r){return r==null&&(r=De(8)),bl(t,r),r.write_shift(4,t.v),r}function DF(e){var t=yi(e),r=mn(e);return[t,r,"n"]}function IF(e,t,r){return r==null&&(r=De(16)),vl(t,r),ll(e.v,r),r}function zw(e){var t=yl(e),r=mn(e);return[t,r,"n"]}function LF(e,t,r){return r==null&&(r=De(12)),bl(t,r),ll(e.v,r),r}function PF(e){var t=yi(e),r=Dm(e);return[t,r,"n"]}function RF(e,t,r){return r==null&&(r=De(12)),vl(t,r),Rb(e.v,r),r}function OF(e){var t=yl(e),r=Dm(e);return[t,r,"n"]}function BF(e,t,r){return r==null&&(r=De(8)),bl(t,r),Rb(e.v,r),r}function MF(e){var t=yi(e),r=Em(e);return[t,r,"is"]}function zF(e){var t=yi(e),r=gn(e);return[t,r,"str"]}function UF(e,t,r){return r==null&&(r=De(12+4*e.v.length)),vl(t,r),Va(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WF(e){var t=yl(e),r=gn(e);return[t,r,"str"]}function qF(e,t,r){return r==null&&(r=De(8+4*e.v.length)),bl(t,r),Va(e.v,r),r.length>r.l?r.slice(0,r.l):r}function HF(e,t,r){var a=e.l+t,n=yi(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var l=Pd(e,a-e.l,r);o[3]=hn(l,null,n,r.supbooks,r)}else e.l=a;return o}function $F(e,t,r){var a=e.l+t,n=yi(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var l=Pd(e,a-e.l,r);o[3]=hn(l,null,n,r.supbooks,r)}else e.l=a;return o}function VF(e,t,r){var a=e.l+t,n=yi(e);n.r=r["!row"];var i=mn(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var l=Pd(e,a-e.l,r);o[3]=hn(l,null,n,r.supbooks,r)}else e.l=a;return o}function GF(e,t,r){var a=e.l+t,n=yi(e);n.r=r["!row"];var i=gn(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var l=Pd(e,a-e.l,r);o[3]=hn(l,null,n,r.supbooks,r)}else e.l=a;return o}var KF=wl,YF=Sc;function XF(e,t){return t==null&&(t=De(4)),t.write_shift(4,e),t}function JF(e,t){var r=e.l+t,a=wl(e),n=Cm(e),i=gn(e),o=gn(e),l=gn(e);e.l=r;var c={rfx:a,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function ZF(e,t){var r=De(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Sc({s:Qr(e[0]),e:Qr(e[0])},r),Fm("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Va(n||"",r),Va(e[1].Tooltip||"",r),Va("",r),r.slice(0,r.l)}function QF(){}function eD(e,t,r){var a=e.l+t,n=Ob(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var l=SC(e,a-e.l,r);o[1]=l}else e.l=a;return o}function tD(e,t,r){var a=e.l+t,n=wl(e),i=[n];if(r.cellFormula){var o=NC(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function rD(e,t,r){r==null&&(r=De(18));var a=Rd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var Uw=["left","right","top","bottom","header","footer"];function aD(e){var t={};return Uw.forEach(function(r){t[r]=mn(e)}),t}function nD(e,t){return t==null&&(t=De(6*8)),el(e),Uw.forEach(function(r){ll(e[r],t)}),t}function iD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sD(e,t,r){r==null&&(r=De(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function oD(e){var t=De(24);return t.write_shift(4,4),t.write_shift(4,1),Sc(e,t),t}function lD(e,t){return t==null&&(t=De(16*4+2)),t.write_shift(2,e.password?Bm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function cD(){}function uD(){}function fD(e,t,r,a,n,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,d,v,m,y,_,k,g,w,C,E=[];l.biff=12,l["!row"]=0;var A=0,I=!1,D=[],B={},L=l.supbooks||n.supbooks||[[]];if(L.sharedf=B,L.arrayf=D,L.SheetNames=n.SheetNames||n.Sheets.map(function(pe){return pe.name}),!l.supbooks&&(l.supbooks=L,n.Names))for(var F=0;F<n.Names.length;++F)L[0][F+1]=n.Names[F];var z=[],M=[],q=!1;B0[16]={n:"BrtShortReal",f:zw};var fe;if(zs(e,function(Q,we,Y){if(!p)switch(Y){case 148:u=Q;break;case 0:d=Q,l.sheetRows&&l.sheetRows<=d.r&&(p=!0),w=la(y=d.r),l["!row"]=d.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=pc(Q.hpt)),M[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:Q[2]},Q[2]){case"n":v.v=Q[1];break;case"s":g=g0[Q[1]],v.v=g.t,v.r=g.r;break;case"b":v.v=!!Q[1];break;case"e":v.v=Q[1],l.cellText!==!1&&(v.w=Us[v.v]);break;case"str":v.t="s",v.v=Q[1];break;case"is":v.t="s",v.v=Q[1].t;break}if((m=o.CellXf[Q[0].iStyleRef])&&Ow(v,m.numFmtId,null,l,i,o),_=Q[0].c==-1?_+1:Q[0].c,l.dense?(c[y]||(c[y]=[]),c[y][_]=v):c[$r(_)+w]=v,l.cellFormula){for(I=!1,A=0;A<D.length;++A){var T=D[A];d.r>=T[0].s.r&&d.r<=T[0].e.r&&_>=T[0].s.c&&_<=T[0].e.c&&(v.F=Yt(T[0]),I=!0)}!I&&Q.length>3&&(v.f=Q[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>_&&(f.s.c=_),f.e.r<d.r&&(f.e.r=d.r),f.e.c<_&&(f.e.c=_),l.cellDates&&m&&v.t=="n"&&xl(Ft[m.numFmtId])){var R=fo(v.v);R&&(v.t="d",v.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 1:case 12:if(!l.sheetStubs||h)break;v={t:"z",v:void 0},_=Q[0].c==-1?_+1:Q[0].c,l.dense?(c[y]||(c[y]=[]),c[y][_]=v):c[$r(_)+w]=v,f.s.r>d.r&&(f.s.r=d.r),f.s.c>_&&(f.s.c=_),f.e.r<d.r&&(f.e.r=d.r),f.e.c<_&&(f.e.c=_),fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 176:E.push(Q);break;case 49:fe=((l.xlmeta||{}).Cell||[])[Q-1];break;case 494:var N=a["!id"][Q.relId];for(N?(Q.Target=N.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=N):Q.relId==""&&(Q.Target="#"+Q.loc),y=Q.rfx.s.r;y<=Q.rfx.e.r;++y)for(_=Q.rfx.s.c;_<=Q.rfx.e.c;++_)l.dense?(c[y]||(c[y]=[]),c[y][_]||(c[y][_]={t:"z",v:void 0}),c[y][_].l=Q):(k=It({c:_,r:y}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=Q);break;case 426:if(!l.cellFormula)break;D.push(Q),C=l.dense?c[y][_]:c[$r(_)+w],C.f=hn(Q[1],f,{r:d.r,c:_},L,l),C.F=Yt(Q[0]);break;case 427:if(!l.cellFormula)break;B[It(Q[0].s)]=Q[1],C=l.dense?c[y][_]:c[$r(_)+w],C.f=hn(Q[1],f,{r:d.r,c:_},L,l);break;case 60:if(!l.cellStyles)break;for(;Q.e>=Q.s;)z[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},q||(q=!0,Mm(Q.w/256)),yo(z[Q.e+1]);break;case 161:c["!autofilter"]={ref:Yt(Q)};break;case 476:c["!margins"]=Q;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),Q.name&&(n.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(c["!outline"]={above:Q.above,left:Q.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),Q.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!we.T){if(!h||l.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Yt(u||f)),l.sheetRows&&c["!ref"]){var he=or(c["!ref"]);l.sheetRows<=+he.e.r&&(he.e.r=l.sheetRows-1,he.e.r>f.e.r&&(he.e.r=f.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>f.e.c&&(he.e.c=f.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Yt(he))}return E.length>0&&(c["!merges"]=E),z.length>0&&(c["!cols"]=z),M.length>0&&(c["!rows"]=M),c}function dD(e,t,r,a,n,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Pr(t),t.z=t.z||Ft[14],t.v=Ba(Vr(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=jo(n.cellXfs,t,n),t.l&&i["!links"].push([It(c),t.l]),t.c&&i["!comments"].push([It(c),t.c]),t.t){case"s":case"str":return n.bookSST?(l=Hm(n.Strings,t.v,n.revStrings),c.t="s",c.v=l,o?ze(e,18,FF(t,c)):ze(e,7,EF(t,c))):(c.t="str",o?ze(e,17,qF(t,c)):ze(e,6,UF(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ze(e,13,BF(t,c)):ze(e,2,RF(t,c)):o?ze(e,16,LF(t,c)):ze(e,5,IF(t,c)),!0;case"b":return c.t="b",o?ze(e,15,kF(t,c)):ze(e,4,wF(t,c)),!0;case"e":return c.t="e",o?ze(e,14,jF(t,c)):ze(e,3,AF(t,c)),!0}return o?ze(e,12,yF(t,c)):ze(e,1,gF(t,c)),!0}function hD(e,t,r,a){var n=or(t["!ref"]||"A1"),i,o="",l=[];ze(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var f=n.s.r;f<=u;++f){o=la(f),uF(e,t,n,f);var h=!1;if(f<=n.e.r)for(var p=n.s.c;p<=n.e.c;++p){f===n.s.r&&(l[p]=$r(p)),i=l[p]+o;var d=c?(t[f]||[])[p]:t[i];if(!d){h=!1;continue}h=dD(e,d,f,p,a,t,h)}}ze(e,146)}function pD(e,t){!t||!t["!merges"]||(ze(e,177,XF(t["!merges"].length)),t["!merges"].forEach(function(r){ze(e,176,YF(r))}),ze(e,178))}function mD(e,t){!t||!t["!cols"]||(ze(e,390),t["!cols"].forEach(function(r,a){r&&ze(e,60,rD(a,r))}),ze(e,391))}function xD(e,t){!t||!t["!ref"]||(ze(e,648),ze(e,649,oD(or(t["!ref"]))),ze(e,650))}function gD(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Nr(r,-1,a[1].Target.replace(/#.*$/,""),ar.HLINK);ze(e,494,ZF(a,n))}}),delete t["!links"]}function vD(e,t,r,a){if(t["!comments"].length>0){var n=Nr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ar.VML);ze(e,551,Fm("rId"+n)),t["!legacy"]=n}}function yD(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:Yt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Nn(i);l.s.r==l.e.r&&(l.e.r=Nn(t["!ref"]).e.r,i=Yt(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),ze(e,161,Sc(or(i))),ze(e,162)}}function bD(e,t,r){ze(e,133),ze(e,137,sD(t,r)),ze(e,138),ze(e,134)}function wD(e,t){t["!protect"]&&ze(e,535,lD(t["!protect"]))}function _D(e,t,r,a){var n=In(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=or(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ze(n,129),(r.vbaraw||o["!outline"])&&ze(n,147,mF(l,o["!outline"])),ze(n,148,dF(c)),bD(n,o,r.Workbook),mD(n,o),hD(n,o,e,t),wD(n,o),yD(n,o,r,e),pD(n,o),gD(n,o,a),o["!margins"]&&ze(n,476,nD(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&xD(n,o),vD(n,o,e,a),ze(n,130),n.end()}function kD(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=gr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function SD(e,t,r,a,n,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=kD(h);f.s.r=f.s.c=0,f.e.c=l,u=$r(l),p[0].forEach(function(d,v){o[u+la(v)]={t:"n",v:d,z:p[1]},c=v}),f.e.r<c&&(f.e.r=c),++l}),l>0&&(o["!ref"]=Yt(f)),o}function AD(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Bw);return l&&$m(l[0],i,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function ND(e,t){e.l+=10;var r=gn(e);return{name:r}}function jD(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return zs(e,function(c,u,f){switch(f){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Vm=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ED=[],CD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function D2(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=qr(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function I2(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=qr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Ww(e){I2(e.WBProps,Vm),I2(e.CalcPr,CD),D2(e.WBView,TD),D2(e.Sheets,ED),sc.date1904=qr(e.WBProps.date1904)}function FD(e){return!e.Workbook||!e.Workbook.WBProps?"false":qr(e.Workbook.WBProps.date1904)?"true":"false"}var DD="][*?/\\".split("");function qw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return DD.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ID(e,t,r){e.forEach(function(a,n){qw(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Hw(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ID(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)FC(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var LD=/<\w+:workbook/;function PD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},o=0;if(e.replace(yn,function(c,u){var f=Pt(c);switch(ls(f[0])){case"<?xml":break;case"<workbook":c.match(LD)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vm.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=qr(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=Fr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=gr(Fr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Fr(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),qr(f.hidden||"0")&&(i.Hidden=!0),o=u+c.length;break;case"</definedName>":i.Ref=gr(Fr(e.slice(o,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),gl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Ww(r),r}function $w(e){var t=[ba];t[t.length]=Je("workbook",null,{xmlns:gl[0],"xmlns:r":Oa.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Vm.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Je("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Tr(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Je("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Je("definedName",Tr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function RD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Kp(e),r.name=gn(e),r}function OD(e,t){return t||(t=De(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Fm(e.strRelID,t),Va(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function BD(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?gn(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function MD(e,t){t||(t=De(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Pb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function zD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function UD(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=vA(e),o=AC(e,0,r),l=Cm(e);e.l=a;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function WD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],B0[16]={n:"BrtFRTArchID$",f:zD},zs(e,function(c,u,f){switch(f){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=hn(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,c]):o[0]=[f,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Ww(r),r.Names=i,r.supbooks=o,r}function qD(e,t){ze(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ze(e,156,OD(n))}ze(e,144)}function HD(e,t){t||(t=De(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Va("SheetJS",t),Va(j0.version,t),Va(j0.version,t),Va("7262",t),t.length>t.l?t.slice(0,t.l):t}function $D(e,t){t||(t=De(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function VD(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(ze(e,135),ze(e,158,$D(n)),ze(e,136))}}function GD(e,t){var r=In();return ze(r,131),ze(r,128,HD()),ze(r,153,MD(e.Workbook&&e.Workbook.WBProps||null)),VD(r,e),qD(r,e),ze(r,132),r.end()}function KD(e,t,r){return t.slice(-4)===".bin"?WD(e,r):PD(e,r)}function YD(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?fD(e,a,r,n,i,o,l):WC(e,a,r,n,i,o,l)}function XD(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?jD(e,a,r,n,i):AD(e,a,r,n,i)}function JD(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?eE():tE()}function ZD(e,t,r,a,n,i,o,l){return t.slice(-4)===".bin"?ZT():QT()}function QD(e,t,r,a){return t.slice(-4)===".bin"?Yj(e,r,a):Oj(e,r,a)}function e7(e,t,r){return Sw(e,r)}function t7(e,t,r){return t.slice(-4)===".bin"?rj(e,r):Q8(e,r)}function r7(e,t,r){return t.slice(-4)===".bin"?GT(e,r):BT(e,r)}function a7(e,t,r){return t.slice(-4)===".bin"?PT(e):IT(e)}function n7(e,t,r,a){return r.slice(-4)===".bin"?RT(e,t,r,a):void 0}function i7(e,t,r){return t.slice(-4)===".bin"?CT(e,t,r):DT(e,t,r)}function s7(e,t,r){return(t.slice(-4)===".bin"?GD:$w)(e)}function o7(e,t,r,a,n){return(t.slice(-4)===".bin"?_D:Mw)(e,r,a,n)}function l7(e,t,r){return(t.slice(-4)===".bin"?iT:_w)(e,r)}function c7(e,t,r){return(t.slice(-4)===".bin"?ij:pw)(e,r)}function u7(e,t,r){return(t.slice(-4)===".bin"?KT:jw)(e)}function f7(e){return(e.slice(-4)===".bin"?FT:Aw)()}var Vw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Gw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ei(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(Vw),i,o,l,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(Gw),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function d7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Vw),n,i,o,l;if(a)for(l=0;l!=a.length;++l)n=a[l].match(Gw),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var y0;function h7(e,t){var r=y0[e]||gr(e);return r==="General"?sl(t):ei(r,t)}function p7(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=qr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Vr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[gr(t)]=n}function m7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Us[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=E0(e.v):e.w=sl(e.v):e.w=h7(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=y0[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&xl(a)){var n=fo(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function x7(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=Ej[a.Pattern]||a.Pattern)}e[t.ID]=t}function g7(e,t,r,a,n,i,o,l,c,u){var f="General",h=a.StyleID,p={};u=u||{};var d=[],v=0;for(h===void 0&&l&&(h=l.StyleID),h===void 0&&o&&(h=o.StyleID);i[h]!==void 0&&(i[h].nf&&(f=i[h].nf),i[h].Interior&&d.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=qr(e);break;case"String":a.t="s",a.r=Xg(gr(e)),a.v=e.indexOf("<")>-1?gr(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Vr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=gr(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=zb[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=Xg(t||e));break}if(m7(a,f,u),u.cellFormula!==!1)if(a.Formula){var m=gr(a.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),a.f=ic(m,n),delete a.Formula,a.ArrayRange=="RC"?a.F=ic("RC:RC",n):a.ArrayRange&&(a.F=ic(a.ArrayRange,n),c.push([or(a.F),a.F]))}else for(v=0;v<c.length;++v)n.r>=c[v][0].s.r&&n.r<=c[v][0].e.r&&n.c>=c[v][0].s.c&&n.c<=c[v][0].e.c&&(a.F=c[v][1]);u.cellStyles&&(d.forEach(function(y){!p.patternType&&y.patternType&&(p.patternType=y.patternType)}),a.s=p),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function v7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Jh(e,t){var r=t||{};wc();var a=Jl(bm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof pr<"u"?a=pr.utils.decode(65001,Wf(a)):a=Fr(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=Pr(r);return o.type="string",hc.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){n.indexOf("<"+it)>=0&&(i=!0)}),i)return eI(a,r);y0={"General Number":"General","General Date":Ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ft[15],"Short Date":Ft[14],"Long Time":Ft[19],"Medium Time":Ft[18],"Short Time":Ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ft[2],Standard:Ft[4],Percent:Ft[10],Scientific:Ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,f={},h=[],p=r.dense?[]:{},d="",v={},m={},y=Ei('<Data ss:Type="String">'),_=0,k=0,g=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},E={},A="",I=0,D=[],B={},L={},F=0,z=[],M=[],q={},fe=[],he,pe=!1,Q=[],we=[],Y={},T=0,R=0,N={Sheets:[],WBProps:{date1904:!1}},O={};D0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var H="";l=D0.exec(a);)switch(l[3]=(H=l[3]).toLowerCase()){case"data":if(H=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?g7(a.slice(_,l.index),A,y,c[c.length-1][0]=="comment"?q:v,{c:k,r:g},C,fe[k],m,Q,r):(A="",y=Ei(l[0]),_=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(M.length>0&&(v.c=M),(!r.sheetRows||r.sheetRows>g)&&v.v!==void 0&&(r.dense?(p[g]||(p[g]=[]),p[g][k]=v):p[$r(k)+la(g)]=v),v.HRef&&(v.l={Target:gr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(T=k+(parseInt(v.MergeAcross,10)|0),R=g+(parseInt(v.MergeDown,10)|0),D.push({s:{c:k,r:g},e:{c:T,r:R}})),!r.sheetStubs)v.MergeAcross?k=T+1:++k;else if(v.MergeAcross||v.MergeDown){for(var ae=k;ae<=T;++ae)for(var de=g;de<=R;++de)(ae>k||de>g)&&(r.dense?(p[de]||(p[de]=[]),p[de][ae]={t:"z"}):p[$r(ae)+la(de)]={t:"z"});k=T+1}else++k;else v=d7(l[0]),v.Index&&(k=+v.Index-1),k<w.s.c&&(w.s.c=k),k>w.e.c&&(w.e.c=k),l[0].slice(-2)==="/>"&&++k,M=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(g<w.s.r&&(w.s.r=g),g>w.e.r&&(w.e.r=g),l[0].slice(-2)==="/>"&&(m=Ei(l[0]),m.Index&&(g=+m.Index-1)),k=0,++g):(m=Ei(l[0]),m.Index&&(g=+m.Index-1),Y={},(m.AutoFitHeight=="0"||m.Height)&&(Y.hpx=parseInt(m.Height,10),Y.hpt=O0(Y.hpx),we[g]=Y),m.Hidden=="1"&&(Y.hidden=!0,we[g]=Y));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));h.push(d),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=Yt(w),r.sheetRows&&r.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=r.sheetRows-1,p["!ref"]=Yt(w))),D.length&&(p["!merges"]=D),fe.length>0&&(p["!cols"]=fe),we.length>0&&(p["!rows"]=we),f[d]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=k=0,c.push([l[3],!1]),u=Ei(l[0]),d=gr(u.Name),p=r.dense?[]:{},D=[],Q=[],we=[],O={name:d,Hidden:0},N.Sheets.push(O);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),fe=[],pe=!1}break;case"style":l[1]==="/"?x7(C,E,r):E=Ei(l[0]);break;case"numberformat":E.nf=gr(Ei(l[0]).Format||"General"),y0[E.nf]&&(E.nf=y0[E.nf]);for(var me=0;me!=392&&Ft[me]!=E.nf;++me);if(me==392){for(me=57;me!=392;++me)if(Ft[me]==null){is(E.nf,me);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(he=Ei(l[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!pe&&he.wpx>10){pe=!0,pn=bw;for(var xe=0;xe<fe.length;++xe)fe[xe]&&yo(fe[xe])}pe&&yo(he),fe[he.Index-1||fe.length]=he;for(var Se=0;Se<+he.Span;++Se)fe[fe.length]=Pr(he);break;case"namedrange":if(l[1]==="/")break;N.Names||(N.Names=[]);var Z=Pt(l[0]),Fe={Name:Z.Name,Ref:ic(Z.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(Fe.Sheet=N.Sheets.length-1),N.Names.push(Fe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=a.slice(I,l.index):I=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Ei(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?qA(B,H,a.slice(F,l.index)):F=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));v7(q),M.push(q)}else c.push([l[3],!1]),u=Ei(l[0]),q={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var $e=Ei(l[0]);p["!autofilter"]={ref:ic($e.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return B2(a,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(l[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(F,l.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else F=l.index+l[0].length;break;case"header":p["!margins"]||el(p["!margins"]={},"xlml"),isNaN(+Pt(l[0]).Margin)||(p["!margins"].header=+Pt(l[0]).Margin);break;case"footer":p["!margins"]||el(p["!margins"]={},"xlml"),isNaN(+Pt(l[0]).Margin)||(p["!margins"].footer=+Pt(l[0]).Margin);break;case"pagemargins":var Oe=Pt(l[0]);p["!margins"]||el(p["!margins"]={},"xlml"),isNaN(+Oe.Top)||(p["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(p["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(p["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(p["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?p7(L,H,z,a.slice(F,l.index)):(z=l,F=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Be={};return!r.bookSheets&&!r.bookProps&&(Be.Sheets=f),Be.SheetNames=h,Be.Workbook=N,Be.SSF=Pr(Ft),Be.Props=B,Be.Custprops=L,Be}function t1(e,t){switch(Ym(t=t||{}),t.type||"base64"){case"base64":return Jh(Qn(e),t);case"binary":case"buffer":case"file":return Jh(e,t);case"array":return Jh(Ao(e),t)}}function y7(e,t){var r=[];return e.Props&&r.push(HA(e.Props,t)),e.Custprops&&r.push($A(e.Props,e.Custprops)),r.join("")}function b7(){return""}function w7(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(Je("NumberFormat",null,{"ss:Format":Tr(Ft[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Je("Style",i.join(""),o))}),Je("Styles",r.join(""))}function Kw(e){return Je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Wm(e.Ref,{r:0,c:0})})}function _7(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(Kw(n)))}return Je("Names",r.join(""))}function k7(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(Kw(l)))}return i.join("")}function S7(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Je("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Je("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(tn("ProtectContents","True")),e["!protect"].objects&&n.push(tn("ProtectObjects","True")),e["!protect"].scenarios&&n.push(tn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(tn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(tn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Je("WorksheetOptions",n.join(""),{xmlns:Gn.x})}function A7(e){return e.map(function(t){var r=G6(t.t||""),a=Je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",a,{"ss:Author":t.a})}).join("")}function N7(e,t,r,a,n,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Tr(Wm(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Qr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Tr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Tr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=o.c||u[f].s.r!=o.r||(u[f].e.c>u[f].s.c&&(l["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(l["ss:MergeDown"]=u[f].e.r-u[f].s.r));var h="",p="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=Us[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ft[14]);break;case"s":h="String",p=V6(e.v||"");break}var d=jo(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+d),l["ss:Index"]=o.c+1;var v=e.v!=null?p:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(m+=A7(e.c)),Je("Cell",m,l)}function j7(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=pc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function T7(e,t,r,a){if(!e["!ref"])return"";var n=or(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,_){yo(y);var k=!!y.width,g=Rd(_,y),w={"ss:Index":_+1};k&&(w["ss:Width"]=P0(g.width)),y.hidden&&(w["ss:Hidden"]="1"),l.push(Je("Column",null,w))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var f=[j7(u,(e["!rows"]||[])[u])],h=n.s.c;h<=n.e.c;++h){var p=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>h)&&!(i[o].s.r>u)&&!(i[o].e.c<h)&&!(i[o].e.r<u)){(i[o].s.c!=h||i[o].s.r!=u)&&(p=!0);break}if(!p){var d={r:u,c:h},v=It(d),m=c?(e[u]||[])[h]:e[v];f.push(N7(m,v,e,t,r,a,d))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}function E7(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],o=i?k7(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?T7(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(S7(i,t,e,r)),a.join("")}function C7(e,t){t||(t={}),e.SSF||(e.SSF=Pr(Ft)),e.SSF&&(wc(),au(e.SSF),t.revssf=Cd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],jo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(y7(e,t)),r.push(b7()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Je("Worksheet",E7(a,t,e),{"ss:Name":Tr(e.SheetNames[a])}));return r[2]=w7(e,t),r[3]=_7(e),ba+Je("Workbook",r.join(""),{xmlns:Gn.ss,"xmlns:o":Gn.o,"xmlns:x":Gn.x,"xmlns:ss":Gn.ss,"xmlns:dt":Gn.dt,"xmlns:html":Gn.html})}function F7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=kA(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=SA(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var D7=[60,1084,2066,2165,2175];function I7(e,t,r,a,n){var i=a,o=[],l=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Ds(r,r.l),u=r1[c],f=0;u!=null&&D7.indexOf(c)>-1;)i=Ds(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),l=r.slice(f,r.l+4+i),o.push(l),r.l+=4+i,u=r1[c=Ds(r,r.l)];var h=$a(o);en(h,0);var p=0;h.lens=[];for(var d=0;d<o.length;++d)h.lens.push(p),p+=o[d].length;if(h.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+a;return t.f(h,h.length,n)}function Yi(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ft[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Us[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=E0(e.v):e.w=sl(e.v):e.w=ei(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&xl(Ft[a]||String(a))){var n=fo(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function lf(e,t,r){return{v:e,ixfe:t,t:r}}function L7(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},o={},l=null,c=[],u="",f={},h,p="",d,v,m,y,_={},k=[],g,w,C=[],E=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},D=function(Qe){return Qe<8?Jo[Qe]:Qe<64&&E[Qe-8]||Jo[Qe]},B=function(Qe,et,fr){var Nt=et.XF.data;if(!(!Nt||!Nt.patternType||!fr||!fr.cellStyles)){et.s={},et.s.patternType=Nt.patternType;var Ot;(Ot=L0(D(Nt.icvFore)))&&(et.s.fgColor={rgb:Ot}),(Ot=L0(D(Nt.icvBack)))&&(et.s.bgColor={rgb:Ot})}},L=function(Qe,et,fr){if(!(Y>1)&&!(fr.sheetRows&&Qe.r>=fr.sheetRows)){if(fr.cellStyles&&et.XF&&et.XF.data&&B(Qe,et,fr),delete et.ixfe,delete et.XF,h=Qe,p=It(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),fr.cellFormula&&et.f){for(var Nt=0;Nt<k.length;++Nt)if(!(k[Nt][0].s.c>Qe.c||k[Nt][0].s.r>Qe.r)&&!(k[Nt][0].e.c<Qe.c||k[Nt][0].e.r<Qe.r)){et.F=Yt(k[Nt][0]),(k[Nt][0].s.c!=Qe.c||k[Nt][0].s.r!=Qe.r)&&delete et.f,et.f&&(et.f=""+hn(k[Nt][1],o,Qe,Q,F));break}}fr.dense?(n[Qe.r]||(n[Qe.r]=[]),n[Qe.r][Qe.c]=et):n[p]=et}},F={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var z,M=[],q=[],fe=[],he=[],pe=!1,Q=[];Q.SheetNames=F.snames,Q.sharedf=F.sharedf,Q.arrayf=F.arrayf,Q.names=[],Q.XTI=[];var we=0,Y=0,T=0,R=[],N=[],O;F.codepage=1200,mi(1200);for(var H=!1;e.l<e.length-1;){var ae=e.l,de=e.read_shift(2);if(de===0&&we===10)break;var me=e.l===e.length?0:e.read_shift(2),xe=r1[de];if(xe&&xe.f){if(t.bookSheets&&we===133&&de!==133)break;if(we=de,xe.r===2||xe.r==12){var Se=e.read_shift(2);if(me-=2,!F.enc&&Se!==de&&((Se&255)<<8|Se>>8)!==de)throw new Error("rt mismatch: "+Se+"!="+de);xe.r==12&&(e.l+=10,me-=10)}var Z={};if(de===10?Z=xe.f(e,me,F):Z=I7(de,xe,e,me,F),Y==0&&[9,521,1033,2057].indexOf(we)===-1)continue;switch(de){case 34:r.opts.Date1904=A.WBProps.date1904=Z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=Z,!t.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=Z;break;case 66:var Fe=Number(Z);switch(Fe){case 21010:Fe=1200;break;case 32768:Fe=1e4;break;case 32769:Fe=1252;break}mi(F.codepage=Fe),H=!0;break;case 317:F.rrtabid=Z;break;case 25:F.winlocked=Z;break;case 439:r.opts.RefreshAll=Z;break;case 12:r.opts.CalcCount=Z;break;case 16:r.opts.CalcDelta=Z;break;case 17:r.opts.CalcIter=Z;break;case 13:r.opts.CalcMode=Z;break;case 14:r.opts.CalcPrecision=Z;break;case 95:r.opts.CalcSaveRecalc=Z;break;case 15:F.CalcRefMode=Z;break;case 2211:r.opts.FullCalc=Z;break;case 129:Z.fDialog&&(n["!type"]="dialog"),Z.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),Z.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:C.push(Z);break;case 430:Q.push([Z]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(Z);break;case 24:case 536:O={Name:Z.Name,Ref:hn(Z.rgce,o,null,Q,F)},Z.itab>0&&(O.Sheet=Z.itab-1),Q.names.push(O),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(N[Z.itab-1]={ref:Yt(Z.rgce[0][0][1][2])});break;case 22:F.ExternCount=Z;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(Z),Q.XTI=Q.XTI.concat(Z);break;case 2196:if(F.biff<8)break;O!=null&&(O.Comment=Z[1]);break;case 18:n["!protect"]=Z;break;case 19:Z!==0&&F.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,F.snames.push(Z.name);break;case 10:{if(--Y)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Yt(o),t.sheetRows&&t.sheetRows<=o.e.r){var $e=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Yt(o),o.e.r=$e}o.e.r++,o.e.c++}M.length>0&&(n["!merges"]=M),q.length>0&&(n["!objects"]=q),fe.length>0&&(n["!cols"]=fe),he.length>0&&(n["!rows"]=he),A.Sheets.push(I)}u===""?f=n:a[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),F.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(F.biff=5,H=!0,mi(F.codepage=28591)),F.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(F.biff=2),Y++)break;if(n=t.dense?[]:{},F.biff<8&&!H&&(H=!0,mi(F.codepage=t.codepage||1252)),F.biff<5||Z.BIFFVer==0&&Z.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-me,name:u};i[J.pos]=J,F.snames.push(u)}else u=(i[ae]||{name:""}).name;Z.dt==32&&(n["!type"]="chart"),Z.dt==64&&(n["!type"]="macro"),M=[],q=[],F.arrayf=k=[],fe=[],he=[],pe=!1,I={Hidden:(i[ae]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[Z.r]||[])[Z.c]:n[It({c:Z.c,r:Z.r})])&&++Z.c,g={ixfe:Z.ixfe,XF:C[Z.ixfe]||{},v:Z.val,t:"n"},T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Z.c,r:Z.r},g,t);break;case 5:case 517:g={ixfe:Z.ixfe,XF:C[Z.ixfe],v:Z.val,t:Z.t},T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Z.c,r:Z.r},g,t);break;case 638:g={ixfe:Z.ixfe,XF:C[Z.ixfe],v:Z.rknum,t:"n"},T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Z.c,r:Z.r},g,t);break;case 189:for(var Oe=Z.c;Oe<=Z.C;++Oe){var Be=Z.rkrec[Oe-Z.c][0];g={ixfe:Be,XF:C[Be],v:Z.rkrec[Oe-Z.c][1],t:"n"},T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Oe,r:Z.r},g,t)}break;case 6:case 518:case 1030:{if(Z.val=="String"){l=Z;break}if(g=lf(Z.val,Z.cell.ixfe,Z.tt),g.XF=C[g.ixfe],t.cellFormula){var it=Z.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var Me=it[0][0][1][0],pt=it[0][0][1][1],at=It({r:Me,c:pt});_[at]?g.f=""+hn(Z.formula,o,Z.cell,Q,F):g.F=((t.dense?(n[Me]||[])[pt]:n[at])||{}).F}else g.f=""+hn(Z.formula,o,Z.cell,Q,F)}T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L(Z.cell,g,t),l=Z}break;case 7:case 519:if(l)l.val=Z,g=lf(Z,l.cell.ixfe,"s"),g.XF=C[g.ixfe],t.cellFormula&&(g.f=""+hn(l.formula,o,l.cell,Q,F)),T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L(l.cell,g,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(Z);var bt=It(Z[0].s);if(d=t.dense?(n[Z[0].s.r]||[])[Z[0].s.c]:n[bt],t.cellFormula&&d){if(!l||!bt||!d)break;d.f=""+hn(Z[1],o,Z[0],Q,F),d.F=Yt(Z[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!l)break;_[It(l.cell)]=Z[0],d=t.dense?(n[l.cell.r]||[])[l.cell.c]:n[It(l.cell)],(d||{}).f=""+hn(Z[0],o,h,Q,F)}}break;case 253:g=lf(c[Z.isst].t,Z.ixfe,"s"),c[Z.isst].h&&(g.h=c[Z.isst].h),g.XF=C[g.ixfe],T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Z.c,r:Z.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:Z.ixfe,XF:C[Z.ixfe],t:"z"},T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Z.c,r:Z.r},g,t));break;case 190:if(t.sheetStubs)for(var ft=Z.c;ft<=Z.C;++ft){var qt=Z.ixfe[ft-Z.c];g={ixfe:qt,XF:C[qt],t:"z"},T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:ft,r:Z.r},g,t)}break;case 214:case 516:case 4:g=lf(Z.val,Z.ixfe,"s"),g.XF=C[g.ixfe],T>0&&(g.z=R[g.ixfe>>8&63]),Yi(g,t,r.opts.Date1904),L({c:Z.c,r:Z.r},g,t);break;case 0:case 512:Y===1&&(o=Z);break;case 252:c=Z;break;case 1054:if(F.biff==4){R[T++]=Z[1];for(var Mt=0;Mt<T+163&&Ft[Mt]!=Z[1];++Mt);Mt>=163&&is(Z[1],T+163)}else is(Z[1],Z[0]);break;case 30:{R[T++]=Z;for(var jt=0;jt<T+163&&Ft[jt]!=Z;++jt);jt>=163&&is(Z,T+163)}break;case 229:M=M.concat(Z);break;case 93:q[Z.cmo[0]]=F.lastobj=Z;break;case 438:F.lastobj.TxO=Z;break;case 127:F.lastobj.ImData=Z;break;case 440:for(y=Z[0].s.r;y<=Z[0].e.r;++y)for(m=Z[0].s.c;m<=Z[0].e.c;++m)d=t.dense?(n[y]||[])[m]:n[It({c:m,r:y})],d&&(d.l=Z[1]);break;case 2048:for(y=Z[0].s.r;y<=Z[0].e.r;++y)for(m=Z[0].s.c;m<=Z[0].e.c;++m)d=t.dense?(n[y]||[])[m]:n[It({c:m,r:y})],d&&d.l&&(d.l.Tooltip=Z[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;d=t.dense?(n[Z[0].r]||[])[Z[0].c]:n[It(Z[0])];var Xt=q[Z[2]];d||(t.dense?(n[Z[0].r]||(n[Z[0].r]=[]),d=n[Z[0].r][Z[0].c]={t:"z"}):d=n[It(Z[0])]={t:"z"},o.e.r=Math.max(o.e.r,Z[0].r),o.s.r=Math.min(o.s.r,Z[0].r),o.e.c=Math.max(o.e.c,Z[0].c),o.s.c=Math.min(o.s.c,Z[0].c)),d.c||(d.c=[]),v={a:Z[1],t:Xt.TxO.t},d.c.push(v)}break;case 2173:_T(C[Z.ixfe],Z.ext);break;case 125:{if(!F.cellStyles)break;for(;Z.e>=Z.s;)fe[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},pe||(pe=!0,Mm(Z.w/256)),yo(fe[Z.e+1])}break;case 520:{var Tt={};Z.level!=null&&(he[Z.r]=Tt,Tt.level=Z.level),Z.hidden&&(he[Z.r]=Tt,Tt.hidden=!0),Z.hpt&&(he[Z.r]=Tt,Tt.hpt=Z.hpt,Tt.hpx=pc(Z.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||el(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=Z;break;case 161:n["!margins"]||el(n["!margins"]={}),n["!margins"].header=Z.header,n["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(A.Views[0].RTL=!0);break;case 146:E=Z;break;case 2198:z=Z;break;case 140:w=Z;break;case 442:u?I.CodeName=Z||I.name:A.WBProps.CodeName=Z||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=me}return r.SheetNames=fa(i).sort(function(st,Qe){return Number(st)-Number(Qe)}).map(function(st){return i[st].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&N.forEach(function(st,Qe){r.Sheets[r.SheetNames[Qe]]["!autofilter"]=st}),r.Strings=c,r.SSF=Pr(Ft),F.enc&&(r.Encryption=F.enc),z&&(r.Themes=z),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),Q.names.length>0&&(A.Names=Q.names),r.Workbook=A,r}var b0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function P7(e,t,r){var a=kt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=p2(a,Yp,b0.DSI);for(var i in n)t[i]=n[i]}catch(u){if(r.WTF)throw u}var o=kt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=p2(o,Xp,b0.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Vb(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function R7(e,t){var r=[],a=[],n=[],i=0,o,l=Hg(Yp,"n"),c=Hg(Xp,"n");if(e.Props)for(o=fa(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:n).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=fa(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:n).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<n.length;++i)Qb.indexOf(n[i][0])>-1||$b.indexOf(n[i][0])>-1||n[i][1]!=null&&u.push(n[i]);a.length&&kt.utils.cfb_add(t,"/SummaryInformation",m2(a,b0.SI,c,Xp)),(r.length||u.length)&&kt.utils.cfb_add(t,"/DocumentSummaryInformation",m2(r,b0.DSI,l,Yp,u.length?u:null,b0.UDI))}function Gm(e,t){t||(t={}),Ym(t),Td(),t.codepage&&jd(t.codepage);var r,a;if(e.FullPaths){if(kt.find(e,"/encryption"))throw new Error("File is password-protected");r=kt.find(e,"!CompObj"),a=kt.find(e,"/Workbook")||kt.find(e,"/Book")}else{switch(t.type){case"base64":e=Kn(Qn(e));break;case"binary":e=Kn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}en(e,0),a={content:e}}var n,i;if(r&&F7(r),t.bookProps&&!t.bookSheets)n={};else{var o=tr?"buffer":"array";if(a&&a.content)n=L7(a.content,t);else if((i=kt.find(e,"PerfectOffice_MAIN"))&&i.content)n=Qo.to_workbook(i.content,(t.type=o,t));else if((i=kt.find(e,"NativeContent_MAIN"))&&i.content)n=Qo.to_workbook(i.content,(t.type=o,t));else throw(i=kt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&kt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=XT(e))}var l={};return e.FullPaths&&P7(e,l,t),n.Props=n.Custprops=l,t.bookFiles&&(n.cfb=e),n}function O7(e,t){var r=t||{},a=kt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return kt.utils.cfb_add(a,n,Yw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&R7(e,a),r.biff==8&&e.vbaraw&&JT(a,kt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var B0={0:{f:lF},1:{f:xF},2:{f:PF},3:{f:SF},4:{f:bF},5:{f:DF},6:{f:zF},7:{f:TF},8:{f:GF},9:{f:VF},10:{f:HF},11:{f:$F},12:{f:vF},13:{f:OF},14:{f:NF},15:{f:_F},16:{f:zw},17:{f:WF},18:{f:CF},19:{f:Em},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:UD},40:{},42:{},43:{f:zj},44:{f:Bj},45:{f:qj},46:{f:$j},47:{f:Hj},48:{},49:{f:fA},50:{},51:{f:AT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uw},62:{f:MF},63:{f:LT},64:{f:cD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:iD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pF},148:{f:fF,p:16},151:{f:QF},152:{},153:{f:BD},154:{},155:{},156:{f:RD},157:{},158:{},159:{T:1,f:tj},160:{T:-1},161:{T:1,f:wl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kT},336:{T:-1},337:{f:TT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eD},427:{f:tD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:aD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$T},633:{T:1},634:{T:-1},635:{T:1,f:qT},636:{T:-1},637:{f:mA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ND},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},r1={6:{f:Yh},10:{f:oo},12:{f:Ta},13:{f:Ta},14:{f:xa},15:{f:xa},16:{f:mn},17:{f:xa},18:{f:xa},19:{f:Ta},20:{f:w2},21:{f:w2},23:{f:cw},24:{f:k2},25:{f:xa},26:{},27:{},28:{f:u8},29:{},34:{f:xa},35:{f:_2},38:{f:mn},39:{f:mn},40:{f:mn},41:{f:mn},42:{f:xa},43:{f:xa},47:{f:_j},49:{f:ON},51:{f:Ta},60:{},61:{f:DN},64:{f:xa},65:{f:RN},66:{f:Ta},77:{},80:{},81:{},82:{},85:{f:Ta},89:{},90:{},91:{},92:{f:wN},93:{f:h8},94:{},95:{f:xa},96:{},97:{},99:{f:xa},125:{f:uw},128:{f:ZN},129:{f:kN},130:{f:Ta},131:{f:xa},132:{f:xa},133:{f:SN},134:{},140:{f:w8},141:{f:Ta},144:{},146:{f:S8},151:{},152:{},153:{},154:{},155:{},156:{f:Ta},157:{},158:{},160:{f:F8},161:{f:j8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KN},190:{f:YN},193:{f:oo},197:{},198:{},199:{},200:{},201:{},202:{f:xa},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ta},220:{},221:{f:xa},222:{},224:{f:JN},225:{f:bN},226:{f:oo},227:{},229:{f:f8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:NN},253:{f:MN},255:{f:TN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ew},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xa},353:{f:oo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:a8},431:{f:xa},432:{},433:{},434:{},437:{},438:{f:x8},439:{f:xa},440:{f:g8},441:{},442:{f:su},443:{},444:{f:Ta},445:{},446:{},448:{f:oo},449:{f:FN,r:2},450:{f:oo},512:{f:v2},513:{f:C8},515:{f:t8},516:{f:UN},517:{f:b2},519:{f:D8},520:{f:EN},523:{},545:{f:S2},549:{f:g2},566:{},574:{f:LN},638:{f:GN},659:{},1048:{},1054:{f:qN},1084:{},1212:{f:o8},2048:{f:y8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:nf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:oo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:A8,r:12},2173:{f:wT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xa,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:s8,r:12},2197:{},2198:{f:mT,r:12},2199:{},2200:{},2201:{},2202:{f:l8,r:12},2203:{f:oo},2204:{},2205:{},2206:{},2207:{},2211:{f:CN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ta},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:T8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:k8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:v2},1:{},2:{f:O8},3:{f:P8},4:{f:L8},5:{f:b2},7:{f:M8},8:{},9:{f:nf},11:{},22:{f:Ta},30:{f:$N},31:{},32:{},33:{f:S2},36:{},37:{f:g2},50:{f:z8},62:{},52:{},67:{},68:{f:Ta},69:{},86:{},126:{},127:{f:I8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:U8},223:{},234:{},354:{},421:{},518:{f:Yh},521:{f:nf},536:{f:k2},547:{f:_2},561:{},579:{},1030:{f:Yh},1033:{f:nf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ze(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&Nm(r)&&e.push(r)}}function B7(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Ze(e,t,r,n);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function uu(e,t,r){return e||(e=De(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function M7(e,t,r,a){var n=De(9);return uu(n,e,t),tw(r,a||"b",n),n}function z7(e,t,r){var a=De(8+2*r.length);return uu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function U7(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Ba(Vr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Ze(e,2,B8(r,a,n)):Ze(e,3,R8(r,a,n));return;case"b":case"e":Ze(e,5,M7(r,a,t.v,t.t));return;case"s":case"str":Ze(e,4,z7(r,a,(t.v||"").slice(0,255)));return}Ze(e,1,uu(null,r,a))}function W7(e,t,r,a){var n=Array.isArray(t),i=or(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Yt(i)}for(var u=i.s.r;u<=i.e.r;++u){l=la(u);for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(c[f]=$r(f)),o=c[f]+l;var h=n?(t[u]||[])[f]:t[o];h&&U7(e,h,u,f)}}}function q7(e,t){for(var r=t||{},a=In(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ze(a,r.biff==4?1033:r.biff==3?521:9,Rm(e,16,r)),W7(a,e.Sheets[e.SheetNames[n]],n,r),Ze(a,10),a.end()}function H7(e,t,r){Ze(e,49,BN({sz:12,name:"Arial"},r))}function $7(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Ze(e,1054,HN(n,t[n],r))})}function V7(e,t){var r=De(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ze(e,2151,r),r=De(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sw(or(t["!ref"]||"A1"),r),r.write_shift(4,4),Ze(e,2152,r)}function G7(e,t){for(var r=0;r<16;++r)Ze(e,224,y2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Ze(e,224,y2(a,0,t))})}function K7(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Ze(e,440,v8(a)),a[1].Tooltip&&Ze(e,2048,b8(a))}delete t["!links"]}function Y7(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Ze(e,125,N8(Rd(n,a),n))})}}function X7(e,t,r,a,n){var i=16+jo(n.cellXfs,t,n);if(t.v==null&&!t.bf){Ze(e,513,ul(r,a,i));return}if(t.bf)Ze(e,6,kC(t,r,a,n,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ba(Vr(t.v)):t.v;Ze(e,515,r8(r,a,o,i));break;case"b":case"e":Ze(e,517,e8(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var l=Hm(n.Strings,t.v,n.revStrings);Ze(e,253,zN(r,a,l,i))}else Ze(e,516,WN(r,a,(t.v||"").slice(0,255),i,n));break;default:Ze(e,513,ul(r,a,i))}}function J7(e,t,r){var a=In(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,f,h="",p=[],d=or(i["!ref"]||"A1"),v=u?65536:16384;if(d.e.c>255||d.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,v-1)}Ze(a,2057,Rm(r,16,t)),Ze(a,13,hi(1)),Ze(a,12,hi(100)),Ze(a,15,An(!0)),Ze(a,17,An(!1)),Ze(a,16,ll(.001)),Ze(a,95,An(!0)),Ze(a,42,An(!1)),Ze(a,43,An(!1)),Ze(a,130,hi(1)),Ze(a,128,QN()),Ze(a,131,An(!1)),Ze(a,132,An(!1)),u&&Y7(a,i["!cols"]),Ze(a,512,VN(d,t)),u&&(i["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=la(m);for(var y=d.s.c;y<=d.e.c;++y){m===d.s.r&&(p[y]=$r(y)),f=p[y]+h;var _=c?(i[m]||[])[y]:i[f];_&&(X7(a,_,m,y,t),u&&_.l&&i["!links"].push([f,_.l]))}}var k=l.CodeName||l.name||n;return u&&Ze(a,574,PN((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&Ze(a,229,d8(i["!merges"])),u&&K7(a,i),Ze(a,442,rw(k)),u&&V7(a,i),Ze(a,10),a.end()}function Z7(e,t,r){var a=In(),n=(e||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ze(a,2057,Rm(e,5,r)),r.bookType=="xla"&&Ze(a,135),Ze(a,225,l?hi(1200):null),Ze(a,193,eN(2)),c&&Ze(a,191),c&&Ze(a,192),Ze(a,226),Ze(a,92,_N("SheetJS",r)),Ze(a,66,hi(l?1200:1252)),l&&Ze(a,353,hi(0)),l&&Ze(a,448),Ze(a,317,E8(e.SheetNames.length)),l&&e.vbaraw&&Ze(a,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Ze(a,442,rw(u))}Ze(a,156,hi(17)),Ze(a,25,An(!1)),Ze(a,18,An(!1)),Ze(a,19,hi(0)),l&&Ze(a,431,An(!1)),l&&Ze(a,444,hi(0)),Ze(a,61,IN()),Ze(a,64,An(!1)),Ze(a,141,hi(0)),Ze(a,34,An(FD(e)=="true")),Ze(a,14,An(!0)),l&&Ze(a,439,An(!1)),Ze(a,218,hi(0)),H7(a,e,r),$7(a,e.SSF,r),G7(a,r),l&&Ze(a,352,An(!1));var f=a.end(),h=In();l&&Ze(h,140,_8()),l&&r.Strings&&B7(h,252,jN(r.Strings)),Ze(h,10);var p=h.end(),d=In(),v=0,m=0;for(m=0;m<e.SheetNames.length;++m)v+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var y=f.length+v+p.length;for(m=0;m<e.SheetNames.length;++m){var _=i[m]||{};Ze(d,133,AN({pos:y,hs:_.Hidden||0,dt:0,name:e.SheetNames[m]},r)),y+=t[m].length}var k=d.end();if(v!=k.length)throw new Error("BS8 "+v+" != "+k.length);var g=[];return f.length&&g.push(f),k.length&&g.push(k),p.length&&g.push(p),$a(g)}function Q7(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Pr(Ft)),e&&e.SSF&&(wc(),au(e.SSF),r.revssf=Cd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Xm(r),r.cellXfs=[],jo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=J7(n,r,e);return a.unshift(Z7(e,a,r)),$a(a)}function Yw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Nn(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Q7(e,t);case 4:case 3:case 2:return q7(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function L2(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=n.index,l=i&&i.index||e.length,c=B6(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,h=0,p=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<c.length;++o){var m=c[o].trim(),y=m.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var _=m.split(/<\/t[dh]>/i);for(l=0;l<_.length;++l){var k=_[l].trim();if(k.match(/<t[dh]/i)){for(var g=k,w=0;g.charAt(0)=="<"&&(w=g.indexOf(">"))>-1;)g=g.slice(w+1);for(var C=0;C<v.length;++C){var E=v[C];E.s.c==f&&E.s.r<u&&u<=E.e.r&&(f=E.e.c+1,C=-1)}var A=Pt(k.slice(0,k.indexOf(">")));p=A.colspan?+A.colspan:1,((h=+A.rowspan)>1||p>1)&&v.push({s:{r:u,c:f},e:{r:u+(h||1)-1,c:f+p-1}});var I=A.t||A["data-t"]||"";if(!g.length){f+=p;continue}if(g=kb(g),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!g.length){f+=p;continue}var D={t:"s",v:g};r.raw||!g.trim().length||I=="s"||(g==="TRUE"?D={t:"b",v:!0}:g==="FALSE"?D={t:"b",v:!1}:isNaN(Pi(g))?isNaN(dc(g).getDate())||(D={t:"d",v:Vr(g)},r.cellDates||(D={t:"n",v:Ba(D.v)}),D.z=r.dateNF||Ft[14]):D={t:"n",v:Pi(g)}),r.dense?(a[u]||(a[u]=[]),a[u][f]=D):a[It({r:u,c:f})]=D,f+=p}}}}return a["!ref"]=Yt(d),v.length&&(a["!merges"]=v),a}function Xw(e,t,r,a){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>o)&&!(n[u].e.r<r||n[u].e.c<o)){if(n[u].s.r<r||n[u].s.c<o){l=-1;break}l=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(l<0)){var f=It({r,c:o}),h=a.dense?(e[r]||[])[o]:e[f],p=h&&h.v!=null&&(h.h||ym(h.w||(ss(h),h.w)||""))||"",d={};l>1&&(d.rowspan=l),c>1&&(d.colspan=c),a.editable?p='<span contenteditable="true">'+p+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),d.id=(a.id||"sjs")+"-"+f,i.push(Je("td",p,d))}}var v="<tr>";return v+i.join("")+"</tr>"}var Jw='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zw="</body></html>";function eI(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return No(L2(r[0],t),t);var a=tx();return r.forEach(function(n,i){rx(a,L2(n,t),"Sheet"+(i+1))}),a}function Qw(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function e4(e,t){var r=t||{},a=r.header!=null?r.header:Jw,n=r.footer!=null?r.footer:Zw,i=[a],o=Nn(e["!ref"]);r.dense=Array.isArray(e),i.push(Qw(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(Xw(e,o,l,r));return i.push("</table>"+n),i.join("")}function t4(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?Qr(a.origin):a.origin;n=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var f=Nn(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),n==-1&&(u.e.r=n=f.e.r+1)}var h=[],p=0,d=e["!rows"]||(e["!rows"]=[]),v=0,m=0,y=0,_=0,k=0,g=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&m<c;++v){var w=l[v];if(P2(w)){if(a.display)continue;d[m]={hidden:!0}}var C=w.children;for(y=_=0;y<C.length;++y){var E=C[y];if(!(a.display&&P2(E))){var A=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):kb(E.innerHTML),I=E.getAttribute("data-z")||E.getAttribute("z");for(p=0;p<h.length;++p){var D=h[p];D.s.c==_+i&&D.s.r<m+n&&m+n<=D.e.r&&(_=D.e.c+1-i,p=-1)}g=+E.getAttribute("colspan")||1,((k=+E.getAttribute("rowspan")||1)>1||g>1)&&h.push({s:{r:m+n,c:_+i},e:{r:m+n+(k||1)-1,c:_+i+(g||1)-1}});var B={t:"s",v:A},L=E.getAttribute("data-t")||E.getAttribute("t")||"";A!=null&&(A.length==0?B.t=L||"z":a.raw||A.trim().length==0||L=="s"||(A==="TRUE"?B={t:"b",v:!0}:A==="FALSE"?B={t:"b",v:!1}:isNaN(Pi(A))?isNaN(dc(A).getDate())||(B={t:"d",v:Vr(A)},a.cellDates||(B={t:"n",v:Ba(B.v)}),B.z=a.dateNF||Ft[14]):B={t:"n",v:Pi(A)})),B.z===void 0&&I!=null&&(B.z=I);var F="",z=E.getElementsByTagName("A");if(z&&z.length)for(var M=0;M<z.length&&!(z[M].hasAttribute("href")&&(F=z[M].getAttribute("href"),F.charAt(0)!="#"));++M);F&&F.charAt(0)!="#"&&(B.l={Target:F}),a.dense?(e[m+n]||(e[m+n]=[]),e[m+n][_+i]=B):e[It({c:_+i,r:m+n})]=B,u.e.c<_+i&&(u.e.c=_+i),_+=g}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,m-1+n),e["!ref"]=Yt(u),m>=c&&(e["!fullref"]=Yt((u.e.r=l.length-v+m-1+n,u))),e}function r4(e,t){var r=t||{},a=r.dense?[]:{};return t4(a,e,t)}function tI(e,t){return No(r4(e,t),t)}function P2(e){var t="",r=rI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function rI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function aI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=gr(t.replace(/<[^>]*>/g,""));return[r]}var R2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function a4(e,t){var r=t||{},a=bm(e),n=[],i,o,l={name:""},c="",u=0,f,h,p={},d=[],v=r.dense?[]:{},m,y,_={value:""},k="",g=0,w=[],C=-1,E=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,D={},B=[],L={},F=0,z=0,M=[],q=1,fe=1,he=[],pe={Names:[]},Q={},we=["",""],Y=[],T={},R="",N=0,O=!1,H=!1,ae=0;for(D0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=D0.exec(a);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?v["!ref"]=Yt(A):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(v["!fullref"]=v["!ref"],A.e.r=r.sheetRows-1,v["!ref"]=Yt(A)),B.length&&(v["!merges"]=B),M.length&&(v["!rows"]=M),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),p[f.name]=v,H=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Pt(m[0],!1),C=E=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,v=r.dense?[]:{},B=[],M=[],H=!0);break;case"table-row-group":m[1]==="/"?--I:++I;break;case"table-row":case"行":if(m[1]==="/"){C+=q,q=1;break}if(h=Pt(m[0],!1),h.行号?C=h.行号-1:C==-1&&(C=0),q=+h["number-rows-repeated"]||1,q<10)for(ae=0;ae<q;++ae)I>0&&(M[C+ae]={level:I});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(v[C]||(v[C]=[]),v[C][E]={t:"z"}):v[It({r:C,c:E})]={t:"z"}),k="",w=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++E,_=Pt(m[0],!1),fe=parseInt(_["number-columns-repeated"]||"1",10),y={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(y.f=F2(gr(_.formula))),(_.数据类型||_["value-type"])=="string"&&(y.t="s",y.v=gr(_["string-value"]||""),r.dense?(v[C]||(v[C]=[]),v[C][E]=y):v[It({r:C,c:E})]=y),E+=fe-1;else if(m[1]!=="/"){++E,k="",g=0,w=[],fe=1;var de=q?C+q-1:C;if(E>A.e.c&&(A.e.c=E),E<A.s.c&&(A.s.c=E),C<A.s.r&&(A.s.r=C),de>A.e.r&&(A.e.r=de),_=Pt(m[0],!1),Y=[],T={},y={t:_.数据类型||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=gr(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(F=parseInt(_["number-matrix-rows-spanned"],10)||0,z=parseInt(_["number-matrix-columns-spanned"],10)||0,L={s:{r:C,c:E},e:{r:C+F-1,c:E+z-1}},y.F=Yt(L),he.push([L,y.F])),_.formula)y.f=F2(_.formula);else for(ae=0;ae<he.length;++ae)C>=he[ae][0].s.r&&C<=he[ae][0].e.r&&E>=he[ae][0].s.c&&E<=he[ae][0].e.c&&(y.F=he[ae][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(F=parseInt(_["number-rows-spanned"],10)||0,z=parseInt(_["number-columns-spanned"],10)||0,L={s:{r:C,c:E},e:{r:C+F-1,c:E+z-1}},B.push(L)),_["number-columns-repeated"]&&(fe=parseInt(_["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=qr(_["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(_.value);break;case"percentage":y.t="n",y.v=parseFloat(_.value);break;case"currency":y.t="n",y.v=parseFloat(_.value);break;case"date":y.t="d",y.v=Vr(_["date-value"]),r.cellDates||(y.t="n",y.v=Ba(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=P6(_["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Fd(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(_.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",_["string-value"]!=null&&(k=gr(_["string-value"]),w=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(O=!1,y.t==="s"&&(y.v=k||"",w.length&&(y.R=w),O=g==0),Q.Target&&(y.l=Q),Y.length>0&&(y.c=Y,Y=[]),k&&r.cellText!==!1&&(y.w=k),O&&(y.t="z",delete y.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var me=0;me<q;++me){if(fe=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(v[C+me]||(v[C+me]=[]),v[C+me][E]=me==0?y:Pr(y);--fe>0;)v[C+me][E+fe]=Pr(y);else for(v[It({r:C+me,c:E})]=y;--fe>0;)v[It({r:C+me,c:E+fe})]=Pr(y);A.e.c<=E&&(A.e.c=E)}fe=parseInt(_["number-columns-repeated"]||"1",10),E+=fe-1,fe=0,y={},k="",w=[]}Q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=n.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=n.pop())[0]!==m[3])throw"Bad state: "+i;T.t=k,w.length&&(T.R=w),T.a=R,Y.push(T)}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);R="",N=0,k="",g=0,w=[];break;case"creator":m[1]==="/"?R=a.slice(N,m.index):N=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=n.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);k="",g=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(D[l.name]=c,(i=n.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(c="",l=Pt(m[0],!1),n.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Pt(m[0],!1),c+=R2[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Pt(m[0],!1),c+=R2[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":o=Pt(m[0],!1),we=Xh(o["cell-range-address"]);var xe={Name:o.name,Ref:we[0]+"!"+we[1]};H&&(xe.Sheet=d.length),pe.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(m[1]==="/"&&(!_||!_["string-value"])){var Se=aI(a.slice(g,m.index));k=(k.length>0?k+`
`:"")+Se[0]}else Pt(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{we=Xh(Pt(m[0])["target-range-address"]),p[we[0]]["!autofilter"]={ref:we[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Q=Pt(m[0],!1),!Q.href)break;Q.Target=gr(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(we=Xh(Q.Target.slice(1)),Q.Target="#"+we[0]+"!"+we[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var Z={Sheets:p,SheetNames:d,Workbook:pe};return r.bookSheets&&delete Z.Sheets,Z}function O2(e,t){t=t||{},di(e,"META-INF/manifest.xml")&&PA(ja(e,"META-INF/manifest.xml"),t);var r=Yn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=a4(Fr(r),t);return di(e,"meta.xml")&&(a.Props=qb(ja(e,"meta.xml"))),a}function B2(e,t){return a4(e,t)}var nI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+F0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ba+t}}(),M2=function(){var e=function(i){return Tr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Tr(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,f=0,h=Nn(i["!ref"]||"A1"),p=i["!merges"]||[],d=0,v=Array.isArray(i);if(i["!cols"])for(f=0;f<=h.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",y=i["!rows"]||[];for(u=0;u<h.s.r;++u)m=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=h.e.r;++u){for(m=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)c.push(t);for(;f<=h.e.c;++f){var _=!1,k={},g="";for(d=0;d!=p.length;++d)if(!(p[d].s.c>f)&&!(p[d].s.r>u)&&!(p[d].e.c<f)&&!(p[d].e.r<u)){(p[d].s.c!=f||p[d].s.r!=u)&&(_=!0),k["table:number-columns-spanned"]=p[d].e.c-p[d].s.c+1,k["table:number-rows-spanned"]=p[d].e.r-p[d].s.r+1;break}if(_){c.push(r);continue}var w=It({r:u,c:f}),C=v?(i[u]||[])[f]:i[w];if(C&&C.f&&(k["table:formula"]=Tr(EC(C.f)),C.F&&C.F.slice(0,w.length)==w)){var E=Nn(C.F);k["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,k["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!C){c.push(t);continue}switch(C.t){case"b":g=C.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=C.v?"true":"false";break;case"n":g=C.w||String(C.v||0),k["office:value-type"]="float",k["office:value"]=C.v||0;break;case"s":case"str":g=C.v==null?"":C.v,k["office:value-type"]="string";break;case"d":g=C.w||Vr(C.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Vr(C.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(g);if(C.l&&C.l.Target){var I=C.l.Target;I=I.charAt(0)=="#"?"#"+CC(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),A=Je("text:a",A,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+Je("table:table-cell",Je("text:p",A,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var h=u["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;yo(h),h.ods=l;var p=u["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var h=u["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ba],u=F0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=F0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(Wb().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)c.push(a(o.Sheets[o.SheetNames[h]],o,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function n4(e,t){if(t.bookType=="fods")return M2(e,t);var r=xm(),a="",n=[],i=[];return a="mimetype",Qt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Qt(r,a,M2(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Qt(r,a,nI(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Qt(r,a,ba+Wb()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Qt(r,a,BA(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Qt(r,a,RA(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function a1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Fr(Ao(e))}function iI(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Kn(as(e))}function sI(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function wo(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function z2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function oI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function lI(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function M0(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Ar(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ca(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function yr(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=M0(e,r),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=M0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var u={data:l,type:i};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function Za(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Ar(a*8+n.type)),n.type==2&&t.push(Ar(n.data.length)),t.push(n.data))})}),wo(t)}function Km(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ui(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=M0(e,a),i=yr(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:ca(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=yr(l.data),u=ca(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=i[3])!=null&&t[0]&&(o.merge=ca(i[3][0].data)>>>0>0),r.push(o)}return r}function zl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Ar(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Ar(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Ar(o.data.length)}],a[2].push({data:Za(o.meta),type:2})});var i=Za(a);t.push(Ar(i.length)),t.push(i),n.forEach(function(o){return t.push(o)})}),wo(t)}function cI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=M0(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[wo(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var f=wo(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function fi(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(cI(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return wo(t)}function Ul(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Ar(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return wo(t)}function uI(e,t,r,a){var n=fl(e),i=n.getUint32(4,!0),o=(a>1?12:8)+z2(i&(a>1?3470:398))*4,l=-1,c=-1,u=NaN,f=new Date(2001,0,1);i&512&&(l=n.getUint32(o,!0),o+=4),o+=z2(i&(a>1?12288:4096))*4,i&16&&(c=n.getUint32(o,!0),o+=4),i&32&&(u=n.getFloat64(o,!0),o+=8),i&64&&(f.setTime(f.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function fI(e,t,r){var a=fl(e),n=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,f=new Date(2001,0,1);n&1&&(c=oI(e,i),i+=16),n&2&&(u=a.getFloat64(i,!0),i+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(l=a.getUint32(i,!0),i+=4),n&16&&(o=a.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return h}function Zh(e,t){var r=new Uint8Array(32),a=fl(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,lI(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function Qh(e,t){var r=new Uint8Array(32),a=fl(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function dI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return uI(e,t,r,e[0]);case 5:return fI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function dn(e){var t=yr(e);return M0(t[1][0].data)}function U2(e,t){var r=yr(t.data),a=ca(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var l=yr(o.data),c=ca(l[1][0].data)>>>0;switch(a){case 1:i[c]=a1(l[3][0].data);break;case 8:{var u=e[dn(l[9][0].data)][0],f=yr(u.data),h=e[dn(f[1][0].data)][0],p=ca(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var d=yr(h.data);i[c]=d[3].map(function(v){return a1(v.data)}).join("")}break}}),i}function hI(e,t){var r,a,n,i,o,l,c,u,f,h,p,d,v,m,y=yr(e),_=ca(y[1][0].data)>>>0,k=ca(y[2][0].data)>>>0,g=((a=(r=y[8])==null?void 0:r[0])==null?void 0:a.data)&&ca(y[8][0].data)>0||!1,w,C;if((i=(n=y[7])==null?void 0:n[0])!=null&&i.data&&t!=0)w=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,C=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(f=y[4])==null?void 0:f[0])!=null&&h.data&&t!=1)w=(d=(p=y[4])==null?void 0:p[0])==null?void 0:d.data,C=(m=(v=y[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=g?4:1,A=fl(w),I=[],D=0;D<w.length/2;++D){var B=A.getUint16(D*2,!0);B<65535&&I.push([D,B])}if(I.length!=k)throw"Expected ".concat(k," cells, found ").concat(I.length);var L=[];for(D=0;D<I.length-1;++D)L[I[D][0]]=C.subarray(I[D][1]*E,I[D+1][1]*E);return I.length>=1&&(L[I[I.length-1][0]]=C.subarray(I[I.length-1][1]*E)),{R:_,cells:L}}function pI(e,t){var r,a=yr(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?ca(a[7][0].data)>>>0>0?1:0:-1,i=Km(a[5],function(o){return hI(o,n)});return{nrows:ca(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function mI(e,t,r){var a,n=yr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(ca(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(ca(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Yt(i);var o=yr(n[4][0].data),l=U2(e,e[dn(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?U2(e,e[dn(o[17][0].data)][0]):[],u=yr(o[3][0].data),f=0;u[1].forEach(function(h){var p=yr(h.data),d=e[dn(p[2][0].data)][0],v=ca(d.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=pI(e,d);m.data.forEach(function(y,_){y.forEach(function(k,g){var w=It({r:f+_,c:g}),C=dI(k,l,c);C&&(r[w]=C)})}),f+=m.nrows})}function xI(e,t){var r=yr(t.data),a={"!ref":"A1"},n=e[dn(r[2][0].data)],i=ca(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return mI(e,n[0],a),a}function gI(e,t){var r,a=yr(t.data),n={name:(r=a[1])!=null&&r[0]?a1(a[1][0].data):"",sheets:[]},i=Km(a[2],dn);return i.forEach(function(o){e[o].forEach(function(l){var c=ca(l.meta[1][0].data);c==6e3&&n.sheets.push(xI(e,l))})}),n}function vI(e,t){var r=tx(),a=yr(t.data),n=Km(a[1],dn);if(n.forEach(function(i){e[i].forEach(function(o){var l=ca(o.meta[1][0].data);if(l==2){var c=gI(e,o);c.sheets.forEach(function(u,f){rx(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ep(e){var t,r,a,n,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=fi(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var f;try{f=ui(u)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){i[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var l=((n=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&ca(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(u){var f=ca(u.meta[1][0].data)>>>0;if(f==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return vI(i,l)}function yI(e,t,r){var a,n,i,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&ca(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=fl(e[7][0].data),f=0,h=[],p=fl(e[4][0].data),d=0,v=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),p.setUint16(m*2,d,!0);var y,_;switch(typeof t[m]){case"string":y=Zh({t:"s",v:t[m]},r),_=Qh({t:"s",v:t[m]},r);break;case"number":y=Zh({t:"n",v:t[m]},r),_=Qh({t:"n",v:t[m]},r);break;case"boolean":y=Zh({t:"b",v:t[m]},r),_=Qh({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(y),f+=y.length,v.push(_),d+=_.length,++c}for(e[2][0].data=Ar(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535,!0);return e[6][0].data=wo(h),e[3][0].data=wo(v),c}function bI(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Nn(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Yt(a)));var i=ed(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(N){typeof N=="string"&&o.push(N)})});var l={},c=[],u=kt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(R,N){return[R,u.FullPaths[N]]}).forEach(function(R){var N=R[0],O=R[1];if(N.type==2&&N.name.match(/\.iwa/)){var H=N.content,ae=fi(H),de=ui(ae);de.forEach(function(me){c.push(me.id),l[me.id]={deps:[],location:O,type:ca(me.messages[0].meta[1][0].data)}})}}),c.sort(function(R,N){return R-N});var f=c.filter(function(R){return R>1}).map(function(R){return[R,Ar(R)]});u.FileIndex.map(function(R,N){return[R,u.FullPaths[N]]}).forEach(function(R){var N=R[0];if(R[1],!!N.name.match(/\.iwa/)){var O=ui(fi(N.content));O.forEach(function(H){H.messages.forEach(function(ae){f.forEach(function(de){H.messages.some(function(me){return ca(me.meta[1][0].data)!=11006&&sI(me.data,de[1])})&&l[de[0]].deps.push(H.id)})})})}});for(var h=kt.find(u,l[1].location),p=ui(fi(h.content)),d,v=0;v<p.length;++v){var m=p[v];m.id==1&&(d=m)}var y=dn(yr(d.messages[0].data)[1][0].data);for(h=kt.find(u,l[y].location),p=ui(fi(h.content)),v=0;v<p.length;++v)m=p[v],m.id==y&&(d=m);for(y=dn(yr(d.messages[0].data)[2][0].data),h=kt.find(u,l[y].location),p=ui(fi(h.content)),v=0;v<p.length;++v)m=p[v],m.id==y&&(d=m);for(y=dn(yr(d.messages[0].data)[2][0].data),h=kt.find(u,l[y].location),p=ui(fi(h.content)),v=0;v<p.length;++v)m=p[v],m.id==y&&(d=m);var _=yr(d.messages[0].data);{_[6][0].data=Ar(a.e.r+1),_[7][0].data=Ar(a.e.c+1);var k=dn(_[46][0].data),g=kt.find(u,l[k].location),w=ui(fi(g.content));{for(var C=0;C<w.length&&w[C].id!=k;++C);if(w[C].id!=k)throw"Bad ColumnRowUIDMapArchive";var E=yr(w[C].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var A=0;A<=a.e.c;++A){var I=[];I[1]=I[2]=[{type:0,data:Ar(A+420690)}],E[1].push({type:2,data:Za(I)}),E[2].push({type:0,data:Ar(A)}),E[3].push({type:0,data:Ar(A)})}E[4]=[],E[5]=[],E[6]=[];for(var D=0;D<=a.e.r;++D)I=[],I[1]=I[2]=[{type:0,data:Ar(D+726270)}],E[4].push({type:2,data:Za(I)}),E[5].push({type:0,data:Ar(D)}),E[6].push({type:0,data:Ar(D)});w[C].messages[0].data=Za(E)}g.content=Ul(zl(w)),g.size=g.content.length,delete _[46];var B=yr(_[4][0].data);{B[7][0].data=Ar(a.e.r+1);var L=yr(B[1][0].data),F=dn(L[2][0].data);g=kt.find(u,l[F].location),w=ui(fi(g.content));{if(w[0].id!=F)throw"Bad HeaderStorageBucket";var z=yr(w[0].messages[0].data);for(D=0;D<i.length;++D){var M=yr(z[2][0].data);M[1][0].data=Ar(D),M[4][0].data=Ar(i[D].length),z[2][D]={type:z[2][0].type,data:Za(M)}}w[0].messages[0].data=Za(z)}g.content=Ul(zl(w)),g.size=g.content.length;var q=dn(B[2][0].data);g=kt.find(u,l[q].location),w=ui(fi(g.content));{if(w[0].id!=q)throw"Bad HeaderStorageBucket";for(z=yr(w[0].messages[0].data),A=0;A<=a.e.c;++A)M=yr(z[2][0].data),M[1][0].data=Ar(A),M[4][0].data=Ar(a.e.r+1),z[2][A]={type:z[2][0].type,data:Za(M)};w[0].messages[0].data=Za(z)}g.content=Ul(zl(w)),g.size=g.content.length;var fe=dn(B[4][0].data);(function(){for(var R=kt.find(u,l[fe].location),N=ui(fi(R.content)),O,H=0;H<N.length;++H){var ae=N[H];ae.id==fe&&(O=ae)}var de=yr(O.messages[0].data);{de[3]=[];var me=[];o.forEach(function(Z,Fe){me[1]=[{type:0,data:Ar(Fe)}],me[2]=[{type:0,data:Ar(1)}],me[3]=[{type:2,data:iI(Z)}],de[3].push({type:2,data:Za(me)})})}O.messages[0].data=Za(de);var xe=zl(N),Se=Ul(xe);R.content=Se,R.size=R.content.length})();var he=yr(B[3][0].data);{var pe=he[1][0];delete he[2];var Q=yr(pe.data);{var we=dn(Q[2][0].data);(function(){for(var R=kt.find(u,l[we].location),N=ui(fi(R.content)),O,H=0;H<N.length;++H){var ae=N[H];ae.id==we&&(O=ae)}var de=yr(O.messages[0].data);{delete de[6],delete he[7];var me=new Uint8Array(de[5][0].data);de[5]=[];for(var xe=0,Se=0;Se<=a.e.r;++Se){var Z=yr(me);xe+=yI(Z,i[Se],o),Z[1][0].data=Ar(Se),de[5].push({data:Za(Z),type:2})}de[1]=[{type:0,data:Ar(a.e.c+1)}],de[2]=[{type:0,data:Ar(a.e.r+1)}],de[3]=[{type:0,data:Ar(xe)}],de[4]=[{type:0,data:Ar(a.e.r+1)}]}O.messages[0].data=Za(de);var Fe=zl(N),$e=Ul(Fe);R.content=$e,R.size=R.content.length})()}pe.data=Za(Q)}B[3][0].data=Za(he)}_[4][0].data=Za(B)}d.messages[0].data=Za(_);var Y=zl(p),T=Ul(Y);return h.content=T,h.size=h.content.length,u}function i4(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Ym(e){i4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xm(e){i4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function wI(e){return ar.WS.indexOf(e)>-1?"sheet":e==ar.CS?"chart":e==ar.DS?"dialog":e==ar.MS?"macro":e&&e.length?e:"sheet"}function _I(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,wI(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kI(e,t,r,a,n,i,o,l,c,u,f,h){try{i[a]=x0(Yn(e,r,!0),t);var p=ja(e,t),d;switch(l){case"sheet":d=YD(p,t,n,c,i[a],u,f,h);break;case"chart":if(d=XD(p,t,n,c,i[a],u,f,h),!d||!d["!drawel"])break;var v=c0(d["!drawel"].Target,t),m=I0(v),y=OT(Yn(e,v,!0),x0(Yn(e,m,!0),v)),_=c0(y,v),k=I0(_);d=SD(Yn(e,_,!0),_,c,x0(Yn(e,k,!0),_),u,d);break;case"macro":d=JD(p,t,n,c,i[a],u,f,h);break;case"dialog":d=ZD(p,t,n,c,i[a],u,f,h);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=d;var g=[];i&&i[a]&&fa(i[a]).forEach(function(w){var C="";if(i[a][w].Type==ar.CMNT){C=c0(i[a][w].Target,t);var E=r7(ja(e,C,!0),C,c);if(!E||!E.length)return;N2(d,E,!1)}i[a][w].Type==ar.TCMNT&&(C=c0(i[a][w].Target,t),g=g.concat(MT(ja(e,C,!0),c)))}),g&&g.length&&N2(d,g,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function li(e){return e.charAt(0)=="/"?e.slice(1):e}function s4(e,t){if(wc(),t=t||{},Ym(t),di(e,"META-INF/manifest.xml")||di(e,"objectdata.xml"))return O2(e,t);if(di(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ep<"u"){if(e.FileIndex)return ep(e);var r=kt.utils.cfb_new();return Gg(e).forEach(function(M){Qt(r,M,z6(e,M))}),ep(r)}throw new Error("Unsupported NUMBERS file")}if(!di(e,"[Content_Types].xml"))throw di(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):di(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Gg(e),n=IA(Yn(e,"[Content_Types].xml")),i=!1,o,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",ja(e,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!ja(e,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(g0=[],n.sst)try{g0=t7(ja(e,li(n.sst)),n.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&n.themes.length&&(c=e7(Yn(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=QD(ja(e,li(n.style)),n.style,c,t))}n.links.map(function(M){try{var q=x0(Yn(e,I0(li(M))),M);return n7(ja(e,li(M)),q,M,t)}catch{}});var f=KD(ja(e,li(n.workbooks[0])),n.workbooks[0],t),h={},p="";n.coreprops.length&&(p=ja(e,li(n.coreprops[0]),!0),p&&(h=qb(p)),n.extprops.length!==0&&(p=ja(e,li(n.extprops[0]),!0),p&&zA(p,h,t)));var d={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(p=Yn(e,li(n.custprops[0]),!0),p&&(d=WA(p,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?o=f.Sheets.map(function(q){return q.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),t.bookProps&&(v.Props=h,v.Custprops=d),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var m={};t.bookDeps&&n.calcchain&&(m=a7(ja(e,li(n.calcchain)),n.calcchain));var y=0,_={},k,g;{var w=f.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var C=0;C!=w.length;++C)h.SheetNames[C]=w[C].name}var E=i?"bin":"xml",A=n.workbooks[0].lastIndexOf("/"),I=(n.workbooks[0].slice(0,A+1)+"_rels/"+n.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");di(e,I)||(I="xl/_rels/workbook."+E+".rels");var D=x0(Yn(e,I,!0),I.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=i7(ja(e,li(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=UT(ja(e,li(n.people[0])),t)),D&&(D=_I(D,f.Sheets));var B=ja(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var L="sheet";if(D&&D[y]?(k="xl/"+D[y][1].replace(/[\/]?xl\//,""),di(e,k)||(k=D[y][1]),di(e,k)||(k=I.replace(/_rels\/.*$/,"")+D[y][1]),L=D[y][2]):(k="xl/worksheets/sheet"+(y+1-B)+"."+E,k=k.replace(/sheet0\./,"sheet.")),g=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==y&&(F=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==h.SheetNames[y].toLowerCase()&&(F=1);if(!F)continue e}}kI(e,k,g,h.SheetNames[y],y,_,o,L,t,f,c,u)}return v={Directory:n,Workbook:f,Props:h,Custprops:d,Deps:m,Sheets:o,SheetNames:h.SheetNames,Strings:g0,Styles:u,Themes:c,SSF:Pr(Ft)},t&&t.bookFiles&&(e.files?(v.keys=a,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(M,q){M=M.replace(/^Root Entry[\/]/,""),v.keys.push(M),v.files[M]=e.FileIndex[q]}))),t&&t.bookVBA&&(n.vba.length>0?v.vbaraw=ja(e,li(n.vba[0]),!0):n.defaults&&n.defaults.bin===YT&&(v.vbaraw=ja(e,"xl/vbaProject.bin",!0))),v}function SI(e,t){var r=t||{},a="Workbook",n=kt.find(e,a);try{if(a="/!DataSpaces/Version",n=kt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(sj(n.content),a="/!DataSpaces/DataSpaceMap",n=kt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=lj(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=kt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=cj(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=kt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);fj(n.content)}catch{}if(a="/EncryptionInfo",n=kt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=dj(n.content);if(a="/EncryptedPackage",n=kt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function AI(e,t){return t.bookType=="ods"?n4(e,t):t.bookType=="numbers"?bI(e,t):t.bookType=="xlsb"?NI(e,t):o4(e,t)}function NI(e,t){Zl=1024,e&&!e.SSF&&(e.SSF=Pr(Ft)),e&&e.SSF&&(wc(),au(e.SSF),t.revssf=Cd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,v0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Tw.indexOf(t.bookType)>-1,n=Lm();Xm(t=t||{});var i=xm(),o="",l=0;if(t.cellXfs=[],jo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Qt(i,o,Hb(e.Props,t)),n.coreprops.push(o),Nr(t.rels,2,o,ar.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Qt(i,o,Gb(e.Props)),n.extprops.push(o),Nr(t.rels,3,o,ar.EXT_PROPS),e.Custprops!==e.Props&&fa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Qt(i,o,Kb(e.Custprops)),n.custprops.push(o),Nr(t.rels,4,o,ar.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Qt(i,o,o7(l-1,o,t,e,f)),n.sheets.push(o),Nr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ar.WS[0])}if(h){var d=h["!comments"],v=!1,m="";d&&d.length>0&&(m="xl/comments"+l+"."+r,Qt(i,m,u7(d,m)),n.comments.push(m),Nr(f,-1,"../comments"+l+"."+r,ar.CMNT),v=!0),h["!legacy"]&&v&&Qt(i,"xl/drawings/vmlDrawing"+l+".vml",Nw(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Qt(i,I0(o),nc(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Qt(i,o,c7(t.Strings,o,t)),n.strs.push(o),Nr(t.wbrels,-1,"sharedStrings."+r,ar.SST)),o="xl/workbook."+r,Qt(i,o,s7(e,o)),n.workbooks.push(o),Nr(t.rels,1,o,ar.WB),o="xl/theme/theme1.xml",Qt(i,o,zm(e.Themes,t)),n.themes.push(o),Nr(t.wbrels,-1,"theme/theme1.xml",ar.THEME),o="xl/styles."+r,Qt(i,o,l7(e,o,t)),n.styles.push(o),Nr(t.wbrels,-1,"styles."+r,ar.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Qt(i,o,e.vbaraw),n.vba.push(o),Nr(t.wbrels,-1,"vbaProject.bin",ar.VBA)),o="xl/metadata."+r,Qt(i,o,f7(o)),n.metadata.push(o),Nr(t.wbrels,-1,"metadata."+r,ar.XLMETA),Qt(i,"[Content_Types].xml",Ub(n,t)),Qt(i,"_rels/.rels",nc(t.rels)),Qt(i,"xl/_rels/workbook."+r+".rels",nc(t.wbrels)),delete t.revssf,delete t.ssf,i}function o4(e,t){Zl=1024,e&&!e.SSF&&(e.SSF=Pr(Ft)),e&&e.SSF&&(wc(),au(e.SSF),t.revssf=Cd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,v0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Tw.indexOf(t.bookType)>-1,n=Lm();Xm(t=t||{});var i=xm(),o="",l=0;if(t.cellXfs=[],jo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Qt(i,o,Hb(e.Props,t)),n.coreprops.push(o),Nr(t.rels,2,o,ar.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qt(i,o,Gb(e.Props)),n.extprops.push(o),Nr(t.rels,3,o,ar.EXT_PROPS),e.Custprops!==e.Props&&fa(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Qt(i,o,Kb(e.Custprops)),n.custprops.push(o),Nr(t.rels,4,o,ar.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],d=(p||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Qt(i,o,Mw(l-1,t,e,h)),n.sheets.push(o),Nr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,ar.WS[0])}if(p){var v=p["!comments"],m=!1,y="";if(v&&v.length>0){var _=!1;v.forEach(function(k){k[1].forEach(function(g){g.T==!0&&(_=!0)})}),_&&(y="xl/threadedComments/threadedComment"+l+"."+r,Qt(i,y,zT(v,f,t)),n.threadedcomments.push(y),Nr(h,-1,"../threadedComments/threadedComment"+l+"."+r,ar.TCMNT)),y="xl/comments"+l+"."+r,Qt(i,y,jw(v)),n.comments.push(y),Nr(h,-1,"../comments"+l+"."+r,ar.CMNT),m=!0}p["!legacy"]&&m&&Qt(i,"xl/drawings/vmlDrawing"+l+".vml",Nw(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Qt(i,I0(o),nc(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Qt(i,o,pw(t.Strings,t)),n.strs.push(o),Nr(t.wbrels,-1,"sharedStrings."+r,ar.SST)),o="xl/workbook."+r,Qt(i,o,$w(e)),n.workbooks.push(o),Nr(t.rels,1,o,ar.WB),o="xl/theme/theme1.xml",Qt(i,o,zm(e.Themes,t)),n.themes.push(o),Nr(t.wbrels,-1,"theme/theme1.xml",ar.THEME),o="xl/styles."+r,Qt(i,o,_w(e,t)),n.styles.push(o),Nr(t.wbrels,-1,"styles."+r,ar.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Qt(i,o,e.vbaraw),n.vba.push(o),Nr(t.wbrels,-1,"vbaProject.bin",ar.VBA)),o="xl/metadata."+r,Qt(i,o,Aw()),n.metadata.push(o),Nr(t.wbrels,-1,"metadata."+r,ar.XLMETA),f.length>1&&(o="xl/persons/person.xml",Qt(i,o,WT(f)),n.people.push(o),Nr(t.wbrels,-1,"persons/person.xml",ar.PEOPLE)),Qt(i,"[Content_Types].xml",Ub(n,t)),Qt(i,"_rels/.rels",nc(t.rels)),Qt(i,"xl/_rels/workbook."+r+".rels",nc(t.wbrels)),delete t.revssf,delete t.ssf,i}function Jm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function jI(e,t){return kt.find(e,"EncryptedPackage")?SI(e,t):Gm(e,t)}function TI(e,t){var r,a=e,n=t||{};return n.type||(n.type=tr&&Buffer.isBuffer(e)?"buffer":"base64"),r=bb(a,n),s4(r,n)}function l4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return t1(e.slice(r),t);default:break e}return hc.to_workbook(e,t)}function EI(e,t){var r="",a=Jm(e,t);switch(t.type){case"base64":r=Qn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ol(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Fr(r)),t.type="binary",l4(r,t)}function CI(e,t){var r=e;return t.type=="base64"&&(r=Qn(r)),r=pr.utils.decode(1200,r.slice(2),"str"),t.type="binary",l4(r,t)}function FI(e){return e.match(/[^\x00-\x7F]/)?as(e):e}function tp(e,t,r,a){return a?(r.type="string",hc.to_workbook(e,r)):hc.to_workbook(t,r)}function z0(e,t){Td();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return z0(new Uint8Array(e),(r=Pr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),sc={},r.dateNF&&(sc.dateNF=r.dateNF),r.type||(r.type=tr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=tr?"buffer":"binary",a=D6(e),typeof Uint8Array<"u"&&!tr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=FI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Pr(r),r.type="array",z0(dm(a),r)}switch((n=Jm(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return jI(kt.read(a,r),r);break;case 9:if(n[1]<=8)return Gm(a,r);break;case 60:return t1(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return q8(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return dw.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?TI(a,r):tp(e,a,r,i);case 239:return n[3]===60?t1(a,r):tp(e,a,r,i);case 255:if(n[1]===254)return CI(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Qo.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Qo.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return e1.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return yw.to_workbook(a,r);break;case 10:case 13:case 32:return EI(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return W8.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?e1.to_workbook(a,r):tp(e,a,r,i)}function W2(e,t){var r=t||{};return r.type="file",z0(e,r)}function c4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return nu(t.file,kt.write(e,{type:tr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return kt.write(e,t)}function DI(e,t){var r=Pr(t||{}),a=AI(e,r);return u4(a,r)}function II(e,t){var r=Pr(t||{}),a=o4(e,r);return u4(a,r)}function u4(e,t){var r={},a=tr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?kt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(ru(n))}return t.password&&typeof encrypt_agile<"u"?c4(encrypt_agile(n,t.password),t):t.type==="file"?nu(t.file,n):t.type=="string"?Fr(n):n}function LI(e,t){var r=t||{},a=O7(e,r);return c4(a,r)}function Zi(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return T0(as(a));case"binary":return as(a);case"string":return e;case"file":return nu(t.file,a,"utf8");case"buffer":return tr?Ms(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Zi(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function PI(e,t){switch(t.type){case"base64":return T0(e);case"binary":return e;case"string":return e;case"file":return nu(t.file,e,"binary");case"buffer":return tr?Ms(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function cf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?T0(r):t.type=="string"?Fr(r):r;case"file":return nu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Zm(e,t){Td(),Hw(e);var r=Pr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Zm(e,r);return r.type="array",ru(a)}return II(e,r)}function Od(e,t){Td(),Hw(e);var r=Pr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Od(e,r);return r.type="array",ru(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Zi(C7(e,r),r);case"slk":case"sylk":return Zi(fw.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Zi(e4(e.Sheets[e.SheetNames[n]],r),r);case"txt":return PI(h4(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Zi(ex(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Zi(dw.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return cf(e1.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Zi(hc.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Zi(yw.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Zi(hw.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Zi(n4(e,r),r);case"wk1":return cf(Qo.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return cf(Qo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),cf(Yw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),LI(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return DI(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Qm(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function U0(e,t,r){var a=r||{};return a.type="file",a.file=t,Qm(a),Od(e,a)}function RI(e,t,r){var a=r||{};return a.type="file",a.file=t,Qm(a),Zm(e,a)}function OI(e,t,r,a){var n=r||{};n.type="file",n.file=e,Qm(n),n.type="buffer";var i=a;return i instanceof Function||(i=r),po.writeFile(e,Od(t,n),i)}function f4(e,t,r,a,n,i,o,l){var c=la(r),u=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,p=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=o?e[r][d]:e[a[d]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;i[d]!=null&&(p[i[d]]=u);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[d]!=null){if(m==null)if(v.t=="e"&&m===null)p[i[d]]=null;else if(u!==void 0)p[i[d]]=u;else if(f&&m===null)p[i[d]]=null;else continue;else p[i[d]]=f&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?m:ss(v,m,l);m!=null&&(h=!1)}}return{row:p,isempty:h}}function ed(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof f){case"string":c=or(f);break;case"number":c=or(e["!ref"]),c.s.r=f;break;default:c=f}a>0&&(n=0);var h=la(c.s.r),p=[],d=[],v=0,m=0,y=Array.isArray(e),_=c.s.r,k=0,g={};y&&!e[_]&&(e[_]=[]);var w=u.skipHidden&&e["!cols"]||[],C=u.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(w[k]||{}).hidden)switch(p[k]=$r(k),r=y?e[_][k]:e[p[k]+h],a){case 1:i[k]=k-c.s.c;break;case 2:i[k]=p[k];break;case 3:i[k]=u.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=ss(r,null,u),m=g[o]||0,!m)g[o]=1;else{do l=o+"_"+m++;while(g[l]);g[o]=m,g[l]=1}i[k]=l}for(_=c.s.r+n;_<=c.e.r;++_)if(!(C[_]||{}).hidden){var E=f4(e,c,_,p,a,i,y,u);(E.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(d[v++]=E.row)}return d.length=v,d}var q2=/"/g;function d4(e,t,r,a,n,i,o,l){for(var c=!0,u=[],f="",h=la(r),p=t.s.c;p<=t.e.c;++p)if(a[p]){var d=l.dense?(e[r]||[])[p]:e[a[p]+h];if(d==null)f="";else if(d.v!=null){c=!1,f=""+(l.rawNumbers&&d.t=="n"?d.v:ss(d,null,l));for(var v=0,m=0;v!==f.length;++v)if((m=f.charCodeAt(v))===n||m===i||m===34||l.forceQuotes){f='"'+f.replace(q2,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(c=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(q2,'""')+'"')):f="";u.push(f)}return l.blankrows===!1&&c?null:u.join(o)}function ex(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=or(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],d=a.skipHidden&&e["!rows"]||[],v=n.s.c;v<=n.e.c;++v)(p[v]||{}).hidden||(h[v]=$r(v));for(var m=0,y=n.s.r;y<=n.e.r;++y)(d[y]||{}).hidden||(f=d4(e,n,y,h,o,c,i,a),f!=null&&(a.strip&&(f=f.replace(u,"")),(f||a.blankrows!==!1)&&r.push((m++?l:"")+f)));return delete a.dense,r.join("")}function h4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ex(e,t);if(typeof pr>"u"||t.type=="string")return r;var a=pr.utils.encode(1200,r,"str");return"ÿþ"+a}function BI(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=or(e["!ref"]),i="",o=[],l,c=[],u=Array.isArray(e);for(l=n.s.c;l<=n.e.c;++l)o[l]=$r(l);for(var f=n.s.r;f<=n.e.r;++f)for(i=la(f),l=n.s.c;l<=n.e.c;++l)if(t=o[l]+i,r=u?(e[f]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function p4(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Qr(a.origin):a.origin;o=c.r,l=c.c}var u,f={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var h=or(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(o=h.e.r+1,f.e.r=o+t.length-1+n)}else o==-1&&(o=0,f.e.r=t.length-1+n);var p=a.header||[],d=0;t.forEach(function(m,y){fa(m).forEach(function(_){(d=p.indexOf(_))==-1&&(p[d=p.length]=_);var k=m[_],g="z",w="",C=It({c:l+d,r:o+y+n});u=W0(i,C),k&&typeof k=="object"&&!(k instanceof Date)?i[C]=k:(typeof k=="number"?g="n":typeof k=="boolean"?g="b":typeof k=="string"?g="s":k instanceof Date?(g="d",a.cellDates||(g="n",k=Ba(k)),w=a.dateNF||Ft[14]):k===null&&a.nullError&&(g="e",k=0),u?(u.t=g,u.v=k,delete u.w,delete u.R,w&&(u.z=w)):i[C]=u={t:g,v:k},w&&(u.z=w))})}),f.e.c=Math.max(f.e.c,l+p.length-1);var v=la(o);if(n)for(d=0;d<p.length;++d)i[$r(d+l)+v]={t:"s",v:p[d]};return i["!ref"]=Yt(f),i}function MI(e,t){return p4(null,e,t)}function W0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Qr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?W0(e,It(t)):W0(e,It({r:t,c:r||0}))}function zI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function tx(){return{SheetNames:[],Sheets:{}}}function rx(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(qw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function UI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=zI(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function WI(e,t){return e.z=t,e}function m4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function qI(e,t,r){return m4(e,"#"+t,r)}function HI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function $I(e,t,r,a){for(var n=typeof t!="string"?t:or(t),i=typeof t=="string"?t:Yt(t),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=W0(e,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=r,a&&(c.D=!0))}return e}var Oi={encode_col:$r,encode_row:la,encode_cell:It,encode_range:Yt,decode_col:Tm,decode_row:jm,split_cell:uA,decode_cell:Qr,decode_range:Nn,format_cell:ss,sheet_add_aoa:Lb,sheet_add_json:p4,sheet_add_dom:t4,aoa_to_sheet:kc,json_to_sheet:MI,table_to_sheet:r4,table_to_book:tI,sheet_to_csv:ex,sheet_to_txt:h4,sheet_to_json:ed,sheet_to_html:e4,sheet_to_formulae:BI,sheet_to_row_object_array:ed,sheet_get_cell:W0,book_new:tx,book_append_sheet:rx,book_set_sheet_visibility:UI,cell_set_number_format:WI,cell_set_hyperlink:m4,cell_set_internal_link:qI,cell_add_comment:HI,sheet_set_array_formula:$I,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Bd;function VI(e){Bd=e}function GI(e,t){var r=Bd(),a=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var n=or(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],d=a.skipHidden&&e["!rows"]||[],v=n.s.c;v<=n.e.c;++v)(p[v]||{}).hidden||(h[v]=$r(v));var m=n.s.r,y=!1,_=0;return r._read=function(){if(!y)return y=!0,r.push("\uFEFF");for(;m<=n.e.r;)if(++m,!(d[m-1]||{}).hidden&&(f=d4(e,n,m-1,h,o,c,i,a),f!=null&&(a.strip&&(f=f.replace(u,"")),f||a.blankrows!==!1)))return r.push((_++?l:"")+f);return r.push(null)},r}function KI(e,t){var r=Bd(),a=t||{},n=a.header!=null?a.header:Jw,i=a.footer!=null?a.footer:Zw;r.push(n);var o=Nn(e["!ref"]);a.dense=Array.isArray(e),r.push(Qw(e,o,a));var l=o.s.r,c=!1;return r._read=function(){if(l>o.e.r)return c||(c=!0,r.push("</table>"+i)),r.push(null);for(;l<=o.e.r;){r.push(Xw(e,o,l,a)),++l;break}},r}function YI(e,t){var r=Bd({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var a={t:"n",v:0},n=0,i=1,o=[],l=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)&&(n=3),typeof h){case"string":u=or(h);break;case"number":u=or(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(i=0);var p=la(u.s.r),d=[],v=0,m=Array.isArray(e),y=u.s.r,_=0,k={};m&&!e[y]&&(e[y]=[]);var g=f.skipHidden&&e["!cols"]||[],w=f.skipHidden&&e["!rows"]||[];for(_=u.s.c;_<=u.e.c;++_)if(!(g[_]||{}).hidden)switch(d[_]=$r(_),a=m?e[y][_]:e[d[_]+p],n){case 1:o[_]=_-u.s.c;break;case 2:o[_]=d[_];break;case 3:o[_]=f.header[_-u.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),c=l=ss(a,null,f),v=k[l]||0,!v)k[l]=1;else{do c=l+"_"+v++;while(k[c]);k[l]=v,k[c]=1}o[_]=c}return y=u.s.r+i,r._read=function(){for(;y<=u.e.r;)if(!(w[y-1]||{}).hidden){var C=f4(e,u,y,d,n,o,m,f);if(++y,C.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows)){r.push(C.row);return}}return r.push(null)},r}var XI={to_json:YI,to_html:KI,to_csv:GI,set_readable:VI};const JI=j0.version,td=Object.freeze(Object.defineProperty({__proto__:null,CFB:kt,SSF:pb,parse_xlscfb:Gm,parse_zip:s4,read:z0,readFile:W2,readFileSync:W2,set_cptable:t6,set_fs:C6,stream:XI,utils:Oi,version:JI,write:Od,writeFile:U0,writeFileAsync:OI,writeFileSync:U0,writeFileXLSX:RI,writeXLSX:Zm},Symbol.toStringTag,{value:"Module"})),ZI=(e,t="stok_girisleri.xlsx")=>{const r=e.map(o=>({"Geliş Tarihi":o.arrivalDate.toLocaleDateString("tr-TR"),"Malzeme Adı":o.materialName,Kategori:o.category,Birim:o.unit,"Gelen Miktar":o.quantity,"Birim Fiyat":o.unitPrice,Tedarikçi:o.supplier,Not:o.note||""})),a=Oi.json_to_sheet(r),n=Oi.book_new();Oi.book_append_sheet(n,a,"Stok Girişleri");const i=[{wch:15},{wch:25},{wch:15},{wch:10},{wch:12},{wch:12},{wch:20},{wch:30}];a["!cols"]=i,U0(n,t)},QI=(e,t="personel_cikislari.xlsx")=>{const r=e.map(o=>({"Veriliş Tarihi":o.issueDate.toLocaleDateString("tr-TR"),Personel:o.employee,Departman:o.department,"Malzeme Adı":o.materialName,"Verilen Miktar":o.quantity,"Teslim Eden":o.issuedBy,Açıklama:o.description||""})),a=Oi.json_to_sheet(r),n=Oi.book_new();Oi.book_append_sheet(n,a,"Personel Çıkışları");const i=[{wch:15},{wch:20},{wch:15},{wch:25},{wch:15},{wch:20},{wch:30}];a["!cols"]=i,U0(n,t)},eL=(e,t="stok_durumu.xlsx")=>{const r=e.map(o=>({"Malzeme Adı":o.materialName,"Toplam Giriş":o.totalEntry,"Toplam Çıkış":o.totalOutput,"Mevcut Stok":o.currentStock,"Kritik Seviye":o.criticalLevel,Durum:o.status==="green"?"Yeşil":o.status==="orange"?"Turuncu":"Kırmızı",Birim:o.unit})),a=Oi.json_to_sheet(r),n=Oi.book_new();Oi.book_append_sheet(n,a,"Stok Durumu");const i=[{wch:25},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:10}];a["!cols"]=i,U0(n,t)},H2=async(e,t,r)=>new Promise(async(a,n)=>{const i=new FileReader;i.onload=async o=>{var l;try{const c=(l=o.target)==null?void 0:l.result,u=z0(c,{type:"binary"}),f=u.SheetNames[0],h=u.Sheets[f],p=Oi.sheet_to_json(h,{header:1});if(p.length<2){n(new Error("Excel dosyası boş veya geçersiz format"));return}const d=p[0].map(C=>String(C).trim()),v=["Geliş Tarihi","Malzeme Adı","Kategori","Birim","Gelen Miktar","Birim Fiyat","Tedarikçi"],m={"Geliş Tarihi":"arrivalDate","Malzeme Adı":"materialName",Kategori:"category",Birim:"unit","Gelen Miktar":"quantity","Birim Fiyat":"unitPrice",Tedarikçi:"supplier",Not:"note","Kritik Seviye":"criticalLevel"},y=v.filter(C=>!d.some(E=>E.toLowerCase().includes(C.toLowerCase())));if(y.length>0&&r)try{const C=p.slice(1).map(A=>{const I={};return d.forEach((D,B)=>{I[D]=A[B]}),I}),E=await $S(C,{requiredFields:v,fieldTypes:{"Geliş Tarihi":"date","Malzeme Adı":"string",Kategori:"string",Birim:"string","Gelen Miktar":"number","Birim Fiyat":"number",Tedarikçi:"string"}});if(E.success&&E.fixedData)return a({entries:[],result:{success:0,failed:0,errors:[]},needsFormatFix:!0,aiFixedData:E.fixedData})}catch(C){console.error("AI format düzeltme hatası:",C)}if(y.length>0)return a({entries:[],result:{success:0,failed:0,errors:[]},needsFormatFix:!0});const _=[],k=[];let g=0,w=0;for(let C=1;C<p.length;C++){const E=p[C];t&&t(C/p.length*100);try{const A={};if(d.forEach((D,B)=>{const L=m[D];L&&E[B]!==void 0&&E[B]!==null&&E[B]!==""&&(A[L]=E[B])}),!A.materialName||!A.category||!A.unit){w++,k.push(`Satır ${C+1}: Malzeme Adı, Kategori ve Birim zorunludur`);return}if(A.arrivalDate)if(typeof A.arrivalDate=="number"){const D=new Date(1899,11,30),B=A.arrivalDate;A.arrivalDate=new Date(D.getTime()+B*24*60*60*1e3)}else if(typeof A.arrivalDate=="string"){const D=new Date(A.arrivalDate);if(isNaN(D.getTime())){const B=A.arrivalDate.split(/[.\/\-]/);if(B.length===3)A.arrivalDate=new Date(parseInt(B[2]),parseInt(B[1])-1,parseInt(B[0]));else throw new Error(`Satır ${C+1}: Geçersiz tarih formatı`)}else A.arrivalDate=D}else A.arrivalDate instanceof Date?A.arrivalDate=A.arrivalDate:A.arrivalDate=new Date;else A.arrivalDate=new Date;A.quantity=parseFloat(A.quantity)||0,A.unitPrice=parseFloat(A.unitPrice)||0,A.criticalLevel=parseFloat(A.criticalLevel)||0;const I={arrivalDate:A.arrivalDate instanceof Date?A.arrivalDate:new Date(A.arrivalDate),materialName:String(A.materialName).trim(),category:String(A.category).trim(),unit:String(A.unit).trim(),quantity:A.quantity,unitPrice:A.unitPrice,supplier:String(A.supplier||"").trim(),note:String(A.note||"").trim()};_.push(I),g++}catch(A){w++,k.push(`Satır ${C+1}: ${A.message||"Bilinmeyen hata"}`)}}a({entries:_,result:{success:g,failed:w,errors:k}})}catch(c){n(new Error(`Excel dosyası okunurken hata: ${c.message}`))}},i.onerror=()=>{n(new Error("Dosya okunamadı"))},i.readAsBinaryString(e)});function tL({isOpen:e,onClose:t,onAccept:r,aiFixedData:a,originalErrors:n}){const[i,o]=ue.useState(new Set(Array.from({length:a.length},(u,f)=>f)));if(!e)return null;const l=u=>{const f=new Set(i);f.has(u)?f.delete(u):f.add(u),o(f)},c=()=>{const u=a.filter((f,h)=>i.has(h));r(u),t()};return s.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:s.jsxs("div",{style:{background:"white",border:"2px solid #000",borderRadius:"0",maxWidth:"900px",width:"100%",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[s.jsxs("div",{style:{padding:"24px",borderBottom:"2px solid #000",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:"white",zIndex:10},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(Ny,{size:24,color:"#000"}),s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#000",margin:0},children:"AI Format Düzeltme"})]}),s.jsx("button",{onClick:t,style:{background:"none",border:"none",cursor:"pointer",padding:"4px"},children:s.jsx(ea,{size:24,color:"#000"})})]}),s.jsxs("div",{style:{padding:"24px"},children:[s.jsxs("div",{style:{marginBottom:"20px",padding:"16px",background:"#f5f5f5",border:"1px solid #000"},children:[s.jsxs("p",{style:{margin:0,fontSize:"14px",color:"#000"},children:[s.jsx("strong",{children:"AI tarafından düzeltilmiş veriler:"})," Lütfen düzeltmeleri kontrol edin ve onaylamak istediğiniz satırları seçin."]}),n.length>0&&s.jsxs("div",{style:{marginTop:"12px"},children:[s.jsx("strong",{style:{fontSize:"12px"},children:"Orijinal Hatalar:"}),s.jsx("ul",{style:{marginTop:"8px",paddingLeft:"20px",fontSize:"12px"},children:n.slice(0,5).map((u,f)=>s.jsx("li",{children:u},f))})]})]}),s.jsx("div",{style:{marginBottom:"20px",maxHeight:"400px",overflow:"auto",border:"1px solid #000"},children:s.jsxs("table",{className:"excel-table",style:{fontSize:"12px"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"40px"},children:s.jsx("input",{type:"checkbox",checked:i.size===a.length,onChange:u=>{u.target.checked?o(new Set(Array.from({length:a.length},(f,h)=>h))):o(new Set)}})}),s.jsx("th",{children:"Geliş Tarihi"}),s.jsx("th",{children:"Malzeme Adı"}),s.jsx("th",{children:"Kategori"}),s.jsx("th",{children:"Birim"}),s.jsx("th",{children:"Miktar"}),s.jsx("th",{children:"Birim Fiyat"}),s.jsx("th",{children:"Tedarikçi"})]})}),s.jsx("tbody",{children:a.map((u,f)=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("input",{type:"checkbox",checked:i.has(f),onChange:()=>l(f)})}),s.jsx("td",{children:u.arrivalDate||u["Geliş Tarihi"]||"-"}),s.jsx("td",{children:u.materialName||u["Malzeme Adı"]||"-"}),s.jsx("td",{children:u.category||u.Kategori||"-"}),s.jsx("td",{children:u.unit||u.Birim||"-"}),s.jsx("td",{children:u.quantity||u["Gelen Miktar"]||"-"}),s.jsx("td",{children:u.unitPrice||u["Birim Fiyat"]||"-"}),s.jsx("td",{children:u.supplier||u.Tedarikçi||"-"})]},f))})]})}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[s.jsx("button",{onClick:t,className:"btn btn-secondary",children:"İptal"}),s.jsxs("button",{onClick:c,disabled:i.size===0,className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(x3,{size:18}),"Seçilenleri Kabul Et (",i.size,")"]})]})]})]})})}function rL(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(!1),[c,u]=ue.useState(0),[f,h]=ue.useState(!1),[p,d]=ue.useState([]),v=ue.useRef(null),[m,y]=ue.useState({materialName:"",category:"",supplier:"",startDate:"",endDate:""}),[_,k]=ue.useState([]),[g,w]=ue.useState({arrivalDate:new Date().toISOString().split("T")[0],sku:"",materialName:"",category:"",variant:"",unit:"",baseUnit:"",conversionFactor:"",quantity:"",unitPrice:"",supplier:"",warehouse:"",binCode:"",serialLot:"",expiryDate:"",note:"",criticalLevel:""});ue.useEffect(()=>{E(),C()},[m]);const C=async()=>{try{const M=gt(),q=await tu(M==null?void 0:M.companyId);k(q)}catch(M){console.error("Depolar yüklenirken hata:",M)}},E=async()=>{try{a(!0);const M=gt(),q={companyId:M==null?void 0:M.companyId};m.materialName&&(q.materialName=m.materialName),m.category&&(q.category=m.category),m.supplier&&(q.supplier=m.supplier),m.startDate&&(q.startDate=new Date(m.startDate)),m.endDate&&(q.endDate=new Date(m.endDate));const fe=await Py(q);t(fe)}catch(M){console.error("Stok girişleri yüklenirken hata:",M);const q=localStorage.getItem("currentUser"),fe=q?JSON.parse(q):null;await ur(`Stok girişleri yüklenirken hata: ${M.message||M}`,"StockEntry",fe==null?void 0:fe.id,fe==null?void 0:fe.username),alert("Veriler yüklenirken bir hata oluştu")}finally{a(!1)}},A=async M=>{M.preventDefault();const q=parseFloat(g.quantity),fe=parseFloat(g.unitPrice),he=g.criticalLevel?parseFloat(g.criticalLevel):0;if(isNaN(q)||q<=0){alert("Gelen Miktar geçerli bir sayı olmalı ve 0'dan büyük olmalıdır");return}if(isNaN(fe)||fe<0){alert("Birim Fiyat geçerli bir sayı olmalıdır");return}if(g.criticalLevel&&(isNaN(he)||he<0)){alert("Kritik Seviye geçerli bir sayı olmalıdır");return}try{const pe=gt(),Q={arrivalDate:new Date(g.arrivalDate),sku:g.sku||void 0,materialName:g.materialName,category:g.category,variant:g.variant||void 0,unit:g.unit,baseUnit:g.baseUnit||void 0,conversionFactor:g.conversionFactor?parseFloat(g.conversionFactor):void 0,quantity:q,unitPrice:fe,supplier:g.supplier,warehouse:g.warehouse||void 0,binCode:g.binCode||void 0,serialLot:g.serialLot||void 0,expiryDate:g.expiryDate?new Date(g.expiryDate):void 0,note:g.note,companyId:pe==null?void 0:pe.companyId},we=await bf(Q);await Fh(g.materialName,q,g.unit,he,pe==null?void 0:pe.companyId,g.warehouse||void 0);const Y=ml();await tb({userId:Y==null?void 0:Y.id,username:Y==null?void 0:Y.username,userEmail:Y==null?void 0:Y.email,personnelId:Y==null?void 0:Y.personnelId,personnelName:Y==null?void 0:Y.fullName,action:`Stok Giriş Eklendi: ${g.materialName} (${q} ${g.unit})`,module:"stock_entry",details:JSON.stringify({entryId:we,materialName:g.materialName,quantity:q,unit:g.unit,unitPrice:fe,supplier:g.supplier,warehouse:g.warehouse}),companyId:pe==null?void 0:pe.companyId}),alert("Stok girişi başarıyla eklendi!"),i(!1),w({arrivalDate:new Date().toISOString().split("T")[0],sku:"",materialName:"",category:"",variant:"",unit:"",baseUnit:"",conversionFactor:"",quantity:"",unitPrice:"",supplier:"",warehouse:"",binCode:"",serialLot:"",expiryDate:"",note:"",criticalLevel:""}),E()}catch(pe){const Q=localStorage.getItem("currentUser"),we=Q?JSON.parse(Q):null;await ur(`Stok girişi eklenirken hata: ${pe.message||pe}`,"StockEntry",we==null?void 0:we.id,we==null?void 0:we.username),alert("Hata: "+(pe.message||"Stok girişi eklenirken bir hata oluştu"))}},I=()=>{ZI(e,`stok_girisleri_${new Date().toISOString().split("T")[0]}.xlsx`)},D=async M=>{var fe;const q=(fe=M.target.files)==null?void 0:fe[0];if(q){if(!q.name.match(/\.(xlsx|xls)$/i)){alert("Lütfen geçerli bir Excel dosyası seçin (.xlsx veya .xls)");return}try{l(!0),u(0);const he=await H2(q,R=>u(R),!1);if(he.needsFormatFix)if(confirm("Excel dosyasının formatı beklenen formatta değil. AI ile otomatik düzeltme yapmak ister misiniz? (Ücretli servis)")){const N=await H2(q,O=>u(O),!0);if(N.aiFixedData&&N.aiFixedData.length>0){d(N.aiFixedData),h(!0),l(!1),u(0);return}}else{alert("Excel dosyası beklenen formatta değil. Lütfen doğru formatı kullanın."),l(!1),u(0);return}const{entries:pe}=he;let Q=0,we=0;const Y=[];for(const R of pe)try{await bf(R);const N=gt();await Fh(R.materialName,R.quantity,R.unit,0,N==null?void 0:N.companyId,R.warehouse||void 0),Q++}catch(N){we++,Y.push(`${R.materialName}: ${N.message}`)}let T=`İçe aktarma tamamlandı!
Başarılı: ${Q}
Başarısız: ${we}`;Y.length>0&&Y.length<=5?T+=`

Hatalar:
${Y.join(`
`)}`:Y.length>5&&(T+=`

İlk 5 hata:
${Y.slice(0,5).join(`
`)}`),alert(T),v.current&&(v.current.value=""),E()}catch(he){const pe=localStorage.getItem("currentUser"),Q=pe?JSON.parse(pe):null;await ur(`Excel dosyası içe aktarılırken hata: ${he.message||he}`,"StockEntry",Q==null?void 0:Q.id,Q==null?void 0:Q.username),alert("Excel dosyası içe aktarılırken hata: "+he.message)}finally{l(!1),u(0)}}},B=()=>{y({materialName:"",category:"",supplier:"",startDate:"",endDate:""})},L=Array.from(new Set(e.map(M=>M.category))).filter(Boolean),F=Array.from(new Set(e.map(M=>M.supplier))).filter(Boolean),z=Array.from(new Set(e.map(M=>M.materialName))).filter(Boolean);return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Stok Giriş Takip"}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("input",{type:"file",ref:v,accept:".xlsx,.xls",onChange:D,style:{display:"none"}}),s.jsxs("button",{onClick:()=>{var M;return(M=v.current)==null?void 0:M.click()},className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},disabled:o,children:[s.jsx(T3,{size:18}),o?`İçe Aktarılıyor... %${Math.round(c)}`:"Excel'den İçe Aktar"]}),s.jsxs("button",{onClick:I,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Zn,{size:18}),"Excel'e Aktar"]}),s.jsxs("button",{onClick:()=>i(!n),className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Giriş"]})]})]}),n&&s.jsxs("div",{className:"excel-form",style:{marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#000",letterSpacing:"0.3px",textTransform:"uppercase"},children:"Yeni Stok Girişi"}),s.jsx("button",{onClick:()=>i(!1),style:{background:"none",border:"none",cursor:"pointer"},children:s.jsx(ea,{size:24,color:"#7f8c8d"})})]}),s.jsxs("form",{onSubmit:A,children:[s.jsxs("div",{className:"grid-4",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Geliş Tarihi *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:g.arrivalDate,onChange:M=>w({...g,arrivalDate:M.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKU"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.sku,onChange:M=>w({...g,sku:M.target.value}),placeholder:"Ürün kartı SKU (opsiyonel)"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Malzeme Adı *"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.materialName,onChange:M=>w({...g,materialName:M.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kategori *"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.category,onChange:M=>w({...g,category:M.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Varyant (Renk/Beden)"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.variant,onChange:M=>w({...g,variant:M.target.value}),placeholder:"Örn: Kırmızı-M"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Birim *"}),s.jsxs("select",{className:"excel-form-select",value:g.unit,onChange:M=>w({...g,unit:M.target.value}),required:!0,children:[s.jsx("option",{value:"",children:"Seçiniz"}),s.jsx("option",{value:"Adet",children:"Adet"}),s.jsx("option",{value:"Kg",children:"Kg"}),s.jsx("option",{value:"Lt",children:"Lt"}),s.jsx("option",{value:"m²",children:"m²"}),s.jsx("option",{value:"m³",children:"m³"}),s.jsx("option",{value:"Paket",children:"Paket"})]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Temel Birim"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.baseUnit,onChange:M=>w({...g,baseUnit:M.target.value}),placeholder:"Ürün kartındaki temel birim"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Dönüşüm Katsayısı"}),s.jsx("input",{type:"number",step:"0.0001",className:"excel-form-input",value:g.conversionFactor,onChange:M=>w({...g,conversionFactor:M.target.value}),placeholder:"Örn: Koli→Adet"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Gelen Miktar *"}),s.jsx("input",{type:"number",step:"0.01",className:"excel-form-input",value:g.quantity,onChange:M=>w({...g,quantity:M.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Birim Fiyat *"}),s.jsx("input",{type:"number",step:"0.01",className:"excel-form-input",value:g.unitPrice,onChange:M=>w({...g,unitPrice:M.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tedarikçi *"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.supplier,onChange:M=>w({...g,supplier:M.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Depo"}),s.jsxs("select",{className:"excel-form-select",value:g.warehouse,onChange:M=>w({...g,warehouse:M.target.value}),children:[s.jsx("option",{value:"",children:"Depo Seçiniz (Opsiyonel)"}),_.map(M=>s.jsx("option",{value:M.name,children:M.name},M.id))]}),_.length===0&&s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:"Depo Yönetimi sayfasından depo ekleyebilirsiniz."})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Raf/Göz (Bin)"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.binCode,onChange:M=>w({...g,binCode:M.target.value}),placeholder:"Örn: A-01-03"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Seri/Lot"}),s.jsx("input",{type:"text",className:"excel-form-input",value:g.serialLot,onChange:M=>w({...g,serialLot:M.target.value}),placeholder:"Lot veya seri no"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKT"}),s.jsx("input",{type:"date",className:"excel-form-input",value:g.expiryDate,onChange:M=>w({...g,expiryDate:M.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kritik Seviye"}),s.jsx("input",{type:"number",step:"0.01",min:"0",className:"excel-form-input",value:g.criticalLevel,onChange:M=>{const q=M.target.value;(q===""||/^\d*\.?\d*$/.test(q))&&w({...g,criticalLevel:q})},onBlur:M=>{const q=M.target.value;q&&(isNaN(parseFloat(q))||parseFloat(q)<0)?M.target.setCustomValidity("Geçerli bir sayı giriniz"):M.target.setCustomValidity("")}})]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Not"}),s.jsx("textarea",{className:"excel-form-input",rows:3,value:g.note,onChange:M=>w({...g,note:M.target.value})})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsx("button",{type:"submit",className:"btn btn-primary",children:"Kaydet"}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),children:"İptal"})]})]})]}),s.jsxs("div",{className:"filter-section",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Filtrele"}),s.jsx("button",{onClick:B,className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"Filtreleri Temizle"})]}),s.jsxs("div",{className:"filter-row",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Malzeme Adı"}),s.jsxs("select",{className:"excel-form-select",value:m.materialName,onChange:M=>y({...m,materialName:M.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),z.map(M=>s.jsx("option",{value:M,children:M},M))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kategori"}),s.jsxs("select",{className:"excel-form-select",value:m.category,onChange:M=>y({...m,category:M.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),L.map(M=>s.jsx("option",{value:M,children:M},M))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tedarikçi"}),s.jsxs("select",{className:"excel-form-select",value:m.supplier,onChange:M=>y({...m,supplier:M.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),F.map(M=>s.jsx("option",{value:M,children:M},M))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Başlangıç Tarihi"}),s.jsx("input",{type:"date",className:"excel-form-input",value:m.startDate,onChange:M=>y({...m,startDate:M.target.value})})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Bitiş Tarihi"}),s.jsx("input",{type:"date",className:"excel-form-input",value:m.endDate,onChange:M=>y({...m,endDate:M.target.value})})]})]})]}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz stok girişi kaydı bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Geliş Tarihi"}),s.jsx("th",{children:"Malzeme Adı"}),s.jsx("th",{children:"Kategori"}),s.jsx("th",{children:"Birim"}),s.jsx("th",{children:"Gelen Miktar"}),s.jsx("th",{children:"Birim Fiyat"}),s.jsx("th",{children:"Tedarikçi"}),s.jsx("th",{children:"Depo"}),s.jsx("th",{children:"Not"})]})}),s.jsx("tbody",{children:e.map(M=>s.jsxs("tr",{children:[s.jsx("td",{children:M.arrivalDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:M.materialName}),s.jsx("td",{children:M.category}),s.jsx("td",{children:M.unit}),s.jsx("td",{children:M.quantity}),s.jsxs("td",{children:[M.unitPrice.toFixed(2)," ₺"]}),s.jsx("td",{children:M.supplier}),s.jsx("td",{children:M.warehouse||"-"}),s.jsx("td",{children:M.note||"-"})]},M.id))})]})}),s.jsx(tL,{isOpen:f&&p.length>0,onClose:()=>{h(!1),d([]),v.current&&(v.current.value="")},onAccept:async M=>{try{l(!0),u(0);const q=gt();let fe=0,he=0;for(let pe=0;pe<M.length;pe++){const Q=M[pe];u(pe/M.length*100);try{const we={arrivalDate:Q.arrivalDate?new Date(Q.arrivalDate):new Date,materialName:String(Q.materialName||Q["Malzeme Adı"]||"").trim(),category:String(Q.category||Q.Kategori||"").trim(),unit:String(Q.unit||Q.Birim||"").trim(),quantity:parseFloat(Q.quantity||Q["Gelen Miktar"]||"0"),unitPrice:parseFloat(Q.unitPrice||Q["Birim Fiyat"]||"0"),supplier:String(Q.supplier||Q.Tedarikçi||"").trim(),note:String(Q.note||Q.Not||"").trim(),companyId:q==null?void 0:q.companyId};we.materialName&&we.category&&we.unit?(await bf(we),await Fh(we.materialName,we.quantity,we.unit,0,q==null?void 0:q.companyId,we.warehouse||void 0),fe++):he++}catch{he++}}alert(`İçe aktarma tamamlandı!
Başarılı: ${fe}
Başarısız: ${he}`),h(!1),d([]),E()}catch(q){alert("Hata: "+q.message)}finally{l(!1),u(0)}},aiFixedData:p,originalErrors:[]})]})})}function aL(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState([]),[c,u]=ue.useState(!0),[f,h]=ue.useState(!1),[p,d]=ue.useState({employee:"",department:"",materialName:"",startDate:"",endDate:""}),[v,m]=ue.useState({issueDate:new Date().toISOString().split("T")[0],employee:"",department:"",sku:"",variant:"",materialName:"",quantity:"",issuedBy:"",warehouse:"",binCode:"",serialLot:"",expiryDate:"",description:""}),y=$0();ue.useEffect(()=>{_()},[p]);const _=async()=>{try{u(!0);const F=gt(),z={companyId:F==null?void 0:F.companyId};p.employee&&(z.employee=p.employee),p.department&&(z.department=p.department),p.materialName&&(z.materialName=p.materialName),p.startDate&&(z.startDate=new Date(p.startDate)),p.endDate&&(z.endDate=new Date(p.endDate));const[M,q,fe,he]=await Promise.all([Ry(z),gc(F==null?void 0:F.companyId),ud({companyId:F==null?void 0:F.companyId}),tu(F==null?void 0:F.companyId)]);t(M),a(q),i(fe),l(he)}catch(F){console.error("Veriler yüklenirken hata:",F);const z=localStorage.getItem("currentUser"),M=z?JSON.parse(z):null;await ur(`Personel çıkış verileri yüklenirken hata: ${F.message||F}`,"StockOutput",M==null?void 0:M.id,M==null?void 0:M.username),alert("Veriler yüklenirken bir hata oluştu")}finally{u(!1)}},k=async F=>{F.preventDefault();const z=parseFloat(v.quantity);if(isNaN(z)||z<=0){alert("Verilen Miktar geçerli bir sayı olmalı ve 0'dan büyük olmalıdır");return}if(z>L){alert(`Verilen miktar mevcut stoktan fazla olamaz. Maksimum: ${L} ${B==null?void 0:B.unit}`);return}const M=n.find(q=>q.name===v.employee);if(!M){alert("Lütfen kayıtlı bir personel seçin. Personel Yönetimi sayfasından personel ekleyebilirsiniz.");return}try{const q=gt(),fe={issueDate:new Date(v.issueDate),employee:v.employee,department:v.department,sku:v.sku||void 0,variant:v.variant||void 0,personnelId:M.id,materialName:v.materialName,quantity:z,issuedBy:v.issuedBy,warehouse:v.warehouse||void 0,binCode:v.binCode||void 0,serialLot:v.serialLot||void 0,expiryDate:v.expiryDate?new Date(v.expiryDate):void 0,description:v.description,companyId:q==null?void 0:q.companyId},he=await R3(fe);alert("Personel çıkışı başarıyla eklendi!"),h(!1),m({issueDate:new Date().toISOString().split("T")[0],employee:"",department:"",sku:"",variant:"",materialName:"",quantity:"",issuedBy:"",warehouse:"",binCode:"",serialLot:"",expiryDate:"",description:""}),_(),y(`/zimmet-signature/${he}`)}catch(q){alert("Hata: "+(q.message||"Personel çıkışı eklenirken bir hata oluştu"))}},g=()=>{QI(e,`personel_cikislari_${new Date().toISOString().split("T")[0]}.xlsx`)},w=()=>{d({employee:"",department:"",materialName:"",startDate:"",endDate:""})},E=(F=>F?r.filter(z=>z.currentStock>0&&z.warehouse===F):r.filter(z=>z.currentStock>0&&!z.warehouse))(v.warehouse),A=Array.from(new Set(n.map(F=>F.name))).filter(Boolean),I=Array.from(new Set(n.map(F=>F.department))).filter(Boolean),D=Array.from(new Set(e.map(F=>F.materialName))).filter(Boolean),B=r.find(F=>F.materialName===v.materialName&&F.warehouse===(v.warehouse||void 0)),L=(B==null?void 0:B.currentStock)||0;return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Personel Çıkış Takip"}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsxs("button",{onClick:g,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Zn,{size:18}),"Excel'e Aktar"]}),s.jsxs("button",{onClick:()=>h(!f),className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Çıkış"]})]})]}),f&&s.jsxs("div",{className:"excel-form",style:{marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#000",letterSpacing:"0.3px",textTransform:"uppercase"},children:"Yeni Personel Çıkışı"}),s.jsx("button",{onClick:()=>h(!1),style:{background:"none",border:"none",cursor:"pointer"},children:s.jsx(ea,{size:24,color:"#7f8c8d"})})]}),E.length===0&&s.jsx("div",{style:{background:"#fff3cd",color:"#856404",padding:"12px",borderRadius:"4px",marginBottom:"20px",fontSize:"14px"},children:"⚠️ Stokta hiç malzeme bulunmamaktadır. Önce stok girişi yapmalısınız."}),s.jsxs("form",{onSubmit:k,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Veriliş Tarihi *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:v.issueDate,onChange:F=>m({...v,issueDate:F.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Personel *"}),s.jsxs("select",{className:"excel-form-select",value:v.employee,onChange:F=>{const z=n.find(M=>M.name===F.target.value);m({...v,employee:F.target.value,department:(z==null?void 0:z.department)||""})},required:!0,disabled:n.length===0,children:[s.jsx("option",{value:"",children:"Seçiniz"}),n.map(F=>s.jsxs("option",{value:F.name,children:[F.name," - ",F.department]},F.id))]}),n.length===0&&s.jsx("div",{style:{fontSize:"12px",color:"#dc3545",marginTop:"4px"},children:"Önce personel kaydı yapılmalıdır. Personel Yönetimi sayfasından ekleyin."})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKU"}),s.jsx("input",{type:"text",className:"excel-form-input",value:v.sku,onChange:F=>m({...v,sku:F.target.value}),placeholder:"Ürün kartı SKU (opsiyonel)"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Varyant"}),s.jsx("input",{type:"text",className:"excel-form-input",value:v.variant,onChange:F=>m({...v,variant:F.target.value}),placeholder:"Örn: Kırmızı-M"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Departman *"}),s.jsx("input",{type:"text",className:"excel-form-input",value:v.department,onChange:F=>m({...v,department:F.target.value}),required:!0,readOnly:!0,style:{background:"#f5f5f5"}})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Depo *"}),s.jsxs("select",{className:"excel-form-select",value:v.warehouse,onChange:F=>{m({...v,warehouse:F.target.value,materialName:"",quantity:""})},required:!0,disabled:o.length===0,children:[s.jsx("option",{value:"",children:"Depo Seçiniz"}),o.map(F=>s.jsx("option",{value:F.name,children:F.name},F.id))]}),o.length===0&&s.jsx("div",{style:{fontSize:"12px",color:"#dc3545",marginTop:"4px"},children:"Önce depo kaydı yapılmalıdır. Depo Yönetimi sayfasından ekleyin."})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Raf/Göz (Bin)"}),s.jsx("input",{type:"text",className:"excel-form-input",value:v.binCode,onChange:F=>m({...v,binCode:F.target.value}),placeholder:"Örn: A-01-03"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Malzeme Adı *"}),s.jsxs("select",{className:"excel-form-select",value:v.materialName,onChange:F=>m({...v,materialName:F.target.value}),required:!0,disabled:E.length===0,children:[s.jsx("option",{value:"",children:"Seçiniz"}),E.map(F=>s.jsxs("option",{value:F.materialName,children:[F.materialName," ",F.warehouse&&`(${F.warehouse})`," (Mevcut: ",F.currentStock," ",F.unit,")"]},`${F.materialName}-${F.warehouse||"no-warehouse"}`))]}),B&&s.jsxs("div",{style:{fontSize:"12px",color:"#7f8c8d",marginTop:"4px"},children:["Mevcut stok: ",B.currentStock," ",B.unit,B.warehouse&&` - Depo: ${B.warehouse}`]}),v.warehouse&&E.length===0&&s.jsx("div",{style:{fontSize:"12px",color:"#dc3545",marginTop:"4px"},children:"Seçilen depoda stok bulunmamaktadır."})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Verilen Miktar *"}),s.jsx("input",{type:"number",step:"0.01",min:"0.01",max:L,className:"excel-form-input",value:v.quantity,onChange:F=>{const z=F.target.value;(z===""||/^\d*\.?\d*$/.test(z))&&m({...v,quantity:z})},onBlur:F=>{const z=parseFloat(F.target.value);isNaN(z)||z<=0?F.target.setCustomValidity("Geçerli bir sayı giriniz (0'dan büyük)"):z>L?F.target.setCustomValidity(`Maksimum: ${L} ${B==null?void 0:B.unit}`):F.target.setCustomValidity("")},required:!0,disabled:!v.materialName}),v.materialName&&L>0&&s.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px",fontWeight:"500"},children:["Maksimum: ",L," ",B==null?void 0:B.unit]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Seri/Lot"}),s.jsx("input",{type:"text",className:"excel-form-input",value:v.serialLot,onChange:F=>m({...v,serialLot:F.target.value}),placeholder:"Lot veya seri no"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKT"}),s.jsx("input",{type:"date",className:"excel-form-input",value:v.expiryDate,onChange:F=>m({...v,expiryDate:F.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Teslim Eden *"}),s.jsx("input",{type:"text",className:"excel-form-input",value:v.issuedBy,onChange:F=>m({...v,issuedBy:F.target.value}),required:!0})]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Açıklama"}),s.jsx("textarea",{className:"excel-form-input",rows:3,value:v.description,onChange:F=>m({...v,description:F.target.value})})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:E.length===0,children:"Kaydet ve İmza Sayfasına Git"}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>h(!1),children:"İptal"})]})]})]}),s.jsxs("div",{className:"filter-section",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Filtrele"}),s.jsx("button",{onClick:w,className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"Filtreleri Temizle"})]}),s.jsxs("div",{className:"filter-row",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Personel"}),s.jsxs("select",{className:"excel-form-select",value:p.employee,onChange:F=>d({...p,employee:F.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),A.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Departman"}),s.jsxs("select",{className:"excel-form-select",value:p.department,onChange:F=>d({...p,department:F.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),I.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Malzeme Adı"}),s.jsxs("select",{className:"excel-form-select",value:p.materialName,onChange:F=>d({...p,materialName:F.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),D.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Başlangıç Tarihi"}),s.jsx("input",{type:"date",className:"excel-form-input",value:p.startDate,onChange:F=>d({...p,startDate:F.target.value})})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Bitiş Tarihi"}),s.jsx("input",{type:"date",className:"excel-form-input",value:p.endDate,onChange:F=>d({...p,endDate:F.target.value})})]})]})]}),s.jsx("div",{className:"table-container",children:c?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz personel çıkışı kaydı bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Veriliş Tarihi"}),s.jsx("th",{children:"Personel"}),s.jsx("th",{children:"Departman"}),s.jsx("th",{children:"Malzeme Adı"}),s.jsx("th",{children:"Verilen Miktar"}),s.jsx("th",{children:"Teslim Eden"}),s.jsx("th",{children:"Depo"}),s.jsx("th",{children:"Açıklama"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(F=>s.jsxs("tr",{children:[s.jsx("td",{children:F.issueDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:F.employee}),s.jsx("td",{children:F.department}),s.jsx("td",{children:F.materialName}),s.jsx("td",{children:F.quantity}),s.jsx("td",{children:F.issuedBy}),s.jsx("td",{children:F.warehouse||"-"}),s.jsx("td",{children:F.description||"-"}),s.jsx("td",{children:s.jsxs("button",{onClick:()=>y(`/zimmet-signature/${F.id}`),className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(y3,{size:14}),"İmza"]})})]},F.id))})]})})]})})}function nL(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState(!0),[o,l]=ue.useState("all"),[c,u]=ue.useState("all"),[f,h]=ue.useState(""),[p,d]=ue.useState(""),[v,m]=ue.useState("");ue.useEffect(()=>{y(),_()},[c]);const y=async()=>{try{i(!0);const E=gt(),A=c==="all"?void 0:c,I=await gc(E==null?void 0:E.companyId,A,f||void 0,p||void 0,v||void 0);t(I)}catch(E){console.error("Stok durumu yüklenirken hata:",E);const A=localStorage.getItem("currentUser"),I=A?JSON.parse(A):null;await ur(`Stok durumu yüklenirken hata: ${E.message||E}`,"StockStatus",I==null?void 0:I.id,I==null?void 0:I.username),alert("Veriler yüklenirken bir hata oluştu")}finally{i(!1)}},_=async()=>{try{const E=gt(),A=await tu(E==null?void 0:E.companyId);a(A)}catch(E){console.error("Depolar yüklenirken hata:",E)}},k=()=>{const E=o==="all"?e:e.filter(A=>A.status===o);eL(E,`stok_durumu_${new Date().toISOString().split("T")[0]}.xlsx`)},g=E=>{switch(E){case"green":return s.jsx("span",{className:"status-green",children:"Yeşil"});case"orange":return s.jsx("span",{className:"status-orange",children:"Turuncu"});case"red":return s.jsx("span",{className:"status-red",children:"Kırmızı"});default:return s.jsx("span",{children:"-"})}},w=o==="all"?e:e.filter(E=>E.status===o),C={all:e.length,green:e.filter(E=>E.status==="green").length,orange:e.filter(E=>E.status==="orange").length,red:e.filter(E=>E.status==="red").length};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Stok Durumu"}),s.jsxs("button",{onClick:k,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Zn,{size:18}),"Excel'e Aktar"]})]}),s.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"0",marginBottom:"20px",border:"2px solid #000"},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"15px"},children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#000"},children:"Depo Filtresi"}),s.jsxs("select",{value:c,onChange:E=>u(E.target.value),style:{padding:"8px 12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",minWidth:"200px",background:"white"},children:[s.jsx("option",{value:"all",children:"Tüm Depolar"}),s.jsx("option",{value:"",children:"Depo Belirtilmemiş"}),r.map(E=>s.jsx("option",{value:E.name,children:E.name},E.id))]})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#000"},children:"SKU"}),s.jsx("input",{type:"text",value:f,onChange:E=>h(E.target.value),style:{padding:"8px 12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"},placeholder:"SKU"})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#000"},children:"Varyant"}),s.jsx("input",{type:"text",value:p,onChange:E=>d(E.target.value),style:{padding:"8px 12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"},placeholder:"Renk/beden"})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#000"},children:"Raf/Göz"}),s.jsx("input",{type:"text",value:v,onChange:E=>m(E.target.value),style:{padding:"8px 12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"},placeholder:"Bin kodu"})]})]}),s.jsxs("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap",alignItems:"center"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#000"},children:"Durum Filtresi:"}),s.jsxs("button",{onClick:()=>l("all"),className:"btn",style:{background:o==="all"?"#000":"#fff",color:o==="all"?"white":"#000",border:"2px solid #000",padding:"8px 16px",fontSize:"12px",fontWeight:"600",letterSpacing:"0.5px",textTransform:"uppercase"},children:["Tümü (",C.all,")"]}),s.jsxs("button",{onClick:()=>l("green"),className:"btn",style:{background:o==="green"?"#28a745":"#fff",color:o==="green"?"white":"#000",border:o==="green"?"2px solid #28a745":"2px solid #000",padding:"8px 16px",fontSize:"12px",fontWeight:"600",letterSpacing:"0.5px",textTransform:"uppercase"},children:["Yeşil (",C.green,")"]}),s.jsxs("button",{onClick:()=>l("orange"),className:"btn",style:{background:o==="orange"?"#ffc107":"#fff",color:"#000",border:o==="orange"?"2px solid #ffc107":"2px solid #000",padding:"8px 16px",fontSize:"12px",fontWeight:"600",letterSpacing:"0.5px",textTransform:"uppercase"},children:["Turuncu (",C.orange,")"]}),s.jsxs("button",{onClick:()=>l("red"),className:"btn",style:{background:o==="red"?"#dc3545":"#fff",color:o==="red"?"white":"#000",border:o==="red"?"2px solid #dc3545":"2px solid #000",padding:"8px 16px",fontSize:"12px",fontWeight:"600",letterSpacing:"0.5px",textTransform:"uppercase"},children:["Kırmızı (",C.red,")"]})]})]}),s.jsx("div",{style:{background:"#fff",border:"2px solid #000",borderRadius:"0",padding:"20px",marginBottom:"20px",fontSize:"13px",color:"#000"},children:s.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"12px"},children:[s.jsx(Ny,{size:20,color:"#000",style:{flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("strong",{style:{fontSize:"14px",fontWeight:"700",letterSpacing:"0.3px",textTransform:"uppercase"},children:"Durum Açıklamaları:"}),s.jsxs("ul",{style:{marginTop:"12px",paddingLeft:"20px",lineHeight:"1.8"},children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Yeşil:"})," Mevcut stok kritik seviyenin üstünde"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Turuncu:"})," Mevcut stok kritik seviyeye yaklaşıyor (kritik seviyenin 1.5 katına kadar)"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Kırmızı:"})," Mevcut stok kritik seviyenin altında veya sıfır"]})]}),s.jsx("p",{style:{marginTop:"12px",marginBottom:0,fontSize:"12px",color:"#666"},children:"Bu sayfa otomatik olarak hesaplanır. Stok giriş ve çıkışlarına göre güncellenir."})]})]})}),s.jsx("div",{className:"table-container",children:n?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):w.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:o==="all"?"Henüz stok durumu kaydı bulunmamaktadır.":"Bu durumda stok bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Malzeme Adı"}),s.jsx("th",{children:"Varyant"}),s.jsx("th",{children:"Depo"}),s.jsx("th",{children:"Raf/Göz"}),s.jsx("th",{children:"Toplam Giriş"}),s.jsx("th",{children:"Toplam Çıkış"}),s.jsx("th",{children:"Mevcut Stok"}),s.jsx("th",{children:"Kritik Seviye"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Birim"})]})}),s.jsx("tbody",{children:w.map(E=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:E.sku||"-"}),s.jsx("td",{style:{fontWeight:"500"},children:E.materialName}),s.jsx("td",{children:E.variant||s.jsx("span",{style:{color:"#999"},children:"-"})}),s.jsx("td",{children:E.warehouse||s.jsx("span",{style:{color:"#999"},children:"-"})}),s.jsx("td",{children:E.binCode||s.jsx("span",{style:{color:"#999"},children:"-"})}),s.jsx("td",{children:E.totalEntry}),s.jsx("td",{children:E.totalOutput}),s.jsx("td",{style:{fontWeight:"700",color:E.status==="red"?"#dc3545":E.status==="orange"?"#ffc107":"#28a745"},children:E.currentStock}),s.jsx("td",{children:E.criticalLevel}),s.jsx("td",{children:g(E.status)}),s.jsx("td",{children:E.unit})]},E.id))})]})})]})})}var x4={exports:{}};/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function dl(e,t,r){this.x=e,this.y=t,this.time=r||new Date().getTime()}dl.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1};dl.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))};dl.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time};function ax(e,t,r,a){this.startPoint=e,this.control1=t,this.control2=r,this.endPoint=a}ax.prototype.length=function(){for(var e=10,t=0,r=void 0,a=void 0,n=0;n<=e;n+=1){var i=n/e,o=this._point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),l=this._point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){var c=o-r,u=l-a;t+=Math.sqrt(c*c+u*u)}r=o,a=l}return t};ax.prototype._point=function(e,t,r,a,n){return t*(1-e)*(1-e)*(1-e)+3*r*(1-e)*(1-e)*e+3*a*(1-e)*e*e+n*e*e*e};function iL(e,t,r){var a,n,i,o=null,l=0;r||(r={});var c=function(){l=r.leading===!1?0:Date.now(),o=null,i=e.apply(a,n),o||(a=n=null)};return function(){var u=Date.now();!l&&r.leading===!1&&(l=u);var f=t-(u-l);return a=this,n=arguments,f<=0||f>t?(o&&(clearTimeout(o),o=null),l=u,i=e.apply(a,n),o||(a=n=null)):!o&&r.trailing!==!1&&(o=setTimeout(c,f)),i}}function Rr(e,t){var r=this,a=t||{};this.velocityFilterWeight=a.velocityFilterWeight||.7,this.minWidth=a.minWidth||.5,this.maxWidth=a.maxWidth||2.5,this.throttle="throttle"in a?a.throttle:16,this.minDistance="minDistance"in a?a.minDistance:5,this.throttle?this._strokeMoveUpdate=iL(Rr.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=Rr.prototype._strokeUpdate,this.dotSize=a.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=a.penColor||"black",this.backgroundColor=a.backgroundColor||"rgba(0,0,0,0)",this.onBegin=a.onBegin,this.onEnd=a.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(n){n.which===1&&(r._mouseButtonDown=!0,r._strokeBegin(n))},this._handleMouseMove=function(n){r._mouseButtonDown&&r._strokeMoveUpdate(n)},this._handleMouseUp=function(n){n.which===1&&r._mouseButtonDown&&(r._mouseButtonDown=!1,r._strokeEnd(n))},this._handleTouchStart=function(n){if(n.targetTouches.length===1){var i=n.changedTouches[0];r._strokeBegin(i)}},this._handleTouchMove=function(n){n.preventDefault();var i=n.targetTouches[0];r._strokeMoveUpdate(i)},this._handleTouchEnd=function(n){var i=n.target===r._canvas;i&&(n.preventDefault(),r._strokeEnd(n))},this.on()}Rr.prototype.clear=function(){var e=this._ctx,t=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(),this._isEmpty=!0};Rr.prototype.fromDataURL=function(e){var t=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=new Image,n=r.ratio||window.devicePixelRatio||1,i=r.width||this._canvas.width/n,o=r.height||this._canvas.height/n;this._reset(),a.src=e,a.onload=function(){t._ctx.drawImage(a,0,0,i,o)},this._isEmpty=!1};Rr.prototype.toDataURL=function(e){var t;switch(e){case"image/svg+xml":return this._toSVG();default:for(var r=arguments.length,a=Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return(t=this._canvas).toDataURL.apply(t,[e].concat(a))}};Rr.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};Rr.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};Rr.prototype.isEmpty=function(){return this._isEmpty};Rr.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),typeof this.onBegin=="function"&&this.onBegin(e)};Rr.prototype._strokeUpdate=function(e){var t=e.clientX,r=e.clientY,a=this._createPoint(t,r),n=this._data[this._data.length-1],i=n&&n[n.length-1],o=i&&a.distanceTo(i)<this.minDistance;if(!(i&&o)){var l=this._addPoint(a),c=l.curve,u=l.widths;c&&u&&this._drawCurve(c,u.start,u.end),this._data[this._data.length-1].push({x:a.x,y:a.y,time:a.time,color:this.penColor})}};Rr.prototype._strokeEnd=function(e){var t=this.points.length>2,r=this.points[0];if(!t&&r&&this._drawDot(r),r){var a=this._data[this._data.length-1],n=a[a.length-1];r.equals(n)||a.push({x:r.x,y:r.y,time:r.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(e)};Rr.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};Rr.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};Rr.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};Rr.prototype._createPoint=function(e,t,r){var a=this._canvas.getBoundingClientRect();return new dl(e-a.left,t-a.top,r||new Date().getTime())};Rr.prototype._addPoint=function(e){var t=this.points,r=void 0;if(t.push(e),t.length>2){t.length===3&&t.unshift(t[0]),r=this._calculateCurveControlPoints(t[0],t[1],t[2]);var a=r.c2;r=this._calculateCurveControlPoints(t[1],t[2],t[3]);var n=r.c1,i=new ax(t[1],a,n,t[2]),o=this._calculateCurveWidths(i);return t.shift(),{curve:i,widths:o}}return{}};Rr.prototype._calculateCurveControlPoints=function(e,t,r){var a=e.x-t.x,n=e.y-t.y,i=t.x-r.x,o=t.y-r.y,l={x:(e.x+t.x)/2,y:(e.y+t.y)/2},c={x:(t.x+r.x)/2,y:(t.y+r.y)/2},u=Math.sqrt(a*a+n*n),f=Math.sqrt(i*i+o*o),h=l.x-c.x,p=l.y-c.y,d=f/(u+f),v={x:c.x+h*d,y:c.y+p*d},m=t.x-v.x,y=t.y-v.y;return{c1:new dl(l.x+m,l.y+y),c2:new dl(c.x+m,c.y+y)}};Rr.prototype._calculateCurveWidths=function(e){var t=e.startPoint,r=e.endPoint,a={start:null,end:null},n=this.velocityFilterWeight*r.velocityFrom(t)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(n);return a.start=this._lastWidth,a.end=i,this._lastVelocity=n,this._lastWidth=i,a};Rr.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)};Rr.prototype._drawPoint=function(e,t,r){var a=this._ctx;a.moveTo(e,t),a.arc(e,t,r,0,2*Math.PI,!1),this._isEmpty=!1};Rr.prototype._drawCurve=function(e,t,r){var a=this._ctx,n=r-t,i=Math.floor(e.length());a.beginPath();for(var o=0;o<i;o+=1){var l=o/i,c=l*l,u=c*l,f=1-l,h=f*f,p=h*f,d=p*e.startPoint.x;d+=3*h*l*e.control1.x,d+=3*f*c*e.control2.x,d+=u*e.endPoint.x;var v=p*e.startPoint.y;v+=3*h*l*e.control1.y,v+=3*f*c*e.control2.y,v+=u*e.endPoint.y;var m=t+u*n;this._drawPoint(d,v,m)}a.closePath(),a.fill()};Rr.prototype._drawDot=function(e){var t=this._ctx,r=typeof this.dotSize=="function"?this.dotSize():this.dotSize;t.beginPath(),this._drawPoint(e.x,e.y,r),t.closePath(),t.fill()};Rr.prototype._fromData=function(e,t,r){for(var a=0;a<e.length;a+=1){var n=e[a];if(n.length>1)for(var i=0;i<n.length;i+=1){var o=n[i],l=new dl(o.x,o.y,o.time),c=o.color;if(i===0)this.penColor=c,this._reset(),this._addPoint(l);else if(i!==n.length-1){var u=this._addPoint(l),f=u.curve,h=u.widths;f&&h&&t(f,h,c)}}else{this._reset();var p=n[0];r(p)}}};Rr.prototype._toSVG=function(){var e=this,t=this._data,r=this._canvas,a=Math.max(window.devicePixelRatio||1,1),n=0,i=0,o=r.width/a,l=r.height/a,c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS(null,"width",r.width),c.setAttributeNS(null,"height",r.height),this._fromData(t,function(_,k,g){var w=document.createElement("path");if(!isNaN(_.control1.x)&&!isNaN(_.control1.y)&&!isNaN(_.control2.x)&&!isNaN(_.control2.y)){var C="M "+_.startPoint.x.toFixed(3)+","+_.startPoint.y.toFixed(3)+" "+("C "+_.control1.x.toFixed(3)+","+_.control1.y.toFixed(3)+" ")+(_.control2.x.toFixed(3)+","+_.control2.y.toFixed(3)+" ")+(_.endPoint.x.toFixed(3)+","+_.endPoint.y.toFixed(3));w.setAttribute("d",C),w.setAttribute("stroke-width",(k.end*2.25).toFixed(3)),w.setAttribute("stroke",g),w.setAttribute("fill","none"),w.setAttribute("stroke-linecap","round"),c.appendChild(w)}},function(_){var k=document.createElement("circle"),g=typeof e.dotSize=="function"?e.dotSize():e.dotSize;k.setAttribute("r",g),k.setAttribute("cx",_.x),k.setAttribute("cy",_.y),k.setAttribute("fill",_.color),c.appendChild(k)});var u="data:image/svg+xml;base64,",f='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+n+" "+i+" "+o+" "+l+'"')+(' width="'+o+'"')+(' height="'+l+'"')+">",h=c.innerHTML;if(h===void 0){var p=document.createElement("dummy"),d=c.childNodes;p.innerHTML="";for(var v=0;v<d.length;v+=1)p.appendChild(d[v].cloneNode(!0));h=p.innerHTML}var m="</svg>",y=f+h+m;return u+btoa(y)};Rr.prototype.fromData=function(e){var t=this;this.clear(),this._fromData(e,function(r,a){return t._drawCurve(r,a.start,a.end)},function(r){return t._drawDot(r)}),this._data=e};Rr.prototype.toData=function(){return this._data};const sL=Object.freeze(Object.defineProperty({__proto__:null,default:Rr},Symbol.toStringTag,{value:"Module"})),oL=yk(sL);var rp={exports:{}},$2;function lL(){return $2||($2=1,function(e,t){(function(r,a){e.exports=a()})(my,function(){return function(r){function a(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return r[i].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}var n={};return a.m=r,a.c=n,a.p="",a(0)}([function(r,a){function n(u){var f=u.getContext("2d"),h=u.width,p=u.height,d=f.getImageData(0,0,h,p).data,v=l(!0,h,p,d),m=l(!1,h,p,d),y=c(!0,h,p,d),_=c(!1,h,p,d),k=_-y+1,g=m-v+1,w=f.getImageData(y,v,k,g);return u.width=k,u.height=g,f.clearRect(0,0,k,g),f.putImageData(w,0,0),u}function i(u,f,h,p){return{red:p[4*(h*f+u)],green:p[4*(h*f+u)+1],blue:p[4*(h*f+u)+2],alpha:p[4*(h*f+u)+3]}}function o(u,f,h,p){return i(u,f,h,p).alpha}function l(u,f,h,p){for(var d=u?1:-1,v=u?0:h-1,m=v;u?m<h:m>-1;m+=d)for(var y=0;y<f;y++)if(o(y,m,f,p))return m;return null}function c(u,f,h,p){for(var d=u?1:-1,v=u?0:f-1,m=v;u?m<f:m>-1;m+=d)for(var y=0;y<h;y++)if(o(m,y,f,p))return m;return null}Object.defineProperty(a,"__esModule",{value:!0}),a.default=n}])})}(rp)),rp.exports}(function(e,t){(function(r,a){e.exports=a(Mk(),ue,oL,lL())})(my,function(r,a,n,i){return function(o){function l(u){if(c[u])return c[u].exports;var f=c[u]={exports:{},id:u,loaded:!1};return o[u].call(f.exports,f,f.exports,l),f.loaded=!0,f.exports}var c={};return l.m=o,l.c=c,l.p="",l(0)}([function(o,l,c){function u(D){return D&&D.__esModule?D:{default:D}}function f(D,B){var L={};for(var F in D)B.indexOf(F)>=0||Object.prototype.hasOwnProperty.call(D,F)&&(L[F]=D[F]);return L}function h(D,B){if(!(D instanceof B))throw new TypeError("Cannot call a class as a function")}function p(D,B){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!B||typeof B!="object"&&typeof B!="function"?D:B}function d(D,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);D.prototype=Object.create(B&&B.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(D,B):D.__proto__=B)}Object.defineProperty(l,"__esModule",{value:!0});var v=Object.assign||function(D){for(var B=1;B<arguments.length;B++){var L=arguments[B];for(var F in L)Object.prototype.hasOwnProperty.call(L,F)&&(D[F]=L[F])}return D},m=function(){function D(B,L){for(var F=0;F<L.length;F++){var z=L[F];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(B,z.key,z)}}return function(B,L,F){return L&&D(B.prototype,L),F&&D(B,F),B}}(),y=c(1),_=u(y),k=c(2),g=u(k),w=c(3),C=u(w),E=c(4),A=u(E),I=function(D){function B(){var L,F,z,M;h(this,B);for(var q=arguments.length,fe=Array(q),he=0;he<q;he++)fe[he]=arguments[he];return F=z=p(this,(L=B.__proto__||Object.getPrototypeOf(B)).call.apply(L,[this].concat(fe))),z._sigPad=null,z._excludeOurProps=function(){var pe=z.props,Q=(pe.canvasProps,pe.clearOnResize,f(pe,["canvasProps","clearOnResize"]));return Q},z.getCanvas=function(){return z._canvas},z.getTrimmedCanvas=function(){var pe=document.createElement("canvas");return pe.width=z._canvas.width,pe.height=z._canvas.height,pe.getContext("2d").drawImage(z._canvas,0,0),(0,A.default)(pe)},z.getSignaturePad=function(){return z._sigPad},z._checkClearOnResize=function(){z.props.clearOnResize&&z._resizeCanvas()},z._resizeCanvas=function(){var pe=z.props.canvasProps||{},Q=pe.width,we=pe.height;if(!Q||!we){var Y=z._canvas,T=Math.max(window.devicePixelRatio||1,1);Q||(Y.width=Y.offsetWidth*T),we||(Y.height=Y.offsetHeight*T),Y.getContext("2d").scale(T,T),z.clear()}},z.on=function(){return window.addEventListener("resize",z._checkClearOnResize),z._sigPad.on()},z.off=function(){return window.removeEventListener("resize",z._checkClearOnResize),z._sigPad.off()},z.clear=function(){return z._sigPad.clear()},z.isEmpty=function(){return z._sigPad.isEmpty()},z.fromDataURL=function(pe,Q){return z._sigPad.fromDataURL(pe,Q)},z.toDataURL=function(pe,Q){return z._sigPad.toDataURL(pe,Q)},z.fromData=function(pe){return z._sigPad.fromData(pe)},z.toData=function(){return z._sigPad.toData()},M=F,p(z,M)}return d(B,D),m(B,[{key:"componentDidMount",value:function(){this._sigPad=new C.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var L=this,F=this.props.canvasProps;return g.default.createElement("canvas",v({ref:function(z){L._canvas=z}},F))}}]),B}(k.Component);I.propTypes={velocityFilterWeight:_.default.number,minWidth:_.default.number,maxWidth:_.default.number,minDistance:_.default.number,dotSize:_.default.oneOfType([_.default.number,_.default.func]),penColor:_.default.string,throttle:_.default.number,onEnd:_.default.func,onBegin:_.default.func,canvasProps:_.default.object,clearOnResize:_.default.bool},I.defaultProps={clearOnResize:!0},l.default=I},function(o,l){o.exports=r},function(o,l){o.exports=a},function(o,l){o.exports=n},function(o,l){o.exports=i}])})})(x4);var cL=x4.exports;const V2=bk(cL);function uL(){const{outputId:e}=wk(),t=$0(),[r,a]=ue.useState(null),[n,i]=ue.useState(!0),[o,l]=ue.useState(null),[c,u]=ue.useState(null),[f,h]=ue.useState("");ue.useEffect(()=>{p()},[e]);const p=async()=>{try{if(!e)return;const y=ir(qe,"stockOutputs",e),_=await xy(y);if(_.exists()){const k=_.data();a({employee:k.employee,department:k.department,materialName:k.materialName,quantity:k.quantity,issueDate:k.issueDate.toDate(),returnDate:k.returnDate||"",employeeSignature:k.employeeSignature||"",authorizedSignature:k.authorizedSignature||""}),h(k.returnDate||"")}}catch(y){console.error("Zimmet verisi yüklenirken hata:",y),alert("Veri yüklenirken bir hata oluştu")}finally{i(!1)}},d=async()=>{try{if(!e||!o||!c){alert("Lütfen her iki imzayı da tamamlayın");return}const y=o.toDataURL(),_=c.toDataURL();if(y===o.toDataURL("image/png")&&o.isEmpty()){alert("Lütfen personel imzasını ekleyin");return}if(_===c.toDataURL("image/png")&&c.isEmpty()){alert("Lütfen yetkili imzasını ekleyin");return}const k=ir(qe,"stockOutputs",e);await Xr(k,{employeeSignature:y,authorizedSignature:_,returnDate:f||null}),alert("İmzalar başarıyla kaydedildi!"),t("/stock-output")}catch(y){console.error("İmzalar kaydedilirken hata:",y),alert("İmzalar kaydedilirken bir hata oluştu")}},v=()=>{window.print()},m=y=>{y==="employee"&&o?o.clear():y==="authorized"&&c&&c.clear()};return n?s.jsx(nr,{children:s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."})}):r?s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Zimmet İmza Sayfası"}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsxs("button",{onClick:()=>t("/stock-output"),className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(d3,{size:18}),"Geri"]}),s.jsxs("button",{onClick:v,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Zn,{size:18}),"Yazdır"]}),s.jsxs("button",{onClick:d,className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(oa,{size:18}),"Kaydet"]})]})]}),s.jsxs("div",{id:"zimmet-form",style:{background:"white",width:"210mm",minHeight:"297mm",margin:"0 auto",padding:"20mm",boxShadow:"0 0 10px rgba(0,0,0,0.1)",fontSize:"14px",lineHeight:"1.6"},children:[s.jsx("div",{style:{textAlign:"center",marginBottom:"30px",borderBottom:"2px solid #333",paddingBottom:"15px"},children:s.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",margin:0},children:"ZİMMET TUTANAĞI"})}),s.jsx("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"30px"},children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"8px",border:"1px solid #333",fontWeight:"600",width:"30%"},children:"Personel Adı:"}),s.jsx("td",{style:{padding:"8px",border:"1px solid #333"},children:r.employee})]}),s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"8px",border:"1px solid #333",fontWeight:"600"},children:"Departman:"}),s.jsx("td",{style:{padding:"8px",border:"1px solid #333"},children:r.department})]}),s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"8px",border:"1px solid #333",fontWeight:"600"},children:"Malzeme:"}),s.jsx("td",{style:{padding:"8px",border:"1px solid #333"},children:r.materialName})]}),s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"8px",border:"1px solid #333",fontWeight:"600"},children:"Miktar:"}),s.jsx("td",{style:{padding:"8px",border:"1px solid #333"},children:r.quantity})]}),s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"8px",border:"1px solid #333",fontWeight:"600"},children:"Veriliş Tarihi:"}),s.jsx("td",{style:{padding:"8px",border:"1px solid #333"},children:r.issueDate.toLocaleDateString("tr-TR")})]}),s.jsxs("tr",{children:[s.jsx("td",{style:{padding:"8px",border:"1px solid #333",fontWeight:"600"},children:"İade Tarihi:"}),s.jsx("td",{style:{padding:"8px",border:"1px solid #333"},children:s.jsx("input",{type:"date",value:f,onChange:y=>h(y.target.value),style:{width:"100%",padding:"4px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px"}})})]})]})}),s.jsxs("div",{style:{marginTop:"40px"},children:[s.jsxs("div",{style:{marginBottom:"30px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"10px"},children:"Personel İmzası:"}),s.jsx("div",{style:{border:"2px solid #333",borderRadius:"4px",background:"#f9f9f9",marginBottom:"10px"},children:r.employeeSignature?s.jsx("img",{src:r.employeeSignature,alt:"Personel İmzası",style:{width:"100%",maxHeight:"150px",objectFit:"contain"}}):s.jsx(V2,{ref:y=>l(y),canvasProps:{width:600,height:150,className:"signature-canvas"},backgroundColor:"#f9f9f9"})}),!r.employeeSignature&&s.jsx("button",{onClick:()=>m("employee"),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"Temizle"})]}),s.jsxs("div",{style:{marginTop:"40px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"10px"},children:"Yetkili İmzası:"}),s.jsx("div",{style:{border:"2px solid #333",borderRadius:"4px",background:"#f9f9f9",marginBottom:"10px"},children:r.authorizedSignature?s.jsx("img",{src:r.authorizedSignature,alt:"Yetkili İmzası",style:{width:"100%",maxHeight:"150px",objectFit:"contain"}}):s.jsx(V2,{ref:y=>u(y),canvasProps:{width:600,height:150,className:"signature-canvas"},backgroundColor:"#f9f9f9"})}),!r.authorizedSignature&&s.jsx("button",{onClick:()=>m("authorized"),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"Temizle"})]})]}),s.jsx("div",{style:{marginTop:"50px",fontSize:"12px",color:"#666",textAlign:"center"},children:s.jsx("p",{children:"Bu belge elektronik ortamda oluşturulmuştur ve geçerlidir."})})]}),s.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            #zimmet-form, #zimmet-form * {
              visibility: visible;
            }
            #zimmet-form {
              position: absolute;
              left: 0;
              top: 0;
              width: 210mm;
              box-shadow: none;
            }
            button {
              display: none !important;
            }
          }
        `})]})}):s.jsx(nr,{children:s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Zimmet verisi bulunamadı"})})}function fL(){var g;const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({name:"",department:""}),[f,h]=ue.useState({name:"",department:"",email:"",phone:"",employeeId:"",permissions:[]});ue.useEffect(()=>{d()},[c]);const p=async()=>{try{a(!0);const w=gt();if(!(w!=null&&w.companyCode)){alert("Şirket kodunuz bulunamadı. Lütfen admin ile iletişime geçin.");return}const{collection:C,getDocs:E,query:A,where:I}=await xi(async()=>{const{collection:z,getDocs:M,query:q,where:fe}=await import("./firebase-Dq6vfPGW.js").then(he=>he.m);return{collection:z,getDocs:M,query:q,where:fe}},[]),{db:D}=await xi(async()=>{const{db:z}=await Promise.resolve().then(()=>_y);return{db:z}},void 0),B=A(C(D,"users"),I("companyCode","==",w.companyCode)),F=(await E(B)).docs.map(z=>({id:z.id,...z.data()}));if(F.length===0){alert("Bu şirket kodu ile eşleşen kullanıcı bulunamadı.");return}for(const z of F){if(!z.companyId&&w.companyId){const{doc:M,updateDoc:q,Timestamp:fe}=await xi(async()=>{const{doc:he,updateDoc:pe,Timestamp:Q}=await import("./firebase-Dq6vfPGW.js").then(we=>we.m);return{doc:he,updateDoc:pe,Timestamp:Q}},[]);await q(M(D,"users",z.id),{companyId:w.companyId,companyName:z.companyName||"",updatedAt:fe.now()}),z.companyId=w.companyId}await jp(z)}await d(),alert(`${F.length} kullanıcı kontrol edildi ve personel kayıtları güncellendi.`)}catch(w){console.error("Personel kontrolü hata:",w),alert("Personel kontrolü sırasında hata oluştu.")}finally{a(!1)}},d=async()=>{try{a(!0);const w=gt(),C={companyId:w==null?void 0:w.companyId};c.name&&(C.name=c.name),c.department&&(C.department=c.department);const E=await ud(C);t(E)}catch(w){console.error("Personel listesi yüklenirken hata:",w);const C=localStorage.getItem("currentUser"),E=C?JSON.parse(C):null;await ur(`Personel listesi yüklenirken hata: ${w.message||w}`,"PersonnelManagement",E==null?void 0:E.id,E==null?void 0:E.username),alert("Veriler yüklenirken bir hata oluştu")}finally{a(!1)}},v=async w=>{if(w.preventDefault(),!f.name||!f.department){alert("Ad ve Departman zorunludur");return}try{const C=gt(),{permissions:E,...A}=f,I={...A,permissions:E.length>0?E:void 0,companyId:C==null?void 0:C.companyId};o?(await Zk(o,I),alert("Personel başarıyla güncellendi!")):(await v1(I),alert("Personel başarıyla eklendi!")),i(!1),l(null),h({name:"",department:"",email:"",phone:"",employeeId:"",permissions:[]}),d()}catch(C){const E=localStorage.getItem("currentUser"),A=E?JSON.parse(E):null;await ur(`Personel kaydedilirken hata: ${C.message||C}`,"PersonnelManagement",A==null?void 0:A.id,A==null?void 0:A.username),alert("Hata: "+(C.message||"Personel kaydedilirken bir hata oluştu"))}},m=w=>{l(w.id||null),h({name:w.name,department:w.department,email:w.email||"",phone:w.phone||"",employeeId:w.employeeId||"",permissions:w.permissions||[]}),i(!0)},y=async w=>{if(confirm("Bu personeli silmek istediğinize emin misiniz?"))try{await Qk(w),alert("Personel başarıyla silindi!"),d()}catch(C){alert("Hata: "+(C.message||"Personel silinirken bir hata oluştu"))}},_=()=>{i(!1),l(null),h({name:"",department:"",email:"",phone:"",employeeId:"",permissions:[]})},k=Array.from(new Set(e.map(w=>w.department))).filter(Boolean);return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",gap:"12px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(fc,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Personel Yönetimi"})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[((g=ml())==null?void 0:g.role)==="manager"&&s.jsxs("button",{className:"btn btn-secondary",onClick:p,disabled:r,style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(fc,{size:16}),"Kullanıcıları Tara"]}),s.jsxs("button",{onClick:()=>i(!0),className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Personel Ekle"]})]})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",marginBottom:"20px",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Personel Adı"}),s.jsx("input",{type:"text",value:c.name,onChange:w=>u({...c,name:w.target.value}),placeholder:"Ara...",style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Departman"}),s.jsxs("select",{value:c.department,onChange:w=>u({...c,department:w.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tümü"}),k.map(w=>s.jsx("option",{value:w,children:w},w))]})]})]}),n&&s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"30px",marginBottom:"30px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"20px",color:"#000"},children:o?"Personel Düzenle":"Yeni Personel Ekle"}),s.jsxs("form",{onSubmit:v,children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Ad Soyad ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"text",value:f.name,onChange:w=>h({...f,name:w.target.value}),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Departman ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"text",value:f.department,onChange:w=>h({...f,department:w.target.value}),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Personel No"}),s.jsx("input",{type:"text",value:f.employeeId,onChange:w=>h({...f,employeeId:w.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Email"}),s.jsx("input",{type:"email",value:f.email,onChange:w=>h({...f,email:w.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Telefon"}),s.jsx("input",{type:"tel",value:f.phone,onChange:w=>h({...f,phone:w.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsxs("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"2px solid #000"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"15px",color:"#000"},children:"Yetkiler"}),s.jsx("p",{style:{fontSize:"12px",color:"#666",marginBottom:"15px"},children:"Bu personelin hangi alanlarda işlem yapabileceğini seçin:"}),s.jsx("div",{style:{display:"grid",gap:"16px"},children:I3.map(w=>s.jsxs("div",{style:{border:"1px solid #ddd",padding:"12px"},children:[s.jsx("div",{style:{fontWeight:700,marginBottom:"8px",fontSize:"14px"},children:w.title}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"10px"},children:w.items.map(C=>s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",border:"1px solid #ccc",cursor:"pointer",background:f.permissions.includes(C)?"#f0f0f0":"white",transition:"all 0.2s"},onMouseEnter:E=>{f.permissions.includes(C)||(E.currentTarget.style.background="#f9f9f9")},onMouseLeave:E=>{f.permissions.includes(C)||(E.currentTarget.style.background="white")},children:[s.jsx("input",{type:"checkbox",checked:f.permissions.includes(C),onChange:E=>{E.target.checked?h({...f,permissions:[...f.permissions,C]}):h({...f,permissions:f.permissions.filter(A=>A!==C)})},style:{width:"18px",height:"18px",cursor:"pointer",transform:"scale(1.1)"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#000"},children:xo[C].label}),s.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"2px"},children:xo[C].description})]})]},C))})]},w.title))})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(oa,{size:18}),o?"Güncelle":"Kaydet"]}),s.jsx("button",{type:"button",onClick:_,className:"btn btn-secondary",children:"İptal"})]})]})]}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz personel kaydı bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Ad Soyad"}),s.jsx("th",{children:"Departman"}),s.jsx("th",{children:"Personel No"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Telefon"}),s.jsx("th",{children:"Yetkiler"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:e.map(w=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:w.name}),s.jsx("td",{children:w.department}),s.jsx("td",{children:w.employeeId||"-"}),s.jsx("td",{children:w.email||"-"}),s.jsx("td",{children:w.phone||"-"}),s.jsx("td",{children:w.permissions&&w.permissions.length>0?s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:w.permissions.map(C=>s.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",background:"#000",color:"#fff",borderRadius:"2px"},children:xo[C].label},C))}):s.jsx("span",{style:{color:"#999",fontSize:"12px"},children:"Yetki yok"})}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs("button",{onClick:()=>m(w),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(jn,{size:14}),"Düzenle"]}),s.jsxs("button",{onClick:()=>w.id&&y(w.id),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",color:"#dc3545"},children:[s.jsx(ea,{size:14}),"Sil"]})]})})]},w.id))})]})})]})})}const nx="orders",g4=async e=>{try{return(await Or(lt(qe,nx),{...e,orderDate:Ye.fromDate(e.orderDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id}catch(t){throw console.error("Sipariş eklenirken hata:",t),t}},Md=async e=>{try{let t=Ke(lt(qe,nx),ua("orderDate","desc"));return e!=null&&e.companyId&&(t=Ke(t,ot("companyId","==",e.companyId))),e!=null&&e.status&&(t=Ke(t,ot("status","==",e.status))),e!=null&&e.supplier&&(t=Ke(t,ot("supplier","==",e.supplier))),e!=null&&e.customerId&&(t=Ke(t,ot("customerId","==",e.customerId))),e!=null&&e.startDate&&(t=Ke(t,ot("orderDate",">=",Ye.fromDate(e.startDate)))),e!=null&&e.endDate&&(t=Ke(t,ot("orderDate","<=",Ye.fromDate(e.endDate)))),(await lr(t)).docs.map(a=>{var n,i,o;return{id:a.id,...a.data(),orderDate:(n=a.data().orderDate)==null?void 0:n.toDate(),createdAt:(i=a.data().createdAt)==null?void 0:i.toDate(),updatedAt:(o=a.data().updatedAt)==null?void 0:o.toDate()}})}catch(t){throw console.error("Sipariş listesi yüklenirken hata:",t),t}},rd=async(e,t)=>{try{const r=ir(qe,nx,e),a={...t,updatedAt:Ye.now()};t.orderDate&&(a.orderDate=Ye.fromDate(t.orderDate)),await Xr(r,a)}catch(r){throw console.error("Sipariş güncellenirken hata:",r),r}},zd="customers",dL=async e=>{try{return(await Or(lt(qe,zd),{...e,balance:e.balance||0,createdAt:Ye.now(),updatedAt:Ye.now()})).id}catch(t){throw console.error("Müşteri eklenirken hata:",t),t}},To=async e=>{try{let t=Ke(lt(qe,zd),ua("name","asc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var n,i;return{id:a.id,...a.data(),balance:a.data().balance||0,createdAt:(n=a.data().createdAt)==null?void 0:n.toDate(),updatedAt:(i=a.data().updatedAt)==null?void 0:i.toDate()}})}catch(t){throw console.error("Müşteri listesi yüklenirken hata:",t),t}},hL=async(e,t)=>{try{const r=ir(qe,zd,e);await Xr(r,{...t,updatedAt:Ye.now()})}catch(r){throw console.error("Müşteri güncellenirken hata:",r),r}},pL=async e=>{try{const t=ir(qe,zd,e);await os(t)}catch(t){throw console.error("Müşteri silinirken hata:",t),t}},Ud="priceRules",ad=e=>e?Ye.fromDate(e):void 0,mL=async e=>(await Or(lt(qe,Ud),{...e,startDate:ad(e.startDate),endDate:ad(e.endDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,Wd=async e=>{let t=Ke(lt(qe,Ud));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l,c;const n=a.data();return{id:a.id,...n,startDate:(i=n.startDate)!=null&&i.toDate?n.startDate.toDate():n.startDate,endDate:(o=n.endDate)!=null&&o.toDate?n.endDate.toDate():n.endDate,createdAt:(l=n.createdAt)!=null&&l.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(c=n.updatedAt)!=null&&c.toDate?n.updatedAt.toDate():n.updatedAt}})},ix=(e,t,r,a,n,i)=>{const o=new Date,l=f=>{const h=f.startDate?f.startDate<=o:!0,p=f.endDate?f.endDate>=o:!0;return h&&p},c=f=>a.filter(h=>{const p=h.minQuantity?!!n&&n>=h.minQuantity:!0,d=i?h.currency===i:!0;return h.materialName===e&&l(h)&&(f||p)&&d}),u=f=>{const h=f.map(p=>{const d=p.customerId?1:p.customerGroup?2:3;return{r:p,priority:d}}).sort((p,d)=>{if(p.priority!==d.priority)return p.priority-d.priority;const v=p.r.startDate?p.r.startDate.getTime():0;return(d.r.startDate?d.r.startDate.getTime():0)-v});for(const{r:p}of h)if(p.customerId&&t&&p.customerId===t||p.customerGroup&&r&&p.customerGroup===r||!p.customerId&&!p.customerGroup)return p};return u(c(!1))||u(c(!0))},xL=async(e,t)=>{const r=ir(qe,Ud,e),a={...t,updatedAt:Ye.now()};t.startDate&&(a.startDate=ad(t.startDate)),t.endDate&&(a.endDate=ad(t.endDate)),await Xr(r,a)},gL=async e=>{const t=ir(qe,Ud,e);await os(t)};function vL(){var he,pe,Q,we;const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState(!0),[c,u]=ue.useState(!1),[f,h]=ue.useState(null),[p,d]=ue.useState({status:"",supplier:"",customerId:"",startDate:"",endDate:""}),[v,m]=ue.useState({orderNumber:"",orderDate:new Date().toISOString().split("T")[0],supplier:"",customerId:"",customerName:"",status:"pending",items:[],notes:"",currency:"TRY"}),[y,_]=ue.useState({materialName:"",quantity:"",unit:"",unitPrice:"",currency:"TRY",exchangeRate:"1"});ue.useEffect(()=>{w(),g(),k()},[p]);const k=async()=>{try{const Y=gt(),T=await Wd(Y==null?void 0:Y.companyId);i(T)}catch(Y){console.error("Fiyat kuralları yüklenirken hata:",Y)}},g=async()=>{try{const Y=gt(),T=await To(Y==null?void 0:Y.companyId);a(T)}catch(Y){console.error("Müşteriler yüklenirken hata:",Y)}},w=async()=>{try{l(!0);const Y=gt(),T={companyId:Y==null?void 0:Y.companyId};p.status&&(T.status=p.status),p.supplier&&(T.supplier=p.supplier),p.customerId&&(T.customerId=p.customerId),p.startDate&&(T.startDate=new Date(p.startDate)),p.endDate&&(T.endDate=new Date(p.endDate));const R=await Md(T);t(R)}catch(Y){console.error("Sipariş listesi yüklenirken hata:",Y);const T=localStorage.getItem("currentUser"),R=T?JSON.parse(T):null;await ur(`Sipariş listesi yüklenirken hata: ${Y.message||Y}`,"OrderManagement",R==null?void 0:R.id,R==null?void 0:R.username),alert("Veriler yüklenirken bir hata oluştu")}finally{l(!1)}},C=()=>{const Y=new Date,T=Y.getFullYear(),R=String(Y.getMonth()+1).padStart(2,"0"),N=String(Y.getDate()).padStart(2,"0"),O=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`SIP-${T}${R}${N}-${O}`},E=()=>{if(!y.materialName||!y.quantity||!y.unit){alert("Lütfen malzeme, miktar ve birim girin");return}const Y=parseFloat(y.quantity);let T=parseFloat(y.unitPrice);const R=y.currency||v.currency||"TRY",N=y.exchangeRate?parseFloat(y.exchangeRate):1;if(isNaN(Y)||Y<=0){alert("Geçerli sayısal değerler girin");return}if(isNaN(T)||T<=0){const ae=r.find(me=>me.id===v.customerId),de=ix(y.materialName,v.customerId,ae==null?void 0:ae.group,n,Y,R);de?T=de.discountPercent?de.price*(1-de.discountPercent/100):de.price:T=0}const O=R===v.currency?T:T*(N||1),H={materialName:y.materialName,quantity:Y,unit:y.unit,unitPrice:O,totalPrice:Y*O,currency:R,exchangeRate:N||1};m({...v,items:[...v.items,H]}),_({materialName:"",quantity:"",unit:"",unitPrice:"",currency:v.currency,exchangeRate:"1"})},A=Y=>{m({...v,items:v.items.filter((T,R)=>R!==Y)})},I=async Y=>{if(Y.preventDefault(),v.orderNumber||m({...v,orderNumber:C()}),v.items.length===0){alert("En az bir ürün eklemelisiniz");return}const T=v.items.reduce((H,ae)=>H+ae.totalPrice,0),R=r.find(H=>H.id===v.customerId),N=(R==null?void 0:R.balance)||0,O=R==null?void 0:R.creditLimit;if(v.customerId&&O!==void 0&&O>0&&N+T>O){alert(`Kredi limiti aşılıyor. Limit: ${O.toFixed(2)} ₺, Mevcut Bakiye: ${N.toFixed(2)} ₺, Sipariş: ${T.toFixed(2)} ₺`);return}try{const H={orderNumber:v.orderNumber||C(),orderDate:new Date(v.orderDate),customerId:v.customerId||void 0,customerName:v.customerName||void 0,supplier:v.supplier,status:v.status,items:v.items,totalAmount:T,notes:v.notes,currency:v.currency};f?(await rd(f,H),alert("Sipariş başarıyla güncellendi!")):(await g4(H),alert("Sipariş başarıyla eklendi!")),u(!1),h(null),D(),w()}catch(H){const ae=localStorage.getItem("currentUser"),de=ae?JSON.parse(ae):null;await ur(`Sipariş kaydedilirken hata: ${H.message||H}`,"OrderManagement",de==null?void 0:de.id,de==null?void 0:de.username),alert("Hata: "+(H.message||"Sipariş kaydedilirken bir hata oluştu"))}},D=()=>{m({orderNumber:"",orderDate:new Date().toISOString().split("T")[0],supplier:"",customerId:"",customerName:"",status:"pending",items:[],notes:"",currency:"TRY"}),_({materialName:"",quantity:"",unit:"",unitPrice:"",currency:"TRY",exchangeRate:"1"})},B=Y=>{h(Y.id||null),m({orderNumber:Y.orderNumber,orderDate:Y.orderDate.toISOString().split("T")[0],supplier:Y.supplier||"",customerId:Y.customerId||"",customerName:Y.customerName||"",status:Y.status,items:Y.items,notes:Y.notes||"",currency:Y.currency||"TRY"}),u(!0)},L=async(Y,T)=>{try{await rd(Y,{status:T}),alert("Sipariş durumu güncellendi!"),w()}catch(R){alert("Hata: "+(R.message||"Durum güncellenirken bir hata oluştu"))}},F=Y=>{switch(Y){case"completed":return s.jsx(mc,{size:16,color:"#28a745"});case"in_progress":return s.jsx(Cp,{size:16,color:"#ffc107"});case"cancelled":return s.jsx(dd,{size:16,color:"#dc3545"});default:return s.jsx(Cp,{size:16,color:"#666"})}},z=Y=>{switch(Y){case"pending":return"Beklemede";case"in_progress":return"İşlemde";case"completed":return"Tamamlandı";case"cancelled":return"İptal";default:return Y}},M=Array.from(new Set(e.map(Y=>Y.supplier))).filter(Boolean),q=v.items.reduce((Y,T)=>Y+T.totalPrice,0),fe=async()=>{if(!e.length){alert("Dışa aktarılacak sipariş bulunamadı");return}const Y=await xi(()=>Promise.resolve().then(()=>td),void 0),T=e.map(O=>({"Sipariş No":O.orderNumber,Müşteri:O.customerName||"",Tedarikçi:O.supplier||"",Tarih:O.orderDate.toLocaleDateString("tr-TR"),Durum:z(O.status),"Ürün Sayısı":O.items.length,"Toplam Tutar":O.totalAmount||0})),R=Y.utils.json_to_sheet(T),N=Y.utils.book_new();Y.utils.book_append_sheet(N,R,"Siparisler"),Y.writeFile(N,`siparisler_${new Date().toISOString().split("T")[0]}.xlsx`)};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(S1,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Sipariş Takip"})]}),s.jsxs("button",{onClick:()=>{u(!0),D()},className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Sipariş"]}),s.jsxs("button",{onClick:fe,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Zn,{size:16}),"Excel'e Aktar"]})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",marginBottom:"20px",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Durum"}),s.jsxs("select",{value:p.status,onChange:Y=>d({...p,status:Y.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tümü"}),s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"in_progress",children:"İşlemde"}),s.jsx("option",{value:"completed",children:"Tamamlandı"}),s.jsx("option",{value:"cancelled",children:"İptal"})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Tedarikçi"}),s.jsxs("select",{value:p.supplier,onChange:Y=>d({...p,supplier:Y.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tümü"}),M.map(Y=>s.jsx("option",{value:Y,children:Y},Y))]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Müşteri"}),s.jsxs("select",{value:p.customerId,onChange:Y=>d({...p,customerId:Y.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tümü"}),r.map(Y=>s.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Başlangıç Tarihi"}),s.jsx("input",{type:"date",value:p.startDate,onChange:Y=>d({...p,startDate:Y.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Bitiş Tarihi"}),s.jsx("input",{type:"date",value:p.endDate,onChange:Y=>d({...p,endDate:Y.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),c&&s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"30px",marginBottom:"30px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"20px",color:"#000"},children:f?"Sipariş Düzenle":"Yeni Sipariş"}),s.jsxs("form",{onSubmit:I,children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",marginBottom:"20px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Sipariş No"}),s.jsx("input",{type:"text",value:v.orderNumber,onChange:Y=>m({...v,orderNumber:Y.target.value}),placeholder:"Otomatik oluşturulacak",style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Sipariş Tarihi ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"date",value:v.orderDate,onChange:Y=>m({...v,orderDate:Y.target.value}),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Tedarikçi"}),s.jsx("input",{type:"text",value:v.supplier,onChange:Y=>m({...v,supplier:Y.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Müşteri"}),s.jsxs("select",{value:v.customerId,onChange:Y=>{const T=r.find(R=>R.id===Y.target.value);m({...v,customerId:Y.target.value,customerName:(T==null?void 0:T.name)||""})},className:"excel-form-select",children:[s.jsx("option",{value:"",children:"Seçiniz (opsiyonel)"}),r.map(Y=>s.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),v.customerId&&s.jsxs("div",{style:{fontSize:"12px",color:"#555",marginTop:"4px"},children:["Bakiye: ",(((he=r.find(Y=>Y.id===v.customerId))==null?void 0:he.balance)||0).toFixed(2)," ₺",((pe=r.find(Y=>Y.id===v.customerId))==null?void 0:pe.creditLimit)!==void 0&&s.jsxs("span",{style:{marginLeft:"8px"},children:["Limit: ",(we=(Q=r.find(Y=>Y.id===v.customerId))==null?void 0:Q.creditLimit)==null?void 0:we.toFixed(2)," ₺"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Durum"}),s.jsxs("select",{value:v.status,onChange:Y=>m({...v,status:Y.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"in_progress",children:"İşlemde"}),s.jsx("option",{value:"completed",children:"Tamamlandı"}),s.jsx("option",{value:"cancelled",children:"İptal"})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Para Birimi (Belge)"}),s.jsx("input",{type:"text",value:v.currency,onChange:Y=>m({...v,currency:Y.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsxs("div",{style:{marginBottom:"20px",padding:"20px",border:"1px solid #e0e0e0"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"15px",color:"#000"},children:"Ürün Ekle"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"10px",marginBottom:"10px"},children:[s.jsx("input",{type:"text",placeholder:"Malzeme Adı",value:y.materialName,onChange:Y=>_({...y,materialName:Y.target.value}),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsx("input",{type:"number",step:"0.01",placeholder:"Miktar",value:y.quantity,onChange:Y=>_({...y,quantity:Y.target.value}),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsx("input",{type:"text",placeholder:"Birim",value:y.unit,onChange:Y=>_({...y,unit:Y.target.value}),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsx("input",{type:"number",step:"0.01",placeholder:"Birim Fiyat",value:y.unitPrice,onChange:Y=>_({...y,unitPrice:Y.target.value}),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsx("input",{type:"text",placeholder:"Kalem PB (vars: belge PB)",value:y.currency,onChange:Y=>_({...y,currency:Y.target.value}),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsx("input",{type:"number",step:"0.0001",placeholder:`Kur -> ${v.currency}`,value:y.exchangeRate,onChange:Y=>_({...y,exchangeRate:Y.target.value}),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsxs("button",{type:"button",onClick:E,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:16}),"Ekle"]})]})]}),v.items.length>0&&s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsxs("table",{className:"excel-table",style:{fontSize:"13px"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Malzeme"}),s.jsx("th",{children:"Miktar"}),s.jsx("th",{children:"Birim"}),s.jsx("th",{children:"Birim Fiyat"}),s.jsx("th",{children:"Kalem PB"}),s.jsx("th",{children:"Toplam"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:v.items.map((Y,T)=>s.jsxs("tr",{children:[s.jsx("td",{children:Y.materialName}),s.jsx("td",{children:Y.quantity}),s.jsx("td",{children:Y.unit}),s.jsxs("td",{children:[Y.unitPrice.toFixed(2)," ",v.currency]}),s.jsxs("td",{children:[Y.currency||v.currency," ",Y.currency&&Y.currency!==v.currency?`(kur ${Y.exchangeRate||1})`:""]}),s.jsxs("td",{children:[Y.totalPrice.toFixed(2)," ",v.currency]}),s.jsx("td",{children:s.jsx("button",{type:"button",onClick:()=>A(T),style:{background:"none",border:"none",cursor:"pointer",color:"#dc3545"},children:s.jsx(ea,{size:16})})})]},T))})]}),s.jsxs("div",{style:{marginTop:"15px",textAlign:"right",fontSize:"18px",fontWeight:"700"},children:["Toplam: ",q.toFixed(2)," ",v.currency]})]}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Notlar"}),s.jsx("textarea",{value:v.notes,onChange:Y=>m({...v,notes:Y.target.value}),rows:3,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",fontFamily:"inherit"}})]}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(oa,{size:18}),f?"Güncelle":"Kaydet"]}),s.jsx("button",{type:"button",onClick:()=>{u(!1),h(null),D()},className:"btn btn-secondary",children:"İptal"})]})]})]}),s.jsx("div",{className:"table-container",children:o?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz sipariş kaydı bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Sipariş No"}),s.jsx("th",{children:"Müşteri"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Tedarikçi"}),s.jsx("th",{children:"Ürün Sayısı"}),s.jsx("th",{children:"Toplam Tutar"}),s.jsx("th",{children:"PB"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:e.map(Y=>{var T;return s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:Y.orderNumber}),s.jsx("td",{children:Y.customerName||"-"}),s.jsx("td",{children:Y.orderDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:Y.supplier||"-"}),s.jsx("td",{children:Y.items.length}),s.jsxs("td",{style:{fontWeight:"600"},children:[((T=Y.totalAmount)==null?void 0:T.toFixed(2))||"0.00"," ",Y.currency||"TRY"]}),s.jsx("td",{children:Y.currency||"TRY"}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[F(Y.status),s.jsx("span",{children:z(Y.status)})]})}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s.jsxs("button",{onClick:()=>B(Y),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(jn,{size:14}),"Düzenle"]}),Y.status!=="completed"&&Y.status!=="cancelled"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Y.id&&L(Y.id,"in_progress"),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"İşleme Al"}),s.jsx("button",{onClick:()=>Y.id&&L(Y.id,"completed"),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"Tamamla"})]})]})})]},Y.id)})})]})})]})})}function yL(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({name:"",description:"",location:""});ue.useEffect(()=>{f()},[]);const f=async()=>{try{a(!0);const m=gt(),y=await tu(m==null?void 0:m.companyId);t(y)}catch(m){console.error("Depo listesi yüklenirken hata:",m);const y=localStorage.getItem("currentUser"),_=y?JSON.parse(y):null;await ur(`Depo listesi yüklenirken hata: ${m.message||m}`,"WarehouseManagement",_==null?void 0:_.id,_==null?void 0:_.username),alert("Veriler yüklenirken bir hata oluştu")}finally{a(!1)}},h=async m=>{if(m.preventDefault(),!c.name.trim()){alert("Depo adı zorunludur");return}try{const y=gt(),_={...c,companyId:y==null?void 0:y.companyId};o?(await XS(o,_),alert("Depo başarıyla güncellendi!")):(await YS(_),alert("Depo başarıyla eklendi!")),i(!1),l(null),u({name:"",description:"",location:""}),f()}catch(y){const _=localStorage.getItem("currentUser"),k=_?JSON.parse(_):null;await ur(`Depo kaydedilirken hata: ${y.message||y}`,"WarehouseManagement",k==null?void 0:k.id,k==null?void 0:k.username),alert("Hata: "+(y.message||"Depo kaydedilirken bir hata oluştu"))}},p=m=>{l(m.id||null),u({name:m.name,description:m.description||"",location:m.location||""}),i(!0)},d=async m=>{if(confirm("Bu depoyu silmek istediğinize emin misiniz?"))try{await JS(m),alert("Depo başarıyla silindi!"),f()}catch(y){const _=localStorage.getItem("currentUser"),k=_?JSON.parse(_):null;await ur(`Depo silinirken hata: ${y.message||y}`,"WarehouseManagement",k==null?void 0:k.id,k==null?void 0:k.username),alert("Hata: "+(y.message||"Depo silinirken bir hata oluştu"))}},v=()=>{i(!1),l(null),u({name:"",description:"",location:""})};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(Ly,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Depo Yönetimi"})]}),s.jsxs("button",{onClick:()=>i(!0),className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Depo Ekle"]})]}),s.jsxs("div",{style:{background:"#f5f5f5",border:"1px solid #e0e0e0",padding:"20px",marginBottom:"30px",fontSize:"13px",color:"#666",lineHeight:"1.8"},children:[s.jsx("strong",{style:{color:"#000",display:"block",marginBottom:"8px"},children:"Bilgi:"}),s.jsxs("ul",{style:{marginLeft:"20px",marginTop:"8px"},children:[s.jsx("li",{children:"İstediğiniz kadar depo oluşturabilirsiniz (sınırsız)"}),s.jsx("li",{children:"Depo adları özelleştirilebilir (örn: Aşağı Depo, Yukarı Depo, Ana Depo)"}),s.jsx("li",{children:"Oluşturduğunuz depolar stok giriş ve çıkış işlemlerinde kullanılabilir"})]})]}),n&&s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"30px",marginBottom:"30px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"20px",color:"#000"},children:o?"Depo Düzenle":"Yeni Depo Ekle"}),s.jsxs("form",{onSubmit:h,children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Depo Adı ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"text",value:c.name,onChange:m=>u({...c,name:m.target.value}),required:!0,placeholder:"Örn: Aşağı Depo, Yukarı Depo",style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Konum"}),s.jsx("input",{type:"text",value:c.location,onChange:m=>u({...c,location:m.target.value}),placeholder:"Örn: Bina 1, Kat 2",style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsxs("div",{style:{marginTop:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Açıklama"}),s.jsx("textarea",{value:c.description,onChange:m=>u({...c,description:m.target.value}),rows:3,placeholder:"Depo hakkında ek bilgiler...",style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",fontFamily:"inherit"}})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(oa,{size:18}),o?"Güncelle":"Kaydet"]}),s.jsx("button",{type:"button",onClick:v,className:"btn btn-secondary",children:"İptal"})]})]})]}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz depo kaydı bulunmamaktadır. Yeni depo eklemek için yukarıdaki butona tıklayın."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Depo Adı"}),s.jsx("th",{children:"Konum"}),s.jsx("th",{children:"Açıklama"}),s.jsx("th",{children:"Oluşturulma Tarihi"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:e.map(m=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:m.name}),s.jsx("td",{children:m.location||"-"}),s.jsx("td",{children:m.description||"-"}),s.jsx("td",{children:m.createdAt?m.createdAt.toLocaleDateString("tr-TR"):"-"}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs("button",{onClick:()=>p(m),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(jn,{size:14}),"Düzenle"]}),s.jsxs("button",{onClick:()=>m.id&&d(m.id),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",color:"#dc3545"},children:[s.jsx(ea,{size:14}),"Sil"]})]})})]},m.id))})]})}),s.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",border:"1px solid #e0e0e0",fontSize:"13px",color:"#666"},children:[s.jsx("strong",{style:{color:"#000"},children:"Toplam Depo Sayısı:"})," ",e.length]})]})})}function bL({children:e,activeTab:t,onTabChange:r}){const a=$0(),[n,i]=ue.useState("users"),o=t!==void 0?t:n,l=u=>{r?r(u):i(u)},c=()=>{localStorage.removeItem("currentUser"),a("/admin-login")};return s.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f5f5f5"},children:[s.jsxs("div",{style:{width:"280px",background:"#1a1a1a",color:"#fff",display:"flex",flexDirection:"column",borderRight:"2px solid #000",position:"fixed",height:"100vh",left:0,top:0,zIndex:1e3},children:[s.jsxs("div",{style:{padding:"30px 20px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx("img",{src:"/Kaptan.png",alt:"Kaptan Logo",style:{width:"40px",height:"40px"}}),s.jsxs("div",{children:[s.jsx("h2",{style:{fontSize:"18px",fontWeight:"700",color:"#fff",margin:0,letterSpacing:"-0.5px"},children:"Kaptan"}),s.jsx("p",{style:{fontSize:"9px",color:"#999",margin:0,letterSpacing:"0.5px",textTransform:"uppercase"},children:"Admin Panel"})]})]}),s.jsxs("div",{style:{flex:1,padding:"20px 0",overflowY:"auto"},children:[s.jsxs("div",{onClick:()=>l("users"),style:{padding:"15px 20px",cursor:"pointer",background:o==="users"?"#000":"transparent",borderLeft:o==="users"?"4px solid #fff":"4px solid transparent",display:"flex",alignItems:"center",gap:"12px",transition:"all 0.2s",color:o==="users"?"#fff":"#ccc"},onMouseEnter:u=>{o!=="users"&&(u.currentTarget.style.background="rgba(255,255,255,0.05)",u.currentTarget.style.color="#fff")},onMouseLeave:u=>{o!=="users"&&(u.currentTarget.style.background="transparent",u.currentTarget.style.color="#ccc")},children:[s.jsx(fc,{size:20}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Kullanıcı Yönetimi"})]}),s.jsxs("div",{onClick:()=>l("errors"),style:{padding:"15px 20px",cursor:"pointer",background:o==="errors"?"#000":"transparent",borderLeft:o==="errors"?"4px solid #fff":"4px solid transparent",display:"flex",alignItems:"center",gap:"12px",transition:"all 0.2s",color:o==="errors"?"#fff":"#ccc"},onMouseEnter:u=>{o!=="errors"&&(u.currentTarget.style.background="rgba(255,255,255,0.05)",u.currentTarget.style.color="#fff")},onMouseLeave:u=>{o!=="errors"&&(u.currentTarget.style.background="transparent",u.currentTarget.style.color="#ccc")},children:[s.jsx(Ep,{size:20}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600"},children:"Hata Logları"})]})]}),s.jsx("div",{style:{padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:s.jsxs("button",{onClick:c,style:{width:"100%",padding:"12px",background:"transparent",color:"#fff",border:"2px solid #fff",borderRadius:"0",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s",letterSpacing:"0.5px",textTransform:"uppercase"},onMouseEnter:u=>{u.currentTarget.style.background="#fff",u.currentTarget.style.color="#000"},onMouseLeave:u=>{u.currentTarget.style.background="transparent",u.currentTarget.style.color="#fff"},children:[s.jsx(Fy,{size:18}),"Çıkış Yap"]})})]}),s.jsx("div",{style:{flex:1,marginLeft:"280px",background:"#fff",minHeight:"100vh"},children:e})]})}const qd="inviteCodes",wL=async e=>(await Or(lt(qe,qd),{...e,createdAt:Ye.now(),updatedAt:Ye.now()})).id,_L=async e=>{var i,o;const t=Ke(lt(qe,qd),ot("code","==",e),ot("isActive","==",!0)),r=await lr(t);if(r.empty)return null;const a=r.docs[0],n=a.data();return{id:a.id,...n,createdAt:(i=n.createdAt)!=null&&i.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(o=n.updatedAt)!=null&&o.toDate?n.updatedAt.toDate():n.updatedAt}},v4=async()=>(await lr(Ke(lt(qe,qd),ua("createdAt","desc")))).docs.map(t=>{var a,n;const r=t.data();return{id:t.id,...r,createdAt:(a=r.createdAt)!=null&&a.toDate?r.createdAt.toDate():r.createdAt,updatedAt:(n=r.updatedAt)!=null&&n.toDate?r.updatedAt.toDate():r.updatedAt}}),kL=async(e,t)=>{const r=ir(qe,qd,e);await Xr(r,{isActive:!1,usedBy:t,updatedAt:Ye.now()})};function SL(){const e=$0(),[t,r]=ue.useState("users"),[a,n]=ue.useState([]),[i,o]=ue.useState([]),[l,c]=ue.useState([]),[,u]=ue.useState([]),[f,h]=ue.useState("all"),[p,d]=ue.useState(!0),[v,m]=ue.useState(!1),[y,_]=ue.useState(null),[k,g]=ue.useState("unresolved"),[w,C]=ue.useState({username:"",password:"",email:"",fullName:"",role:"user",companyId:"",companyCode:"",companyName:"",isActive:!0});ue.useEffect(()=>{const q=localStorage.getItem("currentUser");if(!q){e("/admin-login");return}if(JSON.parse(q).role!=="admin"){alert("Bu sayfaya erişim yetkiniz bulunmamaktadır."),e("/admin-login");return}t==="users"?(A(),E(),I()):D()},[t,k,f,e]);const E=async()=>{try{const q=await y1();c(q)}catch(q){console.error("Şirketler yüklenirken hata:",q)}},A=async()=>{try{d(!0);const fe=await a3(f==="all"?void 0:f);n(fe)}catch(q){console.error("Kullanıcılar yüklenirken hata:",q),alert("Veriler yüklenirken bir hata oluştu")}finally{d(!1)}},I=async()=>{try{const q=await v4();u(q)}catch(q){console.error("Davet kodları yüklenirken hata:",q)}},D=async()=>{try{d(!0);const q={};k==="resolved"?q.resolved=!0:k==="unresolved"&&(q.resolved=!1);const fe=await o3(q);o(fe)}catch(q){console.error("Hata logları yüklenirken hata:",q),alert("Veriler yüklenirken bir hata oluştu")}finally{d(!1)}},B=async q=>{if(q.preventDefault(),!w.username||!y&&!w.password){alert("Kullanıcı adı ve şifre zorunludur");return}if(!w.companyCode){alert("Şirket kodu zorunludur");return}try{let fe=w.companyId,he=w.companyCode,pe=w.companyName;const Q=await ky(w.companyCode.trim());if(!Q){alert("Geçerli bir şirket kodu girin");return}if(fe=Q.id||"",he=Q.code||"",pe=Q.name||"",y){const we={...w,companyId:fe,companyCode:he,companyName:pe};w.password&&(we.password=w.password),await i3(y,we),alert("Kullanıcı başarıyla güncellendi!")}else{if(!w.password){alert("Yeni kullanıcı için şifre zorunludur");return}const we={...w,companyId:fe,companyCode:he,companyName:pe,password:w.password};await Sy(we),alert("Kullanıcı başarıyla eklendi!")}m(!1),_(null),M(),A()}catch(fe){alert("Hata: "+(fe.message||"Kullanıcı kaydedilirken bir hata oluştu"))}},L=q=>{_(q.id||null);const fe=l.find(he=>he.id===q.companyId);C({username:q.username,password:"",email:q.email||"",fullName:q.fullName||"",role:q.role||"manager",companyId:q.companyId||"",companyCode:q.companyCode||"",companyName:(fe==null?void 0:fe.name)||"",isActive:q.isActive}),m(!0)},F=async q=>{if(confirm("Bu kullanıcıyı silmek istediğinize emin misiniz?"))try{await s3(q),alert("Kullanıcı başarıyla silindi!"),A()}catch(fe){alert("Hata: "+(fe.message||"Kullanıcı silinirken bir hata oluştu"))}},z=async q=>{try{const fe=localStorage.getItem("currentUser"),he=fe?JSON.parse(fe).username:"Admin";await l3(q,he),alert("Hata çözüldü olarak işaretlendi!"),D()}catch(fe){alert("Hata: "+(fe.message||"Hata çözülürken bir hata oluştu"))}},M=()=>{C({username:"",password:"",email:"",fullName:"",role:"user",companyId:"",companyCode:"",companyName:"",isActive:!0})};return s.jsx(bL,{activeTab:t,onTabChange:r,children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"30px"},children:[s.jsx(rl,{size:32,color:"#000"}),s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px",margin:0},children:"Admin Paneli"}),s.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"4px",margin:0},children:"Kullanıcı yönetimi ve sistem hata logları buradan yönetilir. Buradan sadece normal kullanıcılar oluşturulur."})]})]}),t==="users"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[s.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",color:"#000"},children:"Kullanıcı Yönetimi"}),s.jsxs("button",{onClick:()=>{m(!0),M(),_(null)},className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Kullanıcı Ekle"]})]}),s.jsx("div",{style:{marginBottom:"16px",padding:"12px",border:"1px solid #ddd",background:"#f8f8f8",color:"#333",fontSize:"13px"},children:"Yeni kullanıcı eklerken şirket kodunu girerek var olan firmaya bağlayın. Davet kodu ile kayıt olanlar da buraya düşer; rol/aktiflik düzenleyebilirsiniz."}),v&&s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"30px",marginBottom:"30px"},children:[s.jsx("h3",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"20px",color:"#000"},children:y?"Kullanıcı Düzenle":"Yeni Kullanıcı Ekle"}),s.jsxs("form",{onSubmit:B,children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Kullanıcı Adı ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"text",value:w.username,onChange:q=>C({...w,username:q.target.value}),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Şifre ",!y&&s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"password",value:w.password,onChange:q=>C({...w,password:q.target.value}),required:!y,placeholder:y?"Değiştirmek için yeni şifre girin":"",style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Email"}),s.jsx("input",{type:"email",value:w.email,onChange:q=>C({...w,email:q.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Ad Soyad"}),s.jsx("input",{type:"text",value:w.fullName,onChange:q=>C({...w,fullName:q.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Şirket Kodu ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"text",value:w.companyCode,onChange:q=>C({...w,companyCode:q.target.value}),placeholder:"Örn: ABC123",required:!0,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}}),s.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"4px",margin:0},children:"Var olan firma kodunu girin. Kod bulunamazsa ekleme yapılmaz."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Rol"}),s.jsxs("select",{value:w.role,onChange:q=>C({...w,role:q.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"user",children:"Kullanıcı"}),s.jsx("option",{value:"manager",children:"Yönetici"})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Rol"}),s.jsx("input",{type:"text",value:"Yönetici (Manager)",disabled:!0,style:{width:"100%",padding:"12px",border:"2px solid #ccc",borderRadius:"0",fontSize:"14px",background:"#f5f5f5",color:"#666",cursor:"not-allowed"}}),s.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"4px",margin:0},children:"Admin Panel'den şirket yöneticisi (manager) oluşturulur"})]}),s.jsx("div",{children:s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:[s.jsx("input",{type:"checkbox",checked:w.isActive,onChange:q=>C({...w,isActive:q.target.checked}),style:{width:"18px",height:"18px"}}),"Aktif"]})})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(oa,{size:18}),y?"Güncelle":"Kaydet"]}),s.jsx("button",{type:"button",onClick:()=>{m(!1),_(null),M()},className:"btn btn-secondary",children:"İptal"})]})]})]}),s.jsxs("div",{style:{marginBottom:"20px",display:"flex",gap:"10px",alignItems:"center"},children:[s.jsx("label",{style:{fontSize:"14px",fontWeight:"600",color:"#000"},children:"Şirket Filtresi:"}),s.jsxs("select",{value:f,onChange:q=>h(q.target.value),style:{padding:"8px 12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",minWidth:"200px"},children:[s.jsx("option",{value:"all",children:"Tüm Şirketler"}),l.map(q=>s.jsx("option",{value:q.id,children:q.name},q.id))]})]}),s.jsx("div",{className:"table-container",children:p?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):a.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:f==="all"?"Henüz kullanıcı kaydı bulunmamaktadır.":"Seçili şirkette kullanıcı kaydı bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Kullanıcı Adı"}),s.jsx("th",{children:"Ad Soyad"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Şirket"}),s.jsx("th",{children:"Rol"}),s.jsx("th",{children:"Oluşturan"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Son Giriş"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:a.map(q=>{var fe,he;return s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:q.username}),s.jsx("td",{children:q.fullName||"-"}),s.jsx("td",{children:q.email||"-"}),s.jsx("td",{children:q.companyCode?s.jsx("span",{style:{fontSize:"12px",color:"#666"},children:((fe=l.find(pe=>pe.id===q.companyId))==null?void 0:fe.name)||q.companyCode}):"-"}),s.jsx("td",{children:s.jsx("span",{style:{padding:"4px 8px",background:q.role==="admin"?"#000":q.role==="manager"?"#666":"#999",color:"#fff",fontSize:"12px",fontWeight:"600"},children:q.role==="admin"?"Admin":q.role==="manager"?"Yönetici":"Kullanıcı"})}),s.jsx("td",{children:q.createdBy?s.jsx("span",{style:{fontSize:"12px",color:"#666"},children:((he=a.find(pe=>pe.id===q.createdBy))==null?void 0:he.username)||"Bilinmiyor"}):"-"}),s.jsx("td",{children:s.jsx("span",{style:{padding:"4px 8px",background:q.isActive?"#28a745":"#dc3545",color:"#fff",fontSize:"12px",fontWeight:"600"},children:q.isActive?"Aktif":"Pasif"})}),s.jsx("td",{children:q.lastLogin?q.lastLogin.toLocaleDateString("tr-TR"):"-"}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs("button",{onClick:()=>L(q),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(jn,{size:14}),"Düzenle"]}),s.jsxs("button",{onClick:()=>q.id&&F(q.id),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",color:"#dc3545"},children:[s.jsx(ea,{size:14}),"Sil"]})]})})]},q.id)})})]})})]}),t==="errors"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",color:"#000"},children:"Hata Logları"}),s.jsxs("select",{value:k,onChange:q=>g(q.target.value),style:{padding:"10px 16px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"unresolved",children:"Çözülmemiş"}),s.jsx("option",{value:"resolved",children:"Çözülmüş"}),s.jsx("option",{value:"all",children:"Tümü"})]})]}),s.jsx("div",{className:"table-container",children:p?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):i.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Hata logu bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Tarih/Saat"}),s.jsx("th",{children:"Kullanıcı"}),s.jsx("th",{children:"Sayfa"}),s.jsx("th",{children:"Hata"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Çözen"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:i.map(q=>s.jsxs("tr",{children:[s.jsx("td",{children:q.timestamp.toLocaleString("tr-TR")}),s.jsx("td",{children:q.username||q.userId||"-"}),s.jsx("td",{children:q.page||"-"}),s.jsx("td",{style:{maxWidth:"400px",wordBreak:"break-word"},children:q.error}),s.jsx("td",{children:q.resolved?s.jsx("span",{style:{color:"#28a745",fontWeight:"600"},children:"Çözüldü"}):s.jsx("span",{style:{color:"#dc3545",fontWeight:"600"},children:"Çözülmedi"})}),s.jsx("td",{children:q.resolvedBy||"-"}),s.jsx("td",{children:!q.resolved&&q.id&&s.jsxs("button",{onClick:()=>z(q.id),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(mc,{size:14}),"Çöz"]})})]},q.id))})]})})]})]})})}function AL(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState({module:"",startDate:"",endDate:""}),o=ml(),l=gt();ue.useEffect(()=>{if((o==null?void 0:o.role)!=="manager"){window.location.href="/dashboard";return}c()},[n]);const c=async()=>{try{a(!0);const h={companyId:l==null?void 0:l.companyId,limit:500};n.module&&(h.module=n.module),n.startDate&&(h.startDate=new Date(n.startDate)),n.endDate&&(h.endDate=new Date(n.endDate),h.endDate.setHours(23,59,59,999));const p=await rb(h);t(p)}catch(h){console.error("Aktivite logları yüklenirken hata:",h),alert("Veriler yüklenirken bir hata oluştu")}finally{a(!1)}},u=h=>new Date(h).toLocaleString("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),f=Array.from(new Set(e.map(h=>h.module))).filter(Boolean);return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(_1,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Aktivite Logları"})]})}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",marginBottom:"20px",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Modül"}),s.jsxs("select",{value:n.module,onChange:h=>i({...n,module:h.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tümü"}),f.map(h=>{var p;return s.jsx("option",{value:h,children:((p=xo[h])==null?void 0:p.label)||h},h)})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Başlangıç Tarihi"}),s.jsx("input",{type:"date",value:n.startDate,onChange:h=>i({...n,startDate:h.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Bitiş Tarihi"}),s.jsx("input",{type:"date",value:n.endDate,onChange:h=>i({...n,endDate:h.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz aktivite logu bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Tarih/Saat"}),s.jsx("th",{children:"Kullanıcı"}),s.jsx("th",{children:"Personel"}),s.jsx("th",{children:"İşlem"}),s.jsx("th",{children:"Modül"}),s.jsx("th",{children:"Detay"})]})}),s.jsx("tbody",{children:e.map(h=>{var p;return s.jsxs("tr",{children:[s.jsx("td",{style:{fontSize:"12px"},children:u(h.timestamp)}),s.jsx("td",{children:s.jsx("div",{style:{fontSize:"13px",fontWeight:"500"},children:h.username||h.userEmail||"-"})}),s.jsx("td",{children:h.personnelName?s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"500"},children:h.personnelName}),h.personnelId&&s.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["ID: ",h.personnelId]})]}):s.jsx("span",{style:{color:"#999"},children:"-"})}),s.jsx("td",{style:{fontSize:"13px"},children:h.action}),s.jsx("td",{children:s.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",background:"#000",color:"#fff",borderRadius:"2px"},children:((p=xo[h.module])==null?void 0:p.label)||h.module})}),s.jsx("td",{style:{fontSize:"12px",color:"#666",maxWidth:"300px"},children:h.details?s.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:h.details}):"-"})]},h.id)})})]})})]})})}function NL(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState({userId:"",module:"",startDate:"",endDate:""}),[o,l]=ue.useState([]),c=gt();ue.useEffect(()=>{(()=>{const v=localStorage.getItem("currentUser");if(!v)return window.location.href="/admin-login",!1;try{return JSON.parse(v).role!=="admin"?(window.location.href="/admin-login",!1):!0}catch{return window.location.href="/admin-login",!1}})()&&u()},[n]);const u=async()=>{try{a(!0);const d={companyId:c==null?void 0:c.companyId,limit:1e3};n.userId&&(d.userId=n.userId),n.module&&(d.module=n.module),n.startDate&&(d.startDate=new Date(n.startDate)),n.endDate&&(d.endDate=new Date(n.endDate),d.endDate.setHours(23,59,59,999));const v=await rb(d);t(v);const m=new Map;v.forEach(y=>{y.userId&&y.username&&m.set(y.userId,{id:y.userId,username:y.username,email:y.userEmail})}),l(Array.from(m.values()))}catch(d){console.error("İşlem emirleri yüklenirken hata:",d),alert("Veriler yüklenirken bir hata oluştu")}finally{a(!1)}},f=d=>new Date(d).toLocaleString("tr-TR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),h=Array.from(new Set(e.map(d=>d.module))).filter(Boolean),p={total:e.length,byUser:e.reduce((d,v)=>{const m=v.userId||"unknown";return d[m]=(d[m]||0)+1,d},{}),byModule:e.reduce((d,v)=>{const m=v.module||"unknown";return d[m]=(d[m]||0)+1,d},{})};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(Bs,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"İşlem Emirleri"})]})}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"20px"},children:[s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#000",marginBottom:"8px"},children:p.total}),s.jsx("div",{style:{fontSize:"13px",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Toplam İşlem"})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#000",marginBottom:"8px"},children:Object.keys(p.byUser).length}),s.jsx("div",{style:{fontSize:"13px",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Aktif Kullanıcı"})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#000",marginBottom:"8px"},children:Object.keys(p.byModule).length}),s.jsx("div",{style:{fontSize:"13px",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Modül Sayısı"})]})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",marginBottom:"20px",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[s.jsxs("div",{children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:[s.jsx(E3,{size:16}),"Kullanıcı"]}),s.jsxs("select",{value:n.userId,onChange:d=>i({...n,userId:d.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tüm Kullanıcılar"}),o.map(d=>s.jsxs("option",{value:d.id,children:[d.username," ",d.email&&`(${d.email})`]},d.id))]})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:[s.jsx(_1,{size:16}),"Modül"]}),s.jsxs("select",{value:n.module,onChange:d=>i({...n,module:d.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",background:"white"},children:[s.jsx("option",{value:"",children:"Tüm Modüller"}),h.map(d=>{var v;return s.jsx("option",{value:d,children:((v=xo[d])==null?void 0:v.label)||d},d)})]})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:[s.jsx(cg,{size:16}),"Başlangıç Tarihi"]}),s.jsx("input",{type:"date",value:n.startDate,onChange:d=>i({...n,startDate:d.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:[s.jsx(cg,{size:16}),"Bitiş Tarihi"]}),s.jsx("input",{type:"date",value:n.endDate,onChange:d=>i({...n,endDate:d.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz işlem emri bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Tarih/Saat"}),s.jsx("th",{children:"Kullanıcı"}),s.jsx("th",{children:"E-posta"}),s.jsx("th",{children:"Personel"}),s.jsx("th",{children:"İşlem"}),s.jsx("th",{children:"Modül"}),s.jsx("th",{children:"Detay"})]})}),s.jsx("tbody",{children:e.map(d=>{var v;return s.jsxs("tr",{children:[s.jsx("td",{style:{fontSize:"12px",whiteSpace:"nowrap"},children:f(d.timestamp)}),s.jsxs("td",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"500"},children:d.username||"-"}),d.userId&&s.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["ID: ",d.userId]})]}),s.jsx("td",{style:{fontSize:"12px",color:"#666"},children:d.userEmail||"-"}),s.jsx("td",{children:d.personnelName?s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"500"},children:d.personnelName}),d.personnelId&&s.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:["ID: ",d.personnelId]})]}):s.jsx("span",{style:{color:"#999"},children:"-"})}),s.jsx("td",{style:{fontSize:"13px"},children:d.action}),s.jsx("td",{children:s.jsx("span",{style:{fontSize:"11px",padding:"4px 8px",background:"#000",color:"#fff",borderRadius:"2px"},children:((v=xo[d.module])==null?void 0:v.label)||d.module})}),s.jsx("td",{style:{fontSize:"12px",color:"#666",maxWidth:"300px"},children:d.details?s.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:d.details}):"-"})]},d.id)})})]})})]})})}function jL(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState(""),[f,h]=ue.useState({name:"",companyName:"",taxNumber:"",taxOffice:"",address:"",city:"",district:"",postalCode:"",phone:"",email:"",contactPerson:"",group:"",creditLimit:"",notes:""});ue.useEffect(()=>{p()},[]);const p=async()=>{try{a(!0);const k=gt(),g=await To(k==null?void 0:k.companyId);t(g)}catch(k){console.error("Müşteri listesi yüklenirken hata:",k);const g=localStorage.getItem("currentUser"),w=g?JSON.parse(g):null;await ur(`Müşteri listesi yüklenirken hata: ${k.message||k}`,"CustomerManagement",w==null?void 0:w.id,w==null?void 0:w.username),alert("Veriler yüklenirken bir hata oluştu")}finally{a(!1)}},d=async k=>{if(k.preventDefault(),!f.name){alert("Müşteri adı zorunludur");return}try{const g=gt(),w=f.creditLimit?parseFloat(f.creditLimit):void 0,C={...f,creditLimit:w&&!isNaN(w)?w:void 0,companyId:g==null?void 0:g.companyId};o?(await hL(o,C),alert("Müşteri başarıyla güncellendi!")):(await dL(C),alert("Müşteri başarıyla eklendi!")),i(!1),l(null),h({name:"",companyName:"",taxNumber:"",taxOffice:"",address:"",city:"",district:"",postalCode:"",phone:"",email:"",contactPerson:"",group:"",creditLimit:"",notes:""}),p()}catch(g){const w=localStorage.getItem("currentUser"),C=w?JSON.parse(w):null;await ur(`Müşteri kaydedilirken hata: ${g.message||g}`,"CustomerManagement",C==null?void 0:C.id,C==null?void 0:C.username),alert("Hata: "+(g.message||"Müşteri kaydedilirken bir hata oluştu"))}},v=k=>{l(k.id||null),h({name:k.name,companyName:k.companyName||"",taxNumber:k.taxNumber||"",taxOffice:k.taxOffice||"",address:k.address||"",city:k.city||"",district:k.district||"",postalCode:k.postalCode||"",phone:k.phone||"",email:k.email||"",contactPerson:k.contactPerson||"",group:k.group||"",creditLimit:k.creditLimit!==void 0?k.creditLimit.toString():"",notes:k.notes||""}),i(!0)},m=async k=>{if(confirm("Bu müşteriyi silmek istediğinize emin misiniz?"))try{await pL(k),alert("Müşteri başarıyla silindi!"),p()}catch(g){const w=localStorage.getItem("currentUser"),C=w?JSON.parse(w):null;await ur(`Müşteri silinirken hata: ${g.message||g}`,"CustomerManagement",C==null?void 0:C.id,C==null?void 0:C.username),alert("Hata: "+(g.message||"Müşteri silinirken bir hata oluştu"))}},y=()=>{i(!1),l(null),h({name:"",companyName:"",taxNumber:"",taxOffice:"",address:"",city:"",district:"",postalCode:"",phone:"",email:"",contactPerson:"",group:"",creditLimit:"",notes:""})},_=e.filter(k=>{var w,C,E,A;if(!c)return!0;const g=c.toLowerCase();return k.name.toLowerCase().includes(g)||((w=k.companyName)==null?void 0:w.toLowerCase().includes(g))||((C=k.phone)==null?void 0:C.toLowerCase().includes(g))||((E=k.email)==null?void 0:E.toLowerCase().includes(g))||((A=k.city)==null?void 0:A.toLowerCase().includes(g))});return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(fc,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Müşteri Yönetimi"})]}),s.jsxs("button",{onClick:()=>i(!0),className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Müşteri Ekle"]})]}),s.jsx("div",{style:{marginBottom:"20px"},children:s.jsxs("div",{style:{position:"relative",maxWidth:"400px"},children:[s.jsx(A3,{size:20,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#666"}}),s.jsx("input",{type:"text",placeholder:"Müşteri ara (ad, şirket, telefon, e-posta, şehir)...",value:c,onChange:k=>u(k.target.value),style:{width:"100%",padding:"12px 12px 12px 40px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})}),n&&s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"30px",marginBottom:"30px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"20px",color:"#000"},children:o?"Müşteri Düzenle":"Yeni Müşteri Ekle"}),s.jsxs("form",{onSubmit:d,children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:["Müşteri Adı ",s.jsx("span",{style:{color:"#dc3545"},children:"*"})]}),s.jsx("input",{type:"text",value:f.name,onChange:k=>h({...f,name:k.target.value}),required:!0,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Şirket Adı"}),s.jsx("input",{type:"text",value:f.companyName,onChange:k=>h({...f,companyName:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Vergi Numarası"}),s.jsx("input",{type:"text",value:f.taxNumber,onChange:k=>h({...f,taxNumber:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Vergi Dairesi"}),s.jsx("input",{type:"text",value:f.taxOffice,onChange:k=>h({...f,taxOffice:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Telefon"}),s.jsx("input",{type:"text",value:f.phone,onChange:k=>h({...f,phone:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Kredi Limiti (₺)"}),s.jsx("input",{type:"number",min:"0",step:"0.01",value:f.creditLimit,onChange:k=>h({...f,creditLimit:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Müşteri Grubu"}),s.jsx("input",{type:"text",value:f.group,onChange:k=>h({...f,group:k.target.value}),placeholder:"Örn: Gold / Silver / Bayi",style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"E-posta"}),s.jsx("input",{type:"email",value:f.email,onChange:k=>h({...f,email:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"İletişim Kişisi"}),s.jsx("input",{type:"text",value:f.contactPerson,onChange:k=>h({...f,contactPerson:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Şehir"}),s.jsx("input",{type:"text",value:f.city,onChange:k=>h({...f,city:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"İlçe"}),s.jsx("input",{type:"text",value:f.district,onChange:k=>h({...f,district:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Posta Kodu"}),s.jsx("input",{type:"text",value:f.postalCode,onChange:k=>h({...f,postalCode:k.target.value}),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsxs("div",{style:{marginTop:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Adres"}),s.jsx("textarea",{value:f.address,onChange:k=>h({...f,address:k.target.value}),rows:3,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",fontFamily:"inherit"}})]}),s.jsxs("div",{style:{marginTop:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Notlar"}),s.jsx("textarea",{value:f.notes,onChange:k=>h({...f,notes:k.target.value}),rows:3,style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px",fontFamily:"inherit"}})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(oa,{size:18}),o?"Güncelle":"Kaydet"]}),s.jsx("button",{type:"button",onClick:y,className:"btn btn-secondary",children:"İptal"})]})]})]}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):_.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:c?"Arama sonucu bulunamadı.":"Henüz müşteri kaydı bulunmamaktadır. Yeni müşteri eklemek için yukarıdaki butona tıklayın."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Müşteri Adı"}),s.jsx("th",{children:"Şirket Adı"}),s.jsx("th",{children:"Grup"}),s.jsx("th",{children:"Telefon"}),s.jsx("th",{children:"E-posta"}),s.jsx("th",{children:"Şehir"}),s.jsx("th",{children:"İletişim Kişisi"}),s.jsx("th",{children:"Bakiye"}),s.jsx("th",{children:"Kredi Limiti"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:_.map(k=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:k.name}),s.jsx("td",{children:k.companyName||"-"}),s.jsx("td",{children:k.group||"-"}),s.jsx("td",{children:k.phone||"-"}),s.jsx("td",{children:k.email||"-"}),s.jsx("td",{children:k.city||"-"}),s.jsx("td",{children:k.contactPerson||"-"}),s.jsxs("td",{children:[(k.balance||0).toFixed(2)," ₺"]}),s.jsx("td",{children:k.creditLimit!==void 0?`${k.creditLimit.toFixed(2)} ₺`:"-"}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs("button",{onClick:()=>v(k),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(jn,{size:14}),"Düzenle"]}),s.jsxs("button",{onClick:()=>k.id&&m(k.id),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",color:"#dc3545"},children:[s.jsx(ea,{size:14}),"Sil"]})]})})]},k.id))})]})}),s.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",border:"1px solid #e0e0e0",fontSize:"13px",color:"#666"},children:[s.jsx("strong",{style:{color:"#000"},children:"Toplam Müşteri Sayısı:"})," ",_.length]})]})})}const sx="shipments",TL=async e=>{try{return(await Or(lt(qe,sx),{...e,shipmentDate:Ye.fromDate(e.shipmentDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id}catch(t){throw console.error("Sevkiyat eklenirken hata:",t),t}},ox=async e=>{try{let t=Ke(lt(qe,sx),ua("shipmentDate","desc"));e!=null&&e.companyId&&(t=Ke(t,ot("companyId","==",e.companyId))),e!=null&&e.customerId&&(t=Ke(t,ot("customerId","==",e.customerId))),e!=null&&e.status&&(t=Ke(t,ot("status","==",e.status)));const r=await lr(t),a=[];return r.forEach(n=>{var l,c;const i=n.data(),o={id:n.id,shipmentNumber:i.shipmentNumber,shipmentDate:i.shipmentDate.toDate(),customerId:i.customerId,customerName:i.customerName,items:i.items,totalAmount:i.totalAmount,status:i.status,notes:i.notes,warehouse:i.warehouse,companyId:i.companyId,createdBy:i.createdBy,createdAt:(l=i.createdAt)==null?void 0:l.toDate(),updatedAt:(c=i.updatedAt)==null?void 0:c.toDate()};e!=null&&e.startDate&&o.shipmentDate<e.startDate||e!=null&&e.endDate&&o.shipmentDate>e.endDate||a.push(o)}),a}catch(t){throw console.error("Sevkiyat listesi yüklenirken hata:",t),t}},EL=async(e,t)=>{try{const r=ir(qe,sx,e);await Xr(r,{status:t,updatedAt:Ye.now()})}catch(r){throw console.error("Sevkiyat durumu güncellenirken hata:",r),r}},G2=()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),n=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return`SEV-${t}${r}${a}-${n}`};function jr(e){"@babel/helpers - typeof";return jr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jr(e)}var Bi=Uint8Array,Xn=Uint16Array,lx=Int32Array,cx=new Bi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ux=new Bi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),K2=new Bi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),y4=function(e,t){for(var r=new Xn(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new lx(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)n[i]=i-r[a]<<5|a;return{b:r,r:n}},b4=y4(cx,2),CL=b4.b,n1=b4.r;CL[28]=258,n1[258]=28;var FL=y4(ux,0),Y2=FL.r,i1=new Xn(32768);for(var Hr=0;Hr<32768;++Hr){var lo=(Hr&43690)>>1|(Hr&21845)<<1;lo=(lo&52428)>>2|(lo&13107)<<2,lo=(lo&61680)>>4|(lo&3855)<<4,i1[Hr]=((lo&65280)>>8|(lo&255)<<8)>>1}var w0=function(e,t,r){for(var a=e.length,n=0,i=new Xn(t);n<a;++n)e[n]&&++i[e[n]-1];var o=new Xn(t);for(n=1;n<t;++n)o[n]=o[n-1]+i[n-1]<<1;var l;if(r){l=new Xn(1<<t);var c=15-t;for(n=0;n<a;++n)if(e[n])for(var u=n<<4|e[n],f=t-e[n],h=o[e[n]-1]++<<f,p=h|(1<<f)-1;h<=p;++h)l[i1[h]>>c]=u}else for(l=new Xn(a),n=0;n<a;++n)e[n]&&(l[n]=i1[o[e[n]-1]++]>>15-e[n]);return l},hl=new Bi(288);for(var Hr=0;Hr<144;++Hr)hl[Hr]=8;for(var Hr=144;Hr<256;++Hr)hl[Hr]=9;for(var Hr=256;Hr<280;++Hr)hl[Hr]=7;for(var Hr=280;Hr<288;++Hr)hl[Hr]=8;var nd=new Bi(32);for(var Hr=0;Hr<32;++Hr)nd[Hr]=5;var DL=w0(hl,9,0),IL=w0(nd,5,0),w4=function(e){return(e+7)/8|0},LL=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Bi(e.subarray(t,r))},Ts=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Zc=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},ap=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,i=r.slice();if(!n)return{t:k4,l:0};if(n==1){var o=new Bi(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(C,E){return C.f-E.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,f=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};f!=n-1;)l=r[r[u].f<r[h].f?u++:h++],c=r[u!=f&&r[u].f<r[h].f?u++:h++],r[f++]={s:-1,f:l.f+c.f,l,r:c};for(var p=i[0].s,a=1;a<n;++a)i[a].s>p&&(p=i[a].s);var d=new Xn(p+1),v=s1(r[f-1],d,0);if(v>t){var a=0,m=0,y=v-t,_=1<<y;for(i.sort(function(E,A){return d[A.s]-d[E.s]||E.f-A.f});a<n;++a){var k=i[a].s;if(d[k]>t)m+=_-(1<<v-d[k]),d[k]=t;else break}for(m>>=y;m>0;){var g=i[a].s;d[g]<t?m-=1<<t-d[g]++-1:++a}for(;a>=0&&m;--a){var w=i[a].s;d[w]==t&&(--d[w],++m)}v=t}return{t:new Bi(d),l:v}},s1=function(e,t,r){return e.s==-1?Math.max(s1(e.l,t,r+1),s1(e.r,t,r+1)):t[e.s]=r},X2=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Xn(++t),a=0,n=e[0],i=1,o=function(c){r[a++]=c},l=1;l<=t;++l)if(e[l]==n&&l!=t)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=e[l]}return{c:r.subarray(0,a),n:t}},Qc=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},_4=function(e,t,r){var a=r.length,n=w4(t+2);e[n]=a&255,e[n+1]=a>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var i=0;i<a;++i)e[n+i+4]=r[i];return(n+4+a)*8},J2=function(e,t,r,a,n,i,o,l,c,u,f){Ts(t,f++,r),++n[256];for(var h=ap(n,15),p=h.t,d=h.l,v=ap(i,15),m=v.t,y=v.l,_=X2(p),k=_.c,g=_.n,w=X2(m),C=w.c,E=w.n,A=new Xn(19),I=0;I<k.length;++I)++A[k[I]&31];for(var I=0;I<C.length;++I)++A[C[I]&31];for(var D=ap(A,7),B=D.t,L=D.l,F=19;F>4&&!B[K2[F-1]];--F);var z=u+5<<3,M=Qc(n,hl)+Qc(i,nd)+o,q=Qc(n,p)+Qc(i,m)+o+14+3*F+Qc(A,B)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&z<=M&&z<=q)return _4(t,f,e.subarray(c,c+u));var fe,he,pe,Q;if(Ts(t,f,1+(q<M)),f+=2,q<M){fe=w0(p,d,0),he=p,pe=w0(m,y,0),Q=m;var we=w0(B,L,0);Ts(t,f,g-257),Ts(t,f+5,E-1),Ts(t,f+10,F-4),f+=14;for(var I=0;I<F;++I)Ts(t,f+3*I,B[K2[I]]);f+=3*F;for(var Y=[k,C],T=0;T<2;++T)for(var R=Y[T],I=0;I<R.length;++I){var N=R[I]&31;Ts(t,f,we[N]),f+=B[N],N>15&&(Ts(t,f,R[I]>>5&127),f+=R[I]>>12)}}else fe=DL,he=hl,pe=IL,Q=nd;for(var I=0;I<l;++I){var O=a[I];if(O>255){var N=O>>18&31;Zc(t,f,fe[N+257]),f+=he[N+257],N>7&&(Ts(t,f,O>>23&31),f+=cx[N]);var H=O&31;Zc(t,f,pe[H]),f+=Q[H],H>3&&(Zc(t,f,O>>5&8191),f+=ux[H])}else Zc(t,f,fe[O]),f+=he[O]}return Zc(t,f,fe[256]),f+he[256]},PL=new lx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),k4=new Bi(0),RL=function(e,t,r,a,n,i){var o=i.z||e.length,l=new Bi(a+o+5*(1+Math.ceil(o/7e3))+n),c=l.subarray(a,l.length-n),u=i.l,f=(i.r||0)&7;if(t){f&&(c[0]=i.r>>3);for(var h=PL[t-1],p=h>>13,d=h&8191,v=(1<<r)-1,m=i.p||new Xn(32768),y=i.h||new Xn(v+1),_=Math.ceil(r/3),k=2*_,g=function($e){return(e[$e]^e[$e+1]<<_^e[$e+2]<<k)&v},w=new lx(25e3),C=new Xn(288),E=new Xn(32),A=0,I=0,D=i.i||0,B=0,L=i.w||0,F=0;D+2<o;++D){var z=g(D),M=D&32767,q=y[z];if(m[M]=q,y[z]=M,L<=D){var fe=o-D;if((A>7e3||B>24576)&&(fe>423||!u)){f=J2(e,c,0,w,C,E,I,B,F,D-F,f),B=A=I=0,F=D;for(var he=0;he<286;++he)C[he]=0;for(var he=0;he<30;++he)E[he]=0}var pe=2,Q=0,we=d,Y=M-q&32767;if(fe>2&&z==g(D-Y))for(var T=Math.min(p,fe)-1,R=Math.min(32767,D),N=Math.min(258,fe);Y<=R&&--we&&M!=q;){if(e[D+pe]==e[D+pe-Y]){for(var O=0;O<N&&e[D+O]==e[D+O-Y];++O);if(O>pe){if(pe=O,Q=Y,O>T)break;for(var H=Math.min(Y,O-2),ae=0,he=0;he<H;++he){var de=D-Y+he&32767,me=m[de],xe=de-me&32767;xe>ae&&(ae=xe,q=de)}}}M=q,q=m[M],Y+=M-q&32767}if(Q){w[B++]=268435456|n1[pe]<<18|Y2[Q];var Se=n1[pe]&31,Z=Y2[Q]&31;I+=cx[Se]+ux[Z],++C[257+Se],++E[Z],L=D+pe,++A}else w[B++]=e[D],++C[e[D]]}}for(D=Math.max(D,L);D<o;++D)w[B++]=e[D],++C[e[D]];f=J2(e,c,u,w,C,E,I,B,F,D-F,f),u||(i.r=f&7|c[f/8|0]<<3,f-=7,i.h=y,i.p=m,i.i=D,i.w=L)}else{for(var D=i.w||0;D<o+u;D+=65535){var Fe=D+65535;Fe>=o&&(c[f/8|0]=u,Fe=o),f=_4(c,f+1,e.subarray(D,Fe))}i.i=o}return LL(l,0,a+w4(f)+n)},S4=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}e=a,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},OL=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Bi(i.length+e.length);o.set(i),o.set(e,i.length),e=o,n.w=i.length}return RL(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,n)},A4=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},BL=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=S4();n.p(t.dictionary),A4(e,2,n.d())}};function o1(e,t){t||(t={});var r=S4();r.p(e);var a=OL(e,t,t.dictionary?6:2,4);return BL(a,t),A4(a,a.length-4,r.d()),a}var ML=typeof TextDecoder<"u"&&new TextDecoder,zL=0;try{ML.decode(k4,{stream:!0}),zL=1}catch{}function UL(e){if(Array.isArray(e))return e}function WL(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,n,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(f){u=!0,n=f}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw n}}return l}}function Z2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function qL(e,t){if(e){if(typeof e=="string")return Z2(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z2(e,t):void 0}}function HL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q2(e,t){return UL(e)||WL(e,t)||qL(e,t)||HL()}function ev(e,t="utf8"){return new TextDecoder(t).decode(e)}const $L=new TextEncoder;function VL(e){return $L.encode(e)}const GL=1024*8,KL=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),np={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class fx{constructor(t=GL,r={}){Sr(this,"buffer");Sr(this,"byteLength");Sr(this,"byteOffset");Sr(this,"length");Sr(this,"offset");Sr(this,"lastWrittenByte");Sr(this,"littleEndian");Sr(this,"_data");Sr(this,"_mark");Sr(this,"_marks");let a=!1;typeof t=="number"?t=new ArrayBuffer(t):(a=!0,this.lastWrittenByte=t.byteLength);const n=r.offset?r.offset>>>0:0,i=t.byteLength-n;let o=n;(ArrayBuffer.isView(t)||t instanceof fx)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+n),t=t.buffer),a?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const a=(this.offset+t)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const a=np[r].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,i=this.buffer.slice(n,n+a);if(this.littleEndian===KL&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(n,n+a));l.reverse();const c=new np[r](l.buffer);return this.offset+=a,c.reverse(),c}const o=new np[r](i);return this.offset+=a,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let a=0;a<t;a++)r+=this.readChar();return r}readUtf8(t=1){return ev(this.readBytes(t))}decodeText(t=1,r="utf8"){return ev(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(VL(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ac(e){let t=e.length;for(;--t>=0;)e[t]=0}const YL=3,XL=258,N4=29,JL=256,ZL=JL+1+N4,j4=30,QL=512,eP=new Array((ZL+2)*2);Ac(eP);const tP=new Array(j4*2);Ac(tP);const rP=new Array(QL);Ac(rP);const aP=new Array(XL-YL+1);Ac(aP);const nP=new Array(N4);Ac(nP);const iP=new Array(j4);Ac(iP);const sP=(e,t,r,a)=>{let n=e&65535|0,i=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+t[a++]|0,i=i+n|0;while(--o);n%=65521,i%=65521}return n|i<<16|0};var l1=sP;const oP=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},lP=new Uint32Array(oP()),cP=(e,t,r,a)=>{const n=lP,i=a+r;e^=-1;for(let o=a;o<i;o++)e=e>>>8^n[(e^t[o])&255];return e^-1};var Xi=cP,c1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},T4={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const uP=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var fP=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)uP(r,a)&&(e[a]=r[a])}}return e},dP=e=>{let t=0;for(let a=0,n=e.length;a<n;a++)t+=e[a].length;const r=new Uint8Array(t);for(let a=0,n=0,i=e.length;a<i;a++){let o=e[a];r.set(o,n),n+=o.length}return r},E4={assign:fP,flattenChunks:dP};let C4=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{C4=!1}const q0=new Uint8Array(256);for(let e=0;e<256;e++)q0[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;q0[254]=q0[254]=1;var hP=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,a,n,i,o=e.length,l=0;for(n=0;n<o;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=e.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,n=0;i<l;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=e.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const pP=(e,t)=>{if(t<65534&&e.subarray&&C4)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r};var mP=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let a,n;const i=new Array(r*2);for(n=0,a=0;a<r;){let o=e[a++];if(o<128){i[n++]=o;continue}let l=q0[o];if(l>4){i[n++]=65533,a+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&a<r;)o=o<<6|e[a++]&63,l--;if(l>1){i[n++]=65533;continue}o<65536?i[n++]=o:(o-=65536,i[n++]=55296|o>>10&1023,i[n++]=56320|o&1023)}return pP(i,n)},xP=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+q0[e[r]]>t?r:t},u1={string2buf:hP,buf2string:mP,utf8border:xP};function gP(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var vP=gP;const uf=16209,yP=16191;var bP=function(t,r){let a,n,i,o,l,c,u,f,h,p,d,v,m,y,_,k,g,w,C,E,A,I,D,B;const L=t.state;a=t.next_in,D=t.input,n=a+(t.avail_in-5),i=t.next_out,B=t.output,o=i-(r-t.avail_out),l=i+(t.avail_out-257),c=L.dmax,u=L.wsize,f=L.whave,h=L.wnext,p=L.window,d=L.hold,v=L.bits,m=L.lencode,y=L.distcode,_=(1<<L.lenbits)-1,k=(1<<L.distbits)-1;e:do{v<15&&(d+=D[a++]<<v,v+=8,d+=D[a++]<<v,v+=8),g=m[d&_];t:for(;;){if(w=g>>>24,d>>>=w,v-=w,w=g>>>16&255,w===0)B[i++]=g&65535;else if(w&16){C=g&65535,w&=15,w&&(v<w&&(d+=D[a++]<<v,v+=8),C+=d&(1<<w)-1,d>>>=w,v-=w),v<15&&(d+=D[a++]<<v,v+=8,d+=D[a++]<<v,v+=8),g=y[d&k];r:for(;;){if(w=g>>>24,d>>>=w,v-=w,w=g>>>16&255,w&16){if(E=g&65535,w&=15,v<w&&(d+=D[a++]<<v,v+=8,v<w&&(d+=D[a++]<<v,v+=8)),E+=d&(1<<w)-1,E>c){t.msg="invalid distance too far back",L.mode=uf;break e}if(d>>>=w,v-=w,w=i-o,E>w){if(w=E-w,w>f&&L.sane){t.msg="invalid distance too far back",L.mode=uf;break e}if(A=0,I=p,h===0){if(A+=u-w,w<C){C-=w;do B[i++]=p[A++];while(--w);A=i-E,I=B}}else if(h<w){if(A+=u+h-w,w-=h,w<C){C-=w;do B[i++]=p[A++];while(--w);if(A=0,h<C){w=h,C-=w;do B[i++]=p[A++];while(--w);A=i-E,I=B}}}else if(A+=h-w,w<C){C-=w;do B[i++]=p[A++];while(--w);A=i-E,I=B}for(;C>2;)B[i++]=I[A++],B[i++]=I[A++],B[i++]=I[A++],C-=3;C&&(B[i++]=I[A++],C>1&&(B[i++]=I[A++]))}else{A=i-E;do B[i++]=B[A++],B[i++]=B[A++],B[i++]=B[A++],C-=3;while(C>2);C&&(B[i++]=B[A++],C>1&&(B[i++]=B[A++]))}}else if(w&64){t.msg="invalid distance code",L.mode=uf;break e}else{g=y[(g&65535)+(d&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){L.mode=yP;break e}else{t.msg="invalid literal/length code",L.mode=uf;break e}else{g=m[(g&65535)+(d&(1<<w)-1)];continue t}break}}while(a<n&&i<l);C=v>>3,a-=C,v-=C<<3,d&=(1<<v)-1,t.next_in=a,t.next_out=i,t.avail_in=a<n?5+(n-a):5-(a-n),t.avail_out=i<l?257+(l-i):257-(i-l),L.hold=d,L.bits=v};const Wl=15,tv=852,rv=592,av=0,ip=1,nv=2,wP=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_P=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),kP=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),SP=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),AP=(e,t,r,a,n,i,o,l)=>{const c=l.bits;let u=0,f=0,h=0,p=0,d=0,v=0,m=0,y=0,_=0,k=0,g,w,C,E,A,I=null,D;const B=new Uint16Array(Wl+1),L=new Uint16Array(Wl+1);let F=null,z,M,q;for(u=0;u<=Wl;u++)B[u]=0;for(f=0;f<a;f++)B[t[r+f]]++;for(d=c,p=Wl;p>=1&&B[p]===0;p--);if(d>p&&(d=p),p===0)return n[i++]=1<<24|64<<16|0,n[i++]=1<<24|64<<16|0,l.bits=1,0;for(h=1;h<p&&B[h]===0;h++);for(d<h&&(d=h),y=1,u=1;u<=Wl;u++)if(y<<=1,y-=B[u],y<0)return-1;if(y>0&&(e===av||p!==1))return-1;for(L[1]=0,u=1;u<Wl;u++)L[u+1]=L[u]+B[u];for(f=0;f<a;f++)t[r+f]!==0&&(o[L[t[r+f]]++]=f);if(e===av?(I=F=o,D=20):e===ip?(I=wP,F=_P,D=257):(I=kP,F=SP,D=0),k=0,f=0,u=h,A=i,v=d,m=0,C=-1,_=1<<d,E=_-1,e===ip&&_>tv||e===nv&&_>rv)return 1;for(;;){z=u-m,o[f]+1<D?(M=0,q=o[f]):o[f]>=D?(M=F[o[f]-D],q=I[o[f]-D]):(M=96,q=0),g=1<<u-m,w=1<<v,h=w;do w-=g,n[A+(k>>m)+w]=z<<24|M<<16|q|0;while(w!==0);for(g=1<<u-1;k&g;)g>>=1;if(g!==0?(k&=g-1,k+=g):k=0,f++,--B[u]===0){if(u===p)break;u=t[r+o[f]]}if(u>d&&(k&E)!==C){for(m===0&&(m=d),A+=h,v=u-m,y=1<<v;v+m<p&&(y-=B[v+m],!(y<=0));)v++,y<<=1;if(_+=1<<v,e===ip&&_>tv||e===nv&&_>rv)return 1;C=k&E,n[C]=d<<24|v<<16|A-i|0}}return k!==0&&(n[A+k]=u-m<<24|64<<16|0),l.bits=d,0};var _0=AP;const NP=0,F4=1,D4=2,{Z_FINISH:iv,Z_BLOCK:jP,Z_TREES:ff,Z_OK:pl,Z_STREAM_END:TP,Z_NEED_DICT:EP,Z_STREAM_ERROR:vi,Z_DATA_ERROR:I4,Z_MEM_ERROR:L4,Z_BUF_ERROR:CP,Z_DEFLATED:sv}=T4,Hd=16180,ov=16181,lv=16182,cv=16183,uv=16184,fv=16185,dv=16186,hv=16187,pv=16188,mv=16189,id=16190,Es=16191,sp=16192,xv=16193,op=16194,gv=16195,vv=16196,yv=16197,bv=16198,df=16199,hf=16200,wv=16201,_v=16202,kv=16203,Sv=16204,Av=16205,lp=16206,Nv=16207,jv=16208,Kr=16209,P4=16210,R4=16211,FP=852,DP=592,IP=15,LP=IP,Tv=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function PP(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const kl=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Hd||t.mode>R4?1:0},O4=e=>{if(kl(e))return vi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Hd,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(FP),t.distcode=t.distdyn=new Int32Array(DP),t.sane=1,t.back=-1,pl},B4=e=>{if(kl(e))return vi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,O4(e)},M4=(e,t)=>{let r;if(kl(e))return vi;const a=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?vi:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,B4(e))},z4=(e,t)=>{if(!e)return vi;const r=new PP;e.state=r,r.strm=e,r.window=null,r.mode=Hd;const a=M4(e,t);return a!==pl&&(e.state=null),a},RP=e=>z4(e,LP);let Ev=!0,cp,up;const OP=e=>{if(Ev){cp=new Int32Array(512),up=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(_0(F4,e.lens,0,288,cp,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;_0(D4,e.lens,0,32,up,0,e.work,{bits:5}),Ev=!1}e.lencode=cp,e.lenbits=9,e.distcode=up,e.distbits=5},U4=(e,t,r,a)=>{let n;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),a>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(n=i.wsize-i.wnext,n>a&&(n=a),i.window.set(t.subarray(r-a,r-a+n),i.wnext),a-=n,a?(i.window.set(t.subarray(r-a,r),0),i.wnext=a,i.whave=i.wsize):(i.wnext+=n,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=n))),0},BP=(e,t)=>{let r,a,n,i,o,l,c,u,f,h,p,d,v,m,y=0,_,k,g,w,C,E,A,I;const D=new Uint8Array(4);let B,L;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(kl(e)||!e.output||!e.input&&e.avail_in!==0)return vi;r=e.state,r.mode===Es&&(r.mode=sp),o=e.next_out,n=e.output,c=e.avail_out,i=e.next_in,a=e.input,l=e.avail_in,u=r.hold,f=r.bits,h=l,p=c,I=pl;e:for(;;)switch(r.mode){case Hd:if(r.wrap===0){r.mode=sp;break}for(;f<16;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,D[0]=u&255,D[1]=u>>>8&255,r.check=Xi(r.check,D,2,0),u=0,f=0,r.mode=ov;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Kr;break}if((u&15)!==sv){e.msg="unknown compression method",r.mode=Kr;break}if(u>>>=4,f-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=Kr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?mv:Es,u=0,f=0;break;case ov:for(;f<16;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(r.flags=u,(r.flags&255)!==sv){e.msg="unknown compression method",r.mode=Kr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Kr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,r.check=Xi(r.check,D,2,0)),u=0,f=0,r.mode=lv;case lv:for(;f<32;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,D[2]=u>>>16&255,D[3]=u>>>24&255,r.check=Xi(r.check,D,4,0)),u=0,f=0,r.mode=cv;case cv:for(;f<16;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,r.check=Xi(r.check,D,2,0)),u=0,f=0,r.mode=uv;case uv:if(r.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(D[0]=u&255,D[1]=u>>>8&255,r.check=Xi(r.check,D,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=fv;case fv:if(r.flags&1024&&(d=r.length,d>l&&(d=l),d&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(i,i+d),A)),r.flags&512&&r.wrap&4&&(r.check=Xi(r.check,a,d,i)),l-=d,i+=d,r.length-=d),r.length))break e;r.length=0,r.mode=dv;case dv:if(r.flags&2048){if(l===0)break e;d=0;do A=a[i+d++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&d<l);if(r.flags&512&&r.wrap&4&&(r.check=Xi(r.check,a,d,i)),l-=d,i+=d,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=hv;case hv:if(r.flags&4096){if(l===0)break e;d=0;do A=a[i+d++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&d<l);if(r.flags&512&&r.wrap&4&&(r.check=Xi(r.check,a,d,i)),l-=d,i+=d,A)break e}else r.head&&(r.head.comment=null);r.mode=pv;case pv:if(r.flags&512){for(;f<16;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Kr;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Es;break;case mv:for(;f<32;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}e.adler=r.check=Tv(u),u=0,f=0,r.mode=id;case id:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=f,EP;e.adler=r.check=1,r.mode=Es;case Es:if(t===jP||t===ff)break e;case sp:if(r.last){u>>>=f&7,f-=f&7,r.mode=lp;break}for(;f<3;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}switch(r.last=u&1,u>>>=1,f-=1,u&3){case 0:r.mode=xv;break;case 1:if(OP(r),r.mode=df,t===ff){u>>>=2,f-=2;break e}break;case 2:r.mode=vv;break;case 3:e.msg="invalid block type",r.mode=Kr}u>>>=2,f-=2;break;case xv:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Kr;break}if(r.length=u&65535,u=0,f=0,r.mode=op,t===ff)break e;case op:r.mode=gv;case gv:if(d=r.length,d){if(d>l&&(d=l),d>c&&(d=c),d===0)break e;n.set(a.subarray(i,i+d),o),l-=d,i+=d,c-=d,o+=d,r.length-=d;break}r.mode=Es;break;case vv:for(;f<14;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(r.nlen=(u&31)+257,u>>>=5,f-=5,r.ndist=(u&31)+1,u>>>=5,f-=5,r.ncode=(u&15)+4,u>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Kr;break}r.have=0,r.mode=yv;case yv:for(;r.have<r.ncode;){for(;f<3;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}r.lens[F[r.have++]]=u&7,u>>>=3,f-=3}for(;r.have<19;)r.lens[F[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},I=_0(NP,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,I){e.msg="invalid code lengths set",r.mode=Kr;break}r.have=0,r.mode=bv;case bv:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],_=y>>>24,k=y>>>16&255,g=y&65535,!(_<=f);){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(g<16)u>>>=_,f-=_,r.lens[r.have++]=g;else{if(g===16){for(L=_+2;f<L;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(u>>>=_,f-=_,r.have===0){e.msg="invalid bit length repeat",r.mode=Kr;break}A=r.lens[r.have-1],d=3+(u&3),u>>>=2,f-=2}else if(g===17){for(L=_+3;f<L;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}u>>>=_,f-=_,A=0,d=3+(u&7),u>>>=3,f-=3}else{for(L=_+7;f<L;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}u>>>=_,f-=_,A=0,d=11+(u&127),u>>>=7,f-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Kr;break}for(;d--;)r.lens[r.have++]=A}}if(r.mode===Kr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Kr;break}if(r.lenbits=9,B={bits:r.lenbits},I=_0(F4,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,I){e.msg="invalid literal/lengths set",r.mode=Kr;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},I=_0(D4,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,I){e.msg="invalid distances set",r.mode=Kr;break}if(r.mode=df,t===ff)break e;case df:r.mode=hf;case hf:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=f,bP(e,p),o=e.next_out,n=e.output,c=e.avail_out,i=e.next_in,a=e.input,l=e.avail_in,u=r.hold,f=r.bits,r.mode===Es&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],_=y>>>24,k=y>>>16&255,g=y&65535,!(_<=f);){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(k&&!(k&240)){for(w=_,C=k,E=g;y=r.lencode[E+((u&(1<<w+C)-1)>>w)],_=y>>>24,k=y>>>16&255,g=y&65535,!(w+_<=f);){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}u>>>=w,f-=w,r.back+=w}if(u>>>=_,f-=_,r.back+=_,r.length=g,k===0){r.mode=Av;break}if(k&32){r.back=-1,r.mode=Es;break}if(k&64){e.msg="invalid literal/length code",r.mode=Kr;break}r.extra=k&15,r.mode=wv;case wv:if(r.extra){for(L=r.extra;f<L;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=_v;case _v:for(;y=r.distcode[u&(1<<r.distbits)-1],_=y>>>24,k=y>>>16&255,g=y&65535,!(_<=f);){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(!(k&240)){for(w=_,C=k,E=g;y=r.distcode[E+((u&(1<<w+C)-1)>>w)],_=y>>>24,k=y>>>16&255,g=y&65535,!(w+_<=f);){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}u>>>=w,f-=w,r.back+=w}if(u>>>=_,f-=_,r.back+=_,k&64){e.msg="invalid distance code",r.mode=Kr;break}r.offset=g,r.extra=k&15,r.mode=kv;case kv:if(r.extra){for(L=r.extra;f<L;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Kr;break}r.mode=Sv;case Sv:if(c===0)break e;if(d=p-c,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Kr;break}d>r.wnext?(d-=r.wnext,v=r.wsize-d):v=r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=n,v=o-r.offset,d=r.length;d>c&&(d=c),c-=d,r.length-=d;do n[o++]=m[v++];while(--d);r.length===0&&(r.mode=hf);break;case Av:if(c===0)break e;n[o++]=r.length,c--,r.mode=hf;break;case lp:if(r.wrap){for(;f<32;){if(l===0)break e;l--,u|=a[i++]<<f,f+=8}if(p-=c,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Xi(r.check,n,p,o-p):l1(r.check,n,p,o-p)),p=c,r.wrap&4&&(r.flags?u:Tv(u))!==r.check){e.msg="incorrect data check",r.mode=Kr;break}u=0,f=0}r.mode=Nv;case Nv:if(r.wrap&&r.flags){for(;f<32;){if(l===0)break e;l--,u+=a[i++]<<f,f+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Kr;break}u=0,f=0}r.mode=jv;case jv:I=TP;break e;case Kr:I=I4;break e;case P4:return L4;case R4:default:return vi}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=f,(r.wsize||p!==e.avail_out&&r.mode<Kr&&(r.mode<lp||t!==iv))&&U4(e,e.output,e.next_out,p-e.avail_out),h-=e.avail_in,p-=e.avail_out,e.total_in+=h,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Xi(r.check,n,p,e.next_out-p):l1(r.check,n,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Es?128:0)+(r.mode===df||r.mode===op?256:0),(h===0&&p===0||t===iv)&&I===pl&&(I=CP),I},MP=e=>{if(kl(e))return vi;let t=e.state;return t.window&&(t.window=null),e.state=null,pl},zP=(e,t)=>{if(kl(e))return vi;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,pl):vi},UP=(e,t)=>{const r=t.length;let a,n,i;return kl(e)||(a=e.state,a.wrap!==0&&a.mode!==id)?vi:a.mode===id&&(n=1,n=l1(n,t,r,0),n!==a.check)?I4:(i=U4(e,t,r,r),i?(a.mode=P4,L4):(a.havedict=1,pl))};var WP=B4,qP=M4,HP=O4,$P=RP,VP=z4,GP=BP,KP=MP,YP=zP,XP=UP,JP="pako inflate (from Nodeca project)",Fs={inflateReset:WP,inflateReset2:qP,inflateResetKeep:HP,inflateInit:$P,inflateInit2:VP,inflate:GP,inflateEnd:KP,inflateGetHeader:YP,inflateSetDictionary:XP,inflateInfo:JP};function ZP(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var QP=ZP;const W4=Object.prototype.toString,{Z_NO_FLUSH:eR,Z_FINISH:tR,Z_OK:H0,Z_STREAM_END:fp,Z_NEED_DICT:dp,Z_STREAM_ERROR:rR,Z_DATA_ERROR:Cv,Z_MEM_ERROR:aR}=T4;function fu(e){this.options=E4.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vP,this.strm.avail_out=0;let r=Fs.inflateInit2(this.strm,t.windowBits);if(r!==H0)throw new Error(c1[r]);if(this.header=new QP,Fs.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=u1.string2buf(t.dictionary):W4.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Fs.inflateSetDictionary(this.strm,t.dictionary),r!==H0)))throw new Error(c1[r])}fu.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?tR:eR,W4.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),i=Fs.inflate(r,o),i===dp&&n&&(i=Fs.inflateSetDictionary(r,n),i===H0?i=Fs.inflate(r,o):i===Cv&&(i=dp));r.avail_in>0&&i===fp&&r.state.wrap>0&&e[r.next_in]!==0;)Fs.inflateReset(r),i=Fs.inflate(r,o);switch(i){case rR:case Cv:case dp:case aR:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===fp))if(this.options.to==="string"){let c=u1.utf8border(r.output,r.next_out),u=r.next_out-c,f=u1.buf2string(r.output,c);r.next_out=u,r.avail_out=a-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===H0&&l===0)){if(i===fp)return i=Fs.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};fu.prototype.onData=function(e){this.chunks.push(e)};fu.prototype.onEnd=function(e){e===H0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E4.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function nR(e,t){const r=new fu(t);if(r.push(e),r.err)throw r.msg||c1[r.err];return r.result}var iR=fu,sR=nR,oR={Inflate:iR,inflate:sR};const{Inflate:lR,inflate:cR}=oR;var Fv=lR,uR=cR;const q4=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;q4[e]=t}const Dv=4294967295;function fR(e,t,r){let a=e;for(let n=0;n<r;n++)a=q4[(a^t[n])&255]^a>>>8;return a}function dR(e,t){return(fR(Dv,e,t)^Dv)>>>0}function Iv(e,t,r){const a=e.readUint32(),n=dR(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function H4(e,t,r){for(let a=0;a<r;a++)t[a]=e[a]}function $4(e,t,r,a){let n=0;for(;n<a;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+t[n-a]&255}function V4(e,t,r,a){let n=0;if(r.length===0)for(;n<a;n++)t[n]=e[n];else for(;n<a;n++)t[n]=e[n]+r[n]&255}function G4(e,t,r,a,n){let i=0;if(r.length===0){for(;i<n;i++)t[i]=e[i];for(;i<a;i++)t[i]=e[i]+(t[i-n]>>1)&255}else{for(;i<n;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<a;i++)t[i]=e[i]+(t[i-n]+r[i]>>1)&255}}function K4(e,t,r,a,n){let i=0;if(r.length===0){for(;i<n;i++)t[i]=e[i];for(;i<a;i++)t[i]=e[i]+t[i-n]&255}else{for(;i<n;i++)t[i]=e[i]+r[i]&255;for(;i<a;i++)t[i]=e[i]+hR(t[i-n],r[i],r[i-n])&255}}function hR(e,t,r){const a=e+t-r,n=Math.abs(a-e),i=Math.abs(a-t),o=Math.abs(a-r);return n<=i&&n<=o?e:i<=o?t:r}function pR(e,t,r,a,n,i){switch(e){case 0:H4(t,r,n);break;case 1:$4(t,r,n,i);break;case 2:V4(t,r,a,n);break;case 3:G4(t,r,a,n,i);break;case 4:K4(t,r,a,n,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const mR=new Uint16Array([255]),xR=new Uint8Array(mR.buffer),gR=xR[0]===255;function vR(e){const{data:t,width:r,height:a,channels:n,depth:i}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*n,c=new Uint8Array(a*r*l);let u=0;for(let f=0;f<7;f++){const h=o[f],p=Math.ceil((r-h.x)/h.xStep),d=Math.ceil((a-h.y)/h.yStep);if(p<=0||d<=0)continue;const v=p*l,m=new Uint8Array(v);for(let y=0;y<d;y++){const _=t[u++],k=t.subarray(u,u+v);u+=v;const g=new Uint8Array(v);pR(_,k,g,m,v,l),m.set(g);for(let w=0;w<p;w++){const C=h.x+w*h.xStep,E=h.y+y*h.yStep;if(!(C>=r||E>=a))for(let A=0;A<l;A++)c[(E*r+C)*l+A]=g[w*l+A]}}}if(i===16){const f=new Uint16Array(c.buffer);if(gR)for(let h=0;h<f.length;h++)f[h]=yR(f[h]);return f}else return c}function yR(e){return(e&255)<<8|e>>8&255}const bR=new Uint16Array([255]),wR=new Uint8Array(bR.buffer),_R=wR[0]===255,kR=new Uint8Array(0);function Lv(e){const{data:t,width:r,height:a,channels:n,depth:i}=e,o=Math.ceil(i/8)*n,l=Math.ceil(i/8*n*r),c=new Uint8Array(a*l);let u=kR,f=0,h,p;for(let d=0;d<a;d++){switch(h=t.subarray(f+1,f+1+l),p=c.subarray(d*l,(d+1)*l),t[f]){case 0:H4(h,p,l);break;case 1:$4(h,p,l,o);break;case 2:V4(h,p,u,l);break;case 3:G4(h,p,u,l,o);break;case 4:K4(h,p,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[f]}`)}u=p,f+=l+1}if(i===16){const d=new Uint16Array(c.buffer);if(_R)for(let v=0;v<d.length;v++)d[v]=SR(d[v]);return d}else return c}function SR(e){return(e&255)<<8|e>>8&255}const jf=Uint8Array.of(137,80,78,71,13,10,26,10);function Pv(e){if(!AR(e.readBytes(jf.length)))throw new Error("wrong PNG signature")}function AR(e){if(e.length<jf.length)return!1;for(let t=0;t<jf.length;t++)if(e[t]!==jf[t])return!1;return!0}const NR="tEXt",jR=0,Y4=new TextDecoder("latin1");function TR(e){if(CR(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const ER=/^[\u0000-\u00FF]*$/;function CR(e){if(!ER.test(e))throw new Error("invalid latin1 text")}function FR(e,t,r){const a=X4(t);e[a]=DR(t,r-a.length-1)}function X4(e){for(e.mark();e.readByte()!==jR;);const t=e.offset;e.reset();const r=Y4.decode(e.readBytes(t-e.offset-1));return e.skip(1),TR(r),r}function DR(e,t){return Y4.decode(e.readBytes(t))}const Hn={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},hp={UNKNOWN:-1,DEFLATE:0},Rv={UNKNOWN:-1,ADAPTIVE:0},pp={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},pf={NONE:0,BACKGROUND:1,PREVIOUS:2},mp={SOURCE:0,OVER:1};class IR extends fx{constructor(r,a={}){super(r);Sr(this,"_checkCrc");Sr(this,"_inflator");Sr(this,"_png");Sr(this,"_apng");Sr(this,"_end");Sr(this,"_hasPalette");Sr(this,"_palette");Sr(this,"_hasTransparency");Sr(this,"_transparency");Sr(this,"_compressionMethod");Sr(this,"_filterMethod");Sr(this,"_interlaceMethod");Sr(this,"_colorType");Sr(this,"_isAnimated");Sr(this,"_numberOfFrames");Sr(this,"_numberOfPlays");Sr(this,"_frames");Sr(this,"_writingDataChunks");const{checkCrc:n=!1}=a;this._checkCrc=n,this._inflator=new Fv,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=hp.UNKNOWN,this._filterMethod=Rv.UNKNOWN,this._interlaceMethod=pp.UNKNOWN,this._colorType=Hn.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Pv(this);!this._end;){const r=this.readUint32(),a=this.readChars(4);this.decodeChunk(r,a)}return this.decodeImage(),this._png}decodeApng(){for(Pv(this);!this._end;){const r=this.readUint32(),a=this.readChars(4);this.decodeApngChunk(r,a)}return this.decodeApngImage(),this._apng}decodeChunk(r,a){const n=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case NR:FR(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Iv(this,r+4,a):this.skip(4)}decodeApngChunk(r,a){const n=this.offset;switch(a!=="fdAT"&&a!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),a){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,a),this.offset=n+r;break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Iv(this,r+4,a):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=LR(this.readUint8());const a=this.readUint8();this._colorType=a;let n;switch(a){case Hn.GREYSCALE:n=1;break;case Hn.TRUECOLOUR:n=3;break;case Hn.INDEXED_COLOUR:n=1;break;case Hn.GREYSCALE_ALPHA:n=2;break;case Hn.TRUECOLOUR_ALPHA:n=4;break;case Hn.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==hp.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const a=r/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<a;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const a=r,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let a=r,n=this.offset+this.byteOffset;if(n+=4,a-=4,this._inflator.push(new Uint8Array(this.buffer,n,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Hn.GREYSCALE:case Hn.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let a=0;a<r/2;a++)this._transparency[a]=this.readUint16();break}case Hn.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let a=0;for(;a<r;a++){const n=this.readByte();this._palette[a].push(n)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case Hn.UNKNOWN:case Hn.GREYSCALE_ALPHA:case Hn.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const a=X4(this),n=this.readUint8();if(n!==hp.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(r-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:uR(i)}}decodepHYs(){const r=this.readUint32(),a=this.readUint32(),n=this.readByte();this._png.resolution={x:r,y:a,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const a={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(r);if(n){if(n.data=Lv({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)a.data=n.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(n,i,a),this.addFrameDataToCanvas(a,n)}this._apng.frames.push(a)}}return this._apng}disposeFrame(r,a,n){switch(r.disposeOp){case pf.NONE:break;case pf.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)n.data[l+c]=0}break;case pf.PREVIOUS:n.data.set(a.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,a){const n=1<<this._png.depth,i=(o,l)=>{const c=((o+a.yOffset)*this._png.width+a.xOffset+l)*this._png.channels,u=(o*a.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(a.blendOp){case mp.SOURCE:for(let o=0;o<a.height;o++)for(let l=0;l<a.width;l++){const{index:c,frameIndex:u}=i(o,l);for(let f=0;f<this._png.channels;f++)r.data[c+f]=a.data[u+f]}break;case mp.OVER:for(let o=0;o<a.height;o++)for(let l=0;l<a.width;l++){const{index:c,frameIndex:u}=i(o,l);for(let f=0;f<this._png.channels;f++){const h=a.data[u+this._png.channels-1]/n,p=f%(this._png.channels-1)===0?1:a.data[u+f],d=Math.floor(h*p+(1-h)*r.data[c+f]);r.data[c+f]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var a;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((a=this._frames)==null?void 0:a.at(0)).data:this._inflator.result;if(this._filterMethod!==Rv.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===pp.NO_INTERLACE)this._png.data=Lv({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===pp.ADAM7)this._png.data=vR({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,a=this._frames.at(-1);a?a.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:pf.NONE,blendOp:mp.SOURCE,data:r}),this._inflator=new Fv,this._writingDataChunks=!1}}function LR(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var Ov;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(Ov||(Ov={}));function PR(e,t){return new IR(e,t).decode()}var Bt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function xp(){Bt.console&&typeof Bt.console.log=="function"&&Bt.console.log.apply(Bt.console,arguments)}var Lr={log:xp,warn:function(e){Bt.console&&(typeof Bt.console.warn=="function"?Bt.console.warn.apply(Bt.console,arguments):xp.call(null,arguments))},error:function(e){Bt.console&&(typeof Bt.console.error=="function"?Bt.console.error.apply(Bt.console,arguments):xp(e))}};function gp(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){$o(a.response,t,r)},a.onerror=function(){Lr.error("could not download file")},a.send()}function Bv(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function mf(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var $o=Bt.saveAs||((typeof window>"u"?"undefined":jr(window))!=="object"||window!==Bt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Bt.URL||Bt.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin!==location.origin?Bv(n.href)?gp(e,t,r):mf(n,n.target="_blank"):mf(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){mf(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Bv(e))gp(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){mf(a)})}else navigator.msSaveOrOpenBlob(function(n,i){return i===void 0?i={autoBom:!1}:jr(i)!=="object"&&(Lr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return gp(e,t,r);var n=e.type==="application/octet-stream",i=/constructor/i.test(Bt.HTMLElement)||Bt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":jr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=f:location=f,a=null},l.readAsDataURL(e)}else{var c=Bt.URL||Bt.webkitURL,u=c.createObjectURL(e);a?a.location=u:location.href=u,a=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function J4(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,i=r[a].process,o=n.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Tf=Bt.atob.bind(Bt),Mv=Bt.btoa.bind(Bt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function vp(e,t){var r=e[0],a=e[1],n=e[2],i=e[3];r=on(r,a,n,i,t[0],7,-680876936),i=on(i,r,a,n,t[1],12,-389564586),n=on(n,i,r,a,t[2],17,606105819),a=on(a,n,i,r,t[3],22,-1044525330),r=on(r,a,n,i,t[4],7,-176418897),i=on(i,r,a,n,t[5],12,1200080426),n=on(n,i,r,a,t[6],17,-1473231341),a=on(a,n,i,r,t[7],22,-45705983),r=on(r,a,n,i,t[8],7,1770035416),i=on(i,r,a,n,t[9],12,-1958414417),n=on(n,i,r,a,t[10],17,-42063),a=on(a,n,i,r,t[11],22,-1990404162),r=on(r,a,n,i,t[12],7,1804603682),i=on(i,r,a,n,t[13],12,-40341101),n=on(n,i,r,a,t[14],17,-1502002290),r=ln(r,a=on(a,n,i,r,t[15],22,1236535329),n,i,t[1],5,-165796510),i=ln(i,r,a,n,t[6],9,-1069501632),n=ln(n,i,r,a,t[11],14,643717713),a=ln(a,n,i,r,t[0],20,-373897302),r=ln(r,a,n,i,t[5],5,-701558691),i=ln(i,r,a,n,t[10],9,38016083),n=ln(n,i,r,a,t[15],14,-660478335),a=ln(a,n,i,r,t[4],20,-405537848),r=ln(r,a,n,i,t[9],5,568446438),i=ln(i,r,a,n,t[14],9,-1019803690),n=ln(n,i,r,a,t[3],14,-187363961),a=ln(a,n,i,r,t[8],20,1163531501),r=ln(r,a,n,i,t[13],5,-1444681467),i=ln(i,r,a,n,t[2],9,-51403784),n=ln(n,i,r,a,t[7],14,1735328473),r=cn(r,a=ln(a,n,i,r,t[12],20,-1926607734),n,i,t[5],4,-378558),i=cn(i,r,a,n,t[8],11,-2022574463),n=cn(n,i,r,a,t[11],16,1839030562),a=cn(a,n,i,r,t[14],23,-35309556),r=cn(r,a,n,i,t[1],4,-1530992060),i=cn(i,r,a,n,t[4],11,1272893353),n=cn(n,i,r,a,t[7],16,-155497632),a=cn(a,n,i,r,t[10],23,-1094730640),r=cn(r,a,n,i,t[13],4,681279174),i=cn(i,r,a,n,t[0],11,-358537222),n=cn(n,i,r,a,t[3],16,-722521979),a=cn(a,n,i,r,t[6],23,76029189),r=cn(r,a,n,i,t[9],4,-640364487),i=cn(i,r,a,n,t[12],11,-421815835),n=cn(n,i,r,a,t[15],16,530742520),r=un(r,a=cn(a,n,i,r,t[2],23,-995338651),n,i,t[0],6,-198630844),i=un(i,r,a,n,t[7],10,1126891415),n=un(n,i,r,a,t[14],15,-1416354905),a=un(a,n,i,r,t[5],21,-57434055),r=un(r,a,n,i,t[12],6,1700485571),i=un(i,r,a,n,t[3],10,-1894986606),n=un(n,i,r,a,t[10],15,-1051523),a=un(a,n,i,r,t[1],21,-2054922799),r=un(r,a,n,i,t[8],6,1873313359),i=un(i,r,a,n,t[15],10,-30611744),n=un(n,i,r,a,t[6],15,-1560198380),a=un(a,n,i,r,t[13],21,1309151649),r=un(r,a,n,i,t[4],6,-145523070),i=un(i,r,a,n,t[11],10,-1120210379),n=un(n,i,r,a,t[2],15,718787259),a=un(a,n,i,r,t[9],21,-343485551),e[0]=mo(r,e[0]),e[1]=mo(a,e[1]),e[2]=mo(n,e[2]),e[3]=mo(i,e[3])}function $d(e,t,r,a,n,i){return t=mo(mo(t,e),mo(a,i)),mo(t<<n|t>>>32-n,r)}function on(e,t,r,a,n,i,o){return $d(t&r|~t&a,e,t,n,i,o)}function ln(e,t,r,a,n,i,o){return $d(t&a|r&~a,e,t,n,i,o)}function cn(e,t,r,a,n,i,o){return $d(t^r^a,e,t,n,i,o)}function un(e,t,r,a,n,i,o){return $d(r^(t|~a),e,t,n,i,o)}function Z4(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)vp(a,RR(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(vp(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,vp(a,n),a}function RR(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var zv="0123456789abcdef".split("");function OR(e){for(var t="",r=0;r<4;r++)t+=zv[e>>8*r+4&15]+zv[e>>8*r&15];return t}function BR(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function f1(e){return Z4(e).map(BR).join("")}var MR=function(e){for(var t=0;t<e.length;t++)e[t]=OR(e[t]);return e.join("")}(Z4("hello"))!="5d41402abc4b2a76b9719d911017c592";function mo(e,t){if(MR){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function d1(e,t){var r,a,n,i;if(e!==r){for(var o=(n=e,i=1+(256/e.length|0),new Array(i+1).join(n)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var f=l[c];u=(u+f+o.charCodeAt(c))%256,l[c]=l[u],l[u]=f}r=e,a=l}else l=a;var h=t.length,p=0,d=0,v="";for(c=0;c<h;c++)d=(d+(f=l[p=(p+1)%256]))%256,l[p]=l[d],l[d]=f,o=l[(l[p]+l[d])%256],v+=String.fromCharCode(t.charCodeAt(c)^o);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Uv={print:4,modify:8,copy:16,"annot-forms":32};function Kl(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(l){if(Uv.perm!==void 0)throw new Error("Invalid permission: "+l);n+=Uv[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=f1(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=d1(this.encryptionKey,this.padding)}function Yl(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);t+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):e[a]}return t}function Wv(e){if(jr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[a,!!n],i},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,a)}catch(l){Bt.console&&Lr.error("jsPDF PubSub Error",l.message,l)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function sd(e){if(!(this instanceof sd))return new sd(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Q4(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Ko(e,t,r,a,n){if(!(this instanceof Ko))return new Ko(e,t,r,a,n);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Q4.call(this,a,n)}function Ql(e,t,r,a,n){if(!(this instanceof Ql))return new Ql(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Q4.call(this,a,n)}function ht(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],i=arguments[3],o=[],l=1,c=16,u="S",f=null;jr(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,n=e.format||n,i=e.compress||e.compressPdf||i,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},d={internal:{},__private__:{}};d.__private__.PubSub=Wv;var v="1.3",m=d.__private__.getPdfVersion=function(){return v};d.__private__.setPdfVersion=function(S){v=S};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return y};var _=d.__private__.getPageFormat=function(S){return y[S]};n=n||"a4";var k="compat",g="advanced",w=k;function C(){this.saveGraphicsState(),J(new Ct(Qe,0,0,-Qe,0,Lo()*Qe).toString()+" cm"),this.setFontSize(this.getFontSize()/Qe),u="n",w=g}function E(){this.restoreGraphicsState(),u="S",w=k}var A=d.__private__.combineFontStyleAndFontWeight=function(S,U){if(S=="bold"&&U=="normal"||S=="bold"&&U==400||S=="normal"&&U=="italic"||S=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(S=U==400||U==="normal"?S==="italic"?"italic":"normal":U!=700&&U!=="bold"||S!=="normal"?(U==700?"bold":U)+""+S:"bold"),S};d.advancedAPI=function(S){var U=w===k;return U&&C.call(this),typeof S!="function"||(S(this),U&&E.call(this)),this},d.compatAPI=function(S){var U=w===g;return U&&E.call(this),typeof S!="function"||(S(this),U&&C.call(this)),this},d.isAdvancedAPI=function(){return w===g};var I,D=function(S){if(w!==g)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=d.roundToPrecision=d.__private__.roundToPrecision=function(S,U){var le=t||U;if(isNaN(S)||isNaN(le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(le).replace(/0+$/,"")};I=d.hpf=d.__private__.hpf=typeof c=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return B(S,c)}:c==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return B(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return B(S,16)};var L=d.f2=d.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return B(S,2)},F=d.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return B(S,3)},z=d.scale=d.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return w===k?S*Qe:w===g?S:void 0},M=function(S){return z(function(U){return w===k?Lo()-U:w===g?U:void 0}(S))};d.__private__.setPrecision=d.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var q,fe="00000000000000000000000000000000",he=d.__private__.getFileId=function(){return fe},pe=d.__private__.setFileId=function(S){return fe=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():fe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Ea=new Kl(f.userPermissions,f.userPassword,f.ownerPassword,fe)),fe};d.setFileId=function(S){return pe(S),this},d.getFileId=function(){return he()};var Q=d.__private__.convertDateToPDFDate=function(S){var U=S.getTimezoneOffset(),le=U<0?"+":"-",ge=Math.floor(Math.abs(U/60)),be=Math.abs(U%60),Pe=[le,N(ge),"'",N(be),"'"].join("");return["D:",S.getFullYear(),N(S.getMonth()+1),N(S.getDate()),N(S.getHours()),N(S.getMinutes()),N(S.getSeconds()),Pe].join("")},we=d.__private__.convertPDFDateToDate=function(S){var U=parseInt(S.substr(2,4),10),le=parseInt(S.substr(6,2),10)-1,ge=parseInt(S.substr(8,2),10),be=parseInt(S.substr(10,2),10),Pe=parseInt(S.substr(12,2),10),Ue=parseInt(S.substr(14,2),10);return new Date(U,le,ge,be,Pe,Ue,0)},Y=d.__private__.setCreationDate=function(S){var U;if(S===void 0&&(S=new Date),S instanceof Date)U=Q(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=S}return q=U},T=d.__private__.getCreationDate=function(S){var U=q;return S==="jsDate"&&(U=we(q)),U};d.setCreationDate=function(S){return Y(S),this},d.getCreationDate=function(S){return T(S)};var R,N=d.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},O=d.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},H=0,ae=[],de=[],me=0,xe=[],Se=[],Z=!1,Fe=de;d.__private__.setCustomOutputDestination=function(S){Z=!0,Fe=S};var $e=function(S){Z||(Fe=S)};d.__private__.resetCustomOutputDestination=function(){Z=!1,Fe=de};var J=d.__private__.out=function(S){return S=S.toString(),me+=S.length+1,Fe.push(S),Fe},Oe=d.__private__.write=function(S){return J(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},Be=d.__private__.getArrayBuffer=function(S){for(var U=S.length,le=new ArrayBuffer(U),ge=new Uint8Array(le);U--;)ge[U]=S.charCodeAt(U);return le},it=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return it};var Me=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(S){return Me=w===g?S/Qe:S,this};var pt,at=d.__private__.getFontSize=d.getFontSize=function(){return w===k?Me:Me*Qe},bt=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(S){return bt=S,this},d.__private__.getR2L=d.getR2L=function(){return bt};var ft,qt=d.__private__.setZoomMode=function(S){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))pt=S;else if(isNaN(S)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');pt=S}else pt=parseInt(S,10)};d.__private__.getZoomMode=function(){return pt};var Mt,jt=d.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');ft=S};d.__private__.getPageMode=function(){return ft};var Xt=d.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');Mt=S};d.__private__.getLayoutMode=function(){return Mt},d.__private__.setDisplayMode=d.setDisplayMode=function(S,U,le){return qt(S),Xt(U),jt(le),this};var Tt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(S){if(Object.keys(Tt).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Tt[S]},d.__private__.getDocumentProperties=function(){return Tt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(S){for(var U in Tt)Tt.hasOwnProperty(U)&&S[U]&&(Tt[U]=S[U]);return this},d.__private__.setDocumentProperty=function(S,U){if(Object.keys(Tt).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Tt[S]=U};var st,Qe,et,fr,Nt,Ot={},Gt={},Br=[],St={},wr={},Et={},zt={},Mr=null,er=0,At=[],vr=new Wv(d),fs=e.hotfixes||[],za={},bi={},ti=[],Ct=function S(U,le,ge,be,Pe,Ue){if(!(this instanceof S))return new S(U,le,ge,be,Pe,Ue);isNaN(U)&&(U=1),isNaN(le)&&(le=0),isNaN(ge)&&(ge=0),isNaN(be)&&(be=1),isNaN(Pe)&&(Pe=0),isNaN(Ue)&&(Ue=0),this._matrix=[U,le,ge,be,Pe,Ue]};Object.defineProperty(Ct.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(Ct.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(Ct.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(Ct.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(Ct.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(Ct.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(Ct.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(Ct.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(Ct.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(Ct.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(Ct.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(Ct.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(Ct.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ct.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ct.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ct.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ct.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(S)},Ct.prototype.multiply=function(S){var U=S.sx*this.sx+S.shy*this.shx,le=S.sx*this.shy+S.shy*this.sy,ge=S.shx*this.sx+S.sy*this.shx,be=S.shx*this.shy+S.sy*this.sy,Pe=S.tx*this.sx+S.ty*this.shx+this.tx,Ue=S.tx*this.shy+S.ty*this.sy+this.ty;return new Ct(U,le,ge,be,Pe,Ue)},Ct.prototype.decompose=function(){var S=this.sx,U=this.shy,le=this.shx,ge=this.sy,be=this.tx,Pe=this.ty,Ue=Math.sqrt(S*S+U*U),dt=(S/=Ue)*le+(U/=Ue)*ge;le-=S*dt,ge-=U*dt;var yt=Math.sqrt(le*le+ge*ge);return dt/=yt,S*(ge/=yt)<U*(le/=yt)&&(S=-S,U=-U,dt=-dt,Ue=-Ue),{scale:new Ct(Ue,0,0,yt,0,0),translate:new Ct(1,0,0,1,be,Pe),rotate:new Ct(S,U,-U,S,0,0),skew:new Ct(1,0,dt,1,0,0)}},Ct.prototype.toString=function(S){return this.join(" ")},Ct.prototype.inversed=function(){var S=this.sx,U=this.shy,le=this.shx,ge=this.sy,be=this.tx,Pe=this.ty,Ue=1/(S*ge-U*le),dt=ge*Ue,yt=-U*Ue,Ut=-le*Ue,Kt=S*Ue;return new Ct(dt,yt,Ut,Kt,-dt*be-Ut*Pe,-yt*be-Kt*Pe)},Ct.prototype.applyToPoint=function(S){var U=S.x*this.sx+S.y*this.shx+this.tx,le=S.x*this.shy+S.y*this.sy+this.ty;return new xs(U,le)},Ct.prototype.applyToRectangle=function(S){var U=this.applyToPoint(S),le=this.applyToPoint(new xs(S.x+S.w,S.y+S.h));return new Fc(U.x,U.y,le.x-U.x,le.y-U.y)},Ct.prototype.clone=function(){var S=this.sx,U=this.shy,le=this.shx,ge=this.sy,be=this.tx,Pe=this.ty;return new Ct(S,U,le,ge,be,Pe)},d.Matrix=Ct;var wi=d.matrixMult=function(S,U){return U.multiply(S)},_i=new Ct(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=_i;var an=function(S,U){if(!wr[S]){var le=(U instanceof Ko?"Sh":"P")+(Object.keys(St).length+1).toString(10);U.id=le,wr[S]=le,St[le]=U,vr.publish("addPattern",U)}};d.ShadingPattern=Ko,d.TilingPattern=Ql,d.addShadingPattern=function(S,U){return D("addShadingPattern()"),an(S,U),this},d.beginTilingPattern=function(S){D("beginTilingPattern()"),Dc(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},d.endTilingPattern=function(S,U){D("endTilingPattern()"),U.stream=Se[R].join(`
`),an(S,U),vr.publish("endTilingPattern",U),ti.pop().restore()};var Tn,Gr=d.__private__.newObject=function(){var S=wa();return V(S,!0),S},wa=d.__private__.newObjectDeferred=function(){return H++,ae[H]=function(){return me},H},V=function(S,U){return U=typeof U=="boolean"&&U,ae[S]=me,U&&J(S+" 0 obj"),S},se=d.__private__.newAdditionalObject=function(){var S={objId:wa(),content:""};return xe.push(S),S},ee=wa(),re=wa(),oe=d.__private__.decodeColorString=function(S){var U=S.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length!==5||U[4]!=="k"&&U[4]!=="K"||(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var le=parseFloat(U[0]);U=[le,le,le,"r"]}for(var ge="#",be=0;be<3;be++)ge+=("0"+Math.floor(255*parseFloat(U[be])).toString(16)).slice(-2);return ge},ce=d.__private__.encodeColorString=function(S){var U;typeof S=="string"&&(S={ch1:S});var le=S.ch1,ge=S.ch2,be=S.ch3,Pe=S.ch4,Ue=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof le=="string"&&le.charAt(0)!=="#"){var dt=new J4(le);if(dt.ok)le=dt.toHex();else if(!/^\d*\.?\d*$/.test(le))throw new Error('Invalid color "'+le+'" passed to jsPDF.encodeColorString.')}if(typeof le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(le)&&(le="#"+le[1]+le[1]+le[2]+le[2]+le[3]+le[3]),typeof le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(le)){var yt=parseInt(le.substr(1),16);le=yt>>16&255,ge=yt>>8&255,be=255&yt}if(ge===void 0||Pe===void 0&&le===ge&&ge===be)U=typeof le=="string"?le+" "+Ue[0]:S.precision===2?L(le/255)+" "+Ue[0]:F(le/255)+" "+Ue[0];else if(Pe===void 0||jr(Pe)==="object"){if(Pe&&!isNaN(Pe.a)&&Pe.a===0)return["1.","1.","1.",Ue[1]].join(" ");U=typeof le=="string"?[le,ge,be,Ue[1]].join(" "):S.precision===2?[L(le/255),L(ge/255),L(be/255),Ue[1]].join(" "):[F(le/255),F(ge/255),F(be/255),Ue[1]].join(" ")}else U=typeof le=="string"?[le,ge,be,Pe,Ue[2]].join(" "):S.precision===2?[L(le),L(ge),L(be),L(Pe),Ue[2]].join(" "):[F(le),F(ge),F(be),F(Pe),Ue[2]].join(" ");return U},ke=d.__private__.getFilters=function(){return o},Ce=d.__private__.putStream=function(S){var U=(S=S||{}).data||"",le=S.filters||ke(),ge=S.alreadyAppliedFilters||[],be=S.addLength1||!1,Pe=U.length,Ue=S.objectId,dt=function(Ca){return Ca};if(f!==null&&Ue===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(dt=Ea.encryptor(Ue,0));var yt={};le===!0&&(le=["FlateEncode"]);var Ut=S.additionalKeyValues||[],Kt=(yt=ht.API.processDataByFilters!==void 0?ht.API.processDataByFilters(U,le):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(ge)?ge.join(" "):ge.toString());if(yt.data.length!==0&&(Ut.push({key:"Length",value:yt.data.length}),be===!0&&Ut.push({key:"Length1",value:Pe})),Kt.length!=0)if(Kt.split("/").length-1==1)Ut.push({key:"Filter",value:Kt});else{Ut.push({key:"Filter",value:"["+Kt+"]"});for(var mr=0;mr<Ut.length;mr+=1)if(Ut[mr].key==="DecodeParms"){for(var Jr=[],Sa=0;Sa<yt.reverseChain.split("/").length-1;Sa+=1)Jr.push("null");Jr.push(Ut[mr].value),Ut[mr].value="["+Jr.join(" ")+"]"}}J("<<");for(var zr=0;zr<Ut.length;zr++)J("/"+Ut[zr].key+" "+Ut[zr].value);J(">>"),yt.data.length!==0&&(J("stream"),J(dt(yt.data)),J("endstream"))},Ae=d.__private__.putPage=function(S){var U=S.number,le=S.data,ge=S.objId,be=S.contentsObjId;V(ge,!0),J("<</Type /Page"),J("/Parent "+S.rootDictionaryObjId+" 0 R"),J("/Resources "+S.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(I(S.mediaBox.bottomLeftX))+" "+parseFloat(I(S.mediaBox.bottomLeftY))+" "+I(S.mediaBox.topRightX)+" "+I(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&J("/CropBox ["+I(S.cropBox.bottomLeftX)+" "+I(S.cropBox.bottomLeftY)+" "+I(S.cropBox.topRightX)+" "+I(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&J("/BleedBox ["+I(S.bleedBox.bottomLeftX)+" "+I(S.bleedBox.bottomLeftY)+" "+I(S.bleedBox.topRightX)+" "+I(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&J("/TrimBox ["+I(S.trimBox.bottomLeftX)+" "+I(S.trimBox.bottomLeftY)+" "+I(S.trimBox.topRightX)+" "+I(S.trimBox.topRightY)+"]"),S.artBox!==null&&J("/ArtBox ["+I(S.artBox.bottomLeftX)+" "+I(S.artBox.bottomLeftY)+" "+I(S.artBox.topRightX)+" "+I(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&J("/UserUnit "+S.userUnit),vr.publish("putPage",{objId:ge,pageContext:At[U],pageNumber:U,page:le}),J("/Contents "+be+" 0 R"),J(">>"),J("endobj");var Pe=le.join(`
`);return w===g&&(Pe+=`
Q`),V(be,!0),Ce({data:Pe,filters:ke(),objectId:be}),J("endobj"),ge},Ne=d.__private__.putPages=function(){var S,U,le=[];for(S=1;S<=er;S++)At[S].objId=wa(),At[S].contentsObjId=wa();for(S=1;S<=er;S++)le.push(Ae({number:S,data:Se[S],objId:At[S].objId,contentsObjId:At[S].contentsObjId,mediaBox:At[S].mediaBox,cropBox:At[S].cropBox,bleedBox:At[S].bleedBox,trimBox:At[S].trimBox,artBox:At[S].artBox,userUnit:At[S].userUnit,rootDictionaryObjId:ee,resourceDictionaryObjId:re}));V(ee,!0),J("<</Type /Pages");var ge="/Kids [";for(U=0;U<er;U++)ge+=le[U]+" 0 R ";J(ge+"]"),J("/Count "+er),J(">>"),J("endobj"),vr.publish("postPutPages")},Ee=function(S){vr.publish("putFont",{font:S,out:J,newObject:Gr,putStream:Ce}),S.isAlreadyPutted!==!0&&(S.objectNumber=Gr(),J("<<"),J("/Type /Font"),J("/BaseFont /"+Yl(S.postScriptName)),J("/Subtype /Type1"),typeof S.encoding=="string"&&J("/Encoding /"+S.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},He=function(S){S.objectNumber=Gr();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[I(S.x),I(S.y),I(S.x+S.width),I(S.y+S.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var le=S.pages[1].join(`
`);Ce({data:le,additionalKeyValues:U,objectId:S.objectNumber}),J("endobj")},Xe=function(S,U){U||(U=21);var le=Gr(),ge=function(Ue,dt){var yt,Ut=[],Kt=1/(dt-1);for(yt=0;yt<1;yt+=Kt)Ut.push(yt);if(Ut.push(1),Ue[0].offset!=0){var mr={offset:0,color:Ue[0].color};Ue.unshift(mr)}if(Ue[Ue.length-1].offset!=1){var Jr={offset:1,color:Ue[Ue.length-1].color};Ue.push(Jr)}for(var Sa="",zr=0,Ca=0;Ca<Ut.length;Ca++){for(yt=Ut[Ca];yt>Ue[zr+1].offset;)zr++;var Aa=Ue[zr].offset,Ga=(yt-Aa)/(Ue[zr+1].offset-Aa),ys=Ue[zr].color,Ai=Ue[zr+1].color;Sa+=O(Math.round((1-Ga)*ys[0]+Ga*Ai[0]).toString(16))+O(Math.round((1-Ga)*ys[1]+Ga*Ai[1]).toString(16))+O(Math.round((1-Ga)*ys[2]+Ga*Ai[2]).toString(16))}return Sa.trim()}(S.colors,U),be=[];be.push({key:"FunctionType",value:"0"}),be.push({key:"Domain",value:"[0.0 1.0]"}),be.push({key:"Size",value:"["+U+"]"}),be.push({key:"BitsPerSample",value:"8"}),be.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),be.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ce({data:ge,additionalKeyValues:be,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:le}),J("endobj"),S.objectNumber=Gr(),J("<< /ShadingType "+S.type),J("/ColorSpace /DeviceRGB");var Pe="/Coords ["+I(parseFloat(S.coords[0]))+" "+I(parseFloat(S.coords[1]))+" ";S.type===2?Pe+=I(parseFloat(S.coords[2]))+" "+I(parseFloat(S.coords[3])):Pe+=I(parseFloat(S.coords[2]))+" "+I(parseFloat(S.coords[3]))+" "+I(parseFloat(S.coords[4]))+" "+I(parseFloat(S.coords[5])),J(Pe+="]"),S.matrix&&J("/Matrix ["+S.matrix.toString()+"]"),J("/Function "+le+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},nt=function(S,U){var le=wa(),ge=Gr();U.push({resourcesOid:le,objectOid:ge}),S.objectNumber=ge;var be=[];be.push({key:"Type",value:"/Pattern"}),be.push({key:"PatternType",value:"1"}),be.push({key:"PaintType",value:"1"}),be.push({key:"TilingType",value:"1"}),be.push({key:"BBox",value:"["+S.boundingBox.map(I).join(" ")+"]"}),be.push({key:"XStep",value:I(S.xStep)}),be.push({key:"YStep",value:I(S.yStep)}),be.push({key:"Resources",value:le+" 0 R"}),S.matrix&&be.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),Ce({data:S.stream,additionalKeyValues:be,objectId:S.objectNumber}),J("endobj")},Ge=function(S){for(var U in S.objectNumber=Gr(),J("<<"),S)switch(U){case"opacity":J("/ca "+L(S[U]));break;case"stroke-opacity":J("/CA "+L(S[U]))}J(">>"),J("endobj")},rt=function(S){V(S.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var U in J("/Font <<"),Ot)Ot.hasOwnProperty(U)&&(h===!1||h===!0&&p.hasOwnProperty(U))&&J("/"+U+" "+Ot[U].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(St).length>0){for(var U in J("/Shading <<"),St)St.hasOwnProperty(U)&&St[U]instanceof Ko&&St[U].objectNumber>=0&&J("/"+U+" "+St[U].objectNumber+" 0 R");vr.publish("putShadingPatternDict"),J(">>")}}(),function(U){if(Object.keys(St).length>0){for(var le in J("/Pattern <<"),St)St.hasOwnProperty(le)&&St[le]instanceof d.TilingPattern&&St[le].objectNumber>=0&&St[le].objectNumber<U&&J("/"+le+" "+St[le].objectNumber+" 0 R");vr.publish("putTilingPatternDict"),J(">>")}}(S.objectOid),function(){if(Object.keys(Et).length>0){var U;for(U in J("/ExtGState <<"),Et)Et.hasOwnProperty(U)&&Et[U].objectNumber>=0&&J("/"+U+" "+Et[U].objectNumber+" 0 R");vr.publish("putGStateDict"),J(">>")}}(),function(){for(var U in J("/XObject <<"),za)za.hasOwnProperty(U)&&za[U].objectNumber>=0&&J("/"+U+" "+za[U].objectNumber+" 0 R");vr.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},Lt=function(S){Gt[S.fontName]=Gt[S.fontName]||{},Gt[S.fontName][S.fontStyle]=S.id},Er=function(S,U,le,ge,be){var Pe={id:"F"+(Object.keys(Ot).length+1).toString(10),postScriptName:S,fontName:U,fontStyle:le,encoding:ge,isStandardFont:be||!1,metadata:{}};return vr.publish("addFont",{font:Pe,instance:this}),Ot[Pe.id]=Pe,Lt(Pe),Pe.id},sr=d.__private__.pdfEscape=d.pdfEscape=function(S,U){return function(le,ge){var be,Pe,Ue,dt,yt,Ut,Kt,mr,Jr;if(Ue=(ge=ge||{}).sourceEncoding||"Unicode",yt=ge.outputEncoding,(ge.autoencode||yt)&&Ot[st].metadata&&Ot[st].metadata[Ue]&&Ot[st].metadata[Ue].encoding&&(dt=Ot[st].metadata[Ue].encoding,!yt&&Ot[st].encoding&&(yt=Ot[st].encoding),!yt&&dt.codePages&&(yt=dt.codePages[0]),typeof yt=="string"&&(yt=dt[yt]),yt)){for(Kt=!1,Ut=[],be=0,Pe=le.length;be<Pe;be++)(mr=yt[le.charCodeAt(be)])?Ut.push(String.fromCharCode(mr)):Ut.push(le[be]),Ut[be].charCodeAt(0)>>8&&(Kt=!0);le=Ut.join("")}for(be=le.length;Kt===void 0&&be!==0;)le.charCodeAt(be-1)>>8&&(Kt=!0),be--;if(!Kt)return le;for(Ut=ge.noBOM?[]:[254,255],be=0,Pe=le.length;be<Pe;be++){if((Jr=(mr=le.charCodeAt(be))>>8)>>8)throw new Error("Character at position "+be+" of string '"+le+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ut.push(Jr),Ut.push(mr-(Jr<<8))}return String.fromCharCode.apply(void 0,Ut)}(S,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ra=d.__private__.beginPage=function(S){Se[++er]=[],At[er]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Wi(er),$e(Se[R])},Ui=function(S,U){var le,ge,be;switch(r=U||r,typeof S=="string"&&(le=_(S.toLowerCase()),Array.isArray(le)&&(ge=le[0],be=le[1])),Array.isArray(S)&&(ge=S[0]*Qe,be=S[1]*Qe),isNaN(ge)&&(ge=n[0],be=n[1]),(ge>14400||be>14400)&&(Lr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ge=Math.min(14400,ge),be=Math.min(14400,be)),n=[ge,be],r.substr(0,1)){case"l":be>ge&&(n=[be,ge]);break;case"p":ge>be&&(n=[be,ge])}ra(n),Wt(jc),J(Tl),Ec!==0&&J(Ec+" J"),Cc!==0&&J(Cc+" j"),vr.publish("addPage",{pageNumber:er})},ki=function(S){S>0&&S<=er&&(Se.splice(S,1),At.splice(S,1),er--,R>er&&(R=er),this.setPage(R))},Wi=function(S){S>0&&S<=er&&(R=S)},ri=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return Se.length-1},Ws=function(S,U,le){var ge,be=void 0;return le=le||{},S=S!==void 0?S:Ot[st].fontName,U=U!==void 0?U:Ot[st].fontStyle,ge=S.toLowerCase(),Gt[ge]!==void 0&&Gt[ge][U]!==void 0?be=Gt[ge][U]:Gt[S]!==void 0&&Gt[S][U]!==void 0?be=Gt[S][U]:le.disableWarning===!1&&Lr.warn("Unable to look up font label for font '"+S+"', '"+U+"'. Refer to getFontList() for available fonts."),be||le.noFallback||(be=Gt.times[U])==null&&(be=Gt.times.normal),be},_a=d.__private__.putInfo=function(){var S=Gr(),U=function(ge){return ge};for(var le in f!==null&&(U=Ea.encryptor(S,0)),J("<<"),J("/Producer ("+sr(U("jsPDF "+ht.version))+")"),Tt)Tt.hasOwnProperty(le)&&Tt[le]&&J("/"+le.substr(0,1).toUpperCase()+le.substr(1)+" ("+sr(U(Tt[le]))+")");J("/CreationDate ("+sr(U(q))+")"),J(">>"),J("endobj")},Al=d.__private__.putCatalog=function(S){var U=(S=S||{}).rootDictionaryObjId||ee;switch(Gr(),J("<<"),J("/Type /Catalog"),J("/Pages "+U+" 0 R"),pt||(pt="fullwidth"),pt){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var le=""+pt;le.substr(le.length-1)==="%"&&(pt=parseInt(pt)/100),typeof pt=="number"&&J("/OpenAction [3 0 R /XYZ null null "+L(pt)+"]")}switch(Mt||(Mt="continuous"),Mt){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}ft&&J("/PageMode /"+ft),vr.publish("putCatalog"),J(">>"),J("endobj")},Jd=d.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(H+1)),J("/Root "+H+" 0 R"),J("/Info "+(H-1)+" 0 R"),f!==null&&J("/Encrypt "+Ea.oid+" 0 R"),J("/ID [ <"+fe+"> <"+fe+"> ]"),J(">>")},ka=d.__private__.putHeader=function(){J("%PDF-"+v),J("%ºß¬à")},du=d.__private__.putXRef=function(){var S="0000000000";J("xref"),J("0 "+(H+1)),J("0000000000 65535 f ");for(var U=1;U<=H;U++)typeof ae[U]=="function"?J((S+ae[U]()).slice(-10)+" 00000 n "):ae[U]!==void 0?J((S+ae[U]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},qi=d.__private__.buildDocument=function(){var S;H=0,me=0,de=[],ae=[],xe=[],ee=wa(),re=wa(),$e(de),vr.publish("buildDocument"),ka(),Ne(),function(){vr.publish("putAdditionalObjects");for(var le=0;le<xe.length;le++){var ge=xe[le];V(ge.objId,!0),J(ge.content),J("endobj")}vr.publish("postPutAdditionalObjects")}(),S=[],function(){for(var le in Ot)Ot.hasOwnProperty(le)&&(h===!1||h===!0&&p.hasOwnProperty(le))&&Ee(Ot[le])}(),function(){var le;for(le in Et)Et.hasOwnProperty(le)&&Ge(Et[le])}(),function(){for(var le in za)za.hasOwnProperty(le)&&He(za[le])}(),function(le){var ge;for(ge in St)St.hasOwnProperty(ge)&&(St[ge]instanceof Ko?Xe(St[ge]):St[ge]instanceof Ql&&nt(St[ge],le))}(S),vr.publish("putResources"),S.forEach(rt),rt({resourcesOid:re,objectOid:Number.MAX_SAFE_INTEGER}),vr.publish("postPutResources"),f!==null&&(Ea.oid=Gr(),J("<<"),J("/Filter /Standard"),J("/V "+Ea.v),J("/R "+Ea.r),J("/U <"+Ea.toHexString(Ea.U)+">"),J("/O <"+Ea.toHexString(Ea.O)+">"),J("/P "+Ea.P),J(">>"),J("endobj")),_a(),Al();var U=me;return du(),Jd(),J("startxref"),J(""+U),J("%%EOF"),$e(Se[R]),de.join(`
`)},Nl=d.__private__.getBlob=function(S){return new Blob([Be(S)],{type:"application/pdf"})},hu=d.output=d.__private__.output=(Tn=function(S,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",S){case void 0:return qi();case"save":d.save(U.filename);break;case"arraybuffer":return Be(qi());case"blob":return Nl(qi());case"bloburi":case"bloburl":if(Bt.URL!==void 0&&typeof Bt.URL.createObjectURL=="function")return Bt.URL&&Bt.URL.createObjectURL(Nl(qi()))||void 0;Lr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var le="",ge=qi();try{le=Mv(ge)}catch{le=Mv(unescape(encodeURIComponent(ge)))}return"data:application/pdf;filename="+U.filename+";base64,"+le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Bt)==="[object Window]"){var be="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Pe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(be=U.pdfObjectUrl,Pe="");var Ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+be+'"'+Pe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",dt=Bt.open();return dt!==null&&dt.document.write(Ue),dt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Bt)==="[object Window]"){var yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',Ut=Bt.open();if(Ut!==null){Ut.document.write(yt);var Kt=this;Ut.document.documentElement.querySelector("#pdfViewer").onload=function(){Ut.document.title=U.filename,Ut.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Kt.output("bloburl"))}}return Ut}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Bt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',Jr=Bt.open();if(Jr!==null&&(Jr.document.write(mr),Jr.document.title=U.filename),Jr||typeof safari>"u")return Jr;break;case"datauri":case"dataurl":return Bt.document.location.href=this.output("datauristring",U);default:return null}},Tn.foo=function(){try{return Tn.apply(this,arguments)}catch(le){var S=le.stack||"";~S.indexOf(" at ")&&(S=S.split(" at ")[1]);var U="Error in function "+S.split(`
`)[0].split("<")[0]+": "+le.message;if(!Bt.console)throw new Error(U);Bt.console.error(U,le),Bt.alert&&alert(U)}},Tn.foo.bar=Tn,Tn.foo),ai=function(S){return Array.isArray(fs)===!0&&fs.indexOf(S)>-1};switch(a){case"pt":Qe=1;break;case"mm":Qe=72/25.4;break;case"cm":Qe=72/2.54;break;case"in":Qe=72;break;case"px":Qe=ai("px_scaling")==1?.75:96/72;break;case"pc":case"em":Qe=12;break;case"ex":Qe=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Qe=a}var Ea=null;Y(),pe();var ds=d.__private__.getPageInfo=d.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:At[S].objId,pageNumber:S,pageContext:At[S]}},pu=d.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in At)if(At[U].objId===S)break;return ds(U)},Zd=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:At[R].objId,pageNumber:R,pageContext:At[R]}};d.addPage=function(){return Ui.apply(this,arguments),this},d.setPage=function(){return Wi.apply(this,arguments),$e.call(this,Se[R]),this},d.insertPage=function(S){return this.addPage(),this.movePage(R,S),this},d.movePage=function(S,U){var le,ge;if(S>U){le=Se[S],ge=At[S];for(var be=S;be>U;be--)Se[be]=Se[be-1],At[be]=At[be-1];Se[U]=le,At[U]=ge,this.setPage(U)}else if(S<U){le=Se[S],ge=At[S];for(var Pe=S;Pe<U;Pe++)Se[Pe]=Se[Pe+1],At[Pe]=At[Pe+1];Se[U]=le,At[U]=ge,this.setPage(U)}return this},d.deletePage=function(){return ki.apply(this,arguments),this},d.__private__.text=d.text=function(S,U,le,ge,be){var Pe,Ue,dt,yt,Ut,Kt,mr,Jr,Sa,zr=(ge=ge||{}).scope||this;if(typeof S=="number"&&typeof U=="number"&&(typeof le=="string"||Array.isArray(le))){var Ca=le;le=U,U=S,S=Ca}if(arguments[3]instanceof Ct==0?(dt=arguments[4],yt=arguments[5],jr(mr=arguments[3])==="object"&&mr!==null||(typeof dt=="string"&&(yt=dt,dt=null),typeof mr=="string"&&(yt=mr,mr=null),typeof mr=="number"&&(dt=mr,mr=null),ge={flags:mr,angle:dt,align:yt})):(D("The transform parameter of text() with a Matrix value"),Sa=be),isNaN(U)||isNaN(le)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return zr;var Aa,Ga="",ys=typeof ge.lineHeightFactor=="number"?ge.lineHeightFactor:Fo,Ai=zr.internal.scaleFactor;function bs(br){return br=br.split("	").join(Array(ge.TabLen||9).join(" ")),sr(br,mr)}function Lc(br){for(var Dr,ha=br.concat(),Fa=[],ks=ha.length;ks--;)typeof(Dr=ha.shift())=="string"?Fa.push(Dr):Array.isArray(br)&&(Dr.length===1||Dr[1]===void 0&&Dr[2]===void 0)?Fa.push(Dr[0]):Fa.push([Dr[0],Dr[1],Dr[2]]);return Fa}function Cl(br,Dr){var ha;if(typeof br=="string")ha=Dr(br)[0];else if(Array.isArray(br)){for(var Fa,ks,Hc=br.concat(),Il=[],Au=Hc.length;Au--;)typeof(Fa=Hc.shift())=="string"?Il.push(Dr(Fa)[0]):Array.isArray(Fa)&&typeof Fa[0]=="string"&&(ks=Dr(Fa[0],Fa[1],Fa[2]),Il.push([ks[0],ks[1],ks[2]]));ha=Il}return ha}var qs=!1,Po=!0;if(typeof S=="string")qs=!0;else if(Array.isArray(S)){var Ro=S.concat();Ue=[];for(var Hs,Ka=Ro.length;Ka--;)(typeof(Hs=Ro.shift())!="string"||Array.isArray(Hs)&&typeof Hs[0]!="string")&&(Po=!1);qs=Po}if(qs===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var Oo=Me/zr.internal.scaleFactor,Bo=Oo*(ys-1);switch(ge.baseline){case"bottom":le-=Bo;break;case"top":le+=Oo-Bo;break;case"hanging":le+=Oo-2*Bo;break;case"middle":le+=Oo/2-Bo}if((Kt=ge.maxWidth||0)>0&&(typeof S=="string"?S=zr.splitTextToSize(S,Kt):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(br,Dr){return br.concat(zr.splitTextToSize(Dr,Kt))},[]))),Pe={text:S,x:U,y:le,options:ge,mutex:{pdfEscape:sr,activeFontKey:st,fonts:Ot,activeFontSize:Me}},vr.publish("preProcessText",Pe),S=Pe.text,dt=(ge=Pe.options).angle,Sa instanceof Ct==0&&dt&&typeof dt=="number"){dt*=Math.PI/180,ge.rotationDirection===0&&(dt=-dt),w===g&&(dt=-dt);var Pc=Math.cos(dt),Rc=Math.sin(dt);Sa=new Ct(Pc,Rc,-Rc,Pc,0,0)}else dt&&dt instanceof Ct&&(Sa=dt);w!==g||Sa||(Sa=_i),(Ut=ge.charSpace||ms)!==void 0&&(Ga+=I(z(Ut))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jr=ge.horizontalScale)!==void 0&&(Ga+=I(100*Jr)+` Tz
`),ge.lang;var bn=-1,ws=ge.renderingMode!==void 0?ge.renderingMode:ge.stroke,Fl=zr.internal.getCurrentPageInfo().pageContext;switch(ws){case 0:case!1:case"fill":bn=0;break;case 1:case!0:case"stroke":bn=1;break;case 2:case"fillThenStroke":bn=2;break;case 3:case"invisible":bn=3;break;case 4:case"fillAndAddForClipping":bn=4;break;case 5:case"strokeAndAddPathForClipping":bn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":bn=6;break;case 7:case"addToPathForClipping":bn=7}var ku=Fl.usedRenderingMode!==void 0?Fl.usedRenderingMode:-1;bn!==-1?Ga+=bn+` Tr
`:ku!==-1&&(Ga+=`0 Tr
`),bn!==-1&&(Fl.usedRenderingMode=bn),yt=ge.align||"left";var ni,Mo=Me*ys,Oc=zr.internal.pageSize.getWidth(),Bc=Ot[st];Ut=ge.charSpace||ms,Kt=ge.maxWidth||0,mr=Object.assign({autoencode:!0,noBOM:!0},ge.flags);var $s=[],zo=function(br){return zr.getStringUnitWidth(br,{font:Bc,charSpace:Ut,fontSize:Me,doKerning:!1})*Me/Ai};if(Object.prototype.toString.call(S)==="[object Array]"){var Pn;Ue=Lc(S),yt!=="left"&&(ni=Ue.map(zo));var Rn,Vs=0;if(yt==="right"){U-=ni[0],S=[],Ka=Ue.length;for(var _s=0;_s<Ka;_s++)_s===0?(Rn=hs(U),Pn=ps(le)):(Rn=z(Vs-ni[_s]),Pn=-Mo),S.push([Ue[_s],Rn,Pn]),Vs=ni[_s]}else if(yt==="center"){U-=ni[0]/2,S=[],Ka=Ue.length;for(var Gs=0;Gs<Ka;Gs++)Gs===0?(Rn=hs(U),Pn=ps(le)):(Rn=z((Vs-ni[Gs])/2),Pn=-Mo),S.push([Ue[Gs],Rn,Pn]),Vs=ni[Gs]}else if(yt==="left"){S=[],Ka=Ue.length;for(var Mc=0;Mc<Ka;Mc++)S.push(Ue[Mc])}else if(yt==="justify"&&Bc.encoding==="Identity-H"){S=[],Ka=Ue.length,Kt=Kt!==0?Kt:Oc;for(var Dl=0,da=0;da<Ka;da++)if(Pn=da===0?ps(le):-Mo,Rn=da===0?hs(U):Dl,da<Ka-1){var Su=z((Kt-ni[da])/(Ue[da].split(" ").length-1)),$i=Ue[da].split(" ");S.push([$i[0]+" ",Rn,Pn]),Dl=0;for(var Vi=1;Vi<$i.length;Vi++){var zc=(zo($i[Vi-1]+" "+$i[Vi])-zo($i[Vi]))*Ai+Su;Vi==$i.length-1?S.push([$i[Vi],zc,0]):S.push([$i[Vi]+" ",zc,0]),Dl-=zc}}else S.push([Ue[da],Rn,Pn]);S.push(["",Dl,0])}else{if(yt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],Ka=Ue.length,Kt=Kt!==0?Kt:Oc,da=0;da<Ka;da++){Pn=da===0?ps(le):-Mo,Rn=da===0?hs(U):0;var Uc=Ue[da].split(" ").length-1,Wc=Uc>0?(Kt-ni[da])/Uc:0;da<Ka-1?$s.push(I(z(Wc))):$s.push(0),S.push([Ue[da],Rn,Pn])}}}(typeof ge.R2L=="boolean"?ge.R2L:bt)===!0&&(S=Cl(S,function(br,Dr,ha){return[br.split("").reverse().join(""),Dr,ha]})),Pe={text:S,x:U,y:le,options:ge,mutex:{pdfEscape:sr,activeFontKey:st,fonts:Ot,activeFontSize:Me}},vr.publish("postProcessText",Pe),S=Pe.text,Aa=Pe.mutex.isHex||!1;var qc=Ot[st].encoding;qc!=="WinAnsiEncoding"&&qc!=="StandardEncoding"||(S=Cl(S,function(br,Dr,ha){return[bs(br),Dr,ha]})),Ue=Lc(S),S=[];for(var Ks,Ys,Xs,Uo=Array.isArray(Ue[0])?1:0,Js="",Wo=function(br,Dr,ha){var Fa="";return ha instanceof Ct?(ha=typeof ge.angle=="number"?wi(ha,new Ct(1,0,0,1,br,Dr)):wi(new Ct(1,0,0,1,br,Dr),ha),w===g&&(ha=wi(new Ct(1,0,0,-1,0,0),ha)),Fa=ha.join(" ")+` Tm
`):Fa=I(br)+" "+I(Dr)+` Td
`,Fa},ii=0;ii<Ue.length;ii++){switch(Js="",Uo){case 1:Xs=(Aa?"<":"(")+Ue[ii][0]+(Aa?">":")"),Ks=parseFloat(Ue[ii][1]),Ys=parseFloat(Ue[ii][2]);break;case 0:Xs=(Aa?"<":"(")+Ue[ii]+(Aa?">":")"),Ks=hs(U),Ys=ps(le)}$s!==void 0&&$s[ii]!==void 0&&(Js=$s[ii]+` Tw
`),ii===0?S.push(Js+Wo(Ks,Ys,Sa)+Xs):Uo===0?S.push(Js+Xs):Uo===1&&S.push(Js+Wo(Ks,Ys,Sa)+Xs)}S=Uo===0?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var Gi=`BT
/`;return Gi+=st+" "+Me+` Tf
`,Gi+=I(Me*ys)+` TL
`,Gi+=Do+`
`,Gi+=Ga,Gi+=S,J(Gi+="ET"),p[st]=!0,zr};var Qd=d.__private__.clip=d.clip=function(S){return J(S==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Qd("evenodd")},d.__private__.discardPath=d.discardPath=function(){return J("n"),this};var Hi=d.__private__.isValidStyle=function(S){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(U=!0),U};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(S){return Hi(S)&&(u=S),this};var mu=d.__private__.getStyle=d.getStyle=function(S){var U=u;switch(S){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=S}return U},xu=d.close=function(){return J("h"),this};d.stroke=function(){return J("S"),this},d.fill=function(S){return jl("f",S),this},d.fillEvenOdd=function(S){return jl("f*",S),this},d.fillStroke=function(S){return jl("B",S),this},d.fillStrokeEvenOdd=function(S){return jl("B*",S),this};var jl=function(S,U){jr(U)==="object"?th(U,S):J(S)},Co=function(S){S===null||w===g&&S===void 0||(S=mu(S),J(S))};function eh(S,U,le,ge,be){var Pe=new Ql(U||this.boundingBox,le||this.xStep,ge||this.yStep,this.gState,be||this.matrix);Pe.stream=this.stream;var Ue=S+"$$"+this.cloneIndex+++"$$";return an(Ue,Pe),Pe}var th=function(S,U){var le=wr[S.key],ge=St[le];if(ge instanceof Ko)J("q"),J(rh(U)),ge.gState&&d.setGState(ge.gState),J(S.matrix.toString()+" cm"),J("/"+le+" sh"),J("Q");else if(ge instanceof Ql){var be=new Ct(1,0,0,-1,0,Lo());S.matrix&&(be=be.multiply(S.matrix||_i),le=eh.call(ge,S.key,S.boundingBox,S.xStep,S.yStep,be).id),J("q"),J("/Pattern cs"),J("/"+le+" scn"),ge.gState&&d.setGState(ge.gState),J(U),J("Q")}},rh=function(S){switch(S){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Nc=d.moveTo=function(S,U){return J(I(z(S))+" "+I(M(U))+" m"),this},gu=d.lineTo=function(S,U){return J(I(z(S))+" "+I(M(U))+" l"),this},Si=d.curveTo=function(S,U,le,ge,be,Pe){return J([I(z(S)),I(M(U)),I(z(le)),I(M(ge)),I(z(be)),I(M(Pe)),"c"].join(" ")),this};d.__private__.line=d.line=function(S,U,le,ge,be){if(isNaN(S)||isNaN(U)||isNaN(le)||isNaN(ge)||!Hi(be))throw new Error("Invalid arguments passed to jsPDF.line");return w===k?this.lines([[le-S,ge-U]],S,U,[1,1],be||"S"):this.lines([[le-S,ge-U]],S,U,[1,1]).stroke()},d.__private__.lines=d.lines=function(S,U,le,ge,be,Pe){var Ue,dt,yt,Ut,Kt,mr,Jr,Sa,zr,Ca,Aa,Ga;if(typeof S=="number"&&(Ga=le,le=U,U=S,S=Ga),ge=ge||[1,1],Pe=Pe||!1,isNaN(U)||isNaN(le)||!Array.isArray(S)||!Array.isArray(ge)||!Hi(be)||typeof Pe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Nc(U,le),Ue=ge[0],dt=ge[1],Ut=S.length,Ca=U,Aa=le,yt=0;yt<Ut;yt++)(Kt=S[yt]).length===2?(Ca=Kt[0]*Ue+Ca,Aa=Kt[1]*dt+Aa,gu(Ca,Aa)):(mr=Kt[0]*Ue+Ca,Jr=Kt[1]*dt+Aa,Sa=Kt[2]*Ue+Ca,zr=Kt[3]*dt+Aa,Ca=Kt[4]*Ue+Ca,Aa=Kt[5]*dt+Aa,Si(mr,Jr,Sa,zr,Ca,Aa));return Pe&&xu(),Co(be),this},d.path=function(S){for(var U=0;U<S.length;U++){var le=S[U],ge=le.c;switch(le.op){case"m":Nc(ge[0],ge[1]);break;case"l":gu(ge[0],ge[1]);break;case"c":Si.apply(this,ge);break;case"h":xu()}}return this},d.__private__.rect=d.rect=function(S,U,le,ge,be){if(isNaN(S)||isNaN(U)||isNaN(le)||isNaN(ge)||!Hi(be))throw new Error("Invalid arguments passed to jsPDF.rect");return w===k&&(ge=-ge),J([I(z(S)),I(M(U)),I(z(le)),I(z(ge)),"re"].join(" ")),Co(be),this},d.__private__.triangle=d.triangle=function(S,U,le,ge,be,Pe,Ue){if(isNaN(S)||isNaN(U)||isNaN(le)||isNaN(ge)||isNaN(be)||isNaN(Pe)||!Hi(Ue))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[le-S,ge-U],[be-le,Pe-ge],[S-be,U-Pe]],S,U,[1,1],Ue,!0),this},d.__private__.roundedRect=d.roundedRect=function(S,U,le,ge,be,Pe,Ue){if(isNaN(S)||isNaN(U)||isNaN(le)||isNaN(ge)||isNaN(be)||isNaN(Pe)||!Hi(Ue))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var dt=4/3*(Math.SQRT2-1);return be=Math.min(be,.5*le),Pe=Math.min(Pe,.5*ge),this.lines([[le-2*be,0],[be*dt,0,be,Pe-Pe*dt,be,Pe],[0,ge-2*Pe],[0,Pe*dt,-be*dt,Pe,-be,Pe],[2*be-le,0],[-be*dt,0,-be,-Pe*dt,-be,-Pe],[0,2*Pe-ge],[0,-Pe*dt,be*dt,-Pe,be,-Pe]],S+be,U,[1,1],Ue,!0),this},d.__private__.ellipse=d.ellipse=function(S,U,le,ge,be){if(isNaN(S)||isNaN(U)||isNaN(le)||isNaN(ge)||!Hi(be))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Pe=4/3*(Math.SQRT2-1)*le,Ue=4/3*(Math.SQRT2-1)*ge;return Nc(S+le,U),Si(S+le,U-Ue,S+Pe,U-ge,S,U-ge),Si(S-Pe,U-ge,S-le,U-Ue,S-le,U),Si(S-le,U+Ue,S-Pe,U+ge,S,U+ge),Si(S+Pe,U+ge,S+le,U+Ue,S+le,U),Co(be),this},d.__private__.circle=d.circle=function(S,U,le,ge){if(isNaN(S)||isNaN(U)||isNaN(le)||!Hi(ge))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,U,le,le,ge)},d.setFont=function(S,U,le){return le&&(U=A(U,le)),st=Ws(S,U,{disableWarning:!1}),this};var ah=d.__private__.getFont=d.getFont=function(){return Ot[Ws.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var S,U,le={};for(S in Gt)if(Gt.hasOwnProperty(S))for(U in le[S]=[],Gt[S])Gt[S].hasOwnProperty(U)&&le[S].push(U);return le},d.addFont=function(S,U,le,ge,be){var Pe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Pe.indexOf(arguments[3])!==-1?be=arguments[3]:arguments[3]&&Pe.indexOf(arguments[3])==-1&&(le=A(le,ge)),Er.call(this,S,U,le,be=be||"Identity-H")};var Fo,jc=e.lineWidth||.200025,nh=d.__private__.getLineWidth=d.getLineWidth=function(){return jc},Wt=d.__private__.setLineWidth=d.setLineWidth=function(S){return jc=S,J(I(z(S))+" w"),this};d.__private__.setLineDash=ht.API.setLineDash=ht.API.setLineDashPattern=function(S,U){if(S=S||[],U=U||0,isNaN(U)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(le){return I(z(le))}).join(" "),U=I(z(U)),J("["+S+"] "+U+" d"),this};var ih=d.__private__.getLineHeight=d.getLineHeight=function(){return Me*Fo};d.__private__.getLineHeight=d.getLineHeight=function(){return Me*Fo};var sh=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(Fo=S),this},oh=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Fo};sh(e.lineHeight);var hs=d.__private__.getHorizontalCoordinate=function(S){return z(S)},ps=d.__private__.getVerticalCoordinate=function(S){return w===g?S:At[R].mediaBox.topRightY-At[R].mediaBox.bottomLeftY-z(S)},lh=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(S){return I(hs(S))},ch=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(S){return I(ps(S))},Tl=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return oe(Tl)},d.__private__.setStrokeColor=d.setDrawColor=function(S,U,le,ge){return Tl=ce({ch1:S,ch2:U,ch3:le,ch4:ge,pdfColorType:"draw",precision:2}),J(Tl),this};var Tc=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return oe(Tc)},d.__private__.setFillColor=d.setFillColor=function(S,U,le,ge){return Tc=ce({ch1:S,ch2:U,ch3:le,ch4:ge,pdfColorType:"fill",precision:2}),J(Tc),this};var Do=e.textColor||"0 g",uh=d.__private__.getTextColor=d.getTextColor=function(){return oe(Do)};d.__private__.setTextColor=d.setTextColor=function(S,U,le,ge){return Do=ce({ch1:S,ch2:U,ch3:le,ch4:ge,pdfColorType:"text",precision:3}),this};var ms=e.charSpace,fh=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(ms||0)};d.__private__.setCharSpace=d.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ms=S,this};var Ec=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(S){var U=d.CapJoinStyles[S];if(U===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ec=U,J(U+" J"),this};var Cc=0;d.__private__.setLineJoin=d.setLineJoin=function(S){var U=d.CapJoinStyles[S];if(U===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cc=U,J(U+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(I(z(S))+" M"),this},d.GState=sd,d.setGState=function(S){(S=typeof S=="string"?Et[zt[S]]:vu(null,S)).equals(Mr)||(J("/"+S.id+" gs"),Mr=S)};var vu=function(S,U){if(!S||!zt[S]){var le=!1;for(var ge in Et)if(Et.hasOwnProperty(ge)&&Et[ge].equals(U)){le=!0;break}if(le)U=Et[ge];else{var be="GS"+(Object.keys(Et).length+1).toString(10);Et[be]=U,U.id=be}return S&&(zt[S]=U.id),vr.publish("addGState",U),U}};d.addGState=function(S,U){return vu(S,U),this},d.saveGraphicsState=function(){return J("q"),Br.push({key:st,size:Me,color:Do}),this},d.restoreGraphicsState=function(){J("Q");var S=Br.pop();return st=S.key,Me=S.size,Do=S.color,Mr=null,this},d.setCurrentTransformationMatrix=function(S){return J(S.toString()+" cm"),this},d.comment=function(S){return J("#"+S),this};var xs=function(S,U){var le=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return le},set:function(Pe){isNaN(Pe)||(le=parseFloat(Pe))}});var ge=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ge},set:function(Pe){isNaN(Pe)||(ge=parseFloat(Pe))}});var be="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return be},set:function(Pe){be=Pe.toString()}}),this},Fc=function(S,U,le,ge){xs.call(this,S,U),this.type="rect";var be=le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return be},set:function(Ue){isNaN(Ue)||(be=parseFloat(Ue))}});var Pe=ge||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Pe},set:function(Ue){isNaN(Ue)||(Pe=parseFloat(Ue))}}),this},El=function(){this.page=er,this.currentPage=R,this.pages=Se.slice(0),this.pagesContext=At.slice(0),this.x=et,this.y=fr,this.matrix=Nt,this.width=Ic(R),this.height=bu(R),this.outputDestination=Fe,this.id="",this.objectNumber=-1};El.prototype.restore=function(){er=this.page,R=this.currentPage,At=this.pagesContext,Se=this.pages,et=this.x,fr=this.y,Nt=this.matrix,yu(R,this.width),gs(R,this.height),Fe=this.outputDestination};var Dc=function(S,U,le,ge,be){ti.push(new El),er=R=0,Se=[],et=S,fr=U,Nt=be,ra([le,ge])};for(var Io in d.beginFormObject=function(S,U,le,ge,be){return Dc(S,U,le,ge,be),this},d.endFormObject=function(S){return function(U){if(bi[U])ti.pop().restore();else{var le=new El,ge="Xo"+(Object.keys(za).length+1).toString(10);le.id=ge,bi[U]=ge,za[ge]=le,vr.publish("addFormObject",le),ti.pop().restore()}}(S),this},d.doFormObject=function(S,U){var le=za[bi[S]];return J("q"),J(U.toString()+" cm"),J("/"+le.id+" Do"),J("Q"),this},d.getFormObject=function(S){var U=za[bi[S]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},d.save=function(S,U){return S=S||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?($o(Nl(qi()),S),typeof $o.unload=="function"&&Bt.setTimeout&&setTimeout($o.unload,911),this):new Promise(function(le,ge){try{var be=$o(Nl(qi()),S);typeof $o.unload=="function"&&Bt.setTimeout&&setTimeout($o.unload,911),le(be)}catch(Pe){ge(Pe.message)}})},ht.API)ht.API.hasOwnProperty(Io)&&(Io==="events"&&ht.API.events.length?function(S,U){var le,ge,be;for(be=U.length-1;be!==-1;be--)le=U[be][0],ge=U[be][1],S.subscribe.apply(S,[le].concat(typeof ge=="function"?[ge]:ge))}(vr,ht.API.events):d[Io]=ht.API[Io]);function Ic(S){return At[S].mediaBox.topRightX-At[S].mediaBox.bottomLeftX}function yu(S,U){At[S].mediaBox.topRightX=U+At[S].mediaBox.bottomLeftX}function bu(S){return At[S].mediaBox.topRightY-At[S].mediaBox.bottomLeftY}function gs(S,U){At[S].mediaBox.topRightY=U+At[S].mediaBox.bottomLeftY}var vs=d.getPageWidth=function(S){return Ic(S=S||R)/Qe},wu=d.setPageWidth=function(S,U){yu(S,U*Qe)},Lo=d.getPageHeight=function(S){return bu(S=S||R)/Qe},_u=d.setPageHeight=function(S,U){gs(S,U*Qe)};return d.internal={pdfEscape:sr,getStyle:mu,getFont:ah,getFontSize:at,getCharSpace:fh,getTextColor:uh,getLineHeight:ih,getLineHeightFactor:oh,getLineWidth:nh,write:Oe,getHorizontalCoordinate:hs,getVerticalCoordinate:ps,getCoordinateString:lh,getVerticalCoordinateString:ch,collections:{},newObject:Gr,newAdditionalObject:se,newObjectDeferred:wa,newObjectDeferredBegin:V,getFilters:ke,putStream:Ce,events:vr,scaleFactor:Qe,pageSize:{getWidth:function(){return vs(R)},setWidth:function(S){wu(R,S)},getHeight:function(){return Lo(R)},setHeight:function(S){_u(R,S)}},encryptionOptions:f,encryption:Ea,getEncryptor:function(S){return f!==null?Ea.encryptor(S,0):function(U){return U}},output:hu,getNumberOfPages:ri,get pages(){return Se},out:J,f2:L,f3:F,getPageInfo:ds,getPageInfoByObjId:pu,getCurrentPageInfo:Zd,getPDFVersion:m,Point:xs,Rectangle:Fc,Matrix:Ct,hasHotfix:ai},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return vs(R)},set:function(S){wu(R,S)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Lo(R)},set:function(S){_u(R,S)},enumerable:!0,configurable:!0}),(function(S){for(var U=0,le=it.length;U<le;U++){var ge=Er.call(this,S[U][0],S[U][1],S[U][2],it[U][3],!0);h===!1&&(p[ge]=!0);var be=S[U][0].split("-");Lt({id:ge,fontName:be[0],fontStyle:be[1]||""})}vr.publish("addFonts",{fonts:Ot,dictionary:Gt})}).call(d,it),st="F1",Ui(n,r),vr.publish("initialized"),d}Kl.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Kl.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Kl.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Kl.prototype.processOwnerPassword=function(e,t){return d1(f1(t).substr(0,5),e)},Kl.prototype.encryptor=function(e,t){var r=f1(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return d1(r,a)}},sd.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||jr(e)!==jr(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},ht.API={events:[]},ht.version="3.0.4";var ia=ht.API,dx=1,Sl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ql=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ht=function(e){return e.toFixed(2)},co=function(e){return e.toFixed(5)};ia.__acroform__={};var Ln=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},qv=function(e){return e*dx},Qi=function(e){var t=new t_,r=ut.internal.getHeight(e)||0,a=ut.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ht(a)),Number(Ht(r))],t},zR=ia.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},UR=ia.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},WR=ia.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},ga=ia.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return WR(e,t-1)},va=ia.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return zR(e,t-1)},ya=ia.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return UR(e,t-1)},qR=ia.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(n)||0,c.lowerLeft_Y=a(i+l)||0,c.upperRight_X=r(n+o)||0,c.upperRight_Y=a(i)||0,[Number(Ht(c.lowerLeft_X)),Number(Ht(c.lowerLeft_Y)),Number(Ht(c.upperRight_X)),Number(Ht(c.upperRight_Y))]},HR=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=h1(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+Ht(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Qi(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},h1=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(L){return L.split(`
`)}):n.map(function(L){return[L]});var i=r,o=ut.internal.getHeight(e)||0;o=o<0?-o:o;var l=ut.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(L,F,z){if(L+1<n.length){var M=F+" "+n[L+1][0];return xf(M,e,z).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var u,f,h=xf("3",e,i).height,p=e.multiline?o-i:(o-h)/2,d=p+=2,v=0,m=0,y=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+xf(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var _="",k=0,g=0;g<n.length;g++)if(n.hasOwnProperty(g)){var w=!1;if(n[g].length!==1&&y!==n[g].length-1){if((h+2)*(k+2)+2>o)continue e;_+=n[g][y],w=!0,m=g,g--}else{_=(_+=n[g][y]+" ").substr(_.length-1)==" "?_.substr(0,_.length-1):_;var C=parseInt(g),E=c(C,_,i),A=g>=n.length-1;if(E&&!A){_+=" ",y=0;continue}if(E||A){if(A)m=C;else if(e.multiline&&(h+2)*(k+2)+2>o)continue e}else{if(!e.multiline||(h+2)*(k+2)+2>o)continue e;m=C}}for(var I="",D=v;D<=m;D++){var B=n[D];if(e.multiline){if(D===m){I+=B[y]+" ",y=(y+1)%B.length;continue}if(D===v){I+=B[B.length-1]+" ";continue}}I+=B[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,f=xf(I,e,i).width,e.textAlign){case"right":u=l-f-2;break;case"center":u=(l-f)/2;break;default:u=2}t+=Ht(u)+" "+Ht(d)+` Td
`,t+="("+Sl(I)+`) Tj
`,t+=-Ht(u)+` 0 Td
`,d=-(i+2),f=0,v=w?m:m+1,k++,_=""}break}return a.text=t,a.fontSize=i,a},xf=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},$R={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},VR=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},GR=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Mi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify($R)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");dx=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new r_,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var i=a[n];i.objId=void 0,i.hasAnnotation&&VR(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,n){var i=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var l=a[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=qR(l.Rect,n)),n.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ut.createDefaultAppearanceStream(l),jr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=HR(l);c.push({key:"AP",value:"<</N "+f+">>"}),n.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var h="";for(var p in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(p)){var d=l.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var o in d)if(d.hasOwnProperty(o)){var v=d[o];typeof v=="function"&&(v=v.call(n,l)),h+="/"+o+" "+v+" ",n.internal.acroformPlugin.xForms.indexOf(v)>=0||n.internal.acroformPlugin.xForms.push(v)}}else typeof(v=d)=="function"&&(v=v.call(n,l)),h+="/"+o+" "+v,n.internal.acroformPlugin.xForms.indexOf(v)>=0||n.internal.acroformPlugin.xForms.push(v);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:l.objId}),n.internal.out("endobj")}i&&function(m,y){for(var _ in m)if(m.hasOwnProperty(_)){var k=_,g=m[_];y.internal.newObjectDeferredBegin(g.objId,!0),jr(g)==="object"&&typeof g.putStream=="function"&&g.putStream(),delete m[k]}}(n.internal.acroformPlugin.xForms,n)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},e_=ia.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var n="[",i=0;i<e.length;i++)switch(i!==0&&(n+=" "),jr(e[i])){case"boolean":case"number":case"object":n+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+Sl(a(e[i].toString()))+")"):n+=e[i].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},yp=function(e,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Sl(a(e))+")"},ns=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ns.prototype.toString=function(){return this.objId+" 0 R"},ns.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ns.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:e_(n,this.objId,this.scope)}):n instanceof ns?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&e.push({key:a,value:n}))}return e};var t_=function(){ns.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ln(t_,ns);var r_=function(){ns.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Sl(r(e))+")"}},set:function(r){e=r}})};Ln(r_,ns);var Mi=function e(){ns.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute F supplied.');t=_}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ga(t,3)},set:function(_){_?this.F=va(t,3):this.F=ya(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute Ff supplied.');r=_}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(_){a=_!==void 0?_:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(_){a[0]=_}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(_){a[1]=_}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(_){a[2]=_}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(_){a[3]=_}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(_){switch(_){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=_;break;default:throw new Error('Invalid value "'+_+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof od)return;i="FieldObject"+e.FieldNum++}var _=function(k){return k};return this.scope&&(_=this.scope.internal.getEncryptor(this.objId)),"("+Sl(_(i))+")"},set:function(_){i=_.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(_){i=_}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(_){o=_}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(_){l=_}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(_){c=_}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/dx:u},set:function(_){u=_}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(_){f=_}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof od||this instanceof tl))return yp(h,this.objId,this.scope)},set:function(_){_=_.toString(),h=_}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof qa==0?yp(p,this.objId,this.scope):p},set:function(_){_=_.toString(),p=this instanceof qa==0?_.substr(0,1)==="("?ql(_.substr(1,_.length-2)):ql(_):_}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof qa==1?ql(p.substr(1,p.length-1)):p},set:function(_){_=_.toString(),p=this instanceof qa==1?"/"+_:_}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(_){this.V=_}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof qa==0?yp(d,this.objId,this.scope):d},set:function(_){_=_.toString(),d=this instanceof qa==0?_.substr(0,1)==="("?ql(_.substr(1,_.length-2)):ql(_):_}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof qa==1?ql(d.substr(1,d.length-1)):d},set:function(_){_=_.toString(),d=this instanceof qa==1?"/"+_:_}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(_){_=!!_,m=_}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(_){v=_}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,1)},set:function(_){_?this.Ff=va(this.Ff,1):this.Ff=ya(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,2)},set:function(_){_?this.Ff=va(this.Ff,2):this.Ff=ya(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,3)},set:function(_){_?this.Ff=va(this.Ff,3):this.Ff=ya(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(_){if([0,1,2].indexOf(_)===-1)throw new Error('Invalid value "'+_+'" for attribute Q supplied.');y=_}}),Object.defineProperty(this,"textAlign",{get:function(){var _;switch(y){case 0:default:_="left";break;case 1:_="center";break;case 2:_="right"}return _},configurable:!0,enumerable:!0,set:function(_){switch(_){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ln(Mi,ns);var oc=function(){Mi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return e_(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=function(i,o,l){l||(l=1);for(var c,u=[];c=o.exec(i);)u.push(c[l]);return u}(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,18)},set:function(r){r?this.Ff=va(this.Ff,18):this.Ff=ya(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=va(this.Ff,19):this.Ff=ya(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,20)},set:function(r){r?(this.Ff=va(this.Ff,20),t.sort()):this.Ff=ya(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,22)},set:function(r){r?this.Ff=va(this.Ff,22):this.Ff=ya(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,23)},set:function(r){r?this.Ff=va(this.Ff,23):this.Ff=ya(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,27)},set:function(r){r?this.Ff=va(this.Ff,27):this.Ff=ya(this.Ff,27)}}),this.hasAppearanceStream=!1};Ln(oc,Mi);var lc=function(){oc.call(this),this.fontName="helvetica",this.combo=!1};Ln(lc,oc);var cc=function(){lc.call(this),this.combo=!0};Ln(cc,lc);var Ef=function(){cc.call(this),this.edit=!0};Ln(Ef,cc);var qa=function(){Mi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,15)},set:function(r){r?this.Ff=va(this.Ff,15):this.Ff=ya(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,16)},set:function(r){r?this.Ff=va(this.Ff,16):this.Ff=ya(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,17)},set:function(r){r?this.Ff=va(this.Ff,17):this.Ff=ya(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,26)},set:function(r){r?this.Ff=va(this.Ff,26):this.Ff=ya(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+Sl(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){jr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ln(qa,Mi);var Cf=function(){qa.call(this),this.pushButton=!0};Ln(Cf,qa);var uc=function(){qa.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ln(uc,qa);var od=function(){var e,t;Mi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),a)o.push("/"+i+" ("+Sl(n(a[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){jr(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ln(od,Mi),uc.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},uc.prototype.createOption=function(e){var t=new od;return t.Parent=this,t.optionName=e,this.Kids.push(t),KR.call(this.scope,t),t};var Ff=function(){qa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ut.CheckBox.createAppearanceStream()};Ln(Ff,qa);var tl=function(){Mi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,13)},set:function(t){t?this.Ff=va(this.Ff,13):this.Ff=ya(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,21)},set:function(t){t?this.Ff=va(this.Ff,21):this.Ff=ya(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,23)},set:function(t){t?this.Ff=va(this.Ff,23):this.Ff=ya(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,24)},set:function(t){t?this.Ff=va(this.Ff,24):this.Ff=ya(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,25)},set:function(t){t?this.Ff=va(this.Ff,25):this.Ff=ya(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,26)},set:function(t){t?this.Ff=va(this.Ff,26):this.Ff=ya(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ln(tl,Mi);var Df=function(){tl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ga(this.Ff,14)},set:function(e){e?this.Ff=va(this.Ff,14):this.Ff=ya(this.Ff,14)}}),this.password=!0};Ln(Df,tl);var ut={CheckBox:{createAppearanceStream:function(){return{N:{On:ut.CheckBox.YesNormal},D:{On:ut.CheckBox.YesPushDown,Off:ut.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Qi(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=h1(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ht(ut.internal.getWidth(e))+" "+Ht(ut.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Ht(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Qi(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],i=ut.internal.getHeight(e),o=ut.internal.getWidth(e),l=h1(e,e.caption);return n.push("1 g"),n.push("0 0 "+Ht(o)+" "+Ht(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Ht(o-1)+" "+Ht(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Ht(l.fontSize)+" Tf "+a),n.push(l.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Qi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ht(ut.internal.getWidth(e))+" "+Ht(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Circle.YesNormal,t.D[e]=ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Qi(e);t.scope=e.scope;var r=[],a=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=ut.internal.Bezier_C,i=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Qi(e);t.scope=e.scope;var r=[],a=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*ut.internal.Bezier_C).toFixed(5)),o=Number((a*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Qi(e);t.scope=e.scope;var r=[],a=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Cross.YesNormal,t.D[e]=ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Qi(e);t.scope=e.scope;var r=[],a=ut.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ht(ut.internal.getWidth(e)-2)+" "+Ht(ut.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ht(a.x1.x)+" "+Ht(a.x1.y)+" m"),r.push(Ht(a.x2.x)+" "+Ht(a.x2.y)+" l"),r.push(Ht(a.x4.x)+" "+Ht(a.x4.y)+" m"),r.push(Ht(a.x3.x)+" "+Ht(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Qi(e);t.scope=e.scope;var r=ut.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Ht(ut.internal.getWidth(e))+" "+Ht(ut.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Ht(ut.internal.getWidth(e)-2)+" "+Ht(ut.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Ht(r.x1.x)+" "+Ht(r.x1.y)+" m"),a.push(Ht(r.x2.x)+" "+Ht(r.x2.y)+" l"),a.push(Ht(r.x4.x)+" "+Ht(r.x4.y)+" m"),a.push(Ht(r.x3.x)+" "+Ht(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Qi(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ht(ut.internal.getWidth(e))+" "+Ht(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ut.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ut.internal.getWidth(e),r=ut.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},ut.internal.getWidth=function(e){var t=0;return jr(e)==="object"&&(t=qv(e.Rect[2])),t},ut.internal.getHeight=function(e){var t=0;return jr(e)==="object"&&(t=qv(e.Rect[3])),t};var KR=ia.addField=function(e){if(GR(this,e),!(e instanceof Mi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ia.AcroFormChoiceField=oc,ia.AcroFormListBox=lc,ia.AcroFormComboBox=cc,ia.AcroFormEditBox=Ef,ia.AcroFormButton=qa,ia.AcroFormPushButton=Cf,ia.AcroFormRadioButton=uc,ia.AcroFormCheckBox=Ff,ia.AcroFormTextField=tl,ia.AcroFormPasswordField=Df,ia.AcroFormAppearance=ut,ia.AcroForm={ChoiceField:oc,ListBox:lc,ComboBox:cc,EditBox:Ef,Button:qa,PushButton:Cf,RadioButton:uc,CheckBox:Ff,TextField:tl,PasswordField:Df,Appearance:ut},ht.AcroForm={ChoiceField:oc,ListBox:lc,ComboBox:cc,EditBox:Ef,Button:qa,PushButton:Cf,RadioButton:uc,CheckBox:Ff,TextField:tl,PasswordField:Df,Appearance:ut};ht.AcroForm;function a_(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(L,F){var z,M,q,fe,he,pe=r;if((F=F||r)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(E(L))for(he in a)for(q=a[he],z=0;z<q.length;z+=1){for(fe=!0,M=0;M<q[z].length;M+=1)if(q[z][M]!==void 0&&q[z][M]!==L[M]){fe=!1;break}if(fe===!0){pe=he;break}}else for(he in a)for(q=a[he],z=0;z<q.length;z+=1){for(fe=!0,M=0;M<q[z].length;M+=1)if(q[z][M]!==void 0&&q[z][M]!==L.charCodeAt(M)){fe=!1;break}if(fe===!0){pe=he;break}}return pe===r&&F!==r&&(pe=F),pe},i=function L(F){for(var z=this.internal.write,M=this.internal.putStream,q=(0,this.internal.getFilters)();q.indexOf("FlateEncode")!==-1;)q.splice(q.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var fe=[];if(fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Image"}),fe.push({key:"Width",value:F.width}),fe.push({key:"Height",value:F.height}),F.colorSpace===_.INDEXED?fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(fe.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===_.DEVICE_CMYK&&fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),fe.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&fe.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)&&F.transparency.length>0){for(var he="",pe=0,Q=F.transparency.length;pe<Q;pe++)he+=F.transparency[pe]+" "+F.transparency[pe]+" ";fe.push({key:"Mask",value:"["+he+"]"})}F.sMask!==void 0&&fe.push({key:"SMask",value:F.objectId+1+" 0 R"});var we=F.filter!==void 0?["/"+F.filter]:void 0;if(M({data:F.data,additionalKeyValues:fe,alreadyAppliedFilters:we,objectId:F.objectId}),z("endobj"),"sMask"in F&&F.sMask!==void 0){var Y,T=(Y=F.sMaskBitsPerComponent)!==null&&Y!==void 0?Y:F.bitsPerComponent,R={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:T,data:F.sMask};"filter"in F&&(R.decodeParameters="/Predictor ".concat(F.predictor," /Colors 1 /BitsPerComponent ").concat(T," /Columns ").concat(F.width),R.filter=F.filter),L.call(this,R)}if(F.colorSpace===_.INDEXED){var N=this.internal.newObject();M({data:I(new Uint8Array(F.palette)),objectId:N}),z("endobj")}},o=function(){var L=this.internal.collections[t+"images"];for(var F in L)i.call(this,L[F])},l=function(){var L,F=this.internal.collections[t+"images"],z=this.internal.write;for(var M in F)z("/I"+(L=F[M]).index,L.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var L=this.internal.collections[t+"images"];return c.call(this),L},f=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(L){return typeof e["process"+L.toUpperCase()]=="function"},p=function(L){return jr(L)==="object"&&L.nodeType===1},d=function(L,F){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var z=""+L.getAttribute("src");if(z.indexOf("data:image/")===0)return Tf(unescape(z).split("base64,").pop());var M=e.loadFile(z,!0);if(M!==void 0)return M}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var q;switch(F){case"PNG":q="image/png";break;case"WEBP":q="image/webp";break;default:q="image/jpeg"}return Tf(L.toDataURL(q,1).split("base64,").pop())}},v=function(L){var F=this.internal.collections[t+"images"];if(F){for(var z in F)if(L===F[z].alias)return F[z]}},m=function(L,F,z){return L||F||(L=-96,F=-96),L<0&&(L=-1*z.width*72/L/this.internal.scaleFactor),F<0&&(F=-1*z.height*72/F/this.internal.scaleFactor),L===0&&(L=F*z.width/z.height),F===0&&(F=L*z.height/z.width),[L,F]},y=function(L,F,z,M,q,fe){var he=m.call(this,z,M,q),pe=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,we=u.call(this);if(z=he[0],M=he[1],we[q.index]=q,fe){fe*=Math.PI/180;var Y=Math.cos(fe),T=Math.sin(fe),R=function(O){return O.toFixed(4)},N=[R(Y),R(T),R(-1*T),R(Y),0,0,"cm"]}this.internal.write("q"),fe?(this.internal.write([1,"0","0",1,pe(L),Q(F+M),"cm"].join(" ")),this.internal.write(N.join(" ")),this.internal.write([pe(z),"0","0",pe(M),"0","0","cm"].join(" "))):this.internal.write([pe(z),"0","0",pe(M),pe(L),Q(F+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+q.index+" Do"),this.internal.write("Q")},_=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var k=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},g=e.__addimage__.sHashCode=function(L){var F,z,M=0;if(typeof L=="string")for(z=L.length,F=0;F<z;F++)M=(M<<5)-M+L.charCodeAt(F),M|=0;else if(E(L))for(z=L.byteLength/2,F=0;F<z;F++)M=(M<<5)-M+L[F],M|=0;return M},w=e.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var F=!0;return L.length===0&&(F=!1),L.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(F=!1),F},C=e.__addimage__.extractImageFromDataUrl=function(L){if(L==null||!(L=L.trim()).startsWith("data:"))return null;var F=L.indexOf(",");return F<0?null:L.substring(0,F).trim().endsWith("base64")?L.substring(F+1):null};e.__addimage__.isArrayBuffer=function(L){return L instanceof ArrayBuffer};var E=e.__addimage__.isArrayBufferView=function(L){return L instanceof Int8Array||L instanceof Uint8Array||L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(L){for(var F=L.length,z=new Uint8Array(F),M=0;M<F;M++)z[M]=L.charCodeAt(M);return z},I=e.__addimage__.arrayBufferToBinaryString=function(L){for(var F="",z=E(L)?L:new Uint8Array(L),M=0;M<z.length;M+=8192)F+=String.fromCharCode.apply(null,z.subarray(M,M+8192));return F};e.addImage=function(){var L,F,z,M,q,fe,he,pe,Q;if(typeof arguments[1]=="number"?(F=r,z=arguments[1],M=arguments[2],q=arguments[3],fe=arguments[4],he=arguments[5],pe=arguments[6],Q=arguments[7]):(F=arguments[1],z=arguments[2],M=arguments[3],q=arguments[4],fe=arguments[5],he=arguments[6],pe=arguments[7],Q=arguments[8]),jr(L=arguments[0])==="object"&&!p(L)&&"imageData"in L){var we=L;L=we.imageData,F=we.format||F||r,z=we.x||z||0,M=we.y||M||0,q=we.w||we.width||q,fe=we.h||we.height||fe,he=we.alias||he,pe=we.compression||pe,Q=we.rotation||we.angle||Q}var Y=this.internal.getFilters();if(pe===void 0&&Y.indexOf("FlateEncode")!==-1&&(pe="SLOW"),isNaN(z)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var T=D.call(this,L,F,he,pe);return y.call(this,z,M,q,fe,T,Q),this};var D=function(L,F,z,M){var q,fe,he;if(typeof L=="string"&&n(L)===r){L=unescape(L);var pe=B(L,!1);(pe!==""||(pe=e.loadFile(L,!0))!==void 0)&&(L=pe)}if(p(L)&&(L=d(L,F)),F=n(L,F),!h(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((he=z)==null||he.length===0)&&(z=function(Q){return typeof Q=="string"||E(Q)?g(Q):E(Q.data)?g(Q.data):null}(L)),(q=v.call(this,z))||(L instanceof Uint8Array||F==="RGBA"||(fe=L,L=A(L)),q=this["process"+F.toUpperCase()](L,f.call(this),z,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in e.image_compression?Q:k.NONE}(M),fe)),!q)throw new Error("An unknown error occurred whilst processing the image.");return q},B=e.__addimage__.convertBase64ToBinaryString=function(L,F){F=typeof F!="boolean"||F;var z,M="";if(typeof L=="string"){var q;z=(q=C(L))!==null&&q!==void 0?q:L;try{M=Tf(z)}catch(fe){if(F)throw w(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return M};e.getImageProperties=function(L){var F,z,M="";if(p(L)&&(L=d(L)),typeof L=="string"&&n(L)===r&&((M=B(L,!1))===""&&(M=e.loadFile(L)||""),L=M),z=n(L),!h(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(L instanceof Uint8Array||(L=A(L)),!(F=this["process"+z.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=z,F}})(ht.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};ht.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,n,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,h=0;h<u.length&&!f;h++)switch((a=u[h]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){a=u[p];var d=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),_=this.internal.getEncryptor(m.objId),k=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y)+"] ")+"/Contents ("+d(_(a.contents))+")",i+=" /Popup "+y.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+d(_(k))+") >>",m.content=i;var g=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+l(a.bounds.y)+"] ")+" /Parent "+g,a.open&&(i+=" /Open true"),i+=" >>",y.content=i,this.internal.write(m.objId,"0 R",y.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y+a.bounds.h)+"] ";var w=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+d(v(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var C=this.annotations._nameMap[a.options.name];a.options.pageNumber=C.page,a.options.top=C.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+d(v(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;default:var E=l(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+E+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,n,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(a),w:c(r+n),h:u(a+i)},options:o,type:"link"})},e.textWithLink=function(r,a,n,i){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var f=this.splitTextToSize(r,l).length;o=Math.ceil(u*f)}else l=c,o=u;return this.text(r,a,n,i),n+=.2*u,i.align==="center"&&(a-=c/2),i.align==="right"&&(a-=c),this.link(a,n-u,l,o,i),c},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(ht.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},l=e.__arabicParser__.isArabicEndLetter=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(m){return o(m)&&n.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(m){var y=0,_=r,k="",g=0;for(y=0;y<m.length;y+=1)_[m.charCodeAt(y)]!==void 0?(g++,typeof(_=_[m.charCodeAt(y)])=="number"&&(k+=String.fromCharCode(_),_=r,g=0),y===m.length-1&&(_=r,k+=m.charAt(y-(g-1)),y-=g-1,g=0)):(_=r,k+=m.charAt(y-g),y-=g,g=0);return k};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&a[m.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(m,y,_){return o(m)?i(m)===!1?-1:!u(m)||!o(y)&&!o(_)||!o(_)&&l(y)||l(m)&&!o(y)||l(m)&&c(y)||l(m)&&l(y)?0:f(m)&&o(y)&&!l(y)&&o(_)&&u(_)?3:l(m)||!o(_)?1:2:-1},d=function(m){var y=0,_=0,k=0,g="",w="",C="",E=(m=m||"").split("\\s+"),A=[];for(y=0;y<E.length;y+=1){for(A.push(""),_=0;_<E[y].length;_+=1)g=E[y][_],w=E[y][_-1],C=E[y][_+1],o(g)?(k=p(g,w,C),A[y]+=k!==-1?String.fromCharCode(t[g.charCodeAt(0)][k]):g):A[y]+=g;A[y]=h(A[y])}return A.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var m,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,_=[];if(Array.isArray(y)){var k=0;for(_=[],k=0;k<y.length;k+=1)Array.isArray(y[k])?_.push([d(y[k][0]),y[k][1],y[k][2]]):_.push([d(y[k])]);m=_}else m=d(y);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",v])}(ht.API),ht.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(ht.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(m){p=m}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(m){v=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return a.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){a.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),h=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,d=0,v=0,m=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var _=u.maxWidth;_>0?typeof c=="string"?c=this.splitTextToSize(c,_):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(g,w){return g.concat(y.splitTextToSize(w,_))},[])):c=Array.isArray(c)?c:[c];for(var k=0;k<c.length;k++)d<(m=this.getStringUnitWidth(c[k],{font:h})*f)&&(d=m);return d!==0&&(v=c.length),{w:d/=p,h:Math.max((v*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,d&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,f,h,p){if(a.call(this),!f)throw new Error("No data for PDF table.");var d,v,m,y,_=[],k=[],g=[],w={},C={},E=[],A=[],I=(p=p||{}).autoSize||!1,D=p.printHeaders!==!1,B=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,L=p.margins||Object.assign({width:this.getPageWidth()},t),F=typeof p.padding=="number"?p.padding:3,z=p.headerBackgroundColor||"#c8c8c8",M=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=D,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=z,this.internal.__cell__.headerTextColor=M,this.setFontSize(B),h==null)k=_=Object.keys(f[0]),g=_.map(function(){return"left"});else if(Array.isArray(h)&&jr(h[0])==="object")for(_=h.map(function(we){return we.name}),k=h.map(function(we){return we.prompt||we.name||""}),g=h.map(function(we){return we.align||"left"}),d=0;d<h.length;d+=1)C[h[d].name]=.7499990551181103*h[d].width;else Array.isArray(h)&&typeof h[0]=="string"&&(k=_=h,g=_.map(function(){return"left"}));if(I||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<_.length;d+=1){for(w[y=_[d]]=f.map(function(we){return we[y]}),this.setFont(void 0,"bold"),E.push(this.getTextDimensions(k[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=w[y],this.setFont(void 0,"normal"),m=0;m<v.length;m+=1)E.push(this.getTextDimensions(v[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);C[y]=Math.max.apply(null,E)+F+F,E=[]}if(D){var q={};for(d=0;d<_.length;d+=1)q[_[d]]={},q[_[d]].text=k[d],q[_[d]].align=g[d];var fe=l.call(this,q,C);A=_.map(function(we){return new i(c,u,C[we],fe,q[we].text,void 0,q[we].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var he=h.reduce(function(we,Y){return we[Y.name]=Y.align,we},{});for(d=0;d<f.length;d+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:d,data:f[d]},this);var pe=l.call(this,f[d],C);for(m=0;m<_.length;m+=1){var Q=f[d][_[m]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:d,col:m,data:Q},this),o.call(this,new i(c,u,C[_[m]],pe,Q,d+2,he[_[m]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var f=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(d){var v=c[d];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,u[d]-f-f)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/p+f+f},this).reduce(function(d,v){return Math.max(d,v)},0)};e.setTableHeaderRow=function(c){a.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){f=this.internal.__cell__.tableHeaderRow[d].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(v)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(ht.API);var n_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},i_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],p1=a_(i_),s_=[100,200,300,400,500,600,700,800,900],YR=a_(s_);function bp(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return n_[i=i||"normal"]?i:"normal"}(e.style),a=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),n=function(i){return typeof p1[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function Hv(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var XR={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},$v={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Vv(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Gv(e){return e.trimLeft()}function JR(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function ZR(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var gf,Kv,Yv,Hl,vf,Xv,Jv,Zv,wp=["times"];function Qv(e,t,r,a,n){var i=4,o=ty;switch(n){case ht.API.image_compression.FAST:i=1,o=ey;break;case ht.API.image_compression.MEDIUM:i=6,o=ry;break;case ht.API.image_compression.SLOW:i=9,o=ay}e=function(c,u,f,h){for(var p,d=c.length/u,v=new Uint8Array(c.length+d),m=[QR,ey,ty,ry,ay],y=0;y<d;y+=1){var _=y*u,k=c.subarray(_,_+u);if(h)v.set(h(k,f,p),_+y);else{for(var g=m.length,w=[],C=0;C<g;C+=1)w[C]=m[C](k,f,p);var E=tO(w.concat());v.set(w[E],_+y)}p=k}return v}(e,t,Math.ceil(r*a/8),o);var l=o1(e,{level:i});return ht.API.__addimage__.arrayBufferToBinaryString(l)}function QR(e){var t=Array.apply([],e);return t.unshift(0),t}function ey(e,t){var r=e.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var i=e[n-t]||0;a[n+1]=e[n]-i+256&255}return a}function ty(e,t,r){var a=e.length,n=[];n[0]=2;for(var i=0;i<a;i+=1){var o=r&&r[i]||0;n[i+1]=e[i]-o+256&255}return n}function ry(e,t,r){var a=e.length,n=[];n[0]=3;for(var i=0;i<a;i+=1){var o=e[i-t]||0,l=r&&r[i]||0;n[i+1]=e[i]+256-(o+l>>>1)&255}return n}function ay(e,t,r){var a=e.length,n=[];n[0]=4;for(var i=0;i<a;i+=1){var o=eO(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);n[i+1]=e[i]-o+256&255}return n}function eO(e,t,r){if(e===t&&t===r)return e;var a=Math.abs(t-r),n=Math.abs(e-r),i=Math.abs(e+t-r-r);return a<=n&&a<=i?e:n<=i?t:r}function tO(e){var t=e.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return t.indexOf(Math.min.apply(null,t))}function _p(e,t,r){var a=t*r,n=Math.floor(a/8),i=16-(a-8*n+r),o=(1<<r)-1;return o_(e,n)>>i&o}function ny(e,t,r,a){var n=r*a,i=Math.floor(n/8),o=16-(n-8*i+a),l=(1<<a)-1,c=(t&l)<<o;(function(u,f,h){if(f+1<u.byteLength)u.setUint16(f,h,!1);else{var p=h>>8&255;u.setUint8(f,p)}})(e,i,o_(e,i)&~(l<<o)&65535|c)}function o_(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function rO(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],i=n>>7,o=1<<1+(7&n);e[t++],e[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var u=!0,f=[],h=0,p=null,d=0,v=null;for(this.width=r,this.height=a;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],1&m||(p=null),d=m>>2&7,t++;break;case 254:for(;;){if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,k=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,w=e[t++],C=w>>6&1,E=1<<1+(7&w),A=l,I=c,D=!1;w>>7&&(D=!0,A=t,I=E,t+=3*E);var B=t;for(t++;;){var L;if(!((L=e[t++])>=0))throw Error("Invalid block size");if(L===0)break;t+=L}f.push({x:y,y:_,width:k,height:g,has_local_palette:D,palette_offset:A,palette_size:I,data_offset:B,data_length:t-B,transparent_index:p,interlaced:!!C,delay:h,disposal:d});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return v},this.frameInfo=function(F){if(F<0||F>=f.length)throw new Error("Frame index out of range.");return f[F]},this.decodeAndBlitFrameBGRA=function(F,z){var M=this.frameInfo(F),q=M.width*M.height,fe=new Uint8Array(q);iy(e,M.data_offset,fe,q);var he=M.palette_offset,pe=M.transparent_index;pe===null&&(pe=256);var Q=M.width,we=r-Q,Y=Q,T=4*(M.y*r+M.x),R=4*((M.y+M.height)*r+M.x),N=T,O=4*we;M.interlaced===!0&&(O+=4*r*7);for(var H=8,ae=0,de=fe.length;ae<de;++ae){var me=fe[ae];if(Y===0&&(Y=Q,(N+=O)>=R&&(O=4*we+4*r*(H-1),N=T+(Q+we)*(H<<1),H>>=1)),me===pe)N+=4;else{var xe=e[he+3*me],Se=e[he+3*me+1],Z=e[he+3*me+2];z[N++]=Z,z[N++]=Se,z[N++]=xe,z[N++]=255}--Y}},this.decodeAndBlitFrameRGBA=function(F,z){var M=this.frameInfo(F),q=M.width*M.height,fe=new Uint8Array(q);iy(e,M.data_offset,fe,q);var he=M.palette_offset,pe=M.transparent_index;pe===null&&(pe=256);var Q=M.width,we=r-Q,Y=Q,T=4*(M.y*r+M.x),R=4*((M.y+M.height)*r+M.x),N=T,O=4*we;M.interlaced===!0&&(O+=4*r*7);for(var H=8,ae=0,de=fe.length;ae<de;++ae){var me=fe[ae];if(Y===0&&(Y=Q,(N+=O)>=R&&(O=4*we+4*r*(H-1),N=T+(Q+we)*(H<<1),H>>=1)),me===pe)N+=4;else{var xe=e[he+3*me],Se=e[he+3*me+1],Z=e[he+3*me+2];z[N++]=xe,z[N++]=Se,z[N++]=Z,z[N++]=255}--Y}}}function iy(e,t,r,a){for(var n=e[t++],i=1<<n,o=i+1,l=o+1,c=n+1,u=(1<<c)-1,f=0,h=0,p=0,d=e[t++],v=new Int32Array(4096),m=null;;){for(;f<16&&d!==0;)h|=e[t++]<<f,f+=8,d===1?d=e[t++]:--d;if(f<c)break;var y=h&u;if(h>>=c,f-=c,y!==i){if(y===o)break;for(var _=y<l?y:m,k=0,g=_;g>i;)g=v[g]>>8,++k;var w=g;if(p+k+(_!==y?1:0)>a)return void Lr.log("Warning, gif stream longer than expected.");r[p++]=w;var C=p+=k;for(_!==y&&(r[p++]=w),g=_;k--;)g=v[g],r[--C]=255&g,g>>=8;m!==null&&l<4096&&(v[l++]=m<<8|w,l>=u+1&&c<12&&(++c,u=u<<1|1)),m=y}else l=o+1,u=(1<<(c=n+1))-1,m=null}return p!==a&&Lr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function kp(e){var t,r,a,n,i,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),h=new Array(65535),p=new Array(65535),d=new Array(64),v=new Array(64),m=[],y=0,_=7,k=new Array(64),g=new Array(64),w=new Array(64),C=new Array(256),E=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function fe(T,R){for(var N=0,O=0,H=new Array,ae=1;ae<=16;ae++){for(var de=1;de<=T[ae];de++)H[R[O]]=[],H[R[O]][0]=N,H[R[O]][1]=ae,O++,N++;N*=2}return H}function he(T){for(var R=T[0],N=T[1]-1;N>=0;)R&1<<N&&(y|=1<<_),N--,--_<0&&(y==255?(pe(255),pe(0)):pe(y),_=7,y=0)}function pe(T){m.push(T)}function Q(T){pe(T>>8&255),pe(255&T)}function we(T,R,N,O,H){for(var ae,de=H[0],me=H[240],xe=function(Me,pt){var at,bt,ft,qt,Mt,jt,Xt,Tt,st,Qe,et=0;for(st=0;st<8;++st){at=Me[et],bt=Me[et+1],ft=Me[et+2],qt=Me[et+3],Mt=Me[et+4],jt=Me[et+5],Xt=Me[et+6];var fr=at+(Tt=Me[et+7]),Nt=at-Tt,Ot=bt+Xt,Gt=bt-Xt,Br=ft+jt,St=ft-jt,wr=qt+Mt,Et=qt-Mt,zt=fr+wr,Mr=fr-wr,er=Ot+Br,At=Ot-Br;Me[et]=zt+er,Me[et+4]=zt-er;var vr=.707106781*(At+Mr);Me[et+2]=Mr+vr,Me[et+6]=Mr-vr;var fs=.382683433*((zt=Et+St)-(At=Gt+Nt)),za=.5411961*zt+fs,bi=1.306562965*At+fs,ti=.707106781*(er=St+Gt),Ct=Nt+ti,wi=Nt-ti;Me[et+5]=wi+za,Me[et+3]=wi-za,Me[et+1]=Ct+bi,Me[et+7]=Ct-bi,et+=8}for(et=0,st=0;st<8;++st){at=Me[et],bt=Me[et+8],ft=Me[et+16],qt=Me[et+24],Mt=Me[et+32],jt=Me[et+40],Xt=Me[et+48];var _i=at+(Tt=Me[et+56]),an=at-Tt,Tn=bt+Xt,Gr=bt-Xt,wa=ft+jt,V=ft-jt,se=qt+Mt,ee=qt-Mt,re=_i+se,oe=_i-se,ce=Tn+wa,ke=Tn-wa;Me[et]=re+ce,Me[et+32]=re-ce;var Ce=.707106781*(ke+oe);Me[et+16]=oe+Ce,Me[et+48]=oe-Ce;var Ae=.382683433*((re=ee+V)-(ke=Gr+an)),Ne=.5411961*re+Ae,Ee=1.306562965*ke+Ae,He=.707106781*(ce=V+Gr),Xe=an+He,nt=an-He;Me[et+40]=nt+Ne,Me[et+24]=nt-Ne,Me[et+8]=Xe+Ee,Me[et+56]=Xe-Ee,et++}for(st=0;st<64;++st)Qe=Me[st]*pt[st],d[st]=Qe>0?Qe+.5|0:Qe-.5|0;return d}(T,R),Se=0;Se<64;++Se)v[A[Se]]=xe[Se];var Z=v[0]-N;N=v[0],Z==0?he(O[0]):(he(O[p[ae=32767+Z]]),he(h[ae]));for(var Fe=63;Fe>0&&v[Fe]==0;)Fe--;if(Fe==0)return he(de),N;for(var $e,J=1;J<=Fe;){for(var Oe=J;v[J]==0&&J<=Fe;)++J;var Be=J-Oe;if(Be>=16){$e=Be>>4;for(var it=1;it<=$e;++it)he(me);Be&=15}ae=32767+v[J],he(H[(Be<<4)+p[ae]]),he(h[ae]),J++}return Fe!=63&&he(de),N}function Y(T){T=Math.min(Math.max(T,1),100),i!=T&&(function(R){for(var N=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var H=o((N[O]*R+50)/100);H=Math.min(Math.max(H,1),255),l[A[O]]=H}for(var ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var me=o((ae[de]*R+50)/100);me=Math.min(Math.max(me,1),255),c[A[de]]=me}for(var xe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,Z=0;Z<8;Z++)for(var Fe=0;Fe<8;Fe++)u[Se]=1/(l[A[Se]]*xe[Z]*xe[Fe]*8),f[Se]=1/(c[A[Se]]*xe[Z]*xe[Fe]*8),Se++}(T<50?Math.floor(5e3/T):Math.floor(200-2*T)),i=T)}this.encode=function(T,R){R&&Y(R),m=new Array,y=0,_=7,Q(65496),Q(65504),Q(16),pe(74),pe(70),pe(73),pe(70),pe(0),pe(1),pe(1),pe(0),Q(1),Q(1),pe(0),pe(0),function(){Q(65499),Q(132),pe(0);for(var bt=0;bt<64;bt++)pe(l[bt]);pe(1);for(var ft=0;ft<64;ft++)pe(c[ft])}(),function(bt,ft){Q(65472),Q(17),pe(8),Q(ft),Q(bt),pe(3),pe(1),pe(17),pe(0),pe(2),pe(17),pe(1),pe(3),pe(17),pe(1)}(T.width,T.height),function(){Q(65476),Q(418),pe(0);for(var bt=0;bt<16;bt++)pe(I[bt+1]);for(var ft=0;ft<=11;ft++)pe(D[ft]);pe(16);for(var qt=0;qt<16;qt++)pe(B[qt+1]);for(var Mt=0;Mt<=161;Mt++)pe(L[Mt]);pe(1);for(var jt=0;jt<16;jt++)pe(F[jt+1]);for(var Xt=0;Xt<=11;Xt++)pe(z[Xt]);pe(17);for(var Tt=0;Tt<16;Tt++)pe(M[Tt+1]);for(var st=0;st<=161;st++)pe(q[st])}(),Q(65498),Q(12),pe(3),pe(1),pe(0),pe(2),pe(17),pe(3),pe(17),pe(0),pe(63),pe(0);var N=0,O=0,H=0;y=0,_=7,this.encode.displayName="_encode_";for(var ae,de,me,xe,Se,Z,Fe,$e,J,Oe=T.data,Be=T.width,it=T.height,Me=4*Be,pt=0;pt<it;){for(ae=0;ae<Me;){for(Se=Me*pt+ae,Fe=-1,$e=0,J=0;J<64;J++)Z=Se+($e=J>>3)*Me+(Fe=4*(7&J)),pt+$e>=it&&(Z-=Me*(pt+1+$e-it)),ae+Fe>=Me&&(Z-=ae+Fe-Me+4),de=Oe[Z++],me=Oe[Z++],xe=Oe[Z++],k[J]=(E[de]+E[me+256|0]+E[xe+512|0]>>16)-128,g[J]=(E[de+768|0]+E[me+1024|0]+E[xe+1280|0]>>16)-128,w[J]=(E[de+1280|0]+E[me+1536|0]+E[xe+1792|0]>>16)-128;N=we(k,u,N,t,a),O=we(g,f,O,r,n),H=we(w,f,H,r,n),ae+=32}pt+=8}if(_>=0){var at=[];at[1]=_+1,at[0]=(1<<_+1)-1,he(at)}return Q(65497),new Uint8Array(m)},e=e||50,function(){for(var T=String.fromCharCode,R=0;R<256;R++)C[R]=T(R)}(),t=fe(I,D),r=fe(F,z),a=fe(B,L),n=fe(M,q),function(){for(var T=1,R=2,N=1;N<=15;N++){for(var O=T;O<R;O++)p[32767+O]=N,h[32767+O]=[],h[32767+O][1]=N,h[32767+O][0]=O;for(var H=-(R-1);H<=-T;H++)p[32767+H]=N,h[32767+H]=[],h[32767+H][1]=N,h[32767+H][0]=R-1+H;T<<=1,R<<=1}}(),function(){for(var T=0;T<256;T++)E[T]=19595*T,E[T+256|0]=38470*T,E[T+512|0]=7471*T+32768,E[T+768|0]=-11059*T,E[T+1024|0]=-21709*T,E[T+1280|0]=32768*T+8421375,E[T+1536|0]=-27439*T,E[T+1792|0]=-5329*T}(),Y(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ci(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function sy(e){function t(D){if(!D)throw Error("assert :P")}function r(D,B,L){for(var F=0;4>F;F++)if(D[B+F]!=L.charCodeAt(F))return!0;return!1}function a(D,B,L,F,z){for(var M=0;M<z;M++)D[B+M]=L[F+M]}function n(D,B,L,F){for(var z=0;z<F;z++)D[B+z]=L}function i(D){return new Int32Array(D)}function o(D,B){for(var L=[],F=0;F<D;F++)L.push(new B);return L}function l(D,B){var L=[];return function F(z,M,q){for(var fe=q[M],he=0;he<fe&&(z.push(q.length>M+1?[]:new B),!(q.length<M+1));he++)F(z[he],M+1,q)}(L,0,D),L}var c=function(){var D=this;function B(x,b){for(var j=1<<b-1>>>0;x&j;)j>>>=1;return j?(x&j-1)+j:x}function L(x,b,j,P,W){t(!(P%j));do x[b+(P-=j)]=W;while(0<P)}function F(x,b,j,P,W){if(t(2328>=W),512>=W)var G=i(512);else if((G=i(W))==null)return 0;return function(K,X,te,ne,ve,Te){var ie,ye,_e=X,Ie=1<<te,je=i(16),Le=i(16);for(t(ve!=0),t(ne!=null),t(K!=null),t(0<te),ye=0;ye<ve;++ye){if(15<ne[ye])return 0;++je[ne[ye]]}if(je[0]==ve)return 0;for(Le[1]=0,ie=1;15>ie;++ie){if(je[ie]>1<<ie)return 0;Le[ie+1]=Le[ie]+je[ie]}for(ye=0;ye<ve;++ye)ie=ne[ye],0<ne[ye]&&(Te[Le[ie]++]=ye);if(Le[15]==1)return(ne=new z).g=0,ne.value=Te[0],L(K,_e,1,Ie,ne),Ie;var Re,Ve=-1,We=Ie-1,wt=0,ct=1,Jt=1,mt=1<<te;for(ye=0,ie=1,ve=2;ie<=te;++ie,ve<<=1){if(ct+=Jt<<=1,0>(Jt-=je[ie]))return 0;for(;0<je[ie];--je[ie])(ne=new z).g=ie,ne.value=Te[ye++],L(K,_e+wt,ve,mt,ne),wt=B(wt,ie)}for(ie=te+1,ve=2;15>=ie;++ie,ve<<=1){if(ct+=Jt<<=1,0>(Jt-=je[ie]))return 0;for(;0<je[ie];--je[ie]){if(ne=new z,(wt&We)!=Ve){for(_e+=mt,Re=1<<(Ve=ie)-te;15>Ve&&!(0>=(Re-=je[Ve]));)++Ve,Re<<=1;Ie+=mt=1<<(Re=Ve-te),K[X+(Ve=wt&We)].g=Re+te,K[X+Ve].value=_e-X-Ve}ne.g=ie-te,ne.value=Te[ye++],L(K,_e+(wt>>te),ve,mt,ne),wt=B(wt,ie)}}return ct!=2*Le[15]-1?0:Ie}(x,b,j,P,W,G)}function z(){this.value=this.g=0}function M(){this.value=this.g=0}function q(){this.G=o(5,z),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(zo,M)}function fe(x,b,j,P){t(x!=null),t(b!=null),t(2147483648>P),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=b,x.pa=j,x.Jd=b,x.Yc=j+P,x.Zc=4<=P?j+P-4+1:j,de(x)}function he(x,b){for(var j=0;0<b--;)j|=xe(x,128)<<b;return j}function pe(x,b){var j=he(x,b);return me(x)?-j:j}function Q(x,b,j,P){var W,G=0;for(t(x!=null),t(b!=null),t(4294967288>P),x.Sb=P,x.Ra=0,x.u=0,x.h=0,4<P&&(P=4),W=0;W<P;++W)G+=b[j+W]<<8*W;x.Ra=G,x.bb=P,x.oa=b,x.pa=j}function we(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Vs-8>>>0,++x.bb,x.u-=8;O(x)&&(x.h=1,x.u=0)}function Y(x,b){if(t(0<=b),!x.h&&b<=Rn){var j=N(x)&Pn[b];return x.u+=b,we(x),j}return x.h=1,x.u=0}function T(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function N(x){return x.Ra>>>(x.u&Vs-1)>>>0}function O(x){return t(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Vs}function H(x,b){x.u=b,x.h=O(x)}function ae(x){x.u>=_s&&(t(x.u>=_s),we(x))}function de(x){t(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(t(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function me(x){return he(x,1)}function xe(x,b){var j=x.Ca;0>x.b&&de(x);var P=x.b,W=j*b>>>8,G=(x.I>>>P>W)+0;for(G?(j-=W,x.I-=W+1<<P>>>0):j=W+1,P=j,W=0;256<=P;)W+=8,P>>=8;return P=7^W+Gs[P],x.b-=P,x.Ca=(j<<P)-1,G}function Se(x,b,j){x[b+0]=j>>24&255,x[b+1]=j>>16&255,x[b+2]=j>>8&255,x[b+3]=255&j}function Z(x,b){return x[b+0]|x[b+1]<<8}function Fe(x,b){return Z(x,b)|x[b+2]<<16}function $e(x,b){return Z(x,b)|Z(x,b+2)<<16}function J(x,b){var j=1<<b;return t(x!=null),t(0<b),x.X=i(j),x.X==null?0:(x.Mb=32-b,x.Xa=b,1)}function Oe(x,b){t(x!=null),t(b!=null),t(x.Xa==b.Xa),a(b.X,0,x.X,0,1<<b.Xa)}function Be(){this.X=[],this.Xa=this.Mb=0}function it(x,b,j,P){t(j!=null),t(P!=null);var W=j[0],G=P[0];return W==0&&(W=(x*G+b/2)/b),G==0&&(G=(b*W+x/2)/x),0>=W||0>=G?0:(j[0]=W,P[0]=G,1)}function Me(x,b){return x+(1<<b)-1>>>b}function pt(x,b){return((4278255360&x)+(4278255360&b)>>>0&4278255360)+((16711935&x)+(16711935&b)>>>0&16711935)>>>0}function at(x,b){D[b]=function(j,P,W,G,K,X,te){var ne;for(ne=0;ne<K;++ne){var ve=D[x](X[te+ne-1],W,G+ne);X[te+ne]=pt(j[P+ne],ve)}}}function bt(){this.ud=this.hd=this.jd=0}function ft(x,b){return((4278124286&(x^b))>>>1)+(x&b)>>>0}function qt(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function Mt(x,b){return qt(x+(x-b+.5>>1))}function jt(x,b,j){return Math.abs(b-j)-Math.abs(x-j)}function Xt(x,b,j,P,W,G,K){for(P=G[K-1],j=0;j<W;++j)G[K+j]=P=pt(x[b+j],P)}function Tt(x,b,j,P,W){var G;for(G=0;G<j;++G){var K=x[b+G],X=K>>8&255,te=16711935&(te=(te=16711935&K)+((X<<16)+X));P[W+G]=(4278255360&K)+te>>>0}}function st(x,b){b.jd=255&x,b.hd=x>>8&255,b.ud=x>>16&255}function Qe(x,b,j,P,W,G){var K;for(K=0;K<P;++K){var X=b[j+K],te=X>>>8,ne=X,ve=255&(ve=(ve=X>>>16)+((x.jd<<24>>24)*(te<<24>>24)>>>5));ne=255&(ne=(ne+=(x.hd<<24>>24)*(te<<24>>24)>>>5)+((x.ud<<24>>24)*(ve<<24>>24)>>>5)),W[G+K]=(4278255360&X)+(ve<<16)+ne}}function et(x,b,j,P,W){D[b]=function(G,K,X,te,ne,ve,Te,ie,ye){for(te=Te;te<ie;++te)for(Te=0;Te<ye;++Te)ne[ve++]=W(X[P(G[K++])])},D[x]=function(G,K,X,te,ne,ve,Te){var ie=8>>G.b,ye=G.Ea,_e=G.K[0],Ie=G.w;if(8>ie)for(G=(1<<G.b)-1,Ie=(1<<ie)-1;K<X;++K){var je,Le=0;for(je=0;je<ye;++je)je&G||(Le=P(te[ne++])),ve[Te++]=W(_e[Le&Ie]),Le>>=ie}else D["VP8LMapColor"+j](te,ne,_e,Ie,ve,Te,K,X,ye)}}function fr(x,b,j,P,W){for(j=b+j;b<j;){var G=x[b++];P[W++]=G>>16&255,P[W++]=G>>8&255,P[W++]=255&G}}function Nt(x,b,j,P,W){for(j=b+j;b<j;){var G=x[b++];P[W++]=G>>16&255,P[W++]=G>>8&255,P[W++]=255&G,P[W++]=G>>24&255}}function Ot(x,b,j,P,W){for(j=b+j;b<j;){var G=(K=x[b++])>>16&240|K>>12&15,K=240&K|K>>28&15;P[W++]=G,P[W++]=K}}function Gt(x,b,j,P,W){for(j=b+j;b<j;){var G=(K=x[b++])>>16&248|K>>13&7,K=K>>5&224|K>>3&31;P[W++]=G,P[W++]=K}}function Br(x,b,j,P,W){for(j=b+j;b<j;){var G=x[b++];P[W++]=255&G,P[W++]=G>>8&255,P[W++]=G>>16&255}}function St(x,b,j,P,W,G){if(G==0)for(j=b+j;b<j;)Se(P,((G=x[b++])[0]>>24|G[1]>>8&65280|G[2]<<8&16711680|G[3]<<24)>>>0),W+=32;else a(P,W,x,b,j)}function wr(x,b){D[b][0]=D[x+"0"],D[b][1]=D[x+"1"],D[b][2]=D[x+"2"],D[b][3]=D[x+"3"],D[b][4]=D[x+"4"],D[b][5]=D[x+"5"],D[b][6]=D[x+"6"],D[b][7]=D[x+"7"],D[b][8]=D[x+"8"],D[b][9]=D[x+"9"],D[b][10]=D[x+"10"],D[b][11]=D[x+"11"],D[b][12]=D[x+"12"],D[b][13]=D[x+"13"],D[b][14]=D[x+"0"],D[b][15]=D[x+"0"]}function Et(x){return x==ph||x==mh||x==Fu||x==xh}function zt(){this.eb=[],this.size=this.A=this.fb=0}function Mr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function er(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new zt,this.f.kb=new Mr,this.sd=null}function At(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function vr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function fs(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function za(x,b){var j=x.T,P=b.ba.f.RGBA,W=P.eb,G=P.fb+x.ka*P.A,K=oi[b.ba.S],X=x.y,te=x.O,ne=x.f,ve=x.N,Te=x.ea,ie=x.W,ye=b.cc,_e=b.dc,Ie=b.Mc,je=b.Nc,Le=x.ka,Re=x.ka+x.T,Ve=x.U,We=Ve+1>>1;for(Le==0?K(X,te,null,null,ne,ve,Te,ie,ne,ve,Te,ie,W,G,null,null,Ve):(K(b.ec,b.fc,X,te,ye,_e,Ie,je,ne,ve,Te,ie,W,G-P.A,W,G,Ve),++j);Le+2<Re;Le+=2)ye=ne,_e=ve,Ie=Te,je=ie,ve+=x.Rc,ie+=x.Rc,G+=2*P.A,K(X,(te+=2*x.fa)-x.fa,X,te,ye,_e,Ie,je,ne,ve,Te,ie,W,G-P.A,W,G,Ve);return te+=x.fa,x.j+Re<x.o?(a(b.ec,b.fc,X,te,Ve),a(b.cc,b.dc,ne,ve,We),a(b.Mc,b.Nc,Te,ie,We),j--):1&Re||K(X,te,null,null,ne,ve,Te,ie,ne,ve,Te,ie,W,G+P.A,null,null,Ve),j}function bi(x,b,j){var P=x.F,W=[x.J];if(P!=null){var G=x.U,K=b.ba.S,X=K==Cu||K==Fu;b=b.ba.f.RGBA;var te=[0],ne=x.ka;te[0]=x.T,x.Kb&&(ne==0?--te[0]:(--ne,W[0]-=x.width),x.j+x.ka+x.T==x.o&&(te[0]=x.o-x.j-ne));var ve=b.eb;ne=b.fb+ne*b.A,x=Ex(P,W[0],x.width,G,te,ve,ne+(X?0:3),b.A),t(j==te),x&&Et(K)&&$c(ve,ne,X,G,te,b.A)}return 0}function ti(x){var b=x.ma,j=b.ba.S,P=11>j,W=j==Tu||j==Eu||j==Cu||j==hh||j==12||Et(j);if(b.memory=null,b.Ib=null,b.Jb=null,b.Nd=null,!Oc(b.Oa,x,W?11:12))return 0;if(W&&Et(j)&&Lc(),x.da)alert("todo:use_scaling");else{if(P){if(b.Ib=fs,x.Kb){if(j=x.U+1>>1,b.memory=i(x.U+2*j),b.memory==null)return 0;b.ec=b.memory,b.fc=0,b.cc=b.ec,b.dc=b.fc+x.U,b.Mc=b.cc,b.Nc=b.dc+j,b.Ib=za,Lc()}}else alert("todo:EmitYUV");W&&(b.Jb=bi,P&&Ai())}if(P&&!$x){for(x=0;256>x;++x)Y_[x]=89858*(x-128)+Iu>>Du,Z_[x]=-22014*(x-128)+Iu,J_[x]=-45773*(x-128),X_[x]=113618*(x-128)+Iu>>Du;for(x=Gc;x<yh;++x)b=76283*(x-16)+Iu>>Du,Q_[x-Gc]=_a(b,255),ek[x-Gc]=_a(b+8>>4,15);$x=1}return 1}function Ct(x){var b=x.ma,j=x.U,P=x.T;return t(!(1&x.ka)),0>=j||0>=P?0:(j=b.Ib(x,b),b.Jb!=null&&b.Jb(x,b,j),b.Dc+=j,1)}function wi(x){x.ma.memory=null}function _i(x,b,j,P){return Y(x,8)!=47?0:(b[0]=Y(x,14)+1,j[0]=Y(x,14)+1,P[0]=Y(x,1),Y(x,3)!=0?0:!x.h)}function an(x,b){if(4>x)return x+1;var j=x-2>>1;return(2+(1&x)<<j)+Y(b,j)+1}function Tn(x,b){return 120<b?b-120:1<=(j=((j=P_[b-1])>>4)*x+(8-(15&j)))?j:1;var j}function Gr(x,b,j){var P=N(j),W=x[b+=255&P].g-8;return 0<W&&(H(j,j.u+8),P=N(j),b+=x[b].value,b+=P&(1<<W)-1),H(j,j.u+x[b].g),x[b].value}function wa(x,b,j){return j.g+=x.g,j.value+=x.value<<b>>>0,t(8>=j.g),x.g}function V(x,b,j){var P=x.xc;return t((b=P==0?0:x.vc[x.md*(j>>P)+(b>>P)])<x.Wb),x.Ya[b]}function se(x,b,j,P){var W=x.ab,G=x.c*b,K=x.C;b=K+b;var X=j,te=P;for(P=x.Ta,j=x.Ua;0<W--;){var ne=x.gc[W],ve=K,Te=b,ie=X,ye=te,_e=(te=P,X=j,ne.Ea);switch(t(ve<Te),t(Te<=ne.nc),ne.hc){case 2:da(ie,ye,(Te-ve)*_e,te,X);break;case 0:var Ie=ve,je=Te,Le=te,Re=X,Ve=(mt=ne).Ea;Ie==0&&(Mc(ie,ye,null,null,1,Le,Re),Xt(ie,ye+1,0,0,Ve-1,Le,Re+1),ye+=Ve,Re+=Ve,++Ie);for(var We=1<<mt.b,wt=We-1,ct=Me(Ve,mt.b),Jt=mt.K,mt=mt.w+(Ie>>mt.b)*ct;Ie<je;){var cr=Jt,Da=mt,Zt=1;for(Dl(ie,ye,Le,Re-Ve,1,Le,Re);Zt<Ve;){var xt=(Zt&~wt)+We;xt>Ve&&(xt=Ve),(0,Uc[cr[Da++]>>8&15])(ie,ye+ +Zt,Le,Re+Zt-Ve,xt-Zt,Le,Re+Zt),Zt=xt}ye+=Ve,Re+=Ve,++Ie&wt||(mt+=ct)}Te!=ne.nc&&a(te,X-_e,te,X+(Te-ve-1)*_e,_e);break;case 1:for(_e=ie,je=ye,Ve=(ie=ne.Ea)-(Re=ie&~(Le=(ye=1<<ne.b)-1)),Ie=Me(ie,ne.b),We=ne.K,ne=ne.w+(ve>>ne.b)*Ie;ve<Te;){for(wt=We,ct=ne,Jt=new bt,mt=je+Re,cr=je+ie;je<mt;)st(wt[ct++],Jt),Wc(Jt,_e,je,ye,te,X),je+=ye,X+=ye;je<cr&&(st(wt[ct++],Jt),Wc(Jt,_e,je,Ve,te,X),je+=Ve,X+=Ve),++ve&Le||(ne+=Ie)}break;case 3:if(ie==te&&ye==X&&0<ne.b){for(je=te,ie=_e=X+(Te-ve)*_e-(Re=(Te-ve)*Me(ne.Ea,ne.b)),ye=te,Le=X,Ie=[],Re=(Ve=Re)-1;0<=Re;--Re)Ie[Re]=ye[Le+Re];for(Re=Ve-1;0<=Re;--Re)je[ie+Re]=Ie[Re];Su(ne,ve,Te,te,_e,te,X)}else Su(ne,ve,Te,ie,ye,te,X)}X=P,te=j}te!=j&&a(P,j,X,te,G)}function ee(x,b){var j=x.V,P=x.Ba+x.c*x.C,W=b-x.C;if(t(b<=x.l.o),t(16>=W),0<W){var G=x.l,K=x.Ta,X=x.Ua,te=G.width;if(se(x,W,j,P),W=X=[X],t((j=x.C)<(P=b)),t(G.v<G.va),P>G.o&&(P=G.o),j<G.j){var ne=G.j-j;j=G.j,W[0]+=ne*te}if(j>=P?j=0:(W[0]+=4*G.v,G.ka=j-G.j,G.U=G.va-G.v,G.T=P-j,j=1),j){if(X=X[0],11>(j=x.ca).S){var ve=j.f.RGBA,Te=(P=j.S,W=G.U,G=G.T,ne=ve.eb,ve.A),ie=G;for(ve=ve.fb+x.Ma*ve.A;0<ie--;){var ye=K,_e=X,Ie=W,je=ne,Le=ve;switch(P){case ju:qc(ye,_e,Ie,je,Le);break;case Tu:Ks(ye,_e,Ie,je,Le);break;case ph:Ks(ye,_e,Ie,je,Le),$c(je,Le,0,Ie,1,0);break;case Rx:Uo(ye,_e,Ie,je,Le);break;case Eu:St(ye,_e,Ie,je,Le,1);break;case mh:St(ye,_e,Ie,je,Le,1),$c(je,Le,0,Ie,1,0);break;case Cu:St(ye,_e,Ie,je,Le,0);break;case Fu:St(ye,_e,Ie,je,Le,0),$c(je,Le,1,Ie,1,0);break;case hh:Ys(ye,_e,Ie,je,Le);break;case xh:Ys(ye,_e,Ie,je,Le),Tx(je,Le,Ie,1,0);break;case Ox:Xs(ye,_e,Ie,je,Le);break;default:t(0)}X+=te,ve+=Te}x.Ma+=G}else alert("todo:EmitRescaledRowsYUVA");t(x.Ma<=j.height)}}x.C=b,t(x.C<=x.i)}function re(x){var b;if(0<x.ua)return 0;for(b=0;b<x.Wb;++b){var j=x.Ya[b].G,P=x.Ya[b].H;if(0<j[1][P[1]+0].g||0<j[2][P[2]+0].g||0<j[3][P[3]+0].g)return 0}return 1}function oe(x,b,j,P,W,G){if(x.Z!=0){var K=x.qd,X=x.rd;for(t(Qs[x.Z]!=null);b<j;++b)Qs[x.Z](K,X,P,W,P,W,G),K=P,X=W,W+=G;x.qd=K,x.rd=X}}function ce(x,b){var j=x.l.ma,P=j.Z==0||j.Z==1?x.l.j:x.C;if(P=x.C<P?P:x.C,t(b<=x.l.o),b>P){var W=x.l.width,G=j.ca,K=j.tb+W*P,X=x.V,te=x.Ba+x.c*P,ne=x.gc;t(x.ab==1),t(ne[0].hc==3),Vi(ne[0],P,b,X,te,G,K),oe(j,P,b,G,K,W)}x.C=x.Ma=b}function ke(x,b,j,P,W,G,K){var X=x.$/P,te=x.$%P,ne=x.m,ve=x.s,Te=j+x.$,ie=Te;W=j+P*W;var ye=j+P*G,_e=280+ve.ua,Ie=x.Pb?X:16777216,je=0<ve.ua?ve.Wa:null,Le=ve.wc,Re=Te<ye?V(ve,te,X):null;t(x.C<G),t(ye<=W);var Ve=!1;e:for(;;){for(;Ve||Te<ye;){var We=0;if(X>=Ie){var wt=Te-j;t((Ie=x).Pb),Ie.wd=Ie.m,Ie.xd=wt,0<Ie.s.ua&&Oe(Ie.s.Wa,Ie.s.vb),Ie=X+O_}if(te&Le||(Re=V(ve,te,X)),t(Re!=null),Re.Qb&&(b[Te]=Re.qb,Ve=!0),!Ve)if(ae(ne),Re.jc){We=ne,wt=b;var ct=Te,Jt=Re.pd[N(We)&zo-1];t(Re.jc),256>Jt.g?(H(We,We.u+Jt.g),wt[ct]=Jt.value,We=0):(H(We,We.u+Jt.g-256),t(256<=Jt.value),We=Jt.value),We==0&&(Ve=!0)}else We=Gr(Re.G[0],Re.H[0],ne);if(ne.h)break;if(Ve||256>We){if(!Ve)if(Re.nd)b[Te]=(Re.qb|We<<8)>>>0;else{if(ae(ne),Ve=Gr(Re.G[1],Re.H[1],ne),ae(ne),wt=Gr(Re.G[2],Re.H[2],ne),ct=Gr(Re.G[3],Re.H[3],ne),ne.h)break;b[Te]=(ct<<24|Ve<<16|We<<8|wt)>>>0}if(Ve=!1,++Te,++te>=P&&(te=0,++X,K!=null&&X<=G&&!(X%16)&&K(x,X),je!=null))for(;ie<Te;)We=b[ie++],je.X[(506832829*We&4294967295)>>>je.Mb]=We}else if(280>We){if(We=an(We-256,ne),wt=Gr(Re.G[4],Re.H[4],ne),ae(ne),wt=Tn(P,wt=an(wt,ne)),ne.h)break;if(Te-j<wt||W-Te<We)break e;for(ct=0;ct<We;++ct)b[Te+ct]=b[Te+ct-wt];for(Te+=We,te+=We;te>=P;)te-=P,++X,K!=null&&X<=G&&!(X%16)&&K(x,X);if(t(Te<=W),te&Le&&(Re=V(ve,te,X)),je!=null)for(;ie<Te;)We=b[ie++],je.X[(506832829*We&4294967295)>>>je.Mb]=We}else{if(!(We<_e))break e;for(Ve=We-280,t(je!=null);ie<Te;)We=b[ie++],je.X[(506832829*We&4294967295)>>>je.Mb]=We;We=Te,t(!(Ve>>>(wt=je).Xa)),b[We]=wt.X[Ve],Ve=!0}Ve||t(ne.h==O(ne))}if(x.Pb&&ne.h&&Te<W)t(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&Oe(x.s.vb,x.s.Wa);else{if(ne.h)break e;K!=null&&K(x,X>G?G:X),x.a=0,x.$=Te-j}return 1}return x.a=3,0}function Ce(x){t(x!=null),x.vc=null,x.yc=null,x.Ya=null;var b=x.Wa;b!=null&&(b.X=null),x.vb=null,t(x!=null)}function Ae(){var x=new Ut;return x==null?null:(x.a=0,x.xb=zx,wr("Predictor","VP8LPredictors"),wr("Predictor","VP8LPredictors_C"),wr("PredictorAdd","VP8LPredictorsAdd"),wr("PredictorAdd","VP8LPredictorsAdd_C"),da=Tt,Wc=Qe,qc=fr,Ks=Nt,Ys=Ot,Xs=Gt,Uo=Br,D.VP8LMapColor32b=$i,D.VP8LMapColor8b=zc,x)}function Ne(x,b,j,P,W){var G=1,K=[x],X=[b],te=P.m,ne=P.s,ve=null,Te=0;e:for(;;){if(j)for(;G&&Y(te,1);){var ie=K,ye=X,_e=P,Ie=1,je=_e.m,Le=_e.gc[_e.ab],Re=Y(je,2);if(_e.Oc&1<<Re)G=0;else{switch(_e.Oc|=1<<Re,Le.hc=Re,Le.Ea=ie[0],Le.nc=ye[0],Le.K=[null],++_e.ab,t(4>=_e.ab),Re){case 0:case 1:Le.b=Y(je,3)+2,Ie=Ne(Me(Le.Ea,Le.b),Me(Le.nc,Le.b),0,_e,Le.K),Le.K=Le.K[0];break;case 3:var Ve,We=Y(je,8)+1,wt=16<We?0:4<We?1:2<We?2:3;if(ie[0]=Me(Le.Ea,wt),Le.b=wt,Ve=Ie=Ne(We,1,0,_e,Le.K)){var ct,Jt=We,mt=Le,cr=1<<(8>>mt.b),Da=i(cr);if(Da==null)Ve=0;else{var Zt=mt.K[0],xt=mt.w;for(Da[0]=mt.K[0][0],ct=1;ct<1*Jt;++ct)Da[ct]=pt(Zt[xt+ct],Da[ct-1]);for(;ct<4*cr;++ct)Da[ct]=0;mt.K[0]=null,mt.K[0]=Da,Ve=1}}Ie=Ve;break;case 2:break;default:t(0)}G=Ie}}if(K=K[0],X=X[0],G&&Y(te,1)&&!(G=1<=(Te=Y(te,4))&&11>=Te)){P.a=3;break e}var tt;if(tt=G)t:{var pa,Vt,dr,Wr=P,Ya=K,wn=X,aa=Te,nn=j,_n=Wr.m,Ia=Wr.s,xr=[null],_r=1,na=0,kr=R_[aa];r:for(;;){if(nn&&Y(_n,1)){var Xa=Y(_n,3)+2,ji=Me(Ya,Xa),ma=Me(wn,Xa),En=ji*ma;if(!Ne(ji,ma,0,Wr,xr))break r;for(xr=xr[0],Ia.xc=Xa,pa=0;pa<En;++pa){var Ir=xr[pa]>>8&65535;xr[pa]=Ir,Ir>=_r&&(_r=Ir+1)}}if(_n.h)break r;for(Vt=0;5>Vt;++Vt){var La=Bx[Vt];!Vt&&0<aa&&(La+=1<<aa),na<La&&(na=La)}var Bn=o(_r*kr,z),kn=_r,Mn=o(kn,q);if(Mn==null)var zn=null;else t(65536>=kn),zn=Mn;var Cn=i(na);if(zn==null||Cn==null||Bn==null){Wr.a=1;break r}var Un=Bn;for(pa=dr=0;pa<_r;++pa){var Ur=zn[pa],Wn=Ur.G,Ti=Ur.H,qo=0,As=1,Ja=0;for(Vt=0;5>Vt;++Vt){La=Bx[Vt],Wn[Vt]=Un,Ti[Vt]=dr,!Vt&&0<aa&&(La+=1<<aa);n:{var Pu,bh=La,Ru=Wr,Kc=Cn,ak=Un,nk=dr,wh=0,eo=Ru.m,ik=Y(eo,1);if(n(Kc,0,0,bh),ik){var sk=Y(eo,1)+1,ok=Y(eo,1),Kx=Y(eo,ok==0?1:8);Kc[Kx]=1,sk==2&&(Kc[Kx=Y(eo,8)]=1);var Ou=1}else{var Yx=i(19),Xx=Y(eo,4)+4;if(19<Xx){Ru.a=3;var Bu=0;break n}for(Pu=0;Pu<Xx;++Pu)Yx[L_[Pu]]=Y(eo,3);var _h=void 0,Yc=void 0,Jx=Ru,lk=Yx,Mu=bh,Zx=Kc,kh=0,to=Jx.m,Qx=8,eg=o(128,z);a:for(;F(eg,0,7,lk,19);){if(Y(to,1)){var ck=2+2*Y(to,3);if((_h=2+Y(to,ck))>Mu)break a}else _h=Mu;for(Yc=0;Yc<Mu&&_h--;){ae(to);var tg=eg[0+(127&N(to))];H(to,to.u+tg.g);var Ll=tg.value;if(16>Ll)Zx[Yc++]=Ll,Ll!=0&&(Qx=Ll);else{var uk=Ll==16,rg=Ll-16,fk=D_[rg],ag=Y(to,F_[rg])+fk;if(Yc+ag>Mu)break a;for(var dk=uk?Qx:0;0<ag--;)Zx[Yc++]=dk}}kh=1;break a}kh||(Jx.a=3),Ou=kh}(Ou=Ou&&!eo.h)&&(wh=F(ak,nk,8,Kc,bh)),Ou&&wh!=0?Bu=wh:(Ru.a=3,Bu=0)}if(Bu==0)break r;if(As&&I_[Vt]==1&&(As=Un[dr].g==0),qo+=Un[dr].g,dr+=Bu,3>=Vt){var Xc,Sh=Cn[0];for(Xc=1;Xc<La;++Xc)Cn[Xc]>Sh&&(Sh=Cn[Xc]);Ja+=Sh}}if(Ur.nd=As,Ur.Qb=0,As&&(Ur.qb=(Wn[3][Ti[3]+0].value<<24|Wn[1][Ti[1]+0].value<<16|Wn[2][Ti[2]+0].value)>>>0,qo==0&&256>Wn[0][Ti[0]+0].value&&(Ur.Qb=1,Ur.qb+=Wn[0][Ti[0]+0].value<<8)),Ur.jc=!Ur.Qb&&6>Ja,Ur.jc){var zu,Ns=Ur;for(zu=0;zu<zo;++zu){var ro=zu,ao=Ns.pd[ro],Uu=Ns.G[0][Ns.H[0]+ro];256<=Uu.value?(ao.g=Uu.g+256,ao.value=Uu.value):(ao.g=0,ao.value=0,ro>>=wa(Uu,8,ao),ro>>=wa(Ns.G[1][Ns.H[1]+ro],16,ao),ro>>=wa(Ns.G[2][Ns.H[2]+ro],0,ao),wa(Ns.G[3][Ns.H[3]+ro],24,ao))}}}Ia.vc=xr,Ia.Wb=_r,Ia.Ya=zn,Ia.yc=Bn,tt=1;break t}tt=0}if(!(G=tt)){P.a=3;break e}if(0<Te){if(ne.ua=1<<Te,!J(ne.Wa,Te)){P.a=1,G=0;break e}}else ne.ua=0;var Ah=P,ng=K,hk=X,Nh=Ah.s,jh=Nh.xc;if(Ah.c=ng,Ah.i=hk,Nh.md=Me(ng,jh),Nh.wc=jh==0?-1:(1<<jh)-1,j){P.xb=H_;break e}if((ve=i(K*X))==null){P.a=1,G=0;break e}G=(G=ke(P,ve,0,K,X,X,null))&&!te.h;break e}return G?(W!=null?W[0]=ve:(t(ve==null),t(j)),P.$=0,j||Ce(ne)):Ce(ne),G}function Ee(x,b){var j=x.c*x.i,P=j+b+16*b;return t(x.c<=b),x.V=i(P),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+j+b,1)}function He(x,b){var j=x.C,P=b-j,W=x.V,G=x.Ba+x.c*j;for(t(b<=x.l.o);0<P;){var K=16<P?16:P,X=x.l.ma,te=x.l.width,ne=te*K,ve=X.ca,Te=X.tb+te*j,ie=x.Ta,ye=x.Ua;se(x,K,W,G),Cx(ie,ye,ve,Te,ne),oe(X,j,j+K,ve,Te,te),P-=K,W+=K*x.c,j+=K}t(j==b),x.C=x.Ma=b}function Xe(){this.ub=this.yd=this.td=this.Rb=0}function nt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ge(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function rt(){this.Yb=function(){var x=[];return function b(j,P,W){for(var G=W[P],K=0;K<G&&(j.push(W.length>P+1?[]:0),!(W.length<P+1));K++)b(j[K],P+1,W)}(x,0,[3,11]),x}()}function Lt(){this.jb=i(3),this.Wc=l([4,8],rt),this.Xc=l([4,17],rt)}function Er(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function sr(){this.ld=this.La=this.dd=this.tc=0}function ra(){this.Na=this.la=0}function Ui(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ki(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Wi(){this.uc=this.M=this.Nb=0,this.wa=Array(new sr),this.Y=0,this.ya=Array(new ki),this.aa=0,this.l=new Al}function ri(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Ws(){this.cb=this.a=0,this.sc="",this.m=new T,this.Od=new Xe,this.Kc=new nt,this.ed=new Er,this.Qa=new Ge,this.Ic=this.$c=this.Aa=0,this.D=new Wi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,T),this.ia=0,this.pb=o(4,Ui),this.Pa=new Lt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ri),this.Hd=0,this.rb=Array(new ra),this.sb=0,this.wa=Array(new sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ki),this.L=this.aa=0,this.gd=l([4,2],sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function _a(x,b){return 0>x?0:x>b?b:x}function Al(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Jd(){var x=new Ws;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,Vc||(Vc=Nl)),x}function ka(x,b,j){return x.a==0&&(x.a=b,x.sc=j,x.cb=0),0}function du(x,b,j){return 3<=j&&x[b+0]==157&&x[b+1]==1&&x[b+2]==42}function qi(x,b){if(x==null)return 0;if(x.a=0,x.sc="OK",b==null)return ka(x,2,"null VP8Io passed to VP8GetHeaders()");var j=b.data,P=b.w,W=b.ha;if(4>W)return ka(x,7,"Truncated header.");var G=j[P+0]|j[P+1]<<8|j[P+2]<<16,K=x.Od;if(K.Rb=!(1&G),K.td=G>>1&7,K.yd=G>>4&1,K.ub=G>>5,3<K.td)return ka(x,3,"Incorrect keyframe parameters.");if(!K.yd)return ka(x,4,"Frame not displayable.");P+=3,W-=3;var X=x.Kc;if(K.Rb){if(7>W)return ka(x,7,"cannot parse picture header");if(!du(j,P,W))return ka(x,3,"Bad code word");X.c=16383&(j[P+4]<<8|j[P+3]),X.Td=j[P+4]>>6,X.i=16383&(j[P+6]<<8|j[P+5]),X.Ud=j[P+6]>>6,P+=7,W-=7,x.za=X.c+15>>4,x.Ub=X.i+15>>4,b.width=X.c,b.height=X.i,b.Da=0,b.j=0,b.v=0,b.va=b.width,b.o=b.height,b.da=0,b.ib=b.width,b.hb=b.height,b.U=b.width,b.T=b.height,n((G=x.Pa).jb,0,255,G.jb.length),t((G=x.Qa)!=null),G.Cb=0,G.Bb=0,G.Fb=1,n(G.Zb,0,0,G.Zb.length),n(G.Lb,0,0,G.Lb)}if(K.ub>W)return ka(x,7,"bad partition length");fe(G=x.m,j,P,K.ub),P+=K.ub,W-=K.ub,K.Rb&&(X.Ld=me(G),X.Kd=me(G)),X=x.Qa;var te,ne=x.Pa;if(t(G!=null),t(X!=null),X.Cb=me(G),X.Cb){if(X.Bb=me(G),me(G)){for(X.Fb=me(G),te=0;4>te;++te)X.Zb[te]=me(G)?pe(G,7):0;for(te=0;4>te;++te)X.Lb[te]=me(G)?pe(G,6):0}if(X.Bb)for(te=0;3>te;++te)ne.jb[te]=me(G)?he(G,8):255}else X.Bb=0;if(G.Ka)return ka(x,3,"cannot parse segment header");if((X=x.ed).zd=me(G),X.Tb=he(G,6),X.wb=he(G,3),X.Pc=me(G),X.Pc&&me(G)){for(ne=0;4>ne;++ne)me(G)&&(X.vd[ne]=pe(G,6));for(ne=0;4>ne;++ne)me(G)&&(X.od[ne]=pe(G,6))}if(x.L=X.Tb==0?0:X.zd?1:2,G.Ka)return ka(x,3,"cannot parse filter header");var ve=W;if(W=te=P,P=te+ve,X=ve,x.Xb=(1<<he(x.m,2))-1,ve<3*(ne=x.Xb))j=7;else{for(te+=3*ne,X-=3*ne,ve=0;ve<ne;++ve){var Te=j[W+0]|j[W+1]<<8|j[W+2]<<16;Te>X&&(Te=X),fe(x.Jc[+ve],j,te,Te),te+=Te,X-=Te,W+=3}fe(x.Jc[+ne],j,te,X),j=te<P?0:5}if(j!=0)return ka(x,j,"cannot parse partitions");for(j=he(te=x.m,7),W=me(te)?pe(te,4):0,P=me(te)?pe(te,4):0,X=me(te)?pe(te,4):0,ne=me(te)?pe(te,4):0,te=me(te)?pe(te,4):0,ve=x.Qa,Te=0;4>Te;++Te){if(ve.Cb){var ie=ve.Zb[Te];ve.Fb||(ie+=j)}else{if(0<Te){x.pb[Te]=x.pb[0];continue}ie=j}var ye=x.pb[Te];ye.Sc[0]=gh[_a(ie+W,127)],ye.Sc[1]=vh[_a(ie+0,127)],ye.Eb[0]=2*gh[_a(ie+P,127)],ye.Eb[1]=101581*vh[_a(ie+X,127)]>>16,8>ye.Eb[1]&&(ye.Eb[1]=8),ye.Qc[0]=gh[_a(ie+ne,117)],ye.Qc[1]=vh[_a(ie+te,127)],ye.lc=ie+te}if(!K.Rb)return ka(x,4,"Not a key frame.");for(me(G),K=x.Pa,j=0;4>j;++j){for(W=0;8>W;++W)for(P=0;3>P;++P)for(X=0;11>X;++X)ne=xe(G,W_[j][W][P][X])?he(G,8):z_[j][W][P][X],K.Wc[j][W].Yb[P][X]=ne;for(W=0;17>W;++W)K.Xc[j][W]=K.Wc[j][q_[W]]}return x.kc=me(G),x.kc&&(x.Bd=he(G,8)),x.cb=1}function Nl(x,b,j,P,W,G,K){var X=b[W].Yb[j];for(j=0;16>W;++W){if(!xe(x,X[j+0]))return W;for(;!xe(x,X[j+1]);)if(X=b[++W].Yb[0],j=0,W==16)return 16;var te=b[W+1].Yb;if(xe(x,X[j+2])){var ne=x,ve=0;if(xe(ne,(ie=X)[(Te=j)+3]))if(xe(ne,ie[Te+6])){for(X=0,Te=2*(ve=xe(ne,ie[Te+8]))+(ie=xe(ne,ie[Te+9+ve])),ve=0,ie=B_[Te];ie[X];++X)ve+=ve+xe(ne,ie[X]);ve+=3+(8<<Te)}else xe(ne,ie[Te+7])?(ve=7+2*xe(ne,165),ve+=xe(ne,145)):ve=5+xe(ne,159);else ve=xe(ne,ie[Te+4])?3+xe(ne,ie[Te+5]):2;X=te[2]}else ve=1,X=te[1];te=K+M_[W],0>(ne=x).b&&de(ne);var Te,ie=ne.b,ye=(Te=ne.Ca>>1)-(ne.I>>ie)>>31;--ne.b,ne.Ca+=ye,ne.Ca|=1,ne.I-=(Te+1&ye)<<ie,G[te]=((ve^ye)-ye)*P[(0<W)+0]}return 16}function hu(x){var b=x.rb[x.sb-1];b.la=0,b.Na=0,n(x.zc,0,0,x.zc.length),x.ja=0}function ai(x,b,j,P,W){W=x[b+j+32*P]+(W>>3),x[b+j+32*P]=-256&W?0>W?0:255:W}function Ea(x,b,j,P,W,G){ai(x,b,0,j,P+W),ai(x,b,1,j,P+G),ai(x,b,2,j,P-G),ai(x,b,3,j,P-W)}function ds(x){return(20091*x>>16)+x}function pu(x,b,j,P){var W,G=0,K=i(16);for(W=0;4>W;++W){var X=x[b+0]+x[b+8],te=x[b+0]-x[b+8],ne=(35468*x[b+4]>>16)-ds(x[b+12]),ve=ds(x[b+4])+(35468*x[b+12]>>16);K[G+0]=X+ve,K[G+1]=te+ne,K[G+2]=te-ne,K[G+3]=X-ve,G+=4,b++}for(W=G=0;4>W;++W)X=(x=K[G+0]+4)+K[G+8],te=x-K[G+8],ne=(35468*K[G+4]>>16)-ds(K[G+12]),ai(j,P,0,0,X+(ve=ds(K[G+4])+(35468*K[G+12]>>16))),ai(j,P,1,0,te+ne),ai(j,P,2,0,te-ne),ai(j,P,3,0,X-ve),G++,P+=32}function Zd(x,b,j,P){var W=x[b+0]+4,G=35468*x[b+4]>>16,K=ds(x[b+4]),X=35468*x[b+1]>>16;Ea(j,P,0,W+K,x=ds(x[b+1]),X),Ea(j,P,1,W+G,x,X),Ea(j,P,2,W-G,x,X),Ea(j,P,3,W-K,x,X)}function Qd(x,b,j,P,W){pu(x,b,j,P),W&&pu(x,b+16,j,P+4)}function Hi(x,b,j,P){Wo(x,b+0,j,P,1),Wo(x,b+32,j,P+128,1)}function mu(x,b,j,P){var W;for(x=x[b+0]+4,W=0;4>W;++W)for(b=0;4>b;++b)ai(j,P,b,W,x)}function xu(x,b,j,P){x[b+0]&&br(x,b+0,j,P),x[b+16]&&br(x,b+16,j,P+4),x[b+32]&&br(x,b+32,j,P+128),x[b+48]&&br(x,b+48,j,P+128+4)}function jl(x,b,j,P){var W,G=i(16);for(W=0;4>W;++W){var K=x[b+0+W]+x[b+12+W],X=x[b+4+W]+x[b+8+W],te=x[b+4+W]-x[b+8+W],ne=x[b+0+W]-x[b+12+W];G[0+W]=K+X,G[8+W]=K-X,G[4+W]=ne+te,G[12+W]=ne-te}for(W=0;4>W;++W)K=(x=G[0+4*W]+3)+G[3+4*W],X=G[1+4*W]+G[2+4*W],te=G[1+4*W]-G[2+4*W],ne=x-G[3+4*W],j[P+0]=K+X>>3,j[P+16]=ne+te>>3,j[P+32]=K-X>>3,j[P+48]=ne-te>>3,P+=64}function Co(x,b,j){var P,W=b-32,G=On,K=255-x[W-1];for(P=0;P<j;++P){var X,te=G,ne=K+x[b-1];for(X=0;X<j;++X)x[b+X]=te[ne+x[W+X]];b+=32}}function eh(x,b){Co(x,b,4)}function th(x,b){Co(x,b,8)}function rh(x,b){Co(x,b,16)}function Nc(x,b){var j;for(j=0;16>j;++j)a(x,b+32*j,x,b-32,16)}function gu(x,b){var j;for(j=16;0<j;--j)n(x,b,x[b-1],16),b+=32}function Si(x,b,j){var P;for(P=0;16>P;++P)n(b,j+32*P,x,16)}function ah(x,b){var j,P=16;for(j=0;16>j;++j)P+=x[b-1+32*j]+x[b+j-32];Si(P>>5,x,b)}function Fo(x,b){var j,P=8;for(j=0;16>j;++j)P+=x[b-1+32*j];Si(P>>4,x,b)}function jc(x,b){var j,P=8;for(j=0;16>j;++j)P+=x[b+j-32];Si(P>>4,x,b)}function nh(x,b){Si(128,x,b)}function Wt(x,b,j){return x+2*b+j+2>>2}function ih(x,b){var j,P=b-32;for(P=new Uint8Array([Wt(x[P-1],x[P+0],x[P+1]),Wt(x[P+0],x[P+1],x[P+2]),Wt(x[P+1],x[P+2],x[P+3]),Wt(x[P+2],x[P+3],x[P+4])]),j=0;4>j;++j)a(x,b+32*j,P,0,P.length)}function sh(x,b){var j=x[b-1],P=x[b-1+32],W=x[b-1+64],G=x[b-1+96];Se(x,b+0,16843009*Wt(x[b-1-32],j,P)),Se(x,b+32,16843009*Wt(j,P,W)),Se(x,b+64,16843009*Wt(P,W,G)),Se(x,b+96,16843009*Wt(W,G,G))}function oh(x,b){var j,P=4;for(j=0;4>j;++j)P+=x[b+j-32]+x[b-1+32*j];for(P>>=3,j=0;4>j;++j)n(x,b+32*j,P,4)}function hs(x,b){var j=x[b-1+0],P=x[b-1+32],W=x[b-1+64],G=x[b-1-32],K=x[b+0-32],X=x[b+1-32],te=x[b+2-32],ne=x[b+3-32];x[b+0+96]=Wt(P,W,x[b-1+96]),x[b+1+96]=x[b+0+64]=Wt(j,P,W),x[b+2+96]=x[b+1+64]=x[b+0+32]=Wt(G,j,P),x[b+3+96]=x[b+2+64]=x[b+1+32]=x[b+0+0]=Wt(K,G,j),x[b+3+64]=x[b+2+32]=x[b+1+0]=Wt(X,K,G),x[b+3+32]=x[b+2+0]=Wt(te,X,K),x[b+3+0]=Wt(ne,te,X)}function ps(x,b){var j=x[b+1-32],P=x[b+2-32],W=x[b+3-32],G=x[b+4-32],K=x[b+5-32],X=x[b+6-32],te=x[b+7-32];x[b+0+0]=Wt(x[b+0-32],j,P),x[b+1+0]=x[b+0+32]=Wt(j,P,W),x[b+2+0]=x[b+1+32]=x[b+0+64]=Wt(P,W,G),x[b+3+0]=x[b+2+32]=x[b+1+64]=x[b+0+96]=Wt(W,G,K),x[b+3+32]=x[b+2+64]=x[b+1+96]=Wt(G,K,X),x[b+3+64]=x[b+2+96]=Wt(K,X,te),x[b+3+96]=Wt(X,te,te)}function lh(x,b){var j=x[b-1+0],P=x[b-1+32],W=x[b-1+64],G=x[b-1-32],K=x[b+0-32],X=x[b+1-32],te=x[b+2-32],ne=x[b+3-32];x[b+0+0]=x[b+1+64]=G+K+1>>1,x[b+1+0]=x[b+2+64]=K+X+1>>1,x[b+2+0]=x[b+3+64]=X+te+1>>1,x[b+3+0]=te+ne+1>>1,x[b+0+96]=Wt(W,P,j),x[b+0+64]=Wt(P,j,G),x[b+0+32]=x[b+1+96]=Wt(j,G,K),x[b+1+32]=x[b+2+96]=Wt(G,K,X),x[b+2+32]=x[b+3+96]=Wt(K,X,te),x[b+3+32]=Wt(X,te,ne)}function ch(x,b){var j=x[b+0-32],P=x[b+1-32],W=x[b+2-32],G=x[b+3-32],K=x[b+4-32],X=x[b+5-32],te=x[b+6-32],ne=x[b+7-32];x[b+0+0]=j+P+1>>1,x[b+1+0]=x[b+0+64]=P+W+1>>1,x[b+2+0]=x[b+1+64]=W+G+1>>1,x[b+3+0]=x[b+2+64]=G+K+1>>1,x[b+0+32]=Wt(j,P,W),x[b+1+32]=x[b+0+96]=Wt(P,W,G),x[b+2+32]=x[b+1+96]=Wt(W,G,K),x[b+3+32]=x[b+2+96]=Wt(G,K,X),x[b+3+64]=Wt(K,X,te),x[b+3+96]=Wt(X,te,ne)}function Tl(x,b){var j=x[b-1+0],P=x[b-1+32],W=x[b-1+64],G=x[b-1+96];x[b+0+0]=j+P+1>>1,x[b+2+0]=x[b+0+32]=P+W+1>>1,x[b+2+32]=x[b+0+64]=W+G+1>>1,x[b+1+0]=Wt(j,P,W),x[b+3+0]=x[b+1+32]=Wt(P,W,G),x[b+3+32]=x[b+1+64]=Wt(W,G,G),x[b+3+64]=x[b+2+64]=x[b+0+96]=x[b+1+96]=x[b+2+96]=x[b+3+96]=G}function Tc(x,b){var j=x[b-1+0],P=x[b-1+32],W=x[b-1+64],G=x[b-1+96],K=x[b-1-32],X=x[b+0-32],te=x[b+1-32],ne=x[b+2-32];x[b+0+0]=x[b+2+32]=j+K+1>>1,x[b+0+32]=x[b+2+64]=P+j+1>>1,x[b+0+64]=x[b+2+96]=W+P+1>>1,x[b+0+96]=G+W+1>>1,x[b+3+0]=Wt(X,te,ne),x[b+2+0]=Wt(K,X,te),x[b+1+0]=x[b+3+32]=Wt(j,K,X),x[b+1+32]=x[b+3+64]=Wt(P,j,K),x[b+1+64]=x[b+3+96]=Wt(W,P,j),x[b+1+96]=Wt(G,W,P)}function Do(x,b){var j;for(j=0;8>j;++j)a(x,b+32*j,x,b-32,8)}function uh(x,b){var j;for(j=0;8>j;++j)n(x,b,x[b-1],8),b+=32}function ms(x,b,j){var P;for(P=0;8>P;++P)n(b,j+32*P,x,8)}function fh(x,b){var j,P=8;for(j=0;8>j;++j)P+=x[b+j-32]+x[b-1+32*j];ms(P>>4,x,b)}function Ec(x,b){var j,P=4;for(j=0;8>j;++j)P+=x[b+j-32];ms(P>>3,x,b)}function Cc(x,b){var j,P=4;for(j=0;8>j;++j)P+=x[b-1+32*j];ms(P>>3,x,b)}function vu(x,b){ms(128,x,b)}function xs(x,b,j){var P=x[b-j],W=x[b+0],G=3*(W-P)+dh[1020+x[b-2*j]-x[b+j]],K=Nu[112+(G+4>>3)];x[b-j]=On[255+P+Nu[112+(G+3>>3)]],x[b+0]=On[255+W-K]}function Fc(x,b,j,P){var W=x[b+0],G=x[b+j];return si[255+x[b-2*j]-x[b-j]]>P||si[255+G-W]>P}function El(x,b,j,P){return 4*si[255+x[b-j]-x[b+0]]+si[255+x[b-2*j]-x[b+j]]<=P}function Dc(x,b,j,P,W){var G=x[b-3*j],K=x[b-2*j],X=x[b-j],te=x[b+0],ne=x[b+j],ve=x[b+2*j],Te=x[b+3*j];return 4*si[255+X-te]+si[255+K-ne]>P?0:si[255+x[b-4*j]-G]<=W&&si[255+G-K]<=W&&si[255+K-X]<=W&&si[255+Te-ve]<=W&&si[255+ve-ne]<=W&&si[255+ne-te]<=W}function Io(x,b,j,P){var W=2*P+1;for(P=0;16>P;++P)El(x,b+P,j,W)&&xs(x,b+P,j)}function Ic(x,b,j,P){var W=2*P+1;for(P=0;16>P;++P)El(x,b+P*j,1,W)&&xs(x,b+P*j,1)}function yu(x,b,j,P){var W;for(W=3;0<W;--W)Io(x,b+=4*j,j,P)}function bu(x,b,j,P){var W;for(W=3;0<W;--W)Ic(x,b+=4,j,P)}function gs(x,b,j,P,W,G,K,X){for(G=2*G+1;0<W--;){if(Dc(x,b,j,G,K))if(Fc(x,b,j,X))xs(x,b,j);else{var te=x,ne=b,ve=j,Te=te[ne-2*ve],ie=te[ne-ve],ye=te[ne+0],_e=te[ne+ve],Ie=te[ne+2*ve],je=27*(Re=dh[1020+3*(ye-ie)+dh[1020+Te-_e]])+63>>7,Le=18*Re+63>>7,Re=9*Re+63>>7;te[ne-3*ve]=On[255+te[ne-3*ve]+Re],te[ne-2*ve]=On[255+Te+Le],te[ne-ve]=On[255+ie+je],te[ne+0]=On[255+ye-je],te[ne+ve]=On[255+_e-Le],te[ne+2*ve]=On[255+Ie-Re]}b+=P}}function vs(x,b,j,P,W,G,K,X){for(G=2*G+1;0<W--;){if(Dc(x,b,j,G,K))if(Fc(x,b,j,X))xs(x,b,j);else{var te=x,ne=b,ve=j,Te=te[ne-ve],ie=te[ne+0],ye=te[ne+ve],_e=Nu[112+(4+(Ie=3*(ie-Te))>>3)],Ie=Nu[112+(Ie+3>>3)],je=_e+1>>1;te[ne-2*ve]=On[255+te[ne-2*ve]+je],te[ne-ve]=On[255+Te+Ie],te[ne+0]=On[255+ie-_e],te[ne+ve]=On[255+ye-je]}b+=P}}function wu(x,b,j,P,W,G){gs(x,b,j,1,16,P,W,G)}function Lo(x,b,j,P,W,G){gs(x,b,1,j,16,P,W,G)}function _u(x,b,j,P,W,G){var K;for(K=3;0<K;--K)vs(x,b+=4*j,j,1,16,P,W,G)}function S(x,b,j,P,W,G){var K;for(K=3;0<K;--K)vs(x,b+=4,1,j,16,P,W,G)}function U(x,b,j,P,W,G,K,X){gs(x,b,W,1,8,G,K,X),gs(j,P,W,1,8,G,K,X)}function le(x,b,j,P,W,G,K,X){gs(x,b,1,W,8,G,K,X),gs(j,P,1,W,8,G,K,X)}function ge(x,b,j,P,W,G,K,X){vs(x,b+4*W,W,1,8,G,K,X),vs(j,P+4*W,W,1,8,G,K,X)}function be(x,b,j,P,W,G,K,X){vs(x,b+4,1,W,8,G,K,X),vs(j,P+4,1,W,8,G,K,X)}function Pe(){this.ba=new er,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new vr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ue(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function dt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function yt(){this.ua=0,this.Wa=new Be,this.vb=new Be,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new z}function Ut(){this.xb=this.a=0,this.l=new Al,this.ca=new er,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new yt,this.ab=0,this.gc=o(4,dt),this.Oc=0}function Kt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Al,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function mr(x,b,j,P,W,G,K){for(x=x==null?0:x[b+0],b=0;b<K;++b)W[G+b]=x+j[P+b]&255,x=W[G+b]}function Jr(x,b,j,P,W,G,K){var X;if(x==null)mr(null,null,j,P,W,G,K);else for(X=0;X<K;++X)W[G+X]=x[b+X]+j[P+X]&255}function Sa(x,b,j,P,W,G,K){if(x==null)mr(null,null,j,P,W,G,K);else{var X,te=x[b+0],ne=te,ve=te;for(X=0;X<K;++X)ne=ve+(te=x[b+X])-ne,ve=j[P+X]+(-256&ne?0>ne?0:255:ne)&255,ne=te,W[G+X]=ve}}function zr(x,b,j,P){var W=b.width,G=b.o;if(t(x!=null&&b!=null),0>j||0>=P||j+P>G)return null;if(!x.Cc){if(x.ga==null){var K;if(x.ga=new Kt,(K=x.ga==null)||(K=b.width*b.o,t(x.Gb.length==0),x.Gb=i(K),x.Uc=0,x.Gb==null?K=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,K=1),K=!K),!K){K=x.ga;var X=x.Fa,te=x.P,ne=x.qc,ve=x.mb,Te=x.nb,ie=te+1,ye=ne-1,_e=K.l;if(t(X!=null&&ve!=null&&b!=null),Qs[0]=null,Qs[1]=mr,Qs[2]=Jr,Qs[3]=Sa,K.ca=ve,K.tb=Te,K.c=b.width,K.i=b.height,t(0<K.c&&0<K.i),1>=ne)b=0;else if(K.$a=3&X[te+0],K.Z=X[te+0]>>2&3,K.Lc=X[te+0]>>4&3,te=X[te+0]>>6&3,0>K.$a||1<K.$a||4<=K.Z||1<K.Lc||te)b=0;else if(_e.put=Ct,_e.ac=ti,_e.bc=wi,_e.ma=K,_e.width=b.width,_e.height=b.height,_e.Da=b.Da,_e.v=b.v,_e.va=b.va,_e.j=b.j,_e.o=b.o,K.$a)e:{t(K.$a==1),b=Ae();t:for(;;){if(b==null){b=0;break e}if(t(K!=null),K.mc=b,b.c=K.c,b.i=K.i,b.l=K.l,b.l.ma=K,b.l.width=K.c,b.l.height=K.i,b.a=0,Q(b.m,X,ie,ye),!Ne(K.c,K.i,1,b,null)||(b.ab==1&&b.gc[0].hc==3&&re(b.s)?(K.ic=1,X=b.c*b.i,b.Ta=null,b.Ua=0,b.V=i(X),b.Ba=0,b.V==null?(b.a=1,b=0):b=1):(K.ic=0,b=Ee(b,K.c)),!b))break t;b=1;break e}K.mc=null,b=0}else b=ye>=K.c*K.i;K=!b}if(K)return null;x.ga.Lc!=1?x.Ga=0:P=G-j}t(x.ga!=null),t(j+P<=G);e:{if(b=(X=x.ga).c,G=X.l.o,X.$a==0){if(ie=x.rc,ye=x.Vc,_e=x.Fa,te=x.P+1+j*b,ne=x.mb,ve=x.nb+j*b,t(te<=x.P+x.qc),X.Z!=0)for(t(Qs[X.Z]!=null),K=0;K<P;++K)Qs[X.Z](ie,ye,_e,te,ne,ve,b),ie=ne,ye=ve,ve+=b,te+=b;else for(K=0;K<P;++K)a(ne,ve,_e,te,b),ie=ne,ye=ve,ve+=b,te+=b;x.rc=ie,x.Vc=ye}else{if(t(X.mc!=null),b=j+P,t((K=X.mc)!=null),t(b<=K.i),K.C>=b)b=1;else if(X.ic||Ai(),X.ic){X=K.V,ie=K.Ba,ye=K.c;var Ie=K.i,je=(_e=1,te=K.$/ye,ne=K.$%ye,ve=K.m,Te=K.s,K.$),Le=ye*Ie,Re=ye*b,Ve=Te.wc,We=je<Re?V(Te,ne,te):null;t(je<=Le),t(b<=Ie),t(re(Te));t:for(;;){for(;!ve.h&&je<Re;){if(ne&Ve||(We=V(Te,ne,te)),t(We!=null),ae(ve),256>(Ie=Gr(We.G[0],We.H[0],ve)))X[ie+je]=Ie,++je,++ne>=ye&&(ne=0,++te<=b&&!(te%16)&&ce(K,te));else{if(!(280>Ie)){_e=0;break t}Ie=an(Ie-256,ve);var wt,ct=Gr(We.G[4],We.H[4],ve);if(ae(ve),!(je>=(ct=Tn(ye,ct=an(ct,ve)))&&Le-je>=Ie)){_e=0;break t}for(wt=0;wt<Ie;++wt)X[ie+je+wt]=X[ie+je+wt-ct];for(je+=Ie,ne+=Ie;ne>=ye;)ne-=ye,++te<=b&&!(te%16)&&ce(K,te);je<Re&&ne&Ve&&(We=V(Te,ne,te))}t(ve.h==O(ve))}ce(K,te>b?b:te);break t}!_e||ve.h&&je<Le?(_e=0,K.a=ve.h?5:3):K.$=je,b=_e}else b=ke(K,K.V,K.Ba,K.c,K.i,b,He);if(!b){P=0;break e}}j+P>=G&&(x.Cc=1),P=1}if(!P)return null;if(x.Cc&&((P=x.ga)!=null&&(P.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+j*W}function Ca(x,b,j,P,W,G){for(;0<W--;){var K,X=x,te=b+(j?1:0),ne=x,ve=b+(j?0:3);for(K=0;K<P;++K){var Te=ne[ve+4*K];Te!=255&&(Te*=32897,X[te+4*K+0]=X[te+4*K+0]*Te>>23,X[te+4*K+1]=X[te+4*K+1]*Te>>23,X[te+4*K+2]=X[te+4*K+2]*Te>>23)}b+=G}}function Aa(x,b,j,P,W){for(;0<P--;){var G;for(G=0;G<j;++G){var K=x[b+2*G+0],X=15&(ne=x[b+2*G+1]),te=4369*X,ne=(240&ne|ne>>4)*te>>16;x[b+2*G+0]=(240&K|K>>4)*te>>16&240|(15&K|K<<4)*te>>16>>4&15,x[b+2*G+1]=240&ne|X}b+=W}}function Ga(x,b,j,P,W,G,K,X){var te,ne,ve=255;for(ne=0;ne<W;++ne){for(te=0;te<P;++te){var Te=x[b+te];G[K+4*te]=Te,ve&=Te}b+=j,K+=X}return ve!=255}function ys(x,b,j,P,W){var G;for(G=0;G<W;++G)j[P+G]=x[b+G]>>8}function Ai(){$c=Ca,Tx=Aa,Ex=Ga,Cx=ys}function bs(x,b,j){D[x]=function(P,W,G,K,X,te,ne,ve,Te,ie,ye,_e,Ie,je,Le,Re,Ve){var We,wt=Ve-1>>1,ct=X[te+0]|ne[ve+0]<<16,Jt=Te[ie+0]|ye[_e+0]<<16;t(P!=null);var mt=3*ct+Jt+131074>>2;for(b(P[W+0],255&mt,mt>>16,Ie,je),G!=null&&(mt=3*Jt+ct+131074>>2,b(G[K+0],255&mt,mt>>16,Le,Re)),We=1;We<=wt;++We){var cr=X[te+We]|ne[ve+We]<<16,Da=Te[ie+We]|ye[_e+We]<<16,Zt=ct+cr+Jt+Da+524296,xt=Zt+2*(cr+Jt)>>3;mt=xt+ct>>1,ct=(Zt=Zt+2*(ct+Da)>>3)+cr>>1,b(P[W+2*We-1],255&mt,mt>>16,Ie,je+(2*We-1)*j),b(P[W+2*We-0],255&ct,ct>>16,Ie,je+(2*We-0)*j),G!=null&&(mt=Zt+Jt>>1,ct=xt+Da>>1,b(G[K+2*We-1],255&mt,mt>>16,Le,Re+(2*We-1)*j),b(G[K+2*We+0],255&ct,ct>>16,Le,Re+(2*We+0)*j)),ct=cr,Jt=Da}1&Ve||(mt=3*ct+Jt+131074>>2,b(P[W+Ve-1],255&mt,mt>>16,Ie,je+(Ve-1)*j),G!=null&&(mt=3*Jt+ct+131074>>2,b(G[K+Ve-1],255&mt,mt>>16,Le,Re+(Ve-1)*j)))}}function Lc(){oi[ju]=$_,oi[Tu]=Ux,oi[Rx]=V_,oi[Eu]=Wx,oi[Cu]=qx,oi[hh]=Hx,oi[Ox]=G_,oi[ph]=Ux,oi[mh]=Wx,oi[Fu]=qx,oi[xh]=Hx}function Cl(x){return x&-16384?0>x?0:255:x>>K_}function qs(x,b){return Cl((19077*x>>8)+(26149*b>>8)-14234)}function Po(x,b,j){return Cl((19077*x>>8)-(6419*b>>8)-(13320*j>>8)+8708)}function Ro(x,b){return Cl((19077*x>>8)+(33050*b>>8)-17685)}function Hs(x,b,j,P,W){P[W+0]=qs(x,j),P[W+1]=Po(x,b,j),P[W+2]=Ro(x,b)}function Ka(x,b,j,P,W){P[W+0]=Ro(x,b),P[W+1]=Po(x,b,j),P[W+2]=qs(x,j)}function Oo(x,b,j,P,W){var G=Po(x,b,j);b=G<<3&224|Ro(x,b)>>3,P[W+0]=248&qs(x,j)|G>>5,P[W+1]=b}function Bo(x,b,j,P,W){var G=240&Ro(x,b)|15;P[W+0]=240&qs(x,j)|Po(x,b,j)>>4,P[W+1]=G}function Pc(x,b,j,P,W){P[W+0]=255,Hs(x,b,j,P,W+1)}function Rc(x,b,j,P,W){Ka(x,b,j,P,W),P[W+3]=255}function bn(x,b,j,P,W){Hs(x,b,j,P,W),P[W+3]=255}function ws(x,b,j){D[x]=function(P,W,G,K,X,te,ne,ve,Te){for(var ie=ve+(-2&Te)*j;ve!=ie;)b(P[W+0],G[K+0],X[te+0],ne,ve),b(P[W+1],G[K+0],X[te+0],ne,ve+j),W+=2,++K,++te,ve+=2*j;1&Te&&b(P[W+0],G[K+0],X[te+0],ne,ve)}}function Fl(x,b,j){return j==0?x==0?b==0?6:5:b==0?4:0:j}function ku(x,b,j,P,W){switch(x>>>30){case 3:Wo(b,j,P,W,0);break;case 2:ii(b,j,P,W);break;case 1:br(b,j,P,W)}}function ni(x,b){var j,P,W=b.M,G=b.Nb,K=x.oc,X=x.pc+40,te=x.oc,ne=x.pc+584,ve=x.oc,Te=x.pc+600;for(j=0;16>j;++j)K[X+32*j-1]=129;for(j=0;8>j;++j)te[ne+32*j-1]=129,ve[Te+32*j-1]=129;for(0<W?K[X-1-32]=te[ne-1-32]=ve[Te-1-32]=129:(n(K,X-32-1,127,21),n(te,ne-32-1,127,9),n(ve,Te-32-1,127,9)),P=0;P<x.za;++P){var ie=b.ya[b.aa+P];if(0<P){for(j=-1;16>j;++j)a(K,X+32*j-4,K,X+32*j+12,4);for(j=-1;8>j;++j)a(te,ne+32*j-4,te,ne+32*j+4,4),a(ve,Te+32*j-4,ve,Te+32*j+4,4)}var ye=x.Gd,_e=x.Hd+P,Ie=ie.ad,je=ie.Hc;if(0<W&&(a(K,X-32,ye[_e].y,0,16),a(te,ne-32,ye[_e].f,0,8),a(ve,Te-32,ye[_e].ea,0,8)),ie.Za){var Le=K,Re=X-32+16;for(0<W&&(P>=x.za-1?n(Le,Re,ye[_e].y[15],4):a(Le,Re,ye[_e+1].y,0,4)),j=0;4>j;j++)Le[Re+128+j]=Le[Re+256+j]=Le[Re+384+j]=Le[Re+0+j];for(j=0;16>j;++j,je<<=2)Le=K,Re=X+Vx[j],Ni[ie.Ob[j]](Le,Re),ku(je,Ie,16*+j,Le,Re)}else if(Le=Fl(P,W,ie.Ob[0]),Zs[Le](K,X),je!=0)for(j=0;16>j;++j,je<<=2)ku(je,Ie,16*+j,K,X+Vx[j]);for(j=ie.Gc,Le=Fl(P,W,ie.Dd),Ss[Le](te,ne),Ss[Le](ve,Te),je=Ie,Le=te,Re=ne,255&(ie=0|j)&&(170&ie?Gi(je,256,Le,Re):Dr(je,256,Le,Re)),ie=ve,je=Te,255&(j>>=8)&&(170&j?Gi(Ie,320,ie,je):Dr(Ie,320,ie,je)),W<x.Ub-1&&(a(ye[_e].y,0,K,X+480,16),a(ye[_e].f,0,te,ne+224,8),a(ye[_e].ea,0,ve,Te+224,8)),j=8*G*x.B,ye=x.sa,_e=x.ta+16*P+16*G*x.R,Ie=x.qa,ie=x.ra+8*P+j,je=x.Ha,Le=x.Ia+8*P+j,j=0;16>j;++j)a(ye,_e+j*x.R,K,X+32*j,16);for(j=0;8>j;++j)a(Ie,ie+j*x.B,te,ne+32*j,8),a(je,Le+j*x.B,ve,Te+32*j,8)}}function Mo(x,b,j,P,W,G,K,X,te){var ne=[0],ve=[0],Te=0,ie=te!=null?te.kd:0,ye=te??new Ue;if(x==null||12>j)return 7;ye.data=x,ye.w=b,ye.ha=j,b=[b],j=[j],ye.gb=[ye.gb];e:{var _e=b,Ie=j,je=ye.gb;if(t(x!=null),t(Ie!=null),t(je!=null),je[0]=0,12<=Ie[0]&&!r(x,_e[0],"RIFF")){if(r(x,_e[0]+8,"WEBP")){je=3;break e}var Le=$e(x,_e[0]+4);if(12>Le||4294967286<Le){je=3;break e}if(ie&&Le>Ie[0]-8){je=7;break e}je[0]=Le,_e[0]+=12,Ie[0]-=12}je=0}if(je!=0)return je;for(Le=0<ye.gb[0],j=j[0];;){e:{var Re=x;Ie=b,je=j;var Ve=ne,We=ve,wt=_e=[0];if((mt=Te=[Te])[0]=0,8>je[0])je=7;else{if(!r(Re,Ie[0],"VP8X")){if($e(Re,Ie[0]+4)!=10){je=3;break e}if(18>je[0]){je=7;break e}var ct=$e(Re,Ie[0]+8),Jt=1+Fe(Re,Ie[0]+12);if(2147483648<=Jt*(Re=1+Fe(Re,Ie[0]+15))){je=3;break e}wt!=null&&(wt[0]=ct),Ve!=null&&(Ve[0]=Jt),We!=null&&(We[0]=Re),Ie[0]+=18,je[0]-=18,mt[0]=1}je=0}}if(Te=Te[0],_e=_e[0],je!=0)return je;if(Ie=!!(2&_e),!Le&&Te)return 3;if(G!=null&&(G[0]=!!(16&_e)),K!=null&&(K[0]=Ie),X!=null&&(X[0]=0),K=ne[0],_e=ve[0],Te&&Ie&&te==null){je=0;break}if(4>j){je=7;break}if(Le&&Te||!Le&&!Te&&!r(x,b[0],"ALPH")){j=[j],ye.na=[ye.na],ye.P=[ye.P],ye.Sa=[ye.Sa];e:{ct=x,je=b,Le=j;var mt=ye.gb;Ve=ye.na,We=ye.P,wt=ye.Sa,Jt=22,t(ct!=null),t(Le!=null),Re=je[0];var cr=Le[0];for(t(Ve!=null),t(wt!=null),Ve[0]=null,We[0]=null,wt[0]=0;;){if(je[0]=Re,Le[0]=cr,8>cr){je=7;break e}var Da=$e(ct,Re+4);if(4294967286<Da){je=3;break e}var Zt=8+Da+1&-2;if(Jt+=Zt,0<mt&&Jt>mt){je=3;break e}if(!r(ct,Re,"VP8 ")||!r(ct,Re,"VP8L")){je=0;break e}if(cr[0]<Zt){je=7;break e}r(ct,Re,"ALPH")||(Ve[0]=ct,We[0]=Re+8,wt[0]=Da),Re+=Zt,cr-=Zt}}if(j=j[0],ye.na=ye.na[0],ye.P=ye.P[0],ye.Sa=ye.Sa[0],je!=0)break}j=[j],ye.Ja=[ye.Ja],ye.xa=[ye.xa];e:if(mt=x,je=b,Le=j,Ve=ye.gb[0],We=ye.Ja,wt=ye.xa,ct=je[0],Re=!r(mt,ct,"VP8 "),Jt=!r(mt,ct,"VP8L"),t(mt!=null),t(Le!=null),t(We!=null),t(wt!=null),8>Le[0])je=7;else{if(Re||Jt){if(mt=$e(mt,ct+4),12<=Ve&&mt>Ve-12){je=3;break e}if(ie&&mt>Le[0]-8){je=7;break e}We[0]=mt,je[0]+=8,Le[0]-=8,wt[0]=Jt}else wt[0]=5<=Le[0]&&mt[ct+0]==47&&!(mt[ct+4]>>5),We[0]=Le[0];je=0}if(j=j[0],ye.Ja=ye.Ja[0],ye.xa=ye.xa[0],b=b[0],je!=0)break;if(4294967286<ye.Ja)return 3;if(X==null||Ie||(X[0]=ye.xa?2:1),K=[K],_e=[_e],ye.xa){if(5>j){je=7;break}X=K,ie=_e,Ie=G,x==null||5>j?x=0:5<=j&&x[b+0]==47&&!(x[b+4]>>5)?(Le=[0],mt=[0],Ve=[0],Q(We=new R,x,b,j),_i(We,Le,mt,Ve)?(X!=null&&(X[0]=Le[0]),ie!=null&&(ie[0]=mt[0]),Ie!=null&&(Ie[0]=Ve[0]),x=1):x=0):x=0}else{if(10>j){je=7;break}X=_e,x==null||10>j||!du(x,b+3,j-3)?x=0:(ie=x[b+0]|x[b+1]<<8|x[b+2]<<16,Ie=16383&(x[b+7]<<8|x[b+6]),x=16383&(x[b+9]<<8|x[b+8]),1&ie||3<(ie>>1&7)||!(ie>>4&1)||ie>>5>=ye.Ja||!Ie||!x?x=0:(K&&(K[0]=Ie),X&&(X[0]=x),x=1))}if(!x||(K=K[0],_e=_e[0],Te&&(ne[0]!=K||ve[0]!=_e)))return 3;te!=null&&(te[0]=ye,te.offset=b-te.w,t(4294967286>b-te.w),t(te.offset==te.ha-j));break}return je==0||je==7&&Te&&te==null?(G!=null&&(G[0]|=ye.na!=null&&0<ye.na.length),P!=null&&(P[0]=K),W!=null&&(W[0]=_e),0):je}function Oc(x,b,j){var P=b.width,W=b.height,G=0,K=0,X=P,te=W;if(b.Da=x!=null&&0<x.Da,b.Da&&(X=x.cd,te=x.bd,G=x.v,K=x.j,11>j||(G&=-2,K&=-2),0>G||0>K||0>=X||0>=te||G+X>P||K+te>W))return 0;if(b.v=G,b.j=K,b.va=G+X,b.o=K+te,b.U=X,b.T=te,b.da=x!=null&&0<x.da,b.da){if(!it(X,te,j=[x.ib],G=[x.hb]))return 0;b.ib=j[0],b.hb=G[0]}return b.ob=x!=null&&x.ob,b.Kb=x==null||!x.Sd,b.da&&(b.ob=b.ib<3*P/4&&b.hb<3*W/4,b.Kb=0),1}function Bc(x){if(x==null)return 2;if(11>x.S){var b=x.f.RGBA;b.fb+=(x.height-1)*b.A,b.A=-b.A}else b=x.f.kb,x=x.height,b.O+=(x-1)*b.fa,b.fa=-b.fa,b.N+=(x-1>>1)*b.Ab,b.Ab=-b.Ab,b.W+=(x-1>>1)*b.Db,b.Db=-b.Db,b.F!=null&&(b.J+=(x-1)*b.lb,b.lb=-b.lb);return 0}function $s(x,b,j,P){if(P==null||0>=x||0>=b)return 2;if(j!=null){if(j.Da){var W=j.cd,G=j.bd,K=-2&j.v,X=-2&j.j;if(0>K||0>X||0>=W||0>=G||K+W>x||X+G>b)return 2;x=W,b=G}if(j.da){if(!it(x,b,W=[j.ib],G=[j.hb]))return 2;x=W[0],b=G[0]}}P.width=x,P.height=b;e:{var te=P.width,ne=P.height;if(x=P.S,0>=te||0>=ne||!(x>=ju&&13>x))x=2;else{if(0>=P.Rd&&P.sd==null){K=G=W=b=0;var ve=(X=te*Gx[x])*ne;if(11>x||(G=(ne+1)/2*(b=(te+1)/2),x==12&&(K=(W=te)*ne)),(ne=i(ve+2*G+K))==null){x=1;break e}P.sd=ne,11>x?((te=P.f.RGBA).eb=ne,te.fb=0,te.A=X,te.size=ve):((te=P.f.kb).y=ne,te.O=0,te.fa=X,te.Fd=ve,te.f=ne,te.N=0+ve,te.Ab=b,te.Cd=G,te.ea=ne,te.W=0+ve+G,te.Db=b,te.Ed=G,x==12&&(te.F=ne,te.J=0+ve+2*G),te.Tc=K,te.lb=W)}if(b=1,W=P.S,G=P.width,K=P.height,W>=ju&&13>W)if(11>W)x=P.f.RGBA,b&=(X=Math.abs(x.A))*(K-1)+G<=x.size,b&=X>=G*Gx[W],b&=x.eb!=null;else{x=P.f.kb,X=(G+1)/2,ve=(K+1)/2,te=Math.abs(x.fa),ne=Math.abs(x.Ab);var Te=Math.abs(x.Db),ie=Math.abs(x.lb),ye=ie*(K-1)+G;b&=te*(K-1)+G<=x.Fd,b&=ne*(ve-1)+X<=x.Cd,b=(b&=Te*(ve-1)+X<=x.Ed)&te>=G&ne>=X&Te>=X,b&=x.y!=null,b&=x.f!=null,b&=x.ea!=null,W==12&&(b&=ie>=G,b&=ye<=x.Tc,b&=x.F!=null)}else b=0;x=b?0:2}}return x!=0||j!=null&&j.fd&&(x=Bc(P)),x}var zo=64,Pn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Rn=24,Vs=32,_s=8,Gs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];at("Predictor0","PredictorAdd0"),D.Predictor0=function(){return 4278190080},D.Predictor1=function(x){return x},D.Predictor2=function(x,b,j){return b[j+0]},D.Predictor3=function(x,b,j){return b[j+1]},D.Predictor4=function(x,b,j){return b[j-1]},D.Predictor5=function(x,b,j){return ft(ft(x,b[j+1]),b[j+0])},D.Predictor6=function(x,b,j){return ft(x,b[j-1])},D.Predictor7=function(x,b,j){return ft(x,b[j+0])},D.Predictor8=function(x,b,j){return ft(b[j-1],b[j+0])},D.Predictor9=function(x,b,j){return ft(b[j+0],b[j+1])},D.Predictor10=function(x,b,j){return ft(ft(x,b[j-1]),ft(b[j+0],b[j+1]))},D.Predictor11=function(x,b,j){var P=b[j+0];return 0>=jt(P>>24&255,x>>24&255,(b=b[j-1])>>24&255)+jt(P>>16&255,x>>16&255,b>>16&255)+jt(P>>8&255,x>>8&255,b>>8&255)+jt(255&P,255&x,255&b)?P:x},D.Predictor12=function(x,b,j){var P=b[j+0];return(qt((x>>24&255)+(P>>24&255)-((b=b[j-1])>>24&255))<<24|qt((x>>16&255)+(P>>16&255)-(b>>16&255))<<16|qt((x>>8&255)+(P>>8&255)-(b>>8&255))<<8|qt((255&x)+(255&P)-(255&b)))>>>0},D.Predictor13=function(x,b,j){var P=b[j-1];return(Mt((x=ft(x,b[j+0]))>>24&255,P>>24&255)<<24|Mt(x>>16&255,P>>16&255)<<16|Mt(x>>8&255,P>>8&255)<<8|Mt(255&x,255&P))>>>0};var Mc=D.PredictorAdd0;D.PredictorAdd1=Xt,at("Predictor2","PredictorAdd2"),at("Predictor3","PredictorAdd3"),at("Predictor4","PredictorAdd4"),at("Predictor5","PredictorAdd5"),at("Predictor6","PredictorAdd6"),at("Predictor7","PredictorAdd7"),at("Predictor8","PredictorAdd8"),at("Predictor9","PredictorAdd9"),at("Predictor10","PredictorAdd10"),at("Predictor11","PredictorAdd11"),at("Predictor12","PredictorAdd12"),at("Predictor13","PredictorAdd13");var Dl=D.PredictorAdd2;et("ColorIndexInverseTransform","MapARGB","32b",function(x){return x>>8&255},function(x){return x}),et("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(x){return x},function(x){return x>>8&255});var da,Su=D.ColorIndexInverseTransform,$i=D.MapARGB,Vi=D.VP8LColorIndexInverseTransformAlpha,zc=D.MapAlpha,Uc=D.VP8LPredictorsAdd=[];Uc.length=16,(D.VP8LPredictors=[]).length=16,(D.VP8LPredictorsAdd_C=[]).length=16,(D.VP8LPredictors_C=[]).length=16;var Wc,qc,Ks,Ys,Xs,Uo,Js,Wo,ii,Gi,br,Dr,ha,Fa,ks,Hc,Il,Au,_x,kx,Sx,Ax,Nx,jx,$c,Tx,Ex,Cx,Fx=i(511),Dx=i(2041),Ix=i(225),Lx=i(767),Px=0,dh=Dx,Nu=Ix,On=Lx,si=Fx,ju=0,Tu=1,Rx=2,Eu=3,Cu=4,hh=5,Ox=6,ph=7,mh=8,Fu=9,xh=10,F_=[2,3,7],D_=[3,3,11],Bx=[280,256,256,256,40],I_=[0,1,1,1,0],L_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],P_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],R_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],O_=8,gh=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],vh=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Vc=null,B_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],M_=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Mx=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],z_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],U_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],W_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],q_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Zs=[],Ni=[],Ss=[],H_=1,zx=2,Qs=[],oi=[];bs("UpsampleRgbLinePair",Hs,3),bs("UpsampleBgrLinePair",Ka,3),bs("UpsampleRgbaLinePair",bn,4),bs("UpsampleBgraLinePair",Rc,4),bs("UpsampleArgbLinePair",Pc,4),bs("UpsampleRgba4444LinePair",Bo,2),bs("UpsampleRgb565LinePair",Oo,2);var $_=D.UpsampleRgbLinePair,V_=D.UpsampleBgrLinePair,Ux=D.UpsampleRgbaLinePair,Wx=D.UpsampleBgraLinePair,qx=D.UpsampleArgbLinePair,Hx=D.UpsampleRgba4444LinePair,G_=D.UpsampleRgb565LinePair,Du=16,Iu=1<<Du-1,Gc=-227,yh=482,K_=6,$x=0,Y_=i(256),X_=i(256),J_=i(256),Z_=i(256),Q_=i(yh-Gc),ek=i(yh-Gc);ws("YuvToRgbRow",Hs,3),ws("YuvToBgrRow",Ka,3),ws("YuvToRgbaRow",bn,4),ws("YuvToBgraRow",Rc,4),ws("YuvToArgbRow",Pc,4),ws("YuvToRgba4444Row",Bo,2),ws("YuvToRgb565Row",Oo,2);var Vx=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Lu=[0,2,8],tk=[8,7,6,4,4,2,2,2,1,1,1,1],rk=1;this.WebPDecodeRGBA=function(x,b,j,P,W){var G=Tu,K=new Pe,X=new er;K.ba=X,X.S=G,X.width=[X.width],X.height=[X.height];var te=X.width,ne=X.height,ve=new At;if(ve==null||x==null)var Te=2;else t(ve!=null),Te=Mo(x,b,j,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(Te!=0?te=0:(te!=null&&(te[0]=ve.width[0]),ne!=null&&(ne[0]=ve.height[0]),te=1),te){X.width=X.width[0],X.height=X.height[0],P!=null&&(P[0]=X.width),W!=null&&(W[0]=X.height);e:{if(P=new Al,(W=new Ue).data=x,W.w=b,W.ha=j,W.kd=1,b=[0],t(W!=null),((x=Mo(W.data,W.w,W.ha,null,null,null,b,null,W))==0||x==7)&&b[0]&&(x=4),(b=x)==0){if(t(K!=null),P.data=W.data,P.w=W.w+W.offset,P.ha=W.ha-W.offset,P.put=Ct,P.ac=ti,P.bc=wi,P.ma=K,W.xa){if((x=Ae())==null){K=1;break e}if(function(ie,ye){var _e=[0],Ie=[0],je=[0];t:for(;;){if(ie==null)return 0;if(ye==null)return ie.a=2,0;if(ie.l=ye,ie.a=0,Q(ie.m,ye.data,ye.w,ye.ha),!_i(ie.m,_e,Ie,je)){ie.a=3;break t}if(ie.xb=zx,ye.width=_e[0],ye.height=Ie[0],!Ne(_e[0],Ie[0],1,ie,null))break t;return 1}return t(ie.a!=0),0}(x,P)){if(P=(b=$s(P.width,P.height,K.Oa,K.ba))==0){t:{P=x;r:for(;;){if(P==null){P=0;break t}if(t(P.s.yc!=null),t(P.s.Ya!=null),t(0<P.s.Wb),t((j=P.l)!=null),t((W=j.ma)!=null),P.xb!=0){if(P.ca=W.ba,P.tb=W.tb,t(P.ca!=null),!Oc(W.Oa,j,Eu)){P.a=2;break r}if(!Ee(P,j.width)||j.da)break r;if((j.da||Et(P.ca.S))&&Ai(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&Ai()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!J(P.s.vb,P.s.Wa.Xa)){P.a=1;break r}P.xb=0}if(!ke(P,P.V,P.Ba,P.c,P.i,j.o,ee))break r;W.Dc=P.Ma,P=1;break t}t(P.a!=0),P=0}P=!P}P&&(b=x.a)}else b=x.a}else{if((x=new Jd)==null){K=1;break e}if(x.Fa=W.na,x.P=W.P,x.qc=W.Sa,qi(x,P)){if((b=$s(P.width,P.height,K.Oa,K.ba))==0){if(x.Aa=0,j=K.Oa,t((W=x)!=null),j!=null){if(0<(te=0>(te=j.Md)?0:100<te?255:255*te/100)){for(ne=ve=0;4>ne;++ne)12>(Te=W.pb[ne]).lc&&(Te.ia=te*tk[0>Te.lc?0:Te.lc]>>3),ve|=Te.ia;ve&&(alert("todo:VP8InitRandom"),W.ia=1)}W.Ga=j.Id,100<W.Ga?W.Ga=100:0>W.Ga&&(W.Ga=0)}(function(ie,ye){if(ie==null)return 0;if(ye==null)return ka(ie,2,"NULL VP8Io parameter in VP8Decode().");if(!ie.cb&&!qi(ie,ye))return 0;if(t(ie.cb),ye.ac==null||ye.ac(ye)){ye.ob&&(ie.L=0);var _e=Lu[ie.L];if(ie.L==2?(ie.yb=0,ie.zb=0):(ie.yb=ye.v-_e>>4,ie.zb=ye.j-_e>>4,0>ie.yb&&(ie.yb=0),0>ie.zb&&(ie.zb=0)),ie.Va=ye.o+15+_e>>4,ie.Hb=ye.va+15+_e>>4,ie.Hb>ie.za&&(ie.Hb=ie.za),ie.Va>ie.Ub&&(ie.Va=ie.Ub),0<ie.L){var Ie=ie.ed;for(_e=0;4>_e;++_e){var je;if(ie.Qa.Cb){var Le=ie.Qa.Lb[_e];ie.Qa.Fb||(Le+=Ie.Tb)}else Le=Ie.Tb;for(je=0;1>=je;++je){var Re=ie.gd[_e][je],Ve=Le;if(Ie.Pc&&(Ve+=Ie.vd[0],je&&(Ve+=Ie.od[0])),0<(Ve=0>Ve?0:63<Ve?63:Ve)){var We=Ve;0<Ie.wb&&(We=4<Ie.wb?We>>2:We>>1)>9-Ie.wb&&(We=9-Ie.wb),1>We&&(We=1),Re.dd=We,Re.tc=2*Ve+We,Re.ld=40<=Ve?2:15<=Ve?1:0}else Re.tc=0;Re.La=je}}}_e=0}else ka(ie,6,"Frame setup failed"),_e=ie.a;if(_e=_e==0){if(_e){ie.$c=0,0<ie.Aa||(ie.Ic=rk);t:{_e=ie.Ic,Ie=4*(We=ie.za);var wt=32*We,ct=We+1,Jt=0<ie.L?We*(0<ie.Aa?2:1):0,mt=(ie.Aa==2?2:1)*We;if((Re=Ie+832+(je=3*(16*_e+Lu[ie.L])/2*wt)+(Le=ie.Fa!=null&&0<ie.Fa.length?ie.Kc.c*ie.Kc.i:0))!=Re)_e=0;else{if(Re>ie.Vb){if(ie.Vb=0,ie.Ec=i(Re),ie.Fc=0,ie.Ec==null){_e=ka(ie,1,"no memory during frame initialization.");break t}ie.Vb=Re}Re=ie.Ec,Ve=ie.Fc,ie.Ac=Re,ie.Bc=Ve,Ve+=Ie,ie.Gd=o(wt,ri),ie.Hd=0,ie.rb=o(ct+1,ra),ie.sb=1,ie.wa=Jt?o(Jt,sr):null,ie.Y=0,ie.D.Nb=0,ie.D.wa=ie.wa,ie.D.Y=ie.Y,0<ie.Aa&&(ie.D.Y+=We),t(!0),ie.oc=Re,ie.pc=Ve,Ve+=832,ie.ya=o(mt,ki),ie.aa=0,ie.D.ya=ie.ya,ie.D.aa=ie.aa,ie.Aa==2&&(ie.D.aa+=We),ie.R=16*We,ie.B=8*We,We=(wt=Lu[ie.L])*ie.R,wt=wt/2*ie.B,ie.sa=Re,ie.ta=Ve+We,ie.qa=ie.sa,ie.ra=ie.ta+16*_e*ie.R+wt,ie.Ha=ie.qa,ie.Ia=ie.ra+8*_e*ie.B+wt,ie.$c=0,Ve+=je,ie.mb=Le?Re:null,ie.nb=Le?Ve:null,t(Ve+Le<=ie.Fc+ie.Vb),hu(ie),n(ie.Ac,ie.Bc,0,Ie),_e=1}}if(_e){if(ye.ka=0,ye.y=ie.sa,ye.O=ie.ta,ye.f=ie.qa,ye.N=ie.ra,ye.ea=ie.Ha,ye.Vd=ie.Ia,ye.fa=ie.R,ye.Rc=ie.B,ye.F=null,ye.J=0,!Px){for(_e=-255;255>=_e;++_e)Fx[255+_e]=0>_e?-_e:_e;for(_e=-1020;1020>=_e;++_e)Dx[1020+_e]=-128>_e?-128:127<_e?127:_e;for(_e=-112;112>=_e;++_e)Ix[112+_e]=-16>_e?-16:15<_e?15:_e;for(_e=-255;510>=_e;++_e)Lx[255+_e]=0>_e?0:255<_e?255:_e;Px=1}Js=jl,Wo=Qd,Gi=Hi,br=mu,Dr=xu,ii=Zd,ha=wu,Fa=Lo,ks=U,Hc=le,Il=_u,Au=S,_x=ge,kx=be,Sx=Io,Ax=Ic,Nx=yu,jx=bu,Ni[0]=oh,Ni[1]=eh,Ni[2]=ih,Ni[3]=sh,Ni[4]=hs,Ni[5]=lh,Ni[6]=ps,Ni[7]=ch,Ni[8]=Tc,Ni[9]=Tl,Zs[0]=ah,Zs[1]=rh,Zs[2]=Nc,Zs[3]=gu,Zs[4]=Fo,Zs[5]=jc,Zs[6]=nh,Ss[0]=fh,Ss[1]=th,Ss[2]=Do,Ss[3]=uh,Ss[4]=Cc,Ss[5]=Ec,Ss[6]=vu,_e=1}else _e=0}_e&&(_e=function(cr,Da){for(cr.M=0;cr.M<cr.Va;++cr.M){var Zt,xt=cr.Jc[cr.M&cr.Xb],tt=cr.m,pa=cr;for(Zt=0;Zt<pa.za;++Zt){var Vt=tt,dr=pa,Wr=dr.Ac,Ya=dr.Bc+4*Zt,wn=dr.zc,aa=dr.ya[dr.aa+Zt];if(dr.Qa.Bb?aa.$b=xe(Vt,dr.Pa.jb[0])?2+xe(Vt,dr.Pa.jb[2]):xe(Vt,dr.Pa.jb[1]):aa.$b=0,dr.kc&&(aa.Ad=xe(Vt,dr.Bd)),aa.Za=!xe(Vt,145)+0,aa.Za){var nn=aa.Ob,_n=0;for(dr=0;4>dr;++dr){var Ia,xr=wn[0+dr];for(Ia=0;4>Ia;++Ia){xr=U_[Wr[Ya+Ia]][xr];for(var _r=Mx[xe(Vt,xr[0])];0<_r;)_r=Mx[2*_r+xe(Vt,xr[_r])];xr=-_r,Wr[Ya+Ia]=xr}a(nn,_n,Wr,Ya,4),_n+=4,wn[0+dr]=xr}}else xr=xe(Vt,156)?xe(Vt,128)?1:3:xe(Vt,163)?2:0,aa.Ob[0]=xr,n(Wr,Ya,xr,4),n(wn,0,xr,4);aa.Dd=xe(Vt,142)?xe(Vt,114)?xe(Vt,183)?1:3:2:0}if(pa.m.Ka)return ka(cr,7,"Premature end-of-partition0 encountered.");for(;cr.ja<cr.za;++cr.ja){if(pa=xt,Vt=(tt=cr).rb[tt.sb-1],Wr=tt.rb[tt.sb+tt.ja],Zt=tt.ya[tt.aa+tt.ja],Ya=tt.kc?Zt.Ad:0)Vt.la=Wr.la=0,Zt.Za||(Vt.Na=Wr.Na=0),Zt.Hc=0,Zt.Gc=0,Zt.ia=0;else{var na,kr;if(Vt=Wr,Wr=pa,Ya=tt.Pa.Xc,wn=tt.ya[tt.aa+tt.ja],aa=tt.pb[wn.$b],dr=wn.ad,nn=0,_n=tt.rb[tt.sb-1],xr=Ia=0,n(dr,nn,0,384),wn.Za)var Xa=0,ji=Ya[3];else{_r=i(16);var ma=Vt.Na+_n.Na;if(ma=Vc(Wr,Ya[1],ma,aa.Eb,0,_r,0),Vt.Na=_n.Na=(0<ma)+0,1<ma)Js(_r,0,dr,nn);else{var En=_r[0]+3>>3;for(_r=0;256>_r;_r+=16)dr[nn+_r]=En}Xa=1,ji=Ya[0]}var Ir=15&Vt.la,La=15&_n.la;for(_r=0;4>_r;++_r){var Bn=1&La;for(En=kr=0;4>En;++En)Ir=Ir>>1|(Bn=(ma=Vc(Wr,ji,ma=Bn+(1&Ir),aa.Sc,Xa,dr,nn))>Xa)<<7,kr=kr<<2|(3<ma?3:1<ma?2:dr[nn+0]!=0),nn+=16;Ir>>=4,La=La>>1|Bn<<7,Ia=(Ia<<8|kr)>>>0}for(ji=Ir,Xa=La>>4,na=0;4>na;na+=2){for(kr=0,Ir=Vt.la>>4+na,La=_n.la>>4+na,_r=0;2>_r;++_r){for(Bn=1&La,En=0;2>En;++En)ma=Bn+(1&Ir),Ir=Ir>>1|(Bn=0<(ma=Vc(Wr,Ya[2],ma,aa.Qc,0,dr,nn)))<<3,kr=kr<<2|(3<ma?3:1<ma?2:dr[nn+0]!=0),nn+=16;Ir>>=2,La=La>>1|Bn<<5}xr|=kr<<4*na,ji|=Ir<<4<<na,Xa|=(240&La)<<na}Vt.la=ji,_n.la=Xa,wn.Hc=Ia,wn.Gc=xr,wn.ia=43690&xr?0:aa.ia,Ya=!(Ia|xr)}if(0<tt.L&&(tt.wa[tt.Y+tt.ja]=tt.gd[Zt.$b][Zt.Za],tt.wa[tt.Y+tt.ja].La|=!Ya),pa.Ka)return ka(cr,7,"Premature end-of-file encountered.")}if(hu(cr),tt=Da,pa=1,Zt=(xt=cr).D,Vt=0<xt.L&&xt.M>=xt.zb&&xt.M<=xt.Va,xt.Aa==0)t:{if(Zt.M=xt.M,Zt.uc=Vt,ni(xt,Zt),pa=1,Zt=(kr=xt.D).Nb,Vt=(xr=Lu[xt.L])*xt.R,Wr=xr/2*xt.B,_r=16*Zt*xt.R,En=8*Zt*xt.B,Ya=xt.sa,wn=xt.ta-Vt+_r,aa=xt.qa,dr=xt.ra-Wr+En,nn=xt.Ha,_n=xt.Ia-Wr+En,La=(Ir=kr.M)==0,Ia=Ir>=xt.Va-1,xt.Aa==2&&ni(xt,kr),kr.uc)for(Bn=(ma=xt).D.M,t(ma.D.uc),kr=ma.yb;kr<ma.Hb;++kr){Xa=kr,ji=Bn;var kn=(Mn=(Ja=ma).D).Nb;na=Ja.R;var Mn=Mn.wa[Mn.Y+Xa],zn=Ja.sa,Cn=Ja.ta+16*kn*na+16*Xa,Un=Mn.dd,Ur=Mn.tc;if(Ur!=0)if(t(3<=Ur),Ja.L==1)0<Xa&&Ax(zn,Cn,na,Ur+4),Mn.La&&jx(zn,Cn,na,Ur),0<ji&&Sx(zn,Cn,na,Ur+4),Mn.La&&Nx(zn,Cn,na,Ur);else{var Wn=Ja.B,Ti=Ja.qa,qo=Ja.ra+8*kn*Wn+8*Xa,As=Ja.Ha,Ja=Ja.Ia+8*kn*Wn+8*Xa;kn=Mn.ld,0<Xa&&(Fa(zn,Cn,na,Ur+4,Un,kn),Hc(Ti,qo,As,Ja,Wn,Ur+4,Un,kn)),Mn.La&&(Au(zn,Cn,na,Ur,Un,kn),kx(Ti,qo,As,Ja,Wn,Ur,Un,kn)),0<ji&&(ha(zn,Cn,na,Ur+4,Un,kn),ks(Ti,qo,As,Ja,Wn,Ur+4,Un,kn)),Mn.La&&(Il(zn,Cn,na,Ur,Un,kn),_x(Ti,qo,As,Ja,Wn,Ur,Un,kn))}}if(xt.ia&&alert("todo:DitherRow"),tt.put!=null){if(kr=16*Ir,Ir=16*(Ir+1),La?(tt.y=xt.sa,tt.O=xt.ta+_r,tt.f=xt.qa,tt.N=xt.ra+En,tt.ea=xt.Ha,tt.W=xt.Ia+En):(kr-=xr,tt.y=Ya,tt.O=wn,tt.f=aa,tt.N=dr,tt.ea=nn,tt.W=_n),Ia||(Ir-=xr),Ir>tt.o&&(Ir=tt.o),tt.F=null,tt.J=null,xt.Fa!=null&&0<xt.Fa.length&&kr<Ir&&(tt.J=zr(xt,tt,kr,Ir-kr),tt.F=xt.mb,tt.F==null&&tt.F.length==0)){pa=ka(xt,3,"Could not decode alpha data.");break t}kr<tt.j&&(xr=tt.j-kr,kr=tt.j,t(!(1&xr)),tt.O+=xt.R*xr,tt.N+=xt.B*(xr>>1),tt.W+=xt.B*(xr>>1),tt.F!=null&&(tt.J+=tt.width*xr)),kr<Ir&&(tt.O+=tt.v,tt.N+=tt.v>>1,tt.W+=tt.v>>1,tt.F!=null&&(tt.J+=tt.v),tt.ka=kr-tt.j,tt.U=tt.va-tt.v,tt.T=Ir-kr,pa=tt.put(tt))}Zt+1!=xt.Ic||Ia||(a(xt.sa,xt.ta-Vt,Ya,wn+16*xt.R,Vt),a(xt.qa,xt.ra-Wr,aa,dr+8*xt.B,Wr),a(xt.Ha,xt.Ia-Wr,nn,_n+8*xt.B,Wr))}if(!pa)return ka(cr,6,"Output aborted.")}return 1}(ie,ye)),ye.bc!=null&&ye.bc(ye),_e&=1}return _e?(ie.cb=0,_e):0})(x,P)||(b=x.a)}}else b=x.a}b==0&&K.Oa!=null&&K.Oa.fd&&(b=Bc(K.ba))}K=b}G=K!=0?null:11>G?X.f.RGBA.eb:X.f.kb.y}else G=null;return G};var Gx=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(D,B){for(var L="",F=0;F<4;F++)L+=String.fromCharCode(D[B++]);return L}function f(D,B){return D[B+0]|D[B+1]<<8}function h(D,B){return(D[B+0]|D[B+1]<<8|D[B+2]<<16)>>>0}function p(D,B){return(D[B+0]|D[B+1]<<8|D[B+2]<<16|D[B+3]<<24)>>>0}new c;var d=[0],v=[0],m=[],y=new c,_=e,k=function(D,B){var L={},F=0,z=!1,M=0,q=0;if(L.frames=[],!function(T,R){for(var N=0;N<4;N++)if(T[R+N]!="RIFF".charCodeAt(N))return!0;return!1}(D,B)){for(p(D,B+=4),B+=8;B<D.length;){var fe=u(D,B),he=p(D,B+=4);B+=4;var pe=he+(1&he);switch(fe){case"VP8 ":case"VP8L":L.frames[F]===void 0&&(L.frames[F]={}),(Y=L.frames[F]).src_off=z?q:B-8,Y.src_size=M+he+8,F++,z&&(z=!1,M=0,q=0);break;case"VP8X":(Y=L.header={}).feature_flags=D[B];var Q=B+4;Y.canvas_width=1+h(D,Q),Q+=3,Y.canvas_height=1+h(D,Q),Q+=3;break;case"ALPH":z=!0,M=pe+8,q=B-8;break;case"ANIM":(Y=L.header).bgcolor=p(D,B),Q=B+4,Y.loop_count=f(D,Q),Q+=2;break;case"ANMF":var we,Y;(Y=L.frames[F]={}).offset_x=2*h(D,B),B+=3,Y.offset_y=2*h(D,B),B+=3,Y.width=1+h(D,B),B+=3,Y.height=1+h(D,B),B+=3,Y.duration=h(D,B),B+=3,we=D[B++],Y.dispose=1&we,Y.blend=we>>1&1}fe!="ANMF"&&(B+=pe)}return L}}(_,0);k.response=_,k.rgbaoutput=!0,k.dataurl=!1;var g=k.header?k.header:null,w=k.frames?k.frames:null;if(g){g.loop_counter=g.loop_count,d=[g.canvas_height],v=[g.canvas_width];for(var C=0;C<w.length&&w[C].blend!=0;C++);}var E=w[0],A=y.WebPDecodeRGBA(_,E.src_off,E.src_size,v,d);E.rgba=A,E.imgwidth=v[0],E.imgheight=d[0];for(var I=0;I<v[0]*d[0]*4;I++)m[I]=A[I];return this.width=v,this.height=d,this.data=m,this}(function(e){var t,r,a,n,i,o,l,c,u,f=function(T){return T=T||{},this.isStrokeTransparent=T.isStrokeTransparent||!1,this.strokeOpacity=T.strokeOpacity||1,this.strokeStyle=T.strokeStyle||"#000000",this.fillStyle=T.fillStyle||"#000000",this.isFillTransparent=T.isFillTransparent||!1,this.fillOpacity=T.fillOpacity||1,this.font=T.font||"10px sans-serif",this.textBaseline=T.textBaseline||"alphabetic",this.textAlign=T.textAlign||"left",this.lineWidth=T.lineWidth||1,this.lineJoin=T.lineJoin||"miter",this.lineCap=T.lineCap||"butt",this.path=T.path||[],this.transform=T.transform!==void 0?T.transform.clone():new c,this.globalCompositeOperation=T.globalCompositeOperation||"normal",this.globalAlpha=T.globalAlpha||1,this.clip_path=T.clip_path||[],this.currentPoint=T.currentPoint||new o,this.miterLimit=T.miterLimit||10,this.lastPoint=T.lastPoint||new o,this.lineDashOffset=T.lineDashOffset||0,this.lineDash=T.lineDash||[],this.margin=T.margin||[0,0,0,0],this.prevPageLastElemOffset=T.prevPageLastElemOffset||0,this.ignoreClearRect=typeof T.ignoreClearRect!="boolean"||T.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var h=function(T){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=T;Object.defineProperty(this,"pdf",{get:function(){return R}});var N=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return N},set:function(J){N=!!J}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(J){O=!!J}});var H=0;Object.defineProperty(this,"posX",{get:function(){return H},set:function(J){isNaN(J)||(H=J)}});var ae=0;Object.defineProperty(this,"posY",{get:function(){return ae},set:function(J){isNaN(J)||(ae=J)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(J){var Oe;typeof J=="number"?Oe=[J,J,J,J]:((Oe=new Array(4))[0]=J[0],Oe[1]=J.length>=2?J[1]:Oe[0],Oe[2]=J.length>=3?J[2]:Oe[0],Oe[3]=J.length>=4?J[3]:Oe[1]),u.margin=Oe}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(J){de=J}});var me=0;Object.defineProperty(this,"lastBreak",{get:function(){return me},set:function(J){me=J}});var xe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return xe},set:function(J){xe=J}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(J){J instanceof f&&(u=J)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(J){u.path=J}});var Se=[];Object.defineProperty(this,"ctxStack",{get:function(){return Se},set:function(J){Se=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var Oe;Oe=p(J),this.ctx.fillStyle=Oe.style,this.ctx.isFillTransparent=Oe.a===0,this.ctx.fillOpacity=Oe.a,this.pdf.setFillColor(Oe.r,Oe.g,Oe.b,{a:Oe.a}),this.pdf.setTextColor(Oe.r,Oe.g,Oe.b,{a:Oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var Oe=p(J);this.ctx.strokeStyle=Oe.style,this.ctx.isStrokeTransparent=Oe.a===0,this.ctx.strokeOpacity=Oe.a,Oe.a===0?this.pdf.setDrawColor(255,255,255):(Oe.a,this.pdf.setDrawColor(Oe.r,Oe.g,Oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var Z=null,Fe=null,$e=null;Object.defineProperty(this,"fontFaces",{get:function(){return $e},set:function(J){Z=null,Fe=null,$e=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var Oe;if(this.ctx.font=J,(Oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var Be=Oe[1];Oe[2];var it=Oe[3],Me=Oe[4];Oe[5];var pt=Oe[6],at=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Me)[2];Me=Math.floor(at==="px"?parseFloat(Me)*this.pdf.internal.scaleFactor:at==="em"?parseFloat(Me)*this.pdf.getFontSize():parseFloat(Me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Me);var bt=function(et){var fr,Nt,Ot=[],Gt=et.trim();if(Gt==="")return wp;if(Gt in $v)return[$v[Gt]];for(;Gt!=="";){switch(Nt=null,fr=(Gt=Gv(Gt)).charAt(0)){case'"':case"'":Nt=JR(Gt.substring(1),fr);break;default:Nt=ZR(Gt)}if(Nt===null||(Ot.push(Nt[0]),(Gt=Gv(Nt[1]))!==""&&Gt.charAt(0)!==","))return wp;Gt=Gt.replace(/^,/,"")}return Ot}(pt);if(this.fontFaces){var ft=function(et,fr){var Nt=et.getFontList(),Ot=JSON.stringify(Nt);if(Z===null||Fe!==Ot){var Gt=function(Br){var St=[];return Object.keys(Br).forEach(function(wr){Br[wr].forEach(function(Et){var zt=null;switch(Et){case"bold":zt={family:wr,weight:"bold"};break;case"italic":zt={family:wr,style:"italic"};break;case"bolditalic":zt={family:wr,weight:"bold",style:"italic"};break;case"":case"normal":zt={family:wr}}zt!==null&&(zt.ref={name:wr,style:Et},St.push(zt))})}),St}(Nt);Z=function(Br){for(var St={},wr=0;wr<Br.length;++wr){var Et=bp(Br[wr]),zt=Et.family,Mr=Et.stretch,er=Et.style,At=Et.weight;St[zt]=St[zt]||{},St[zt][Mr]=St[zt][Mr]||{},St[zt][Mr][er]=St[zt][Mr][er]||{},St[zt][Mr][er][At]=Et}return St}(Gt.concat(fr)),Fe=Ot}return Z}(this.pdf,this.fontFaces),qt=bt.map(function(et){return{family:et,stretch:"normal",weight:it,style:Be}}),Mt=function(et,fr,Nt){for(var Ot=(Nt=Nt||{}).defaultFontFamily||"times",Gt=Object.assign({},XR,Nt.genericFontFamilies||{}),Br=null,St=null,wr=0;wr<fr.length;++wr)if(Gt[(Br=bp(fr[wr])).family]&&(Br.family=Gt[Br.family]),et.hasOwnProperty(Br.family)){St=et[Br.family];break}if(!(St=St||et[Ot]))throw new Error("Could not find a font-family for the rule '"+Vv(Br)+"' and default family '"+Ot+"'.");if(St=function(Et,zt){if(zt[Et])return zt[Et];var Mr=p1[Et],er=Mr<=p1.normal?-1:1,At=Hv(zt,i_,Mr,er);if(!At)throw new Error("Could not find a matching font-stretch value for "+Et);return At}(Br.stretch,St),St=function(Et,zt){if(zt[Et])return zt[Et];for(var Mr=n_[Et],er=0;er<Mr.length;++er)if(zt[Mr[er]])return zt[Mr[er]];throw new Error("Could not find a matching font-style for "+Et)}(Br.style,St),!(St=function(Et,zt){if(zt[Et])return zt[Et];if(Et===400&&zt[500])return zt[500];if(Et===500&&zt[400])return zt[400];var Mr=YR[Et],er=Hv(zt,s_,Mr,Et<400?-1:1);if(!er)throw new Error("Could not find a matching font-weight for value "+Et);return er}(Br.weight,St)))throw new Error("Failed to resolve a font for the rule '"+Vv(Br)+"'.");return St}(ft,qt);this.pdf.setFont(Mt.ref.name,Mt.ref.style)}else{var jt="";(it==="bold"||parseInt(it,10)>=700||Be==="bold")&&(jt="bold"),Be==="italic"&&(jt+="italic"),jt.length===0&&(jt="normal");for(var Xt="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},st=0;st<bt.length;st++){if(this.pdf.internal.getFont(bt[st],jt,{noFallback:!0,disableWarning:!0})!==void 0){Xt=bt[st];break}if(jt==="bolditalic"&&this.pdf.internal.getFont(bt[st],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Xt=bt[st],jt="bold";else if(this.pdf.internal.getFont(bt[st],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Xt=bt[st],jt="normal";break}}if(Xt===""){for(var Qe=0;Qe<bt.length;Qe++)if(Tt[bt[Qe]]){Xt=Tt[bt[Qe]];break}}Xt=Xt===""?"Times":Xt,this.pdf.setFont(Xt,jt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,Y.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,Y.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};h.prototype.setLineDash=function(T){this.lineDash=T},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){w.call(this,"fill",!1)},h.prototype.stroke=function(){w.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(T,R){if(isNaN(T)||isNaN(R))throw Lr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var N=this.ctx.transform.applyToPoint(new o(T,R));this.path.push({type:"mt",x:N.x,y:N.y}),this.ctx.lastPoint=new o(T,R)},h.prototype.closePath=function(){var T=new o(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&jr(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){T=new o(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(T.x,T.y)},h.prototype.lineTo=function(T,R){if(isNaN(T)||isNaN(R))throw Lr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var N=this.ctx.transform.applyToPoint(new o(T,R));this.path.push({type:"lt",x:N.x,y:N.y}),this.ctx.lastPoint=new o(N.x,N.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},h.prototype.quadraticCurveTo=function(T,R,N,O){if(isNaN(N)||isNaN(O)||isNaN(T)||isNaN(R))throw Lr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var H=this.ctx.transform.applyToPoint(new o(N,O)),ae=this.ctx.transform.applyToPoint(new o(T,R));this.path.push({type:"qct",x1:ae.x,y1:ae.y,x:H.x,y:H.y}),this.ctx.lastPoint=new o(H.x,H.y)},h.prototype.bezierCurveTo=function(T,R,N,O,H,ae){if(isNaN(H)||isNaN(ae)||isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O))throw Lr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new o(H,ae)),me=this.ctx.transform.applyToPoint(new o(T,R)),xe=this.ctx.transform.applyToPoint(new o(N,O));this.path.push({type:"bct",x1:me.x,y1:me.y,x2:xe.x,y2:xe.y,x:de.x,y:de.y}),this.ctx.lastPoint=new o(de.x,de.y)},h.prototype.arc=function(T,R,N,O,H,ae){if(isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O)||isNaN(H))throw Lr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ae=!!ae,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new o(T,R));T=de.x,R=de.y;var me=this.ctx.transform.applyToPoint(new o(0,N)),xe=this.ctx.transform.applyToPoint(new o(0,0));N=Math.sqrt(Math.pow(me.x-xe.x,2)+Math.pow(me.y-xe.y,2))}Math.abs(H-O)>=2*Math.PI&&(O=0,H=2*Math.PI),this.path.push({type:"arc",x:T,y:R,radius:N,startAngle:O,endAngle:H,counterclockwise:ae})},h.prototype.arcTo=function(T,R,N,O,H){throw new Error("arcTo not implemented.")},h.prototype.rect=function(T,R,N,O){if(isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O))throw Lr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(T,R),this.lineTo(T+N,R),this.lineTo(T+N,R+O),this.lineTo(T,R+O),this.lineTo(T,R),this.lineTo(T+N,R),this.lineTo(T,R)},h.prototype.fillRect=function(T,R,N,O){if(isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O))throw Lr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var H={};this.lineCap!=="butt"&&(H.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(H.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(T,R,N,O),this.fill(),H.hasOwnProperty("lineCap")&&(this.lineCap=H.lineCap),H.hasOwnProperty("lineJoin")&&(this.lineJoin=H.lineJoin)}},h.prototype.strokeRect=function(T,R,N,O){if(isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O))throw Lr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(T,R,N,O),this.stroke())},h.prototype.clearRect=function(T,R,N,O){if(isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O))throw Lr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(T,R,N,O))},h.prototype.save=function(T){T=typeof T!="boolean"||T;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),T){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},h.prototype.restore=function(T){T=typeof T!="boolean"||T;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("Q");this.pdf.setPage(R),T&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(T){var R,N,O,H;if(T.isCanvasGradient===!0&&(T=T.getColor()),!T)return{r:0,g:0,b:0,a:0,style:T};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(T))R=0,N=0,O=0,H=0;else{var ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(T);if(ae!==null)R=parseInt(ae[1]),N=parseInt(ae[2]),O=parseInt(ae[3]),H=1;else if((ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(T))!==null)R=parseInt(ae[1]),N=parseInt(ae[2]),O=parseInt(ae[3]),H=parseFloat(ae[4]);else{if(H=1,typeof T=="string"&&T.charAt(0)!=="#"){var de=new J4(T);T=de.ok?de.toHex():"#000000"}T.length===4?(R=T.substring(1,2),R+=R,N=T.substring(2,3),N+=N,O=T.substring(3,4),O+=O):(R=T.substring(1,3),N=T.substring(3,5),O=T.substring(5,7)),R=parseInt(R,16),N=parseInt(N,16),O=parseInt(O,16)}}return{r:R,g:N,b:O,a:H,style:T}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(T,R,N,O){if(isNaN(R)||isNaN(N)||typeof T!="string")throw Lr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!d.call(this)){var H=pe(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;F.call(this,{text:T,x:R,y:N,scale:ae,angle:H,align:this.textAlign,maxWidth:O})}},h.prototype.strokeText=function(T,R,N,O){if(isNaN(R)||isNaN(N)||typeof T!="string")throw Lr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){O=isNaN(O)?void 0:O;var H=pe(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;F.call(this,{text:T,x:R,y:N,scale:ae,renderingMode:"stroke",angle:H,align:this.textAlign,maxWidth:O})}},h.prototype.measureText=function(T){if(typeof T!="string")throw Lr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,N=this.pdf.internal.scaleFactor,O=R.internal.getFontSize(),H=R.getStringUnitWidth(T)*O/R.internal.scaleFactor;return new function(ae){var de=(ae=ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this}({width:H*=Math.round(96*N/72*1e4)/1e4})},h.prototype.scale=function(T,R){if(isNaN(T)||isNaN(R))throw Lr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var N=new c(T,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(N)},h.prototype.rotate=function(T){if(isNaN(T))throw Lr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new c(Math.cos(T),Math.sin(T),-Math.sin(T),Math.cos(T),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},h.prototype.translate=function(T,R){if(isNaN(T)||isNaN(R))throw Lr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var N=new c(1,0,0,1,T,R);this.ctx.transform=this.ctx.transform.multiply(N)},h.prototype.transform=function(T,R,N,O,H,ae){if(isNaN(T)||isNaN(R)||isNaN(N)||isNaN(O)||isNaN(H)||isNaN(ae))throw Lr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new c(T,R,N,O,H,ae);this.ctx.transform=this.ctx.transform.multiply(de)},h.prototype.setTransform=function(T,R,N,O,H,ae){T=isNaN(T)?1:T,R=isNaN(R)?0:R,N=isNaN(N)?0:N,O=isNaN(O)?1:O,H=isNaN(H)?0:H,ae=isNaN(ae)?0:ae,this.ctx.transform=new c(T,R,N,O,H,ae)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(T,R,N,O,H,ae,de,me,xe){var Se=this.pdf.getImageProperties(T),Z=1,Fe=1,$e=1,J=1;O!==void 0&&me!==void 0&&($e=me/O,J=xe/H,Z=Se.width/O*me/O,Fe=Se.height/H*xe/H),ae===void 0&&(ae=R,de=N,R=0,N=0),O!==void 0&&me===void 0&&(me=O,xe=H),O===void 0&&me===void 0&&(me=Se.width,xe=Se.height);var Oe=this.ctx.transform.decompose(),Be=pe(Oe.rotate.shx),it=new c,Me=(it=(it=(it=it.multiply(Oe.translate)).multiply(Oe.skew)).multiply(Oe.scale)).applyToRectangle(new l(ae-R*$e,de-N*J,O*Z,H*Fe));if(this.autoPaging){for(var pt,at=y.call(this,Me),bt=[],ft=0;ft<at.length;ft+=1)bt.indexOf(at[ft])===-1&&bt.push(at[ft]);g(bt);for(var qt=bt[0],Mt=bt[bt.length-1],jt=qt;jt<Mt+1;jt++){this.pdf.setPage(jt);var Xt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Tt=jt===1?this.posY+this.margin[0]:this.margin[0],st=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],et=jt===1?0:st+(jt-2)*Qe;if(this.ctx.clip_path.length!==0){var fr=this.path;pt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(pt,this.posX+this.margin[3],-et+Tt+this.ctx.prevPageLastElemOffset),C.call(this,"fill",!0),this.path=fr}var Nt=JSON.parse(JSON.stringify(Me));Nt=k([Nt],this.posX+this.margin[3],-et+Tt+this.ctx.prevPageLastElemOffset)[0];var Ot=(jt>qt||jt<Mt)&&m.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xt,Qe,null).clip().discardPath()),this.pdf.addImage(T,"JPEG",Nt.x,Nt.y,Nt.w,Nt.h,null,null,Be),Ot&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(T,"JPEG",Me.x,Me.y,Me.w,Me.h,null,null,Be)};var y=function(T,R,N){var O=[];R=R||this.pdf.internal.pageSize.width,N=N||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var H=this.posY+this.ctx.prevPageLastElemOffset;switch(T.type){default:case"mt":case"lt":O.push(Math.floor((T.y+H)/N)+1);break;case"arc":O.push(Math.floor((T.y+H-T.radius)/N)+1),O.push(Math.floor((T.y+H+T.radius)/N)+1);break;case"qct":var ae=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x,T.y);O.push(Math.floor((ae.y+H)/N)+1),O.push(Math.floor((ae.y+ae.h+H)/N)+1);break;case"bct":var de=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x2,T.y2,T.x,T.y);O.push(Math.floor((de.y+H)/N)+1),O.push(Math.floor((de.y+de.h+H)/N)+1);break;case"rect":O.push(Math.floor((T.y+H)/N)+1),O.push(Math.floor((T.y+T.h+H)/N)+1)}for(var me=0;me<O.length;me+=1)for(;this.pdf.internal.getNumberOfPages()<O[me];)_.call(this);return O},_=function(){var T=this.fillStyle,R=this.strokeStyle,N=this.font,O=this.lineCap,H=this.lineWidth,ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=T,this.strokeStyle=R,this.font=N,this.lineCap=O,this.lineWidth=H,this.lineJoin=ae},k=function(T,R,N){for(var O=0;O<T.length;O++)switch(T[O].type){case"bct":T[O].x2+=R,T[O].y2+=N;case"qct":T[O].x1+=R,T[O].y1+=N;default:T[O].x+=R,T[O].y+=N}return T},g=function(T){return T.sort(function(R,N){return R-N})},w=function(T,R){var N=this.fillStyle,O=this.strokeStyle,H=this.lineCap,ae=this.lineWidth,de=Math.abs(ae*this.ctx.transform.scaleX),me=this.lineJoin;if(this.autoPaging){for(var xe,Se,Z=JSON.parse(JSON.stringify(this.path)),Fe=JSON.parse(JSON.stringify(this.path)),$e=[],J=0;J<Fe.length;J++)if(Fe[J].x!==void 0)for(var Oe=y.call(this,Fe[J]),Be=0;Be<Oe.length;Be+=1)$e.indexOf(Oe[Be])===-1&&$e.push(Oe[Be]);for(var it=0;it<$e.length;it++)for(;this.pdf.internal.getNumberOfPages()<$e[it];)_.call(this);g($e);for(var Me=$e[0],pt=$e[$e.length-1],at=Me;at<pt+1;at++){this.pdf.setPage(at),this.fillStyle=N,this.strokeStyle=O,this.lineCap=H,this.lineWidth=de,this.lineJoin=me;var bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=at===1?this.posY+this.margin[0]:this.margin[0],qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],jt=at===1?0:qt+(at-2)*Mt;if(this.ctx.clip_path.length!==0){var Xt=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(xe,this.posX+this.margin[3],-jt+ft+this.ctx.prevPageLastElemOffset),C.call(this,T,!0),this.path=Xt}if(Se=JSON.parse(JSON.stringify(Z)),this.path=k(Se,this.posX+this.margin[3],-jt+ft+this.ctx.prevPageLastElemOffset),R===!1||at===0){var Tt=(at>Me||at<pt)&&m.call(this);Tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,Mt,null).clip().discardPath()),C.call(this,T,R),Tt&&this.pdf.restoreGraphicsState()}this.lineWidth=ae}this.path=Z}else this.lineWidth=de,C.call(this,T,R),this.lineWidth=ae},C=function(T,R){if((T!=="stroke"||R||!v.call(this))&&(T==="stroke"||R||!d.call(this))){for(var N,O,H=[],ae=this.path,de=0;de<ae.length;de++){var me=ae[de];switch(me.type){case"begin":H.push({begin:!0});break;case"close":H.push({close:!0});break;case"mt":H.push({start:me,deltas:[],abs:[]});break;case"lt":var xe=H.length;if(ae[de-1]&&!isNaN(ae[de-1].x)&&(N=[me.x-ae[de-1].x,me.y-ae[de-1].y],xe>0)){for(;xe>=0;xe--)if(H[xe-1].close!==!0&&H[xe-1].begin!==!0){H[xe-1].deltas.push(N),H[xe-1].abs.push(me);break}}break;case"bct":N=[me.x1-ae[de-1].x,me.y1-ae[de-1].y,me.x2-ae[de-1].x,me.y2-ae[de-1].y,me.x-ae[de-1].x,me.y-ae[de-1].y],H[H.length-1].deltas.push(N);break;case"qct":var Se=ae[de-1].x+2/3*(me.x1-ae[de-1].x),Z=ae[de-1].y+2/3*(me.y1-ae[de-1].y),Fe=me.x+2/3*(me.x1-me.x),$e=me.y+2/3*(me.y1-me.y),J=me.x,Oe=me.y;N=[Se-ae[de-1].x,Z-ae[de-1].y,Fe-ae[de-1].x,$e-ae[de-1].y,J-ae[de-1].x,Oe-ae[de-1].y],H[H.length-1].deltas.push(N);break;case"arc":H.push({deltas:[],abs:[],arc:!0}),Array.isArray(H[H.length-1].abs)&&H[H.length-1].abs.push(me)}}O=R?null:T==="stroke"?"stroke":"fill";for(var Be=!1,it=0;it<H.length;it++)if(H[it].arc)for(var Me=H[it].abs,pt=0;pt<Me.length;pt++){var at=Me[pt];at.type==="arc"?I.call(this,at.x,at.y,at.radius,at.startAngle,at.endAngle,at.counterclockwise,void 0,R,!Be):z.call(this,at.x,at.y),Be=!0}else if(H[it].close===!0)this.pdf.internal.out("h"),Be=!1;else if(H[it].begin!==!0){var bt=H[it].start.x,ft=H[it].start.y;M.call(this,H[it].deltas,bt,ft),Be=!0}O&&D.call(this,O),R&&B.call(this)}},E=function(T){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,N=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return T-N;case"top":return T+R-N;case"hanging":return T+R-2*N;case"middle":return T+R/2-N;default:return T}},A=function(T){return T+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var T=function(){};return T.colorStops=[],T.addColorStop=function(R,N){this.colorStops.push([R,N])},T.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},T.isCanvasGradient=!0,T},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(T,R,N,O,H,ae,de,me,xe){for(var Se=fe.call(this,N,O,H,ae),Z=0;Z<Se.length;Z++){var Fe=Se[Z];Z===0&&(xe?L.call(this,Fe.x1+T,Fe.y1+R):z.call(this,Fe.x1+T,Fe.y1+R)),q.call(this,T,R,Fe.x2,Fe.y2,Fe.x3,Fe.y3,Fe.x4,Fe.y4)}me?B.call(this):D.call(this,de)},D=function(T){switch(T){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(T,R){this.pdf.internal.out(r(T)+" "+a(R)+" m")},F=function(T){var R;switch(T.align){case"right":case"end":R="right";break;case"center":R="center";break;default:R="left"}var N,O,H,ae=this.pdf.getTextDimensions(T.text),de=E.call(this,T.y),me=A.call(this,de)-ae.h,xe=this.ctx.transform.applyToPoint(new o(T.x,de));if(this.autoPaging){var Se=this.ctx.transform.decompose(),Z=new c;Z=(Z=(Z=Z.multiply(Se.translate)).multiply(Se.skew)).multiply(Se.scale);for(var Fe=this.ctx.transform.applyToRectangle(new l(T.x,de,ae.w,ae.h)),$e=Z.applyToRectangle(new l(T.x,me,ae.w,ae.h)),J=y.call(this,$e),Oe=[],Be=0;Be<J.length;Be+=1)Oe.indexOf(J[Be])===-1&&Oe.push(J[Be]);g(Oe);for(var it=Oe[0],Me=Oe[Oe.length-1],pt=it;pt<Me+1;pt++){this.pdf.setPage(pt);var at=pt===1?this.posY+this.margin[0]:this.margin[0],bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],qt=ft-this.margin[0],Mt=this.pdf.internal.pageSize.width-this.margin[1],jt=Mt-this.margin[3],Xt=pt===1?0:bt+(pt-2)*qt;if(this.ctx.clip_path.length!==0){var Tt=this.path;N=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(N,this.posX+this.margin[3],-1*Xt+at),C.call(this,"fill",!0),this.path=Tt}var st=k([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Xt+at+this.ctx.prevPageLastElemOffset)[0];T.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*T.scale),H=this.lineWidth,this.lineWidth=H*T.scale);var Qe=this.autoPaging!=="text";if(Qe||st.y+st.h<=ft){if(Qe||st.y>=at&&st.x<=Mt){var et=Qe?T.text:this.pdf.splitTextToSize(T.text,T.maxWidth||Mt-st.x)[0],fr=k([JSON.parse(JSON.stringify(Fe))],this.posX+this.margin[3],-Xt+at+this.ctx.prevPageLastElemOffset)[0],Nt=Qe&&(pt>it||pt<Me)&&m.call(this);Nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,qt,null).clip().discardPath()),this.pdf.text(et,fr.x,fr.y,{angle:T.angle,align:R,renderingMode:T.renderingMode}),Nt&&this.pdf.restoreGraphicsState()}}else st.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-st.y);T.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=H)}}else T.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*T.scale),H=this.lineWidth,this.lineWidth=H*T.scale),this.pdf.text(T.text,xe.x+this.posX,xe.y+this.posY,{angle:T.angle,align:R,renderingMode:T.renderingMode,maxWidth:T.maxWidth}),T.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=H)},z=function(T,R,N,O){N=N||0,O=O||0,this.pdf.internal.out(r(T+N)+" "+a(R+O)+" l")},M=function(T,R,N){return this.pdf.lines(T,R,N,null,null)},q=function(T,R,N,O,H,ae,de,me){this.pdf.internal.out([t(n(N+T)),t(i(O+R)),t(n(H+T)),t(i(ae+R)),t(n(de+T)),t(i(me+R)),"c"].join(" "))},fe=function(T,R,N,O){for(var H=2*Math.PI,ae=Math.PI/2;R>N;)R-=H;var de=Math.abs(N-R);de<H&&O&&(de=H-de);for(var me=[],xe=O?-1:1,Se=R;de>1e-5;){var Z=Se+xe*Math.min(de,ae);me.push(he.call(this,T,Se,Z)),de-=Math.abs(Z-Se),Se=Z}return me},he=function(T,R,N){var O=(N-R)/2,H=T*Math.cos(O),ae=T*Math.sin(O),de=H,me=-ae,xe=de*de+me*me,Se=xe+de*H+me*ae,Z=4/3*(Math.sqrt(2*xe*Se)-Se)/(de*ae-me*H),Fe=de-Z*me,$e=me+Z*de,J=Fe,Oe=-$e,Be=O+R,it=Math.cos(Be),Me=Math.sin(Be);return{x1:T*Math.cos(R),y1:T*Math.sin(R),x2:Fe*it-$e*Me,y2:Fe*Me+$e*it,x3:J*it-Oe*Me,y3:J*Me+Oe*it,x4:T*Math.cos(N),y4:T*Math.sin(N)}},pe=function(T){return 180*T/Math.PI},Q=function(T,R,N,O,H,ae){var de=T+.5*(N-T),me=R+.5*(O-R),xe=H+.5*(N-H),Se=ae+.5*(O-ae),Z=Math.min(T,H,de,xe),Fe=Math.max(T,H,de,xe),$e=Math.min(R,ae,me,Se),J=Math.max(R,ae,me,Se);return new l(Z,$e,Fe-Z,J-$e)},we=function(T,R,N,O,H,ae,de,me){var xe,Se,Z,Fe,$e,J,Oe,Be,it,Me,pt,at,bt,ft,qt=N-T,Mt=O-R,jt=H-N,Xt=ae-O,Tt=de-H,st=me-ae;for(Se=0;Se<41;Se++)it=(Oe=(Z=T+(xe=Se/40)*qt)+xe*(($e=N+xe*jt)-Z))+xe*($e+xe*(H+xe*Tt-$e)-Oe),Me=(Be=(Fe=R+xe*Mt)+xe*((J=O+xe*Xt)-Fe))+xe*(J+xe*(ae+xe*st-J)-Be),Se==0?(pt=it,at=Me,bt=it,ft=Me):(pt=Math.min(pt,it),at=Math.min(at,Me),bt=Math.max(bt,it),ft=Math.max(ft,Me));return new l(Math.round(pt),Math.round(at),Math.round(bt-pt),Math.round(ft-at))},Y=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var T,R,N=(T=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:T,lineDashOffset:R}));this.prevLineDash!==N&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=N)}}})(ht.API),function(e){var t=function(o){var l,c,u,f,h,p,d,v,m,y;for(c=[],u=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>u;u+=4)(h=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(p=(h=((h=((h=((h=(h-(y=h%85))/85)-(m=h%85))/85)-(v=h%85))/85)-(d=h%85))/85)%85,c.push(p+33,d+33,v+33,m+33,y+33)):c.push(122);return function(_,k){for(var g=k;g>0;g--)_.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,f,h,p=String,d="length",v=255,m="charCodeAt",y="slice",_="replace";for(o[y](-2),o=o[y](0,-2)[_](/\s/g,"")[_]("z","!!!!!"),u=[],f=0,h=(o+=l="uuuuu"[y](o[d]%5||5))[d];h>f;f+=5)c=52200625*(o[m](f)-33)+614125*(o[m](f+1)-33)+7225*(o[m](f+2)-33)+85*(o[m](f+3)-33)+(o[m](f+4)-33),u.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(k,g){for(var w=g;w>0;w--)k.pop()}(u,l[d]),p.fromCharCode.apply(p,u)},a=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=o1(l)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=n(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=a(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(ht.API),function(e){e.loadFile=function(t,r,a){return function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,f){var h=new XMLHttpRequest,p=0,d=function(v){var m=v.length,y=[],_=String.fromCharCode;for(p=0;p<m;p+=1)y.push(_(255&v.charCodeAt(p)));return y.join("")};if(h.open("GET",c,!u),h.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(h.onload=function(){h.status===200?f(d(this.responseText)):f(void 0)}),h.send(null),u&&h.status===200)return d(h.responseText)}(n,i,o)}catch{}return l}(t,r,a)},e.loadImageFile=e.loadFile}(ht.API),function(e){function t(){return(Bt.html2canvas?Promise.resolve(Bt.html2canvas):xi(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Bt.DOMPurify?Promise.resolve(Bt.DOMPurify):xi(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var a=function(l){var c=jr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},n=function(l,c){var u=document.createElement(l);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},i=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(l(h,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),u);return(f=f.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(a(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:n("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var d=0;d<f.length;++d){var v=f[d],m=v.src.find(function(y){return y.format==="truetype"});m&&u.addFont(m.url,v.ref.name,v.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,u.context2d.save(!0),c(this.prop.container,p)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(a(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(a(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(l=l||ht.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,f){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,f){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(f,h){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(p){return u.updateProgress(null,f),p}).then(f,h).then(function(p){return u.updateProgress(1),p})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),c&&(c=c.bind(f));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),p=u.call(h,l,c);return o.convert(p,f.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,ht.getPageSize=function(l,c,u){if(jr(l)==="object"){var f=l;l=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var h,p=(""+u).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+c}var v,m=0,y=0;if(d.hasOwnProperty(p))m=d[p][1]/h,y=d[p][0]/h;else try{m=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>m&&(v=y,y=m,m=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",m>y&&(v=y,y=m,m=v)}return{width:y,height:m,unit:c,k:h,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(bp):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(ht.API),ht.API.addJS=function(e){return Yv=e,this.internal.events.subscribe("postPutResources",function(){gf=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(gf+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Kv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Yv+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){gf!==void 0&&Kv!==void 0&&this.internal.out("/Names <</JavaScript "+gf+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],l=a.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(i=0;i<u;i++){var h=r.internal.newObject();f.push(h);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<f.length;i++)r.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,i){var o={title:n,options:i,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var o=a.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var u=0;u<a.children.length;u++)this.renderItems(a.children[u])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var i=0;i<n.children.length;i++)a.count++,this.count_r(a,n.children[i]);return a.count}}])}(ht.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,n,i,o,l){var c,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(h){for(var p,d=256*h.charCodeAt(4)+h.charCodeAt(5),v=h.length,m={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=d,t.indexOf(h.charCodeAt(y+1))!==-1){p=256*h.charCodeAt(y+5)+h.charCodeAt(y+6),m={width:256*h.charCodeAt(y+7)+h.charCodeAt(y+8),height:p,numcomponents:h.charCodeAt(y+9)};break}d=256*h.charCodeAt(y+2)+h.charCodeAt(y+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:a,alias:n}}return f}}(ht.API),ht.API.processPNG=function(e,t,r,a){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var n,i=PR(e,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,u=i.palette,f=i.depth;n=u&&c===1?function(I){for(var D=I.width,B=I.height,L=I.data,F=I.palette,z=I.depth,M=!1,q=[],fe=[],he=void 0,pe=!1,Q=0,we=0;we<F.length;we++){var Y=Q2(F[we],4),T=Y[0],R=Y[1],N=Y[2],O=Y[3];q.push(T,R,N),O!=null&&(O===0?(Q++,fe.length<1&&fe.push(we)):O<255&&(pe=!0))}if(pe||Q>1){M=!0,fe=void 0;var H=D*B;he=new Uint8Array(H);for(var ae=new DataView(L.buffer),de=0;de<H;de++){var me=_p(ae,de,z),xe=Q2(F[me],4)[3];he[de]=xe}}else Q===0&&(fe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:M?8:void 0,colorBytes:L,alphaBytes:he,needSMask:M,palette:q,mask:fe}}(i):c===2||c===4?function(I){for(var D=I.data,B=I.width,L=I.height,F=I.channels,z=I.depth,M=F===2?"DeviceGray":"DeviceRGB",q=F-1,fe=B*L,he=q,pe=fe*he,Q=1*fe,we=Math.ceil(pe*z/8),Y=Math.ceil(Q*z/8),T=new Uint8Array(we),R=new Uint8Array(Y),N=new DataView(D.buffer),O=new DataView(T.buffer),H=new DataView(R.buffer),ae=!1,de=0;de<fe;de++){for(var me=de*F,xe=0;xe<he;xe++)ny(O,_p(N,me+xe,z),de*he+xe,z);var Se=_p(N,me+he,z);Se<(1<<z)-1&&(ae=!0),ny(H,Se,1*de,z)}return{colorSpace:M,colorsPerPixel:q,sMaskBitsPerComponent:ae?z:void 0,colorBytes:T,alphaBytes:R,needSMask:ae}}(i):function(I){var D=I.data,B=I.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:D instanceof Uint16Array?function(L){for(var F=L.length,z=new Uint8Array(2*F),M=new DataView(z.buffer,z.byteOffset,z.byteLength),q=0;q<F;q++)M.setUint16(2*q,L[q],!1);return z}(D):D,needSMask:!1}}(i);var h,p,d,v=n,m=v.colorSpace,y=v.colorsPerPixel,_=v.sMaskBitsPerComponent,k=v.colorBytes,g=v.alphaBytes,w=v.needSMask,C=v.palette,E=v.mask,A=null;return a!==ht.API.image_compression.NONE&&typeof o1=="function"?(A=function(I){var D;switch(I){case ht.API.image_compression.FAST:D=11;break;case ht.API.image_compression.MEDIUM:D=13;break;case ht.API.image_compression.SLOW:D=14;break;default:D=12}return D}(a),h=this.decode.FLATE_DECODE,p="/Predictor ".concat(A," /Colors ").concat(y," /BitsPerComponent ").concat(f," /Columns ").concat(o),e=Qv(k,Math.ceil(o*y*f/8),y,f,a),w&&(d=Qv(g,Math.ceil(o*_/8),1,_,a))):(h=void 0,p=void 0,e=k,w&&(d=g)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:e,index:t,filter:h,decodeParameters:p,transparency:E,palette:C,sMask:d,predictor:A,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:_,colorSpace:m}}},function(e){e.processGIF89A=function(t,r,a,n){var i=new rO(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},f=new kp(100).encode(u,100);return e.processJPEG.call(this,f,r,a,n)},e.processGIF87A=e.processGIF89A}(ht.API),Ci.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ci.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Lr.log("bit decode error:"+r)}},Ci.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,l=0;l<8&&8*n+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Ci.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,l=i>>4,c=15&i,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*n+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Ci.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Ci.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,f=a*this.width*4+4*n;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=u}this.pos+=e}},Ci.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,f=n*this.width*4+4*i;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=e}},Ci.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},Ci.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=o}},Ci.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var i=new Ci(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new kp(100).encode(c,100);return e.processJPEG.call(this,u,r,a,n)}}(ht.API),sy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var i=new sy(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new kp(100).encode(c,100);return e.processJPEG.call(this,u,r,a,n)}}(ht.API),ht.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),l=0,c=0,u=0;u<n;u+=4){var f=a[u],h=a[u+1],p=a[u+2],d=a[u+3];i[l++]=f,i[l++]=h,i[l++]=p,o[c++]=d}var v=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},ht.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Hl=ht.API,vf=Hl.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:n.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:n.metadata.Unicode.kerning,f=u.fof?u.fof:1,h=t.doKerning!==!1,p=0,d=e.length,v=0,m=l[0]||c,y=[];for(r=0;r<d;r++)a=e.charCodeAt(r),typeof n.metadata.widthOfString=="function"?y.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/i)||0)/1e3):(p=h&&jr(u[a])==="object"&&!isNaN(parseInt(u[a][v],10))?u[a][v]/f:0,y.push((l[a]||m)/c+p)),v=a;return y},Xv=Hl.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Hl.processArabic&&(e=Hl.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,n)/r:vf.apply(this,arguments).reduce(function(i,o){return i+o},0)},Jv=function(e,t,r,a){for(var n=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;n.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>a&&(n.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&n.push(e.slice(c,i)),n},Zv=function(e,t,r){r||(r={});var a,n,i,o,l,c,u,f=[],h=[f],p=r.textIndent||0,d=0,v=0,m=e.split(" "),y=vf.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var _=Array(c).join(" "),k=[];m.map(function(w){(w=w.split(/\s*\n/)).length>1?k=k.concat(w.map(function(C,E){return(E&&C.length?`
`:"")+C})):k.push(w[0])}),m=k,c=Xv.apply(this,[_,r])}for(i=0,o=m.length;i<o;i++){var g=0;if(a=m[i],c&&a[0]==`
`&&(a=a.substr(1),g=1),p+d+(v=(n=vf.apply(this,[a,r])).reduce(function(w,C){return w+C},0))>t||g){if(v>t){for(l=Jv.apply(this,[a,n,t-(p+d),t]),f.push(l.shift()),f=[l.pop()];l.length;)h.push([l.shift()]);v=n.slice(a.length-(f[0]?f[0].length:0)).reduce(function(w,C){return w+C},0)}else f=[a];h.push(f),p=v+c,d=y}else f.push(a),p+=d+v,d=y}return u=c?function(w,C){return(C?_:"")+w.join(" ")}:function(w){return w.join(" ")},h.map(u)},Hl.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var h=this.internal.getFont(f.fontName,f.fontStyle),p="Unicode";return h.metadata[p]?{widths:h.metadata[p].widths||{0:1},kerning:h.metadata[p].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=a.length;l<c;l++)u=u.concat(Zv.apply(this,[a[l],o,i]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},i=0;i<16;i++)a[r[i]]=t[i],n[t[i]]=r[i];var o=function(p){return"0x"+parseInt(p,10).toString(16)},l=e.__fontmetrics__.compress=function(p){var d,v,m,y,_=["{"];for(var k in p){if(d=p[k],isNaN(parseInt(k,10))?v="'"+k+"'":(k=parseInt(k,10),v=(v=o(k).slice(2)).slice(0,-1)+n[v.slice(-1)]),typeof d=="number")d<0?(m=o(d).slice(3),y="-"):(m=o(d).slice(2),y=""),m=y+m.slice(0,-1)+n[m.slice(-1)];else{if(jr(d)!=="object")throw new Error("Don't know what to do with value type "+jr(d)+".");m=l(d)}_.push(v+m)}return _.push("}"),_.join("")},c=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,v,m,y,_={},k=1,g=_,w=[],C="",E="",A=p.length-1,I=1;I<A;I+=1)(y=p[I])=="'"?d?(m=d.join(""),d=void 0):d=[]:d?d.push(y):y=="{"?(w.push([g,m]),g={},m=void 0):y=="}"?((v=w.pop())[0][v[1]]=g,m=void 0,g=v[0]):y=="-"?k=-1:m===void 0?a.hasOwnProperty(y)?(C+=a[y],m=parseInt(C,16)*k,k=1,C=""):C+=y:a.hasOwnProperty(y)?(E+=a[y],g[m]=parseInt(E,16)*k,k=1,m=void 0,E=""):E+=y;return _},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},h={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var d=p.font,v=h.Unicode[d.postScriptName];v&&(d.metadata.Unicode={},d.metadata.Unicode.widths=v.widths,d.metadata.Unicode.kerning=v.kerning);var m=f.Unicode[d.postScriptName];m&&(d.metadata.Unicode.encoding=m,d.encoding=m.codePages[0])}])}(ht.API),function(e){var t=function(r){for(var a=r.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=r.charCodeAt(i);return n};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Tf(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])}(ht),ht.API.addSvgAsImage=function(e,t,r,a,n,i,o,l){if(isNaN(t)||isNaN(r))throw Lr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Lr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=a,c.height=n;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Bt.canvg?Promise.resolve(Bt.canvg):xi(()=>import("./index.es-BsQWTpT4.js"),__vite__mapDeps([0,1,2,3]))).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(u,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(f)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,r,a,n,o,l)})},ht.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},ht.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,f=0,h=0;function p(v,m){var y,_=!1;for(y=0;y<v.length;y+=1)v[y]===m&&(_=!0);return _}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=l.length;for(h=0;h<d;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(jr(e)==="object"){for(n in e)if(i=e[n],p(l,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&p(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(u=0;u<i.length;u+=1)if(a=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(f=0;f<i[u].length;f+=1)typeof i[u][f]!="number"&&(a=!1);a===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[n].value="["+c.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,m=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?m.push("/"+v+" /"+r[v].value):m.push("/"+v+" "+r[v].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+o.length+l.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(ht.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],h=0,p=i.length;h<p;++h){if(l=o.metadata.characterToGlyph(i.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(u[4-l.length],l)}return f.join("")},a=function(i){var o,l,c,u,f,h,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,p=(l=Object.keys(i).sort(function(d,v){return d-v})).length;h<p;h++)o=l[h],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(u=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,p=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),d="",v=0;v<p.length;v++)d+=String.fromCharCode(p[v]);var m=u();f({data:d,addLength1:!0,objectId:m}),c("endobj");var y=u();f({data:a(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var _=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Yl(l.fontName)),c("/FontFile2 "+m+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var k=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Yl(l.fontName)),c("/FontDescriptor "+_+" 0 R"),c("/W "+e.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Yl(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+k+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,f=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,p="",d=0;d<h.length;d++)p+=String.fromCharCode(h[d]);var v=u();f({data:p,addLength1:!0,objectId:v}),c("endobj");var m=u();f({data:a(l.metadata.toUnicode),addLength1:!0,objectId:m}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Yl(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var _=0;_<l.metadata.hmtx.widths.length;_++)l.metadata.hmtx.widths[_]=parseInt(l.metadata.hmtx.widths[_]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Yl(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,l=i.text||"",c=i.x,u=i.y,f=i.options||{},h=i.mutex||{},p=h.pdfEscape,d=h.activeFontKey,v=h.fonts,m=d,y="",_=0,k="",g=v[m].encoding;if(v[m].encoding!=="Identity-H")return{text:l,x:c,y:u,options:f,mutex:h};for(k=l,m=d,Array.isArray(l)&&(k=l[0]),_=0;_<k.length;_+=1)v[m].metadata.hasOwnProperty("cmap")&&(o=v[m].metadata.cmap.unicode.codeMap[k[_].charCodeAt(0)]),o||k[_].charCodeAt(0)<256&&v[m].metadata.hasOwnProperty("Unicode")?y+=k[_]:y+="";var w="";return parseInt(m.slice(1))<14||g==="WinAnsiEncoding"?w=p(y,m).split("").map(function(C){return C.charCodeAt(0).toString(16)}).join(""):g==="Identity-H"&&(w=r(y,v[m])),h.isHex=!0,{text:w,x:c,y:u,options:f,mutex:h}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([n(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(n(Object.assign({},c,{text:o[u]})).text);i.text=l}else i.text=n(Object.assign({},c,{text:o})).text}])}(ht),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(ht.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var n,i,o,l,c,u,f,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],_=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,g=0;this.__bidiEngine__={};var w=function(L){var F=L.charCodeAt(),z=F>>8,M=m[z];return M!==void 0?h[256*M+(255&F)]:z===252||z===253?"AL":_.test(z)?"L":z===8?"R":"N"},C=function(L){for(var F,z=0;z<L.length;z++){if((F=w(L.charAt(z)))==="L")return!1;if(F==="R")return!0}return!1},E=function(L,F,z,M){var q,fe,he,pe,Q=F[M];switch(Q){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"N":case"AN":break;case"EN":k&&(Q="AN");break;case"AL":k=!0,Q="R";break;case"WS":case"BN":Q="N";break;case"CS":M<1||M+1>=F.length||(q=z[M-1])!=="EN"&&q!=="AN"||(fe=F[M+1])!=="EN"&&fe!=="AN"?Q="N":k&&(fe="AN"),Q=fe===q?fe:"N";break;case"ES":Q=(q=M>0?z[M-1]:"B")==="EN"&&M+1<F.length&&F[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&z[M-1]==="EN"){Q="EN";break}if(k){Q="N";break}for(he=M+1,pe=F.length;he<pe&&F[he]==="ET";)he++;Q=he<pe&&F[he]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(pe=F.length,he=M+1;he<pe&&F[he]==="NSM";)he++;if(he<pe){var we=L[M],Y=we>=1425&&we<=2303||we===64286;if(q=F[he],Y&&(q==="R"||q==="AL")){Q="R";break}}}Q=M<1||(q=F[M-1])==="B"?"N":z[M-1];break;case"B":k=!1,n=!0,Q=g;break;case"S":i=!0,Q="N"}return Q},A=function(L,F,z){var M=L.split("");return z&&I(M,z,{hiLevel:g}),M.reverse(),F&&F.reverse(),M.join("")},I=function(L,F,z){var M,q,fe,he,pe,Q=-1,we=L.length,Y=0,T=[],R=g?d:p,N=[];for(k=!1,n=!1,i=!1,q=0;q<we;q++)N[q]=w(L[q]);for(fe=0;fe<we;fe++){if(pe=Y,T[fe]=E(L,N,T,fe),M=240&(Y=R[pe][v[T[fe]]]),Y&=15,F[fe]=he=R[Y][5],M>0)if(M===16){for(q=Q;q<fe;q++)F[q]=1;Q=-1}else Q=-1;if(R[Y][6])Q===-1&&(Q=fe);else if(Q>-1){for(q=Q;q<fe;q++)F[q]=he;Q=-1}N[fe]==="B"&&(F[fe]=0),z.hiLevel|=he}i&&function(O,H,ae){for(var de=0;de<ae;de++)if(O[de]==="S"){H[de]=g;for(var me=de-1;me>=0&&O[me]==="WS";me--)H[me]=g}}(N,F,we)},D=function(L,F,z,M,q){if(!(q.hiLevel<L)){if(L===1&&g===1&&!n)return F.reverse(),void(z&&z.reverse());for(var fe,he,pe,Q,we=F.length,Y=0;Y<we;){if(M[Y]>=L){for(pe=Y+1;pe<we&&M[pe]>=L;)pe++;for(Q=Y,he=pe-1;Q<he;Q++,he--)fe=F[Q],F[Q]=F[he],F[he]=fe,z&&(fe=z[Q],z[Q]=z[he],z[he]=fe);Y=pe}Y++}}},B=function(L,F,z){var M=L.split(""),q={hiLevel:g};return z||(z=[]),I(M,z,q),function(fe,he,pe){if(pe.hiLevel!==0&&f)for(var Q,we=0;we<fe.length;we++)he[we]===1&&(Q=y.indexOf(fe[we]))>=0&&(fe[we]=y[Q+1])}(M,z,q),D(2,M,F,z,q),D(1,M,F,z,q),M.join("")};return this.__bidiEngine__.doBidiReorder=function(L,F,z){if(function(q,fe){if(fe)for(var he=0;he<q.length;he++)fe[he]=he;l===void 0&&(l=C(q)),u===void 0&&(u=C(q))}(L,F),o||!c||u)if(o&&c&&l^u)g=l?1:0,L=A(L,F,z);else if(!o&&c&&u)g=l?1:0,L=B(L,F,z),L=A(L,F);else if(!o||l||c||u){if(o&&!c&&l^u)L=A(L,F),l?(g=0,L=B(L,F,z)):(g=1,L=B(L,F,z),L=A(L,F));else if(o&&l&&!c&&u)g=1,L=B(L,F,z),L=A(L,F);else if(!o&&!c&&l^u){var M=f;l?(g=1,L=B(L,F,z),g=0,f=!1,L=B(L,F,z),f=M):(g=0,L=B(L,F,z),L=A(L,F),g=1,f=!1,L=B(L,F,z),f=M,L=A(L,F))}}else g=0,L=B(L,F,z);else g=l?1:0,L=B(L,F,z);return L},this.__bidiEngine__.setOptions=function(L){L&&(o=L.isInputVisual,c=L.isOutputVisual,l=L.isInputRtl,u=L.isOutputRtl,f=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var i=a.options||{};a.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var l=0;for(o=[],l=0;l<n.length;l+=1)Object.prototype.toString.call(n[l])==="[object Array]"?o.push([r.doBidiReorder(n[l][0]),n[l][1],n[l][2]]):o.push([r.doBidiReorder(n[l])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])}(ht),ht.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new _o(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new gO(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new aO(this.contents),this.head=new iO(this),this.name=new uO(this),this.cmap=new l_(this),this.toUnicode={},this.hhea=new sO(this),this.maxp=new fO(this),this.hmtx=new dO(this),this.post=new lO(this),this.os2=new oO(this),this.loca=new xO(this),this.glyf=new hO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var n,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)n=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var zi,_o=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,n,i,o,l,c;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,n,i;for(i=[],a=0,n=t.length;a<n;a++)r=t[a],i.push(this.writeByte(r));return i},e}(),aO=function(){var e;function t(r){var a,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,i,o,l,c,u,f,h,p,d,v,m;for(m in d=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(d)/c),o=Math.floor(h/c),f=16*d-h,(n=new _o).writeInt(this.scalarType),n.writeShort(d),n.writeShort(h),n.writeShort(o),n.writeShort(f),i=16*d,u=n.pos+i,l=null,v=[],r)for(p=r[m],n.writeString(m),n.writeInt(e(p)),n.writeInt(u),n.writeInt(p.length),v=v.concat(p),m==="head"&&(l=u),u+=p.length;u%4;)v.push(0),u++;return n.write(v),a=2981146554-e(n.data),n.pos=l+8,n.writeUInt32(a),n.data},e=function(r){var a,n,i,o;for(r=c_.call(r);r.length%4;)r.push(0);for(i=new _o(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=i.readUInt32();return 4294967295&n},t}(),nO={}.hasOwnProperty,us=function(e,t){for(var r in t)nO.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};zi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var iO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new _o).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),oy=function(){function e(t,r){var a,n,i,o,l,c,u,f,h,p,d,v,m,y,_,k,g;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(d=t.readUInt16(),p=d/2,t.pos+=6,i=function(){var w,C;for(C=[],c=w=0;0<=p?w<p:w>p;c=0<=p?++w:--w)C.push(t.readUInt16());return C}(),t.pos+=2,m=function(){var w,C;for(C=[],c=w=0;0<=p?w<p:w>p;c=0<=p?++w:--w)C.push(t.readUInt16());return C}(),u=function(){var w,C;for(C=[],c=w=0;0<=p?w<p:w>p;c=0<=p?++w:--w)C.push(t.readUInt16());return C}(),f=function(){var w,C;for(C=[],c=w=0;0<=p?w<p:w>p;c=0<=p?++w:--w)C.push(t.readUInt16());return C}(),n=(this.length-t.pos+this.offset)/2,l=function(){var w,C;for(C=[],c=w=0;0<=n?w<n:w>n;c=0<=n?++w:--w)C.push(t.readUInt16());return C}(),c=_=0,g=i.length;_<g;c=++_)for(y=i[c],a=k=v=m[c];v<=y?k<=y:k>=y;a=v<=y?++k:--k)f[c]===0?o=a+u[c]:(o=l[f[c]/2+(a-v)-(p-c)]||0)!==0&&(o+=u[c]),this.codeMap[a]=65535&o}t.pos=h}return e.encode=function(t,r){var a,n,i,o,l,c,u,f,h,p,d,v,m,y,_,k,g,w,C,E,A,I,D,B,L,F,z,M,q,fe,he,pe,Q,we,Y,T,R,N,O,H,ae,de,me,xe,Se,Z;switch(M=new _o,o=Object.keys(t).sort(function(Fe,$e){return Fe-$e}),r){case"macroman":for(m=0,y=function(){var Fe=[];for(v=0;v<256;++v)Fe.push(0);return Fe}(),k={0:0},i={},q=0,Q=o.length;q<Q;q++)k[me=t[n=o[q]]]==null&&(k[me]=++m),i[n]={old:t[n],new:k[t[n]]},y[n]=k[t[n]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(y),{charMap:i,subtable:M.data,maxGlyphID:m+1};case"unicode":for(F=[],h=[],g=0,k={},a={},_=u=null,fe=0,we=o.length;fe<we;fe++)k[C=t[n=o[fe]]]==null&&(k[C]=++g),a[n]={old:C,new:k[C]},l=k[C]-n,_!=null&&l===u||(_&&h.push(_),F.push(n),u=l),_=n;for(_&&h.push(_),h.push(65535),F.push(65535),B=2*(D=F.length),I=2*Math.pow(Math.log(D)/Math.LN2,2),p=Math.log(I/2)/Math.LN2,A=2*D-I,c=[],E=[],d=[],v=he=0,Y=F.length;he<Y;v=++he){if(L=F[v],f=h[v],L===65535){c.push(0),E.push(0);break}if(L-(z=a[L].new)>=32768)for(c.push(0),E.push(2*(d.length+D-v)),n=pe=L;L<=f?pe<=f:pe>=f;n=L<=f?++pe:--pe)d.push(a[n].new);else c.push(z-L),E.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*D+2*d.length),M.writeUInt16(0),M.writeUInt16(B),M.writeUInt16(I),M.writeUInt16(p),M.writeUInt16(A),ae=0,T=h.length;ae<T;ae++)n=h[ae],M.writeUInt16(n);for(M.writeUInt16(0),de=0,R=F.length;de<R;de++)n=F[de],M.writeUInt16(n);for(xe=0,N=c.length;xe<N;xe++)l=c[xe],M.writeUInt16(l);for(Se=0,O=E.length;Se<O;Se++)w=E[Se],M.writeUInt16(w);for(Z=0,H=d.length;Z<H;Z++)m=d[Z],M.writeUInt16(m);return{charMap:a,subtable:M.data,maxGlyphID:g+1}}},e}(),l_=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,a,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new oy(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var a,n;return r==null&&(r="macroman"),a=oy.encode(t,r),(n=new _o).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},e}(),sO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),oO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,a;for(a=[],r=0;r<10;++r)a.push(t.readByte());return a}(),this.charRange=function(){var r,a;for(a=[],r=0;r<4;++r)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),lO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="post",e.prototype.parse=function(t){var r,a,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(a=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)r=t.readByte(),n.push(this.names.push(t.readString(r)));return n;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),cO=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},uO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="name",e.prototype.parse=function(t){var r,a,n,i,o,l,c,u,f,h,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),a=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=f=0,h=a.length;f<h;i=++f)n=a[i],t.pos=n.offset,u=t.readString(n.length),o=new cO(u,n),c[p=n.nameID]==null&&(c[p]=[]),c[n.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),fO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),dO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,a,n,i,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],r=u=0;0<=n?u<n:u>n;r=0<=n?++u:--u)f.push(t.readInt16());return f}(),this.widths=(function(){var u,f,h,p;for(p=[],u=0,f=(h=this.metrics).length;u<f;u++)i=h[u],p.push(i.advance);return p}).call(this),a=this.widths[this.widths.length-1],c=[],r=o=0;0<=n?o<n:o>n;r=0<=n?++o:--o)c.push(this.widths.push(a));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),c_=[].slice,hO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,a,n,i,o,l,c,u,f,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,a=i.indexOf(t),(n=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+a,o=(l=new _o(r.read(n))).readShort(),u=l.readShort(),h=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[t]=o===-1?new mO(l,u,h,c,f):new pO(l,o,u,h,c,f),this.cache[t]))},e.prototype.encode=function(t,r,a){var n,i,o,l,c;for(o=[],i=[],l=0,c=r.length;l<c;l++)n=t[r[l]],i.push(o.length),n&&(o=o.concat(n.encode(a)));return i.push(o.length),{table:o,offsets:i}},e}(),pO=function(){function e(t,r,a,n,i,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),mO=function(){function e(t,r,a,n,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new _o(c_.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),xO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return us(e,zi),e.prototype.tag="loca",e.prototype.parse=function(t){var r,a;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,i;for(i=[],a=0,n=this.length;a<n;a+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var n,i;for(i=[],a=0,n=this.length;a<n;a+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var a=new Uint32Array(this.offsets.length),n=0,i=0,o=0;o<a.length;++o)if(a[o]=n,i<r.length&&r[i]==o){++i,a[o]=n;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(n+=c)}for(var u=new Array(4*a.length),f=0;f<a.length;++f)u[4*f+3]=255&a[f],u[4*f+2]=(65280&a[f])>>8,u[4*f+1]=(16711680&a[f])>>16,u[4*f]=(4278190080&a[f])>>24;return u},e}(),gO=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,n,i;for(r in n=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[r],t[r]=n[a];return t},e.prototype.glyphsFor=function(t){var r,a,n,i,o,l,c;for(n={},o=0,l=t.length;o<l;o++)n[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(a=n[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))a=c[i],n[i]=a;return n},e.prototype.encode=function(t,r){var a,n,i,o,l,c,u,f,h,p,d,v,m,y,_;for(n in a=l_.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),d={0:0},_=a.charMap)d[(c=_[n]).old]=c.new;for(v in p=a.maxGlyphID,o)v in d||(d[v]=p++);return f=function(k){var g,w;for(g in w={},k)w[k[g]]=g;return w}(d),h=Object.keys(f).sort(function(k,g){return k-g}),m=function(){var k,g,w;for(w=[],k=0,g=h.length;k<g;k++)l=h[k],w.push(f[l]);return w}(),i=this.font.glyf.encode(o,m,d),u=this.font.loca.encode(i.offsets,m),y={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();ht.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,i,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)a=r[l],u.push(t.convert(a));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)o=r[n],i.push("/"+n+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();const vO=async(e,t)=>{const r=new ht,a=r.internal.pageSize.getWidth(),n=r.internal.pageSize.getHeight(),i=20;let o=i;if(r.setFontSize(20),r.setFont("helvetica","bold"),r.text("SEVKİYAT ÇEKİ LİSTESİ",a/2,o,{align:"center"}),o+=15,r.setFontSize(12),r.setFont("helvetica","normal"),r.text(`Sevkiyat No: ${e.shipmentNumber}`,i,o),o+=7,r.text(`Tarih: ${e.shipmentDate.toLocaleDateString("tr-TR")}`,i,o),o+=7,r.text(`Durum: ${yO(e.status)}`,i,o),o+=10,r.setFont("helvetica","bold"),r.text("MÜŞTERİ BİLGİLERİ",i,o),o+=7,r.setFont("helvetica","normal"),r.text(`Müşteri: ${e.customerName}`,i,o),o+=7,t){if(t.companyName&&(r.text(`Şirket: ${t.companyName}`,i,o),o+=7),t.address&&(r.text(`Adres: ${t.address}`,i,o),o+=7),t.city||t.district){const p=[t.city,t.district].filter(Boolean).join(" / ");r.text(`Şehir/İlçe: ${p}`,i,o),o+=7}t.phone&&(r.text(`Telefon: ${t.phone}`,i,o),o+=7),t.email&&(r.text(`E-posta: ${t.email}`,i,o),o+=7),t.taxNumber&&(r.text(`Vergi No: ${t.taxNumber}`,i,o),o+=7)}o+=5,r.setFont("helvetica","bold"),r.text("ÜRÜN LİSTESİ",i,o),o+=10;const l=e.currency||"TRY",c={no:12,material:60,quantity:22,unit:18,unitPrice:25,discount:20};let u=i;r.setFontSize(10),r.setFont("helvetica","bold"),r.text("No",u,o),u+=c.no,r.text("Malzeme",u,o),u+=c.material,r.text("Miktar",u,o),u+=c.quantity,r.text("Birim",u,o),u+=c.unit,r.text("İskonto",u,o),u+=c.discount,r.text("Birim Fiyat",u,o),u+=c.unitPrice,r.text("Toplam",u,o),o+=7,r.setLineWidth(.5),r.line(i,o,a-i,o),o+=5,r.setFont("helvetica","normal"),e.items.forEach((p,d)=>{o>n-40&&(r.addPage(),o=i),u=i,r.text(String(d+1),u,o),u+=c.no;const v=p.materialName.length>30?p.materialName.substring(0,27)+"...":p.materialName;if(r.text(v,u,o),u+=c.material,r.text(p.quantity.toString(),u,o),u+=c.quantity,r.text(p.unit,u,o),u+=c.unit,r.text(p.discountPercent!==void 0?`%${p.discountPercent}`:"-",u,o),u+=c.discount,r.text(p.unitPrice.toFixed(2)+` ${l}`,u,o),u+=c.unitPrice,r.text(p.totalPrice.toFixed(2)+` ${l}`,u,o),o+=7,p.currency&&p.currency!=="TRY"){const m=p.exchangeRate||1,y=p.unitPrice/m;r.setFontSize(9),r.text(`   Orijinal: ${y.toFixed(2)} ${p.currency} | Kur: 1 ${p.currency} = ${m.toFixed(4)} ${l}`,i+c.no,o),r.setFontSize(10),o+=6}}),o+=3,r.setLineWidth(.5),r.line(i,o,a-i,o),o+=7,u=i+c.no+c.material+c.quantity+c.unit+c.discount+c.unitPrice,r.setFont("helvetica","bold"),r.text("TOPLAM:",u,o),u+=c.unitPrice,r.text(e.totalAmount.toFixed(2)+` ${l}`,u,o),e.notes&&(o+=15,r.setFont("helvetica","bold"),r.text("NOTLAR:",i,o),o+=7,r.setFont("helvetica","normal"),r.splitTextToSize(e.notes,a-2*i).forEach(d=>{o>n-20&&(r.addPage(),o=i),r.text(d,i,o),o+=7}));const f=e.items.map((p,d)=>p.priceRuleNote?`${d+1}) ${p.materialName}: ${p.priceRuleNote}${p.discountPercent?` (%${p.discountPercent})`:""}`:null).filter(Boolean);f.length>0&&(o+=10,r.setFont("helvetica","bold"),r.text("Fiyat Kuralı Bilgisi:",i,o),o+=7,r.setFont("helvetica","normal"),f.forEach(p=>{o>n-20&&(r.addPage(),o=i),r.text(p,i,o),o+=6})),e.warehouse&&(o+=10,r.setFont("helvetica","normal"),r.setFontSize(10),r.text(`Depo: ${e.warehouse}`,i,o));const h=`Sevkiyat_${e.shipmentNumber}_${e.shipmentDate.toISOString().split("T")[0]}.pdf`;r.save(h)},yO=e=>({pending:"Beklemede",preparing:"Hazırlanıyor",shipped:"Sevk Edildi",delivered:"Teslim Edildi",cancelled:"İptal Edildi"})[e]||e,u_="journalEntries",f_="customers",m1="customerTransactions",hx=async e=>(await Or(lt(qe,u_),{...e,date:Ye.fromDate(e.date),createdAt:ld()})).id,bO=async e=>{const{companyId:t,startDate:r,endDate:a,limit:n=200}=e||{};let i=Ke(lt(qe,u_),ua("date","desc"));return t&&(i=Ke(i,ot("companyId","==",t))),r&&(i=Ke(i,ot("date",">=",Ye.fromDate(r)))),a&&(i=Ke(i,ot("date","<=",Ye.fromDate(a)))),(await lr(i)).docs.slice(0,n).map(c=>{var f,h;const u=c.data();return{id:c.id,...u,date:(f=u.date)!=null&&f.toDate?u.date.toDate():u.date,createdAt:(h=u.createdAt)!=null&&h.toDate?u.createdAt.toDate():u.createdAt}})},d_=async e=>{await Or(lt(qe,m1),{...e,date:e.date,createdAt:ld()})},wO=async e=>{const{customerId:t,amount:r,currency:a="TRY",companyId:n,description:i,referenceType:o,referenceId:l}=e,c=ir(qe,f_,t);await gy(qe,async u=>{const f=await u.get(c);if(!f.exists())throw new Error("Müşteri bulunamadı");const d=(f.data().balance||0)+r;u.update(c,{balance:d,updatedAt:ld()})}),await d_({customerId:t,companyId:n,date:new Date,type:"charge",amount:r,currency:a,description:i||"Müşteri hareketi",referenceType:o,referenceId:l}),await hx({date:new Date,description:i||"Müşteri hareketi",companyId:n,referenceType:o,referenceId:l,lines:[{accountCode:"120",amount:Math.abs(r),currency:a,side:r>=0?"debit":"credit",description:"Müşteri cari"},{accountCode:"600",amount:Math.abs(r),currency:a,side:r>=0?"credit":"debit",description:"Satış gelirleri"}]})},_O=async e=>{const{customerId:t,amount:r,currency:a="TRY",companyId:n,description:i,referenceType:o,referenceId:l}=e;if(r<=0)throw new Error("Tahsilat tutarı pozitif olmalıdır");const c=ir(qe,f_,t);await gy(qe,async u=>{const f=await u.get(c);if(!f.exists())throw new Error("Müşteri bulunamadı");const d=(f.data().balance||0)-r;u.update(c,{balance:d,updatedAt:ld()})}),await d_({customerId:t,companyId:n,date:new Date,type:"payment",amount:-r,currency:a,description:i||"Tahsilat",referenceType:o,referenceId:l}),await hx({date:new Date,description:i||"Tahsilat",companyId:n,referenceType:o,referenceId:l,lines:[{accountCode:"102",amount:r,currency:a,side:"debit",description:"Banka tahsilat"},{accountCode:"120",amount:r,currency:a,side:"credit",description:"Cari kapama"}]})},h_=async e=>{const{customerId:t,companyId:r}=e;let a=Ke(lt(qe,m1),ot("customerId","==",t),ua("date","desc"));return r&&(a=Ke(lt(qe,m1),ot("customerId","==",t),ot("companyId","==",r),ua("date","desc"))),(await lr(a)).docs.map(i=>{var l,c;const o=i.data();return{id:i.id,...o,date:(l=o.date)!=null&&l.toDate?o.date.toDate():o.date,createdAt:(c=o.createdAt)!=null&&c.toDate?o.createdAt.toDate():o.createdAt}})},p_=async e=>{const{customerId:t,companyId:r,asOf:a=new Date}=e,n=await h_({customerId:t,companyId:r}),i={bucket0_30:0,bucket31_60:0,bucket61_90:0,bucket90plus:0,total:0};return n.forEach(o=>{const l=Math.floor((a.getTime()-o.date.getTime())/864e5),c=o.amount;l<=30?i.bucket0_30+=c:l<=60?i.bucket31_60+=c:l<=90?i.bucket61_90+=c:i.bucket90plus+=c,i.total+=c}),i},Vd="quotes",kO=async e=>(await Or(lt(qe,Vd),{...e,quoteDate:Ye.fromDate(e.quoteDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,m_=async e=>{let t=Ke(lt(qe,Vd),ua("quoteDate","desc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l;const n=a.data();return{id:a.id,...n,quoteDate:(i=n.quoteDate)!=null&&i.toDate?n.quoteDate.toDate():n.quoteDate,createdAt:(o=n.createdAt)!=null&&o.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(l=n.updatedAt)!=null&&l.toDate?n.updatedAt.toDate():n.updatedAt}})},px=async(e,t)=>{const r=ir(qe,Vd,e),a={...t,updatedAt:Ye.now()};t.quoteDate&&(a.quoteDate=Ye.fromDate(t.quoteDate)),await Xr(r,a)},SO=async e=>{const t=ir(qe,Vd,e);await os(t)},x_=e=>{const t=new ht({orientation:"portrait",unit:"mm",format:"a4",compress:!0,putOnlyUsedFonts:!0,floatPrecision:16});t.setProperties({title:"Fatura",subject:"Fatura Belgesi",author:"Kaptan ERP",creator:"Kaptan ERP"});const r=t.internal.pageSize.getWidth(),a=t.internal.pageSize.getHeight(),n=20;let i=n;t.setFillColor(240,240,240),t.rect(n,i,r-2*n,25,"F"),t.setFontSize(24),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("FATURA",r/2,i+16,{align:"center"}),i+=35,t.setFontSize(10),t.setFont("helvetica","normal"),t.setTextColor(100,100,100);const o=r-n-50;t.text("Fatura No:",o,i),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text(e.invoiceNumber,o+25,i),i+=6,t.setFont("helvetica","normal"),t.setTextColor(100,100,100),t.text("Tarih:",o,i),t.setFont("helvetica","bold"),t.setTextColor(0,0,0);const l=new Date(e.issueDate);t.text(l.toLocaleDateString("tr-TR"),o+25,i),i+=6,t.setFont("helvetica","normal"),t.setTextColor(100,100,100),t.text("Para Birimi:",o,i),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text(e.currency,o+25,i),i+=15;const c=i,u=(r-3*n)/2;t.setFillColor(250,250,250),t.rect(n,c,u,40,"F"),t.setDrawColor(200,200,200),t.setLineWidth(.5),t.rect(n,c,u,40,"D"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("SATICI",n+u/2,c+8,{align:"center"}),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("Sirket Adi",n+8,c+15),t.text("Vergi No",n+8,c+22),t.text("Adres",n+8,c+29),t.text("Telefon",n+8,c+36);const h=n+u+n;t.setFillColor(250,250,250),t.rect(h,c,u,40,"F"),t.setDrawColor(200,200,200),t.rect(h,c,u,40,"D"),t.setFontSize(11),t.setFont("helvetica","bold"),t.text("ALICI",h+u/2,c+8,{align:"center"}),t.setFont("helvetica","normal"),t.setFontSize(10);const d=(e.customerName||"").length>25?(e.customerName||"").substring(0,22)+"...":e.customerName||"";t.text(d,h+8,c+15),t.text(e.customerVknTckn||"",h+8,c+22),i=c+50,i+=5,t.setFillColor(60,60,60),t.rect(n,i,r-2*n,10,"F"),t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(255,255,255);const v=r-2*n-10,m=2,y={no:7,name:45,qty:14,unit:12,unitPrice:22,discount:16,vatRate:14,net:22,vat:18,total:22},_=(Object.keys(y).length-1)*m,k=Object.values(y).reduce((I,D)=>I+D,0)+_;if(k>v){const I=v/k;Object.keys(y).forEach(D=>{y[D]=Math.floor(y[D]*I)})}let g=n+3;t.text("#",g,i+7),g+=y.no+m,t.text("Aciklama",g,i+7),g+=y.name+m,t.text("Miktar",g+y.qty,i+7,{align:"right"}),g+=y.qty+m,t.text("Birim",g,i+7),g+=y.unit+m,t.text("Birim Fiyat",g+y.unitPrice,i+7,{align:"right"}),g+=y.unitPrice+m,t.text("Iskonto",g+y.discount,i+7,{align:"right"}),g+=y.discount+m,t.text("KDV %",g+y.vatRate,i+7,{align:"right"}),g+=y.vatRate+m,t.text("Net Tutar",g+y.net,i+7,{align:"right"}),g+=y.net+m,t.text("KDV",g+y.vat,i+7,{align:"right"}),g+=y.vat+m,t.text("Toplam",g+y.total,i+7,{align:"right"}),i+=12,t.setTextColor(0,0,0),t.setFont("helvetica","normal"),t.setFontSize(9);let w=0,C=0,E=0;e.lines.forEach((I,D)=>{i>a-60&&(t.addPage(),i=n);const B=I.qty*I.unitPrice*(I.discountPercent?1-I.discountPercent/100:1),L=B*(I.vatRate/100),F=B+L;w+=B,C+=L,E+=F,D%2===0&&(t.setFillColor(250,250,250),t.rect(n,i-5,r-2*n,8,"F")),g=n+3,t.text(String(D+1),g,i),g+=y.no+m;const z=Math.floor(y.name/2.5),M=I.name.length>z?I.name.substring(0,z-3)+"...":I.name;if(t.text(M,g,i),g+=y.name+m,t.text(I.qty.toFixed(2),g+y.qty,i,{align:"right"}),g+=y.qty+m,t.text("Adet",g,i),g+=y.unit+m,t.text(I.unitPrice.toFixed(2),g+y.unitPrice,i,{align:"right"}),g+=y.unitPrice+m,t.text(I.discountPercent?`%${I.discountPercent}`:"-",g+y.discount,i,{align:"right"}),g+=y.discount+m,t.text(`%${I.vatRate}`,g+y.vatRate,i,{align:"right"}),g+=y.vatRate+m,t.text(B.toFixed(2),g+y.net,i,{align:"right"}),g+=y.net+m,t.text(L.toFixed(2),g+y.vat,i,{align:"right"}),g+=y.vat+m,t.text(F.toFixed(2),g+y.total,i,{align:"right"}),i+=8,I.lineCurrency&&I.lineCurrency!==e.currency){const q=I.exchangeRate||1,fe=I.unitPrice/q;t.setFontSize(8),t.setTextColor(100,100,100),t.text(`   Orijinal: ${fe.toFixed(2)} ${I.lineCurrency} | Kur: 1 ${I.lineCurrency} = ${q.toFixed(4)} ${e.currency}`,n+y.no,i),t.setFontSize(9),t.setTextColor(0,0,0),i+=5}}),i+=3,t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(n,i,r-n,i),i+=8,t.setFontSize(10),t.setFont("helvetica","bold");const A=n+3+y.no+m+y.name+m+y.qty+m+y.unit+m+y.unitPrice+m+y.discount+m+y.vatRate+m;g=A,t.text("ARA TOPLAM:",g,i),g+=y.net+m,t.text(w.toFixed(2),g+y.net,i,{align:"right"}),g+=y.net+m,t.text(C.toFixed(2),g+y.vat,i,{align:"right"}),g+=y.vat+m,t.text(E.toFixed(2),g+y.total,i,{align:"right"}),i+=8,t.setFontSize(12),g=A,t.text("GENEL TOPLAM:",g,i),g+=y.net+m+y.vat+m,t.setFontSize(14),t.text(`${E.toFixed(2)} ${e.currency}`,g+y.total,i,{align:"right"}),i=a-20,t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(150,150,150),t.text("Bu belge elektronik ortamda olusturulmustur. GIB entegrasyonu yoktur.",r/2,i,{align:"center"}),t.save(`fatura_${e.invoiceNumber}.pdf`)},AO=e=>{const t=new ht({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),r=t.internal.pageSize.getWidth(),a=t.internal.pageSize.getHeight(),n=20;let i=n;t.setFillColor(240,240,240),t.rect(n,i,r-2*n,25,"F"),t.setFontSize(24),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("E-İRSALİYE",r/2,i+16,{align:"center"}),i+=35,t.setFontSize(10),t.setFont("helvetica","normal"),t.setTextColor(100,100,100);const o=r-n-50;t.text("İrsaliye No:",o,i),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text(e.despatchNumber,o+25,i),i+=6,t.setFont("helvetica","normal"),t.setTextColor(100,100,100),t.text("Tarih:",o,i),t.setFont("helvetica","bold"),t.setTextColor(0,0,0);const l=new Date(e.issueDate);t.text(l.toLocaleDateString("tr-TR"),o+25,i),i+=15;const c=i,u=(r-3*n)/2;t.setFillColor(250,250,250),t.rect(n,c,u,40,"F"),t.setDrawColor(200,200,200),t.setLineWidth(.5),t.rect(n,c,u,40,"D"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("GÖNDEREN",n+u/2,c+8,{align:"center"}),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("Sirket Adi",n+8,c+15),t.text("Vergi No",n+8,c+22),t.text("Adres",n+8,c+29),t.text("Telefon",n+8,c+36);const h=n+u+n;t.setFillColor(250,250,250),t.rect(h,c,u,40,"F"),t.setDrawColor(200,200,200),t.rect(h,c,u,40,"D"),t.setFontSize(11),t.setFont("helvetica","bold"),t.text("ALICI",h+u/2,c+8,{align:"center"}),t.setFont("helvetica","normal"),t.setFontSize(10);const d=(e.customerName||"").length>25?(e.customerName||"").substring(0,22)+"...":e.customerName||"";t.text(d,h+8,c+15),t.text(e.customerVknTckn||"",h+8,c+22),i=c+50,i+=5,t.setFillColor(60,60,60),t.rect(n,i,r-2*n,10,"F"),t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(255,255,255);const v=2,m={no:10,name:100,qty:25,unit:25},y=r-2*n-10,_=(Object.keys(m).length-1)*v,k=Object.values(m).reduce((C,E)=>C+E,0)+_;if(k>y){const C=y/k;Object.keys(m).forEach(E=>{m[E]=Math.floor(m[E]*C)})}let g=n+3;t.text("#",g,i+7),g+=m.no+v,t.text("Aciklama",g,i+7),g+=m.name+v,t.text("Miktar",g+m.qty,i+7,{align:"right"}),g+=m.qty+v,t.text("Birim",g,i+7),i+=12,t.setTextColor(0,0,0),t.setFont("helvetica","normal"),t.setFontSize(10),e.items.forEach((C,E)=>{i>a-40&&(t.addPage(),i=n),E%2===0&&(t.setFillColor(250,250,250),t.rect(n,i-5,r-2*n,8,"F")),g=n+3,t.text(String(E+1),g,i),g+=m.no+v;const A=Math.floor(m.name/2.5),I=C.name.length>A?C.name.substring(0,A-3)+"...":C.name;t.text(I,g,i),g+=m.name+v,t.text(C.qty.toString(),g+m.qty,i,{align:"right"}),g+=m.qty+v,t.text(C.unit,g,i),i+=8}),i+=3,t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(n,i,r-n,i),i+=8;const w=e.items.reduce((C,E)=>C+E.qty,0);t.setFontSize(11),t.setFont("helvetica","bold"),g=n+m.no+m.name,t.text("TOPLAM:",g,i),g+=m.qty,t.text(w.toString(),g,i),i=a-20,t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(150,150,150),t.text("Bu belge elektronik ortamda olusturulmustur. GIB entegrasyonu yoktur.",r/2,i,{align:"center"}),t.save(`irsaliye_${e.despatchNumber}.pdf`)},g_=e=>{const t=o=>{const l=o.quantity*o.unitPrice,c=o.discountPercent?l*(o.discountPercent/100):0;return{gross:l,discount:c,net:l-c}},r=e.lines.reduce((o,l)=>o+t(l).net,0),a=e.lines.reduce((o,l)=>o+t(l).net*(l.vatRate/100),0),n=e.lines.reduce((o,l)=>o+t(l).net*(l.withholdingRate||0),0),i=e.lines.map((o,l)=>`
    <cac:InvoiceLine>
      <cbc:ID>${l+1}</cbc:ID>
      <cbc:InvoicedQuantity>${o.quantity}</cbc:InvoicedQuantity>
      <cbc:LineExtensionAmount currencyID="${e.currency}">${t(o).net.toFixed(2)}</cbc:LineExtensionAmount>
      <cac:Item><cbc:Name>${k0(o.name)}</cbc:Name></cac:Item>
      <cac:Price><cbc:PriceAmount currencyID="${e.currency}">${o.unitPrice.toFixed(2)}</cbc:PriceAmount></cac:Price>
      ${o.discountPercent?`<cac:AllowanceCharge><cbc:ChargeIndicator>false</cbc:ChargeIndicator><cbc:AllowanceChargeReason>İskonto</cbc:AllowanceChargeReason><cbc:MultiplierFactorNumeric>${o.discountPercent}</cbc:MultiplierFactorNumeric></cac:AllowanceCharge>`:""}
      <cac:TaxTotal>
        <cbc:TaxAmount currencyID="${e.currency}">${(t(o).net*(o.vatRate/100)).toFixed(2)}</cbc:TaxAmount>
      </cac:TaxTotal>
    </cac:InvoiceLine>`).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<Invoice xmlns:cac="urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2"
         xmlns:cbc="urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2">
  <cbc:ProfileID>${e.scenario==="E_FATURA"?"TEMELFATURA":"EARSIVFATURA"}</cbc:ProfileID>
  <cbc:ID>${e.invoiceNumber}</cbc:ID>
  <cbc:IssueDate>${e.issueDate}</cbc:IssueDate>
  <cbc:DocumentCurrencyCode>${e.currency}</cbc:DocumentCurrencyCode>
  <cac:AccountingCustomerParty>
    <cac:Party>
      <cac:PartyName><cbc:Name>${k0(e.customerName)}</cbc:Name></cac:PartyName>
      <cac:PartyIdentification><cbc:ID>${e.customerVknTckn}</cbc:ID></cac:PartyIdentification>
    </cac:Party>
  </cac:AccountingCustomerParty>
  <cac:LegalMonetaryTotal>
    <cbc:LineExtensionAmount currencyID="${e.currency}">${r.toFixed(2)}</cbc:LineExtensionAmount>
    <cbc:TaxExclusiveAmount currencyID="${e.currency}">${r.toFixed(2)}</cbc:TaxExclusiveAmount>
    <cbc:TaxInclusiveAmount currencyID="${e.currency}">${(r+a-n).toFixed(2)}</cbc:TaxInclusiveAmount>
    <cbc:PayableAmount currencyID="${e.currency}">${(r+a-n).toFixed(2)}</cbc:PayableAmount>
  </cac:LegalMonetaryTotal>
  ${i}
</Invoice>`},NO=e=>{const t=e.lines.map((r,a)=>`
    <cac:DespatchLine>
      <cbc:ID>${a+1}</cbc:ID>
      <cbc:DeliveredQuantity unitCode="${k0(r.unit)}">${r.quantity}</cbc:DeliveredQuantity>
      <cac:Item><cbc:Name>${k0(r.name)}</cbc:Name></cac:Item>
    </cac:DespatchLine>`).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<DespatchAdvice xmlns:cac="urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2"
                xmlns:cbc="urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2">
  <cbc:ID>${e.despatchNumber}</cbc:ID>
  <cbc:IssueDate>${e.issueDate}</cbc:IssueDate>
  <cac:DespatchSupplierParty>
    <cac:Party>
      <cac:PartyName><cbc:Name>Tedarikçi</cbc:Name></cac:PartyName>
    </cac:Party>
  </cac:DespatchSupplierParty>
  <cac:DeliveryCustomerParty>
    <cac:Party>
      <cac:PartyName><cbc:Name>${k0(e.customerName)}</cbc:Name></cac:PartyName>
      <cac:PartyIdentification><cbc:ID>${e.customerVknTckn}</cbc:ID></cac:PartyIdentification>
    </cac:Party>
  </cac:DeliveryCustomerParty>
  ${t}
</DespatchAdvice>`},k0=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),mx="invoices",jO=async e=>(await Or(lt(qe,mx),{...e,date:Ye.fromDate(e.date),createdAt:Ye.now(),updatedAt:Ye.now()})).id,TO=async e=>{let t=Ke(lt(qe,mx),ua("date","desc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l;const n=a.data();return{id:a.id,...n,date:(i=n.date)!=null&&i.toDate?n.date.toDate():n.date,createdAt:(o=n.createdAt)!=null&&o.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(l=n.updatedAt)!=null&&l.toDate?n.updatedAt.toDate():n.updatedAt}})},EO=async(e,t)=>{const r=ir(qe,mx,e),a={...t,updatedAt:Ye.now()};t.date&&(a.date=Ye.fromDate(t.date)),await Xr(r,a)};function CO(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState([]),[c,u]=ue.useState([]),[f,h]=ue.useState([]),[p,d]=ue.useState([]),[v,m]=ue.useState(!0),[y,_]=ue.useState(!1),[k,g]=ue.useState({customerId:"",status:"",startDate:"",endDate:""}),[w,C]=ue.useState({shipmentNumber:"",shipmentDate:new Date().toISOString().split("T")[0],customerId:"",customerName:"",warehouse:"",orderId:"",orderNumber:"",quoteId:"",quoteNumber:"",items:[],notes:"",status:"pending"}),[E,A]=ue.useState({scenario:"E_ARSIV",currency:"TRY"}),[I,D]=ue.useState({sku:"",variant:"",materialName:"",quantity:"",unit:"",unitPrice:"",warehouse:"",binCode:"",serialLot:"",expiryDate:"",vatRate:"",currency:"",exchangeRate:"1"});ue.useEffect(()=>{B()},[k]);const B=async()=>{try{m(!0);const N=gt(),[O,H,ae,de,me,xe,Se]=await Promise.all([ox({companyId:N==null?void 0:N.companyId,customerId:k.customerId||void 0,status:k.status||void 0,startDate:k.startDate?new Date(k.startDate):void 0,endDate:k.endDate?new Date(k.endDate):void 0}),To(N==null?void 0:N.companyId),gc(N==null?void 0:N.companyId),tu(N==null?void 0:N.companyId),Wd(N==null?void 0:N.companyId),Md({companyId:N==null?void 0:N.companyId}),m_(N==null?void 0:N.companyId)]);t(O),a(H),i(ae),l(de),u(me),h(xe),d(Se)}catch(N){console.error("Veriler yüklenirken hata:",N);const O=localStorage.getItem("currentUser"),H=O?JSON.parse(O):null;await ur(`Sevkiyat verileri yüklenirken hata: ${N.message||N}`,"ShipmentManagement",H==null?void 0:H.id,H==null?void 0:H.username),alert("Veriler yüklenirken bir hata oluştu")}finally{m(!1)}},L=()=>{if(!I.materialName||!I.quantity||!I.unit){alert("Lütfen malzeme, miktar ve birim girin");return}const N=parseFloat(I.quantity);let O=parseFloat(I.unitPrice);const H=I.exchangeRate?parseFloat(I.exchangeRate):1,ae=I.currency||E.currency;let de,me,xe;if(isNaN(N)||N<=0){alert("Geçerli sayısal değerler girin");return}if(isNaN(O)||O<0){const $e=r.find(Oe=>Oe.id===w.customerId),J=ix(I.materialName,w.customerId,$e==null?void 0:$e.group,c,N,ae);J?(me=J.price,de=J.discountPercent,O=J.discountPercent?J.price*(1-J.discountPercent/100):J.price,xe=J.customerId?"Müşteri kuralı":J.customerGroup?`Grup: ${J.customerGroup}`:"Genel kural"):O=0}const Se=n.find($e=>$e.materialName===I.materialName&&$e.warehouse===(I.warehouse||void 0));if(!Se||Se.currentStock<N){alert(`Yetersiz stok! Mevcut stok: ${(Se==null?void 0:Se.currentStock)||0} ${(Se==null?void 0:Se.unit)||""}`);return}const Z=ae===E.currency?O:O*(H||1),Fe={materialName:I.materialName,sku:I.sku||void 0,variant:I.variant||void 0,quantity:N,unit:I.unit,unitPrice:Z,totalPrice:N*Z,discountPercent:de,listPrice:me,priceRuleNote:xe,vatRate:I.vatRate?parseFloat(I.vatRate):void 0,currency:ae,exchangeRate:H||1,warehouse:I.warehouse||void 0,binCode:I.binCode||void 0,serialLot:I.serialLot||void 0,expiryDate:I.expiryDate?new Date(I.expiryDate):void 0};C({...w,items:[...w.items,Fe]}),D({sku:"",variant:"",materialName:"",quantity:"",unit:"",unitPrice:"",warehouse:w.warehouse,binCode:"",serialLot:"",expiryDate:"",vatRate:"",currency:E.currency,exchangeRate:"1"})},F=N=>{C({...w,items:w.items.filter((O,H)=>H!==N)})},z=async N=>{if(N.preventDefault(),!w.customerId){alert("Lütfen müşteri seçin");return}if(w.items.length===0){alert("En az bir ürün eklemelisiniz");return}const O=w.items.reduce((Se,Z)=>Se+Z.totalPrice,0),H=ml(),ae=gt(),de=r.find(Se=>Se.id===w.customerId),me=(de==null?void 0:de.balance)||0,xe=de==null?void 0:de.creditLimit;if(xe!==void 0&&xe>0&&me+O>xe){alert(`Kredi limiti aşılıyor. Limit: ${xe.toFixed(2)} ₺, Mevcut Bakiye: ${me.toFixed(2)} ₺, Yeni Sevkiyat: ${O.toFixed(2)} ₺`);return}try{const Se={shipmentNumber:w.shipmentNumber||G2(),shipmentDate:new Date(w.shipmentDate),customerId:w.customerId,customerName:w.customerName,items:w.items,totalAmount:O,status:w.status,notes:w.notes,warehouse:w.warehouse||void 0,orderId:w.orderId||void 0,orderNumber:w.orderNumber||void 0,quoteId:w.quoteId||void 0,quoteNumber:w.quoteNumber||void 0,currency:E.currency||"TRY",companyId:ae==null?void 0:ae.companyId,createdBy:H==null?void 0:H.id};await TL(Se),de!=null&&de.id&&await wO({customerId:de.id,amount:O,currency:"TRY",companyId:ae==null?void 0:ae.companyId,description:`Sevkiyat ${Se.shipmentNumber}`,referenceType:"shipment",referenceId:Se.shipmentNumber}),await tb({userId:H==null?void 0:H.id,username:H==null?void 0:H.username,userEmail:H==null?void 0:H.email,personnelId:H==null?void 0:H.personnelId,personnelName:H==null?void 0:H.fullName,action:`Sevkiyat Oluşturuldu: ${Se.shipmentNumber} - ${w.customerName}`,module:"shipment",details:JSON.stringify({shipmentNumber:Se.shipmentNumber,customerName:w.customerName,itemCount:w.items.length,totalAmount:O}),companyId:ae==null?void 0:ae.companyId}),alert("Sevkiyat başarıyla oluşturuldu!"),_(!1),M(),B()}catch(Se){const Z=localStorage.getItem("currentUser"),Fe=Z?JSON.parse(Z):null;await ur(`Sevkiyat oluşturulurken hata: ${Se.message||Se}`,"ShipmentManagement",Fe==null?void 0:Fe.id,Fe==null?void 0:Fe.username),alert("Hata: "+(Se.message||"Sevkiyat oluşturulurken bir hata oluştu"))}},M=()=>{C({shipmentNumber:"",shipmentDate:new Date().toISOString().split("T")[0],customerId:"",customerName:"",warehouse:"",orderId:"",orderNumber:"",quoteId:"",quoteNumber:"",items:[],notes:"",status:"pending"}),D({sku:"",variant:"",materialName:"",quantity:"",unit:"",unitPrice:"",warehouse:"",binCode:"",serialLot:"",expiryDate:"",vatRate:"18",currency:"TRY",exchangeRate:"1"})},q=N=>{const O=r.find(H=>H.id===N);C({...w,customerId:N,customerName:(O==null?void 0:O.name)||"",orderId:"",orderNumber:"",quoteId:"",quoteNumber:""})},fe=async(N,O)=>{try{await EL(N,O);const H=e.find(ae=>ae.id===N);if(H){if(H.orderId){const ae=O==="delivered"?"completed":O==="shipped"?"in_progress":O==="cancelled"?"cancelled":void 0;ae&&await rd(H.orderId,{status:ae})}if(H.quoteId){const ae=O==="delivered"?"accepted":O==="cancelled"?"rejected":void 0;ae&&await px(H.quoteId,{status:ae})}}alert("Sevkiyat durumu güncellendi!"),B()}catch(H){alert("Hata: "+(H.message||"Durum güncellenirken bir hata oluştu"))}},he=async N=>{try{const O=r.find(H=>H.id===N.customerId);await vO(N,O)}catch(O){alert("PDF oluşturulurken hata: "+O.message)}},pe=async N=>{var O;try{const H=r.find(Fe=>Fe.id===N.customerId),ae=`FAT-${N.shipmentNumber}`,de=N.shipmentDate.toISOString().split("T")[0],me=E.currency||"TRY",xe=(H==null?void 0:H.taxNumber)||"1111111111",Se=N.items.map(Fe=>({name:Fe.materialName,qty:Fe.quantity,unitPrice:Fe.unitPrice,vatRate:Fe.vatRate!==void 0?Fe.vatRate:18,discountPercent:Fe.discountPercent,lineCurrency:Fe.currency,exchangeRate:Fe.exchangeRate}));await x_({invoiceNumber:ae,issueDate:de,customerName:N.customerName,customerVknTckn:xe,currency:me,lines:Se});const Z=g_({invoiceNumber:ae,issueDate:de,scenario:E.scenario,currency:me,customerName:N.customerName,customerVknTckn:xe,lines:Se.map(Fe=>({name:Fe.name,quantity:Fe.qty,unitPrice:Fe.unitPrice,vatRate:Fe.vatRate,discountPercent:Fe.discountPercent}))});Q(Z,`${ae}.xml`),await jO({invoiceNumber:ae,date:new Date(de),customerId:N.customerId,customerName:N.customerName,currency:me,totalAmount:N.totalAmount,status:"issued",items:N.items.map(Fe=>({materialName:Fe.materialName,quantity:Fe.quantity,unit:Fe.unit,unitPrice:Fe.unitPrice,vatRate:Fe.vatRate,discountPercent:Fe.discountPercent})),shipmentId:N.id,shipmentNumber:N.shipmentNumber,orderId:N.orderId,orderNumber:N.orderNumber,companyId:(O=gt())==null?void 0:O.companyId}),N.orderId&&await rd(N.orderId,{status:"completed"}),alert("Fatura oluşturuldu, PDF/UBL indirildi ve kayıt eklendi.")}catch(H){alert("Fatura oluşturulurken hata: "+(H.message||H))}},Q=(N,O)=>{const H=new Blob([N],{type:"text/xml;charset=utf-8"}),ae=URL.createObjectURL(H),de=document.createElement("a");de.href=ae,de.download=O,de.click(),URL.revokeObjectURL(ae)},we=N=>{switch(N){case"delivered":return s.jsx(mc,{size:16,color:"#28a745"});case"shipped":return s.jsx(Of,{size:16,color:"#007bff"});case"preparing":return s.jsx(Ls,{size:16,color:"#ffc107"});case"cancelled":return s.jsx(dd,{size:16,color:"#dc3545"});default:return s.jsx(Cp,{size:16,color:"#6c757d"})}},Y=N=>({pending:"Beklemede",preparing:"Hazırlanıyor",shipped:"Sevk Edildi",delivered:"Teslim Edildi",cancelled:"İptal Edildi"})[N]||N,T=w.warehouse?n.filter(N=>N.currentStock>0&&N.warehouse===w.warehouse):n.filter(N=>N.currentStock>0&&!N.warehouse),R=n.find(N=>N.materialName===I.materialName&&N.warehouse===(I.warehouse||void 0));return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(Of,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"36px",fontWeight:"700",color:"#000",letterSpacing:"-1px"},children:"Sevkiyat Yönetimi"})]}),s.jsxs("button",{onClick:()=>_(!0),className:"btn btn-primary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Yr,{size:18}),"Yeni Sevkiyat"]})]}),s.jsx("div",{style:{marginBottom:"16px",padding:"12px",border:"1px solid #ddd",background:"#fff"},children:s.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexWrap:"wrap"},children:[s.jsx("strong",{children:"Fatura Ayarları:"}),s.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[s.jsx("span",{children:"Senaryo"}),s.jsxs("select",{className:"excel-form-select",value:E.scenario,onChange:N=>A({...E,scenario:N.target.value}),children:[s.jsx("option",{value:"E_ARSIV",children:"e-Arşiv"}),s.jsx("option",{value:"E_FATURA",children:"e-Fatura"})]})]}),s.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[s.jsx("span",{children:"Para Birimi"}),s.jsx("input",{className:"excel-form-input",style:{width:"100px"},value:E.currency,onChange:N=>A({...E,currency:N.target.value})})]})]})}),s.jsxs("div",{className:"filter-section",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",color:"#000",letterSpacing:"0.5px",textTransform:"uppercase"},children:"Filtrele"}),s.jsx("button",{onClick:()=>g({customerId:"",status:"",startDate:"",endDate:""}),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},children:"Filtreleri Temizle"})]}),s.jsxs("div",{className:"filter-row",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Müşteri"}),s.jsxs("select",{className:"excel-form-select",value:k.customerId,onChange:N=>g({...k,customerId:N.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),r.map(N=>s.jsx("option",{value:N.id,children:N.name},N.id))]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Durum"}),s.jsxs("select",{className:"excel-form-select",value:k.status,onChange:N=>g({...k,status:N.target.value}),children:[s.jsx("option",{value:"",children:"Tümü"}),s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"preparing",children:"Hazırlanıyor"}),s.jsx("option",{value:"shipped",children:"Sevk Edildi"}),s.jsx("option",{value:"delivered",children:"Teslim Edildi"}),s.jsx("option",{value:"cancelled",children:"İptal Edildi"})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Başlangıç Tarihi"}),s.jsx("input",{type:"date",className:"excel-form-input",value:k.startDate,onChange:N=>g({...k,startDate:N.target.value})})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"excel-form-label",children:"Bitiş Tarihi"}),s.jsx("input",{type:"date",className:"excel-form-input",value:k.endDate,onChange:N=>g({...k,endDate:N.target.value})})]})]})]}),y&&s.jsxs("div",{className:"excel-form",style:{marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#000",letterSpacing:"0.3px",textTransform:"uppercase"},children:"Yeni Sevkiyat"}),s.jsx("button",{onClick:()=>{_(!1),M()},style:{background:"none",border:"none",cursor:"pointer"},children:s.jsx(ea,{size:24,color:"#7f8c8d"})})]}),s.jsxs("form",{onSubmit:z,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Sevkiyat No"}),s.jsx("input",{type:"text",className:"excel-form-input",value:w.shipmentNumber||G2(),onChange:N=>C({...w,shipmentNumber:N.target.value}),placeholder:"Otomatik oluşturulur"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Sevkiyat Tarihi *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:w.shipmentDate,onChange:N=>C({...w,shipmentDate:N.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Müşteri *"}),s.jsxs("select",{className:"excel-form-select",value:w.customerId,onChange:N=>q(N.target.value),required:!0,disabled:r.length===0,children:[s.jsx("option",{value:"",children:"Seçiniz"}),r.map(N=>s.jsxs("option",{value:N.id,children:[N.name," ",N.companyName&&`(${N.companyName})`]},N.id))]}),r.length===0&&s.jsx("div",{style:{fontSize:"12px",color:"#dc3545",marginTop:"4px"},children:"Önce müşteri kaydı yapılmalıdır. Müşteri Yönetimi sayfasından ekleyin."})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Depo"}),s.jsxs("select",{className:"excel-form-select",value:w.warehouse,onChange:N=>{C({...w,warehouse:N.target.value}),D({...I,warehouse:N.target.value})},children:[s.jsx("option",{value:"",children:"Depo Seçiniz (Opsiyonel)"}),o.map(N=>s.jsx("option",{value:N.name,children:N.name},N.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Sipariş Bağı"}),s.jsxs("select",{className:"excel-form-select",value:w.orderId,onChange:N=>{const O=N.target.value,H=f.find(ae=>ae.id===O);C({...w,orderId:O,orderNumber:(H==null?void 0:H.orderNumber)||"",quoteId:"",quoteNumber:""})},children:[s.jsx("option",{value:"",children:"Seçiniz (opsiyonel)"}),f.map(N=>s.jsxs("option",{value:N.id,children:[N.orderNumber," - ",N.customerName||"-"]},N.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Teklif Bağı"}),s.jsxs("select",{className:"excel-form-select",value:w.quoteId,onChange:N=>{const O=N.target.value,H=p.find(ae=>ae.id===O);C({...w,quoteId:O,quoteNumber:(H==null?void 0:H.quoteNumber)||"",orderId:"",orderNumber:""})},children:[s.jsx("option",{value:"",children:"Seçiniz (opsiyonel)"}),p.map(N=>s.jsxs("option",{value:N.id,children:[N.quoteNumber," - ",N.customerName||"-"]},N.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Durum"}),s.jsxs("select",{className:"excel-form-select",value:w.status,onChange:N=>C({...w,status:N.target.value}),children:[s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"preparing",children:"Hazırlanıyor"}),s.jsx("option",{value:"shipped",children:"Sevk Edildi"}),s.jsx("option",{value:"delivered",children:"Teslim Edildi"})]})]})]}),s.jsxs("div",{style:{marginTop:"20px",padding:"20px",border:"2px solid #000",background:"white"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"15px"},children:"Ürün Ekle"}),s.jsxs("div",{className:"grid-4",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKU"}),s.jsx("input",{type:"text",className:"excel-form-input",value:I.sku,onChange:N=>D({...I,sku:N.target.value}),placeholder:"Ürün SKU (opsiyonel)"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Varyant"}),s.jsx("input",{type:"text",className:"excel-form-input",value:I.variant,onChange:N=>D({...I,variant:N.target.value}),placeholder:"Örn: Kırmızı-M"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Malzeme *"}),s.jsxs("select",{className:"excel-form-select",value:I.materialName,onChange:N=>{const O=n.find(H=>H.materialName===N.target.value);D({...I,materialName:N.target.value,unit:(O==null?void 0:O.unit)||"",unitPrice:"0"})},required:!0,disabled:T.length===0,children:[s.jsx("option",{value:"",children:"Seçiniz"}),T.map(N=>s.jsxs("option",{value:N.materialName,children:[N.materialName," ",N.warehouse&&`(${N.warehouse})`," (Mevcut: ",N.currentStock," ",N.unit,")"]},`${N.materialName}-${N.warehouse||"no-warehouse"}`))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Miktar *"}),s.jsx("input",{type:"number",step:"0.01",className:"excel-form-input",value:I.quantity,onChange:N=>D({...I,quantity:N.target.value}),required:!0,max:(R==null?void 0:R.currentStock)||0}),R&&s.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:["Maksimum: ",R.currentStock," ",R.unit]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Birim"}),s.jsx("input",{type:"text",className:"excel-form-input",value:I.unit,readOnly:!0,style:{background:"#f5f5f5"}})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Birim Fiyat (₺) *"}),s.jsx("input",{type:"number",step:"0.01",className:"excel-form-input",value:I.unitPrice,onChange:N=>D({...I,unitPrice:N.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kalem Para Birimi"}),s.jsx("input",{type:"text",className:"excel-form-input",value:I.currency,onChange:N=>D({...I,currency:N.target.value}),placeholder:E.currency})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:`Kur (-> ${E.currency})`}),s.jsx("input",{type:"number",step:"0.0001",className:"excel-form-input",value:I.exchangeRate,onChange:N=>D({...I,exchangeRate:N.target.value}),placeholder:"1"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"KDV (%)"}),s.jsx("input",{type:"number",step:"0.01",className:"excel-form-input",value:I.vatRate,onChange:N=>D({...I,vatRate:N.target.value}),placeholder:"Örn: 18"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Raf/Göz (Bin)"}),s.jsx("input",{type:"text",className:"excel-form-input",value:I.binCode,onChange:N=>D({...I,binCode:N.target.value}),placeholder:"Örn: A-01-03"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Seri/Lot"}),s.jsx("input",{type:"text",className:"excel-form-input",value:I.serialLot,onChange:N=>D({...I,serialLot:N.target.value}),placeholder:"Lot veya seri no"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKT"}),s.jsx("input",{type:"date",className:"excel-form-input",value:I.expiryDate,onChange:N=>D({...I,expiryDate:N.target.value})})]})]}),s.jsx("button",{type:"button",onClick:L,className:"btn btn-secondary",style:{marginTop:"10px"},children:"Ürün Ekle"})]}),w.items.length>0&&s.jsxs("div",{style:{marginTop:"20px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"15px"},children:"Ürün Listesi"}),s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Malzeme"}),s.jsx("th",{children:"Varyant"}),s.jsx("th",{children:"Miktar"}),s.jsx("th",{children:"Birim"}),s.jsx("th",{children:"Birim Fiyat"}),s.jsx("th",{children:"Raf/Göz"}),s.jsx("th",{children:"Seri/Lot"}),s.jsx("th",{children:"SKT"}),s.jsx("th",{children:"Toplam"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:w.items.map((N,O)=>s.jsxs("tr",{children:[s.jsx("td",{children:N.sku||"-"}),s.jsx("td",{children:N.materialName}),s.jsx("td",{children:N.variant||"-"}),s.jsx("td",{children:N.quantity}),s.jsx("td",{children:N.unit}),s.jsx("td",{children:N.binCode||"-"}),s.jsx("td",{children:N.serialLot||"-"}),s.jsx("td",{children:N.expiryDate?new Date(N.expiryDate).toLocaleDateString("tr-TR"):"-"}),s.jsxs("td",{children:[N.unitPrice.toFixed(2)," ₺"]}),s.jsxs("td",{children:[N.totalPrice.toFixed(2)," ₺"]}),s.jsx("td",{children:s.jsx("button",{type:"button",onClick:()=>F(O),className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},children:s.jsx(ea,{size:14})})})]},O))}),s.jsx("tfoot",{children:s.jsxs("tr",{children:[s.jsx("td",{colSpan:4,style:{textAlign:"right",fontWeight:"700"},children:"TOPLAM:"}),s.jsxs("td",{style:{fontWeight:"700"},children:[w.items.reduce((N,O)=>N+O.totalPrice,0).toFixed(2)," ₺"]}),s.jsx("td",{})]})})]})]}),s.jsxs("div",{className:"excel-form-group",style:{marginTop:"20px"},children:[s.jsx("label",{className:"excel-form-label",children:"Notlar"}),s.jsx("textarea",{className:"excel-form-input",rows:3,value:w.notes,onChange:N=>C({...w,notes:N.target.value})})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:w.items.length===0||!w.customerId,children:"Kaydet"}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{_(!1),M()},children:"İptal"})]})]})]}),s.jsx("div",{className:"table-container",children:v?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz sevkiyat kaydı bulunmamaktadır."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Sevkiyat No"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Müşteri"}),s.jsx("th",{children:"Bağ"}),s.jsx("th",{children:"Ürün Sayısı"}),s.jsx("th",{children:"Toplam Tutar"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Depo"}),s.jsx("th",{children:"İşlemler"})]})}),s.jsx("tbody",{children:e.map(N=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:"500"},children:N.shipmentNumber}),s.jsx("td",{children:N.shipmentDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:N.customerName}),s.jsx("td",{children:N.orderNumber?`Sipariş: ${N.orderNumber}`:N.quoteNumber?`Teklif: ${N.quoteNumber}`:"-"}),s.jsx("td",{children:N.items.length}),s.jsxs("td",{children:[N.totalAmount.toFixed(2)," ₺"]}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[we(N.status),s.jsx("span",{children:Y(N.status)})]})}),s.jsx("td",{children:N.warehouse||"-"}),s.jsx("td",{children:s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsxs("button",{onClick:()=>N.id&&he(N),className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(Bs,{size:14}),"PDF"]}),s.jsxs("button",{onClick:()=>pe(N),className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(Bs,{size:14}),"Fatura"]}),s.jsxs("select",{value:N.status,onChange:O=>N.id&&fe(N.id,O.target.value),style:{padding:"4px 8px",fontSize:"12px",border:"2px solid #000",borderRadius:"0",background:"white"},children:[s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"preparing",children:"Hazırlanıyor"}),s.jsx("option",{value:"shipped",children:"Sevk Edildi"}),s.jsx("option",{value:"delivered",children:"Teslim Edildi"}),s.jsx("option",{value:"cancelled",children:"İptal Edildi"})]})]})})]},N.id))})]})})]})})}function FO(){const[e,t]=ue.useState([]),[r,a]=ue.useState(""),[n,i]=ue.useState([]),[o,l]=ue.useState(null),[c,u]=ue.useState(""),[f,h]=ue.useState(""),[p,d]=ue.useState(!0),[v,m]=ue.useState(!1);ue.useEffect(()=>{y()},[]),ue.useEffect(()=>{r?_(r):(i([]),l(null))},[r]);const y=async()=>{try{d(!0);const E=gt(),A=await To(E==null?void 0:E.companyId);t(A)}catch(E){console.error("Müşteri listesi yüklenirken hata:",E);const A=localStorage.getItem("currentUser"),I=A?JSON.parse(A):null;await ur(`Müşteri listesi yüklenirken hata: ${E.message||E}`,"CustomerPayments",I==null?void 0:I.id,I==null?void 0:I.username),alert("Veriler yüklenirken bir hata oluştu")}finally{d(!1)}},_=async E=>{try{d(!0);const A=gt(),I=await h_({customerId:E,companyId:A==null?void 0:A.companyId}),D=await p_({customerId:E,companyId:A==null?void 0:A.companyId});i(I),l(D)}catch(A){console.error("Müşteri hareketleri yüklenirken hata:",A),alert("Müşteri hareketleri yüklenirken bir hata oluştu")}finally{d(!1)}},k=async E=>{if(E.preventDefault(),!r){alert("Lütfen müşteri seçin");return}const A=parseFloat(c);if(isNaN(A)||A<=0){alert("Geçerli bir tahsilat tutarı girin");return}try{m(!0);const I=gt();await _O({customerId:r,amount:A,currency:"TRY",companyId:I==null?void 0:I.companyId,description:f||"Tahsilat"}),alert("Tahsilat kaydedildi"),u(""),h(""),_(r)}catch(I){console.error("Tahsilat kaydedilirken hata:",I),alert("Tahsilat kaydedilirken hata: "+(I.message||""))}finally{m(!1)}},g=e.find(E=>E.id===r),w=async()=>{if(!n.length){alert("Dışa aktarılacak hareket yok");return}const E=await xi(()=>Promise.resolve().then(()=>td),void 0),A=n.map(B=>({Tarih:new Date(B.date).toLocaleDateString("tr-TR"),Tür:B.type==="charge"?"Borç":"Tahsilat",Tutar:B.amount,Açıklama:B.description||"",Referans:B.referenceId||""})),I=E.utils.json_to_sheet(A),D=E.utils.book_new();E.utils.book_append_sheet(D,I,"Hareketler"),E.writeFile(D,`musteri_hareketleri_${(g==null?void 0:g.name)||"secili"}_${new Date().toISOString().split("T")[0]}.xlsx`)},C=async()=>{if(!o){alert("Yaşlandırma verisi yok");return}const E=await xi(()=>Promise.resolve().then(()=>td),void 0),A=[{Periyot:"0-30 Gün",Tutar:o.bucket0_30},{Periyot:"31-60 Gün",Tutar:o.bucket31_60},{Periyot:"61-90 Gün",Tutar:o.bucket61_90},{Periyot:"90+ Gün",Tutar:o.bucket90plus},{Periyot:"Toplam",Tutar:o.total}],I=E.utils.json_to_sheet(A),D=E.utils.book_new();E.utils.book_append_sheet(D,I,"Yaslandirma"),E.writeFile(D,`musteri_yaslandirma_${(g==null?void 0:g.name)||"secili"}_${new Date().toISOString().split("T")[0]}.xlsx`)};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(Pf,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#000",letterSpacing:"-0.5px"},children:"Tahsilat ve Yaşlandırma"})]}),s.jsxs("button",{onClick:y,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},disabled:p,children:[s.jsx(fd,{size:16}),"Yenile"]})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"15px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Müşteri"}),s.jsxs("select",{value:r,onChange:E=>a(E.target.value),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"},children:[s.jsx("option",{value:"",children:"Seçiniz"}),e.map(E=>s.jsxs("option",{value:E.id,children:[E.name," ",E.companyName&&`(${E.companyName})`]},E.id))]}),g&&s.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#333",display:"grid",gap:"4px"},children:[s.jsxs("span",{children:[s.jsx("strong",{children:"Telefon:"})," ",g.phone||"-"]}),s.jsxs("span",{children:[s.jsx("strong",{children:"E-posta:"})," ",g.email||"-"]}),s.jsxs("span",{children:[s.jsx("strong",{children:"Şehir:"})," ",g.city||"-"]}),s.jsxs("span",{children:[s.jsx("strong",{children:"Bakiye:"})," ",(g.balance||0).toFixed(2)," ₺",g.creditLimit!==void 0&&s.jsxs("span",{style:{marginLeft:"8px"},children:[s.jsx("strong",{children:"Limit:"})," ",g.creditLimit.toFixed(2)," ₺"]})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Tahsilat Tutarı (₺)"}),s.jsx("input",{type:"number",min:"0",step:"0.01",value:c,onChange:E=>u(E.target.value),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Açıklama"}),s.jsx("input",{type:"text",value:f,onChange:E=>h(E.target.value),style:{width:"100%",padding:"12px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]})]}),s.jsxs("div",{style:{marginTop:"15px"},children:[s.jsx("button",{onClick:k,className:"btn btn-primary",disabled:v||!r,style:{display:"flex",alignItems:"center",gap:"8px"},children:"Tahsilatı Kaydet"}),r&&s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{onClick:w,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"6px"},children:[s.jsx(Zn,{size:16}),"Hareketleri Excel'e Aktar"]}),s.jsxs("button",{onClick:C,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"6px"},children:[s.jsx(Zn,{size:16}),"Yaşlandırma Excel"]})]})]})]}),r&&s.jsxs("div",{style:{marginBottom:"20px",background:"white",border:"2px solid #000",padding:"20px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"12px"},children:"Yaşlandırma"}),o?s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px"},children:[s.jsx(e0,{label:"0-30 Gün",value:o.bucket0_30}),s.jsx(e0,{label:"31-60 Gün",value:o.bucket31_60}),s.jsx(e0,{label:"61-90 Gün",value:o.bucket61_90}),s.jsx(e0,{label:"90+ Gün",value:o.bucket90plus}),s.jsx(e0,{label:"Toplam",value:o.total,bold:!0})]}):s.jsx("div",{children:"Yükleniyor..."})]}),r&&s.jsx("div",{className:"table-container",children:p?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):n.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz hareket bulunmuyor."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Tür"}),s.jsx("th",{children:"Tutar"}),s.jsx("th",{children:"Açıklama"}),s.jsx("th",{children:"Referans"})]})}),s.jsx("tbody",{children:n.map(E=>s.jsxs("tr",{children:[s.jsx("td",{children:new Date(E.date).toLocaleDateString("tr-TR")}),s.jsx("td",{children:E.type==="charge"?"Borç":"Tahsilat"}),s.jsxs("td",{style:{color:E.amount>0?"#c0392b":"#27ae60",fontWeight:600},children:[E.amount.toFixed(2)," ₺"]}),s.jsx("td",{children:E.description||"-"}),s.jsx("td",{children:E.referenceId||"-"})]},E.id))})]})})]})})}function e0({label:e,value:t,bold:r}){return s.jsxs("div",{style:{border:"1px solid #000",padding:"12px",background:"#fff"},children:[s.jsx("div",{style:{fontSize:"12px",color:"#555",marginBottom:"6px"},children:e}),s.jsxs("div",{style:{fontSize:"18px",fontWeight:r?700:600,color:"#000"},children:[t.toFixed(2)," ₺"]})]})}function DO(){const[,e]=ue.useState([]),[t,r]=ue.useState([]),[a,n]=ue.useState(new Date().toISOString().split("T")[0]),[i,o]=ue.useState(!0);ue.useEffect(()=>{l()},[a]);const l=async()=>{try{o(!0);const f=gt(),h=await To(f==null?void 0:f.companyId);e(h);const p=new Date(a),d=await Promise.all(h.map(async v=>{const m=await p_({customerId:v.id,companyId:f==null?void 0:f.companyId,asOf:p});return{customer:v,aging:m}}));r(d)}catch(f){console.error("Yaşlandırma raporu yüklenirken hata:",f);const h=localStorage.getItem("currentUser"),p=h?JSON.parse(h):null;await ur(`Yaşlandırma raporu yüklenirken hata: ${f.message||f}`,"CustomerAgingReport",p==null?void 0:p.id,p==null?void 0:p.username),alert("Veriler yüklenirken bir hata oluştu")}finally{o(!1)}},c=async()=>{if(!t.length){alert("Dışa aktarılacak veri yok");return}const f=await xi(()=>Promise.resolve().then(()=>td),void 0),h=t.map(v=>({Müşteri:v.customer.name,Şirket:v.customer.companyName||"",Telefon:v.customer.phone||"",Email:v.customer.email||"","0-30 Gün":v.aging.bucket0_30,"31-60 Gün":v.aging.bucket31_60,"61-90 Gün":v.aging.bucket61_90,"90+ Gün":v.aging.bucket90plus,Toplam:v.aging.total})),p=f.utils.json_to_sheet(h),d=f.utils.book_new();f.utils.book_append_sheet(d,p,"Yaslandirma"),f.writeFile(d,`musteri_yaslandirma_genel_${a}.xlsx`)},u=t.reduce((f,h)=>(f.bucket0_30+=h.aging.bucket0_30,f.bucket31_60+=h.aging.bucket31_60,f.bucket61_90+=h.aging.bucket61_90,f.bucket90plus+=h.aging.bucket90plus,f.total+=h.aging.total,f),{bucket0_30:0,bucket31_60:0,bucket61_90:0,bucket90plus:0,total:0});return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(Lf,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#000",letterSpacing:"-0.5px"},children:"Cari Yaşlandırma Raporu"})]}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsxs("button",{onClick:l,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},disabled:i,children:[s.jsx(fd,{size:16}),"Yenile"]}),s.jsxs("button",{onClick:c,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},disabled:i||!t.length,children:[s.jsx(Zn,{size:16}),"Excel"]})]})]}),s.jsxs("div",{style:{background:"white",border:"2px solid #000",padding:"20px",marginBottom:"20px",display:"flex",gap:"15px",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"13px",fontWeight:"600",color:"#000"},children:"Rapor Tarihi (As of)"}),s.jsx("input",{type:"date",value:a,onChange:f=>n(f.target.value),style:{padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"}})]}),s.jsxs("div",{style:{fontSize:"13px",color:"#555",display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(fc,{size:16}),t.length," müşteri"]})]}),s.jsx("div",{className:"table-container",children:i?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):t.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Kayıt bulunamadı."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Müşteri"}),s.jsx("th",{children:"Şirket"}),s.jsx("th",{children:"0-30 Gün"}),s.jsx("th",{children:"31-60 Gün"}),s.jsx("th",{children:"61-90 Gün"}),s.jsx("th",{children:"90+ Gün"}),s.jsx("th",{children:"Toplam"})]})}),s.jsx("tbody",{children:t.map(f=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:f.customer.name}),s.jsx("td",{children:f.customer.companyName||"-"}),s.jsxs("td",{children:[f.aging.bucket0_30.toFixed(2)," ₺"]}),s.jsxs("td",{children:[f.aging.bucket31_60.toFixed(2)," ₺"]}),s.jsxs("td",{children:[f.aging.bucket61_90.toFixed(2)," ₺"]}),s.jsxs("td",{children:[f.aging.bucket90plus.toFixed(2)," ₺"]}),s.jsxs("td",{style:{fontWeight:700},children:[f.aging.total.toFixed(2)," ₺"]})]},f.customer.id))}),s.jsx("tfoot",{children:s.jsxs("tr",{children:[s.jsx("td",{colSpan:2,style:{textAlign:"right",fontWeight:700},children:"Genel Toplam"}),s.jsxs("td",{children:[u.bucket0_30.toFixed(2)," ₺"]}),s.jsxs("td",{children:[u.bucket31_60.toFixed(2)," ₺"]}),s.jsxs("td",{children:[u.bucket61_90.toFixed(2)," ₺"]}),s.jsxs("td",{children:[u.bucket90plus.toFixed(2)," ₺"]}),s.jsxs("td",{style:{fontWeight:700},children:[u.total.toFixed(2)," ₺"]})]})})]})})]})})}function IO(){const[e,t]=ue.useState([{id:"l1",accountCode:"",amount:0,currency:"TRY",exchangeRate:1,side:"debit",description:""},{id:"l2",accountCode:"",amount:0,currency:"TRY",exchangeRate:1,side:"credit",description:""}]),[r,a]=ue.useState(new Date().toISOString().split("T")[0]),[n,i]=ue.useState(""),[o,l]=ue.useState("TRY"),[c,u]=ue.useState(""),[f,h]=ue.useState([]),[p,d]=ue.useState(!0),[v,m]=ue.useState(!1);ue.useEffect(()=>{y()},[]);const y=async()=>{try{d(!0);const E=gt(),A=await bO({companyId:E==null?void 0:E.companyId,limit:100});h(A)}catch(E){console.error("Yevmiye kayıtları yüklenirken hata:",E);const A=localStorage.getItem("currentUser"),I=A?JSON.parse(A):null;await ur(`Yevmiye kayıtları yüklenirken hata: ${E.message||E}`,"JournalEntries",I==null?void 0:I.id,I==null?void 0:I.username),alert("Veriler yüklenirken bir hata oluştu")}finally{d(!1)}},_=()=>{t([...e,{id:`l${Date.now()}`,accountCode:"",amount:0,currency:"TRY",exchangeRate:1,side:"debit",description:""}])},k=(E,A,I)=>{t(e.map(D=>D.id===E?{...D,[A]:I}:D))},g=E=>{if(e.length<=2){alert("En az iki satır olmalı (borç/alacak)");return}t(e.filter(A=>A.id!==E))},w=e.reduce((E,A)=>(A.side==="debit"?E.debit+=Number(A.amount)||0:E.credit+=Number(A.amount)||0,E),{debit:0,credit:0}),C=async E=>{if(E.preventDefault(),w.debit<=0||w.debit!==w.credit){alert("Borç ve alacak toplamı eşit ve sıfırdan büyük olmalı");return}if(!r){alert("Tarih seçin");return}try{m(!0);const A=gt(),I=c||(A==null?void 0:A.companyId);await hx({date:new Date(r),description:n||"Yevmiye Fişi",companyId:I,baseCurrency:o,lines:e.map(({id:D,...B})=>B)}),alert("Yevmiye kaydedildi"),i(""),t([{id:"l1",accountCode:"",amount:0,currency:"TRY",exchangeRate:1,side:"debit",description:""},{id:"l2",accountCode:"",amount:0,currency:"TRY",exchangeRate:1,side:"credit",description:""}]),y()}catch(A){console.error("Yevmiye kaydı eklenirken hata:",A),alert("Yevmiye kaydı eklenirken hata: "+(A.message||""))}finally{m(!1)}};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(jy,{size:32,color:"#000"}),s.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#000",letterSpacing:"-0.5px"},children:"Yevmiye Fişleri"})]}),s.jsxs("button",{onClick:y,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},disabled:p,children:[s.jsx(fd,{size:16}),"Yenile"]})]}),s.jsxs("div",{className:"excel-form",style:{marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"18px",fontWeight:"700",color:"#000"},children:"Yeni Fiş"}),s.jsxs("button",{onClick:_,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"6px"},children:[s.jsx(Yr,{size:16}),"Satır Ekle"]})]}),s.jsxs("form",{onSubmit:C,children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"12px"},children:[s.jsxs("div",{children:[s.jsx("label",{className:"excel-form-label",children:"Tarih"}),s.jsx("input",{type:"date",className:"excel-form-input",value:r,onChange:E=>a(E.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"excel-form-label",children:"Açıklama"}),s.jsx("input",{type:"text",className:"excel-form-input",value:n,onChange:E=>i(E.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"excel-form-label",children:"Şirket ID (override)"}),s.jsx("input",{type:"text",className:"excel-form-input",placeholder:"Boş bırakılırsa aktif şirket",value:c,onChange:E=>u(E.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"excel-form-label",children:"Temel Para Birimi"}),s.jsx("input",{type:"text",className:"excel-form-input",value:o,onChange:E=>l(E.target.value),placeholder:"TRY"})]}),s.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:"13px",fontWeight:600,color:"#000"},children:"Toplam Borç:"}),s.jsxs("span",{style:{fontWeight:700},children:[w.debit.toFixed(2)," "]}),s.jsx("span",{style:{fontSize:"13px",fontWeight:600,color:"#000"},children:"Toplam Alacak:"}),s.jsxs("span",{style:{fontWeight:700},children:[w.credit.toFixed(2)," "]})]})]}),s.jsx("div",{className:"table-container",style:{marginBottom:"12px"},children:s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Hesap Kodu"}),s.jsx("th",{children:"Borç / Alacak"}),s.jsx("th",{children:"Tutar"}),s.jsx("th",{children:"Para Birimi"}),s.jsx("th",{children:"Kur"}),s.jsx("th",{children:"Açıklama"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(E=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("input",{type:"text",className:"excel-form-input",value:E.accountCode,onChange:A=>k(E.id,"accountCode",A.target.value),required:!0})}),s.jsx("td",{children:s.jsxs("select",{className:"excel-form-select",value:E.side,onChange:A=>k(E.id,"side",A.target.value),children:[s.jsx("option",{value:"debit",children:"Borç"}),s.jsx("option",{value:"credit",children:"Alacak"})]})}),s.jsx("td",{children:s.jsx("input",{type:"number",step:"0.01",className:"excel-form-input",value:E.amount,onChange:A=>k(E.id,"amount",parseFloat(A.target.value)),required:!0})}),s.jsx("td",{children:s.jsx("input",{type:"text",className:"excel-form-input",placeholder:"TRY",value:E.currency||"TRY",onChange:A=>k(E.id,"currency",A.target.value)})}),s.jsx("td",{children:s.jsx("input",{type:"number",step:"0.0001",className:"excel-form-input",placeholder:"Kur",value:E.exchangeRate||1,onChange:A=>k(E.id,"exchangeRate",parseFloat(A.target.value)||1)})}),s.jsx("td",{children:s.jsx("input",{type:"text",className:"excel-form-input",value:E.description||"",onChange:A=>k(E.id,"description",A.target.value)})}),s.jsx("td",{children:s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>g(E.id),style:{padding:"4px 8px",fontSize:"12px"},children:"Sil"})})]},E.id))})]})}),s.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:v,children:[s.jsx(oa,{size:16,style:{marginRight:"6px"}}),"Kaydet"]})]})]}),s.jsx("div",{className:"table-container",children:p?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):f.length===0?s.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Henüz fiş bulunmuyor."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Açıklama"}),s.jsx("th",{children:"Toplam"}),s.jsx("th",{children:"Satırlar"})]})}),s.jsx("tbody",{children:f.map(E=>{var I,D;const A=((I=E.lines)==null?void 0:I.filter(B=>B.side==="debit").reduce((B,L)=>B+L.amount,0))||0;return s.jsxs("tr",{children:[s.jsx("td",{children:new Date(E.date).toLocaleDateString("tr-TR")}),s.jsx("td",{children:E.description}),s.jsx("td",{children:A.toFixed(2)}),s.jsx("td",{children:s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"12px",color:"#555"},children:(D=E.lines)==null?void 0:D.map((B,L)=>s.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[s.jsx("span",{style:{fontWeight:600},children:B.accountCode}),s.jsx("span",{children:B.side==="debit"?"B":"A"}),s.jsxs("span",{children:[B.amount.toFixed(2)," ",B.currency||"TRY"]}),B.description&&s.jsx("span",{style:{color:"#777"},children:B.description})]},L))})})]},E.id)})})]})})]})})}const Gd="products",LO=async e=>(await Or(lt(qe,Gd),{...e,createdAt:Ye.now(),updatedAt:Ye.now()})).id,PO=async e=>{let t=Ke(lt(qe,Gd));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var n,i;return{id:a.id,...a.data(),createdAt:(n=a.data().createdAt)==null?void 0:n.toDate(),updatedAt:(i=a.data().updatedAt)==null?void 0:i.toDate()}})},RO=async(e,t)=>{const r=ir(qe,Gd,e);await Xr(r,{...t,updatedAt:Ye.now()})},OO=async e=>{const t=ir(qe,Gd,e);await os(t)},ly={sku:"",name:"",category:"",baseUnit:"",barcode:"",variantColor:"",variantSize:"",lotTracking:!1,expiryRequired:!1,conversions:[]};function BO(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({...ly}),[f,h]=ue.useState({fromUnit:"",toUnit:"",factor:""});ue.useEffect(()=>{p()},[]);const p=async()=>{try{a(!0);const g=gt(),w=await PO(g==null?void 0:g.companyId);t(w)}catch(g){const w=localStorage.getItem("currentUser"),C=w?JSON.parse(w):null;await ur(`Ürünler yüklenirken hata: ${g.message||g}`,"ProductManagement",C==null?void 0:C.id,C==null?void 0:C.username),alert("Veri yüklenirken hata")}finally{a(!1)}},d=()=>{u({...ly}),h({fromUnit:"",toUnit:"",factor:""}),l(null)},v=async g=>{if(g.preventDefault(),!c.sku||!c.name||!c.baseUnit){alert("SKU, Ad ve Temel Birim zorunlu");return}const w=gt(),C={sku:c.sku,name:c.name,category:c.category||void 0,baseUnit:c.baseUnit,barcode:c.barcode||void 0,variant:c.variantColor||c.variantSize?{color:c.variantColor||void 0,size:c.variantSize||void 0}:void 0,units:c.conversions.length?c.conversions:void 0,lotTracking:c.lotTracking,expiryRequired:c.expiryRequired,companyId:w==null?void 0:w.companyId};try{o?(await RO(o,C),alert("Ürün güncellendi")):(await LO(C),alert("Ürün eklendi")),d(),i(!1),p()}catch(E){alert("Kayıt hatası: "+(E.message||""))}},m=g=>{var w,C;l(g.id||null),u({sku:g.sku||"",name:g.name||"",category:g.category||"",baseUnit:g.baseUnit||"",barcode:g.barcode||"",variantColor:((w=g.variant)==null?void 0:w.color)||"",variantSize:((C=g.variant)==null?void 0:C.size)||"",lotTracking:!!g.lotTracking,expiryRequired:!!g.expiryRequired,conversions:g.units||[]}),h({fromUnit:"",toUnit:"",factor:""}),i(!0)},y=async g=>{if(confirm("Silmek istediğinize emin misiniz?"))try{await OO(g),p()}catch(w){alert("Silme hatası: "+(w.message||""))}},_=()=>{const g=parseFloat(f.factor);if(!f.fromUnit||!f.toUnit||isNaN(g)||g<=0){alert("Geçerli dönüşüm girin");return}u({...c,conversions:[...c.conversions,{fromUnit:f.fromUnit,toUnit:f.toUnit,factor:g}]}),h({fromUnit:"",toUnit:"",factor:""})},k=g=>{u({...c,conversions:c.conversions.filter((w,C)=>C!==g)})};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Ls,{size:28}),s.jsx("h1",{style:{fontSize:"30px",fontWeight:700},children:"Ürün Kartları"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{d(),i(!0)},children:[s.jsx(Yr,{size:16})," Yeni Ürün"]})]}),n&&s.jsx("div",{className:"excel-form",style:{marginBottom:"20px"},children:s.jsxs("form",{onSubmit:v,children:[s.jsxs("div",{className:"grid-4",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKU *"}),s.jsx("input",{className:"excel-form-input",value:c.sku,onChange:g=>u({...c,sku:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Ürün Adı *"}),s.jsx("input",{className:"excel-form-input",value:c.name,onChange:g=>u({...c,name:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kategori"}),s.jsx("input",{className:"excel-form-input",value:c.category,onChange:g=>u({...c,category:g.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Barkod"}),s.jsx("input",{className:"excel-form-input",value:c.barcode,onChange:g=>u({...c,barcode:g.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Temel Birim *"}),s.jsx("input",{className:"excel-form-input",value:c.baseUnit,onChange:g=>u({...c,baseUnit:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Varyant Renk"}),s.jsx("input",{className:"excel-form-input",value:c.variantColor,onChange:g=>u({...c,variantColor:g.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Varyant Beden"}),s.jsx("input",{className:"excel-form-input",value:c.variantSize,onChange:g=>u({...c,variantSize:g.target.value})})]}),s.jsxs("div",{className:"excel-form-group",style:{display:"flex",gap:"12px",alignItems:"center"},children:[s.jsx("label",{className:"excel-form-label",children:"Lot Takibi"}),s.jsx("input",{type:"checkbox",checked:c.lotTracking,onChange:g=>u({...c,lotTracking:g.target.checked})}),s.jsx("label",{className:"excel-form-label",children:"SKT Zorunlu"}),s.jsx("input",{type:"checkbox",checked:c.expiryRequired,onChange:g=>u({...c,expiryRequired:g.target.checked})})]})]}),s.jsxs("div",{style:{marginTop:"15px",border:"1px solid #e0e0e0",padding:"12px"},children:[s.jsx("h4",{style:{margin:"0 0 10px 0"},children:"Birim Dönüşümleri"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"8px",marginBottom:"8px"},children:[s.jsx("input",{className:"excel-form-input",placeholder:"Kaynak Birim",value:f.fromUnit,onChange:g=>h({...f,fromUnit:g.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Hedef Birim",value:f.toUnit,onChange:g=>h({...f,toUnit:g.target.value})}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.0001",placeholder:"Katsayı",value:f.factor,onChange:g=>h({...f,factor:g.target.value})}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:_,children:"Ekle"})]}),c.conversions.length>0&&s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:c.conversions.map((g,w)=>s.jsxs("div",{style:{border:"1px solid #ccc",padding:"6px 10px",borderRadius:"4px",fontSize:"12px",display:"flex",gap:"6px",alignItems:"center"},children:[s.jsxs("span",{children:[g.fromUnit," → ",g.toUnit," x ",g.factor]}),s.jsx("button",{type:"button",className:"btn btn-secondary",style:{padding:"2px 6px",fontSize:"11px"},onClick:()=>k(w),children:"Sil"})]},w))})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"15px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:16})," ",o?"Güncelle":"Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),d()},children:[s.jsx(ea,{size:16})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"30px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#666"},children:"Henüz ürün kartı yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Ad"}),s.jsx("th",{children:"Kategori"}),s.jsx("th",{children:"Barkod"}),s.jsx("th",{children:"Temel Birim"}),s.jsx("th",{children:"Varyant"}),s.jsx("th",{children:"Lot/SKT"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(g=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:g.sku}),s.jsx("td",{children:g.name}),s.jsx("td",{children:g.category||"-"}),s.jsx("td",{children:g.barcode||"-"}),s.jsx("td",{children:g.baseUnit}),s.jsx("td",{children:g.variant&&`${g.variant.color||""} ${g.variant.size||""}`.trim()||"-"}),s.jsxs("td",{children:[g.lotTracking?"Evet":"Hayır"," / ",g.expiryRequired?"Evet":"Hayır"]}),s.jsxs("td",{style:{display:"flex",gap:"8px"},children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>m(g),children:[s.jsx(jn,{size:14})," Düzenle"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px",color:"#dc3545"},onClick:()=>g.id&&y(g.id),children:[s.jsx(xc,{size:14})," Sil"]})]})]},g.id))})]})})]})})}const xx="requisitions",gx="rfqs",vx="purchaseOrders",yx="goodsReceipts",Eo=e=>e?Ye.fromDate(e):void 0,v_=async e=>(await Or(lt(qe,xx),{...e,requestDate:Eo(e.requestDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,bx=async e=>{let t=Ke(lt(qe,xx));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l;const n=a.data();return{id:a.id,...n,requestDate:(i=n.requestDate)!=null&&i.toDate?n.requestDate.toDate():n.requestDate,createdAt:(o=n.createdAt)!=null&&o.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(l=n.updatedAt)!=null&&l.toDate?n.updatedAt.toDate():n.updatedAt}})},x1=async(e,t)=>{const r=ir(qe,xx,e),a={...t,updatedAt:Ye.now()};t.requestDate&&(a.requestDate=Eo(t.requestDate)),await Xr(r,a)},y_=async e=>(await Or(lt(qe,gx),{...e,dueDate:Eo(e.dueDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,cy=async(e,t)=>{const r=ir(qe,gx,e),a={...t,updatedAt:Ye.now()};t.dueDate&&(a.dueDate=Eo(t.dueDate)),await Xr(r,a)},b_=async e=>{let t=Ke(lt(qe,gx));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l;const n=a.data();return{id:a.id,...n,dueDate:(i=n.dueDate)!=null&&i.toDate?n.dueDate.toDate():n.dueDate,createdAt:(o=n.createdAt)!=null&&o.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(l=n.updatedAt)!=null&&l.toDate?n.updatedAt.toDate():n.updatedAt}})},w_=async e=>(await Or(lt(qe,vx),{...e,orderDate:Eo(e.orderDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,__=async e=>{let t=Ke(lt(qe,vx));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l;const n=a.data();return{id:a.id,...n,orderDate:(i=n.orderDate)!=null&&i.toDate?n.orderDate.toDate():n.orderDate,createdAt:(o=n.createdAt)!=null&&o.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(l=n.updatedAt)!=null&&l.toDate?n.updatedAt.toDate():n.updatedAt}})},uy=async(e,t)=>{const r=ir(qe,vx,e),a={...t,updatedAt:Ye.now()};t.orderDate&&(a.orderDate=Eo(t.orderDate)),await Xr(r,a)},MO=async e=>(await Or(lt(qe,yx),{...e,receiptDate:Eo(e.receiptDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,k_=async e=>{let t=Ke(lt(qe,yx));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l;const n=a.data();return{id:a.id,...n,receiptDate:(i=n.receiptDate)!=null&&i.toDate?n.receiptDate.toDate():n.receiptDate,createdAt:(o=n.createdAt)!=null&&o.toDate?n.createdAt.toDate():n.createdAt,updatedAt:(l=n.updatedAt)!=null&&l.toDate?n.updatedAt.toDate():n.updatedAt}})},fy=async(e,t)=>{const r=ir(qe,yx,e),a={...t,updatedAt:Ye.now()};t.receiptDate&&(a.receiptDate=Eo(t.receiptDate)),await Xr(r,a)};function zO(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({reqNumber:"",requestDate:new Date().toISOString().split("T")[0],requestedBy:"",status:"draft",items:[]}),[f,h]=ue.useState({materialName:"",quantity:"",unit:"",notes:""});ue.useEffect(()=>{p()},[]);const p=async()=>{try{a(!0);const g=gt(),w=await bx(g==null?void 0:g.companyId);t(w)}catch(g){const w=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`Requisition yüklenirken hata: ${g.message||g}`,"RequisitionManagement",w==null?void 0:w.id,w==null?void 0:w.username),alert("Veriler yüklenirken hata")}finally{a(!1)}},d=()=>{u({reqNumber:"",requestDate:new Date().toISOString().split("T")[0],requestedBy:"",status:"draft",items:[]}),h({materialName:"",quantity:"",unit:"",notes:""}),l(null)},v=()=>{const g=parseFloat(f.quantity);if(!f.materialName||!f.unit||isNaN(g)||g<=0){alert("Malzeme, birim ve miktar zorunlu");return}const w={materialName:f.materialName,quantity:g,unit:f.unit,notes:f.notes||void 0};u({...c,items:[...c.items,w]}),h({materialName:"",quantity:"",unit:"",notes:""})},m=g=>{u({...c,items:c.items.filter((w,C)=>C!==g)})},y=async g=>{if(g.preventDefault(),!c.reqNumber||!c.requestDate||c.items.length===0){alert("Talep numarası, tarih ve en az bir kalem zorunlu");return}try{const w=gt(),C={reqNumber:c.reqNumber,requestDate:new Date(c.requestDate),requestedBy:c.requestedBy||void 0,status:c.status,items:c.items,companyId:w==null?void 0:w.companyId};o?(await x1(o,C),alert("Talep güncellendi")):(await v_(C),alert("Talep eklendi")),i(!1),d(),p()}catch(w){alert("Kayıt hatası: "+(w.message||""))}},_=g=>{l(g.id||null),u({reqNumber:g.reqNumber,requestDate:g.requestDate.toISOString().split("T")[0],requestedBy:g.requestedBy||"",status:g.status,items:g.items}),i(!0)},k=async(g,w)=>{await x1(g,{status:w}),p()};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Xo,{size:24}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:700},children:"Satınalma Talepleri"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{d(),i(!0)},children:[s.jsx(Yr,{size:16})," Yeni Talep"]})]}),n&&s.jsx("div",{className:"excel-form",style:{marginBottom:"20px"},children:s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Talep No *"}),s.jsx("input",{className:"excel-form-input",value:c.reqNumber,onChange:g=>u({...c,reqNumber:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Talep Tarihi *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:c.requestDate,onChange:g=>u({...c,requestDate:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Talep Eden"}),s.jsx("input",{className:"excel-form-input",value:c.requestedBy,onChange:g=>u({...c,requestedBy:g.target.value})})]})]}),s.jsxs("div",{style:{marginTop:"12px",border:"1px solid #e0e0e0",padding:"10px"},children:[s.jsx("h4",{style:{margin:"0 0 10px 0"},children:"Kalem Ekle"}),s.jsxs("div",{className:"grid-4",style:{gap:"8px"},children:[s.jsx("input",{className:"excel-form-input",placeholder:"Malzeme",value:f.materialName,onChange:g=>h({...f,materialName:g.target.value})}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",placeholder:"Miktar",value:f.quantity,onChange:g=>h({...f,quantity:g.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim",value:f.unit,onChange:g=>h({...f,unit:g.target.value})}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:v,children:"Ekle"}),s.jsx("input",{className:"excel-form-input",placeholder:"Not (opsiyonel)",value:f.notes,onChange:g=>h({...f,notes:g.target.value})})]}),c.items.length>0&&s.jsx("div",{style:{marginTop:"8px",display:"flex",flexWrap:"wrap",gap:"8px"},children:c.items.map((g,w)=>s.jsxs("div",{style:{border:"1px solid #ccc",padding:"6px 10px",borderRadius:"4px",fontSize:"12px",display:"flex",gap:"6px",alignItems:"center"},children:[s.jsxs("span",{children:[g.materialName," - ",g.quantity," ",g.unit]}),s.jsx("button",{type:"button",className:"btn btn-secondary",style:{padding:"2px 6px",fontSize:"11px"},onClick:()=>m(w),children:"Sil"})]},w))})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," ",o?"Güncelle":"Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),d()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"30px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#666"},children:"Henüz talep yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Talep No"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Talep Eden"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Kalem Sayısı"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(g=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:g.reqNumber}),s.jsx("td",{children:g.requestDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:g.requestedBy||"-"}),s.jsx("td",{children:g.status}),s.jsx("td",{children:g.items.length}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>_(g),children:[s.jsx(jn,{size:12})," Düzenle"]}),g.id&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"approved"),children:[s.jsx(mc,{size:12})," Onay"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"rejected"),children:[s.jsx(dd,{size:12})," Reddet"]})]})]})]},g.id))})]})})]})})}function UO(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState(!0),[o,l]=ue.useState(!1),[c,u]=ue.useState(null),[f,h]=ue.useState({rfqNumber:"",dueDate:new Date().toISOString().split("T")[0],suppliers:"",baseReqId:"",items:[],status:"open"});ue.useEffect(()=>{p()},[]);const p=async()=>{try{i(!0);const k=gt(),[g,w]=await Promise.all([b_(k==null?void 0:k.companyId),bx(k==null?void 0:k.companyId)]);t(g),a(w)}catch(k){const g=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`RFQ yüklenirken hata: ${k.message||k}`,"RFQManagement",g==null?void 0:g.id,g==null?void 0:g.username),alert("Veri yüklenirken hata")}finally{i(!1)}},d=()=>{h({rfqNumber:"",dueDate:new Date().toISOString().split("T")[0],suppliers:"",baseReqId:"",items:[],status:"open"}),u(null)},v=k=>{const g=r.find(w=>w.id===k);h({...f,baseReqId:k,items:(g==null?void 0:g.items)||[]})},m=async k=>{if(k.preventDefault(),!f.rfqNumber||!f.dueDate||f.items.length===0){alert("RFQ no, son tarih ve kalemler zorunlu");return}const g=gt(),w={rfqNumber:f.rfqNumber,suppliers:f.suppliers?f.suppliers.split(",").map(C=>C.trim()).filter(Boolean):[],dueDate:new Date(f.dueDate),items:f.items,status:f.status,companyId:g==null?void 0:g.companyId};try{c?(await cy(c,w),alert("RFQ güncellendi")):(await y_(w),f.baseReqId&&await x1(f.baseReqId,{status:"converted"}),alert("RFQ eklendi")),l(!1),d(),p()}catch(C){alert("Kayıt hatası: "+(C.message||""))}},y=k=>{u(k.id||null),h({rfqNumber:k.rfqNumber,dueDate:k.dueDate.toISOString().split("T")[0],suppliers:(k.suppliers||[]).join(", "),baseReqId:"",items:k.items,status:k.status}),l(!0)},_=async k=>{await cy(k,{status:"closed"}),p()};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Ey,{size:24}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:700},children:"RFQ (Teklif Toplama)"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{d(),l(!0)},children:[s.jsx(Yr,{size:16})," Yeni RFQ"]})]}),o&&s.jsx("div",{className:"excel-form",style:{marginBottom:"20px"},children:s.jsxs("form",{onSubmit:m,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"RFQ No *"}),s.jsx("input",{className:"excel-form-input",value:f.rfqNumber,onChange:k=>h({...f,rfqNumber:k.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Son Tarih *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:f.dueDate,onChange:k=>h({...f,dueDate:k.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tedarikçiler (virgül ile)"}),s.jsx("input",{className:"excel-form-input",value:f.suppliers,onChange:k=>h({...f,suppliers:k.target.value}),placeholder:"Tedarikçi1, Tedarikçi2"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Talep Seç (opsiyonel)"}),s.jsxs("select",{className:"excel-form-select",value:f.baseReqId,onChange:k=>v(k.target.value),children:[s.jsx("option",{value:"",children:"Talep bağlama"}),r.map(k=>s.jsxs("option",{value:k.id,children:[k.reqNumber," - ",k.status]},k.id))]})]})]}),s.jsxs("div",{style:{marginTop:"12px",border:"1px solid #e0e0e0",padding:"10px"},children:[s.jsx("h4",{style:{margin:"0 0 10px 0"},children:"Kalemler"}),f.items.length===0?s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Bağlı talepten kalem çekilecek veya talep seçilmemişse elle eklenmelidir."}):s.jsx("ul",{style:{margin:0,paddingLeft:"18px",fontSize:"13px"},children:f.items.map((k,g)=>s.jsxs("li",{children:[k.materialName," - ",k.quantity," ",k.unit]},g))})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(!1),d()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:n?s.jsx("div",{style:{padding:"30px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#666"},children:"Henüz RFQ yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"RFQ No"}),s.jsx("th",{children:"Son Tarih"}),s.jsx("th",{children:"Tedarikçiler"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Kalem Sayısı"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(k=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:k.rfqNumber}),s.jsx("td",{children:k.dueDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:(k.suppliers||[]).join(", ")||"-"}),s.jsx("td",{children:k.status}),s.jsx("td",{children:k.items.length}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>y(k),children:[s.jsx(jn,{size:12})," Düzenle"]}),k.status!=="closed"&&s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k.id&&_(k.id),children:[s.jsx(mc,{size:12})," Kapat"]})]})]},k.id))})]})})]})})}function WO(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({poNumber:"",orderDate:new Date().toISOString().split("T")[0],supplier:"",items:[],status:"pending",totalAmount:0}),[f,h]=ue.useState({materialName:"",quantity:"",unit:"",unitPrice:""});ue.useEffect(()=>{p()},[]);const p=async()=>{try{a(!0);const g=gt(),w=await __(g==null?void 0:g.companyId);t(w)}catch(g){const w=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`PO yüklenirken hata: ${g.message||g}`,"PurchaseOrderManagement",w==null?void 0:w.id,w==null?void 0:w.username),alert("Veri yüklenirken hata")}finally{a(!1)}},d=()=>{u({poNumber:"",orderDate:new Date().toISOString().split("T")[0],supplier:"",items:[],status:"pending",totalAmount:0}),h({materialName:"",quantity:"",unit:"",unitPrice:""}),l(null)},v=()=>{const g=parseFloat(f.quantity),w=parseFloat(f.unitPrice);if(!f.materialName||!f.unit||isNaN(g)||g<=0||isNaN(w)||w<0){alert("Malzeme, birim, miktar ve fiyat zorunlu");return}const C={materialName:f.materialName,quantity:g,unit:f.unit,notes:void 0,unitPrice:w},E=[...c.items,C],A=E.reduce((I,D)=>I+D.quantity*D.unitPrice,0);u({...c,items:E,totalAmount:A}),h({materialName:"",quantity:"",unit:"",unitPrice:""})},m=g=>{const w=c.items.filter((E,A)=>A!==g),C=w.reduce((E,A)=>E+A.quantity*A.unitPrice,0);u({...c,items:w,totalAmount:C})},y=async g=>{if(g.preventDefault(),!c.poNumber||!c.orderDate||!c.supplier||c.items.length===0){alert("PO no, tarih, tedarikçi ve kalemler zorunlu");return}const w=gt(),C={poNumber:c.poNumber,orderDate:new Date(c.orderDate),supplier:c.supplier,items:c.items,status:c.status,totalAmount:c.totalAmount,companyId:w==null?void 0:w.companyId};try{o?(await uy(o,C),alert("PO güncellendi")):(await w_(C),alert("PO eklendi")),i(!1),d(),p()}catch(E){alert("Kayıt hatası: "+(E.message||""))}},_=g=>{l(g.id||null),u({poNumber:g.poNumber,orderDate:g.orderDate.toISOString().split("T")[0],supplier:g.supplier,items:g.items,status:g.status,totalAmount:g.totalAmount||0}),i(!0)},k=async(g,w)=>{await uy(g,{status:w}),p()};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Rf,{size:24}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:700},children:"Satınalma Siparişleri"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{d(),i(!0)},children:[s.jsx(Yr,{size:16})," Yeni PO"]})]}),n&&s.jsx("div",{className:"excel-form",style:{marginBottom:"20px"},children:s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"PO No *"}),s.jsx("input",{className:"excel-form-input",value:c.poNumber,onChange:g=>u({...c,poNumber:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tarih *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:c.orderDate,onChange:g=>u({...c,orderDate:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tedarikçi *"}),s.jsx("input",{className:"excel-form-input",value:c.supplier,onChange:g=>u({...c,supplier:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Durum"}),s.jsxs("select",{className:"excel-form-select",value:c.status,onChange:g=>u({...c,status:g.target.value}),children:[s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"issued",children:"İletildi"}),s.jsx("option",{value:"received",children:"Teslim Alındı"}),s.jsx("option",{value:"billed",children:"Faturalandı"}),s.jsx("option",{value:"closed",children:"Kapalı"})]})]})]}),s.jsxs("div",{style:{marginTop:"12px",border:"1px solid #e0e0e0",padding:"10px"},children:[s.jsx("h4",{style:{margin:"0 0 10px 0"},children:"Kalem Ekle"}),s.jsxs("div",{className:"grid-4",style:{gap:"8px"},children:[s.jsx("input",{className:"excel-form-input",placeholder:"Malzeme",value:f.materialName,onChange:g=>h({...f,materialName:g.target.value})}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",placeholder:"Miktar",value:f.quantity,onChange:g=>h({...f,quantity:g.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim",value:f.unit,onChange:g=>h({...f,unit:g.target.value})}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",placeholder:"Birim Fiyat",value:f.unitPrice,onChange:g=>h({...f,unitPrice:g.target.value})}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:v,children:"Ekle"})]}),c.items.length>0&&s.jsx("div",{style:{marginTop:"8px",display:"flex",flexWrap:"wrap",gap:"8px"},children:c.items.map((g,w)=>s.jsxs("div",{style:{border:"1px solid #ccc",padding:"6px 10px",borderRadius:"4px",fontSize:"12px",display:"flex",gap:"6px",alignItems:"center"},children:[s.jsxs("span",{children:[g.materialName," - ",g.quantity," ",g.unit," x ",g.unitPrice||0]}),s.jsx("button",{type:"button",className:"btn btn-secondary",style:{padding:"2px 6px",fontSize:"11px"},onClick:()=>m(w),children:"Sil"})]},w))})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px",alignItems:"center"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," ",o?"Güncelle":"Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),d()},children:[s.jsx(ea,{size:14})," İptal"]}),s.jsxs("div",{style:{fontWeight:700,fontSize:"14px"},children:["Toplam: ",c.totalAmount.toFixed(2)," ₺"]})]})]})}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"30px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#666"},children:"Henüz PO yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"PO No"}),s.jsx("th",{children:"Tedarikçi"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Kalem"}),s.jsx("th",{children:"Toplam"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(g=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:g.poNumber}),s.jsx("td",{children:g.supplier}),s.jsx("td",{children:g.orderDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:g.status}),s.jsx("td",{children:g.items.length}),s.jsxs("td",{children:[(g.totalAmount||0).toFixed(2)," ₺"]}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>_(g),children:[s.jsx(jn,{size:12})," Düzenle"]}),g.id&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"issued"),children:[s.jsx(ug,{size:12})," İletildi"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"received"),children:[s.jsx(Of,{size:12})," Teslim"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"billed"),children:[s.jsx(Rf,{size:12})," Faturalandı"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"closed"),children:[s.jsx(ug,{size:12})," Kapalı"]})]})]})]},g.id))})]})})]})})}function qO(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({grnNumber:"",receiptDate:new Date().toISOString().split("T")[0],warehouse:"",items:[],status:"pending",createStock:!0}),[f,h]=ue.useState({materialName:"",quantity:"",unit:"",acceptedQty:""});ue.useEffect(()=>{p()},[]);const p=async()=>{try{a(!0);const g=gt(),w=await k_(g==null?void 0:g.companyId);t(w)}catch(g){const w=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`GRN yüklenirken hata: ${g.message||g}`,"GoodsReceiptManagement",w==null?void 0:w.id,w==null?void 0:w.username),alert("Veri yüklenirken hata")}finally{a(!1)}},d=()=>{u({grnNumber:"",receiptDate:new Date().toISOString().split("T")[0],warehouse:"",items:[],status:"pending",createStock:!0}),h({materialName:"",quantity:"",unit:"",acceptedQty:""}),l(null)},v=()=>{const g=parseFloat(f.quantity),w=f.acceptedQty?parseFloat(f.acceptedQty):void 0;if(!f.materialName||!f.unit||isNaN(g)||g<=0){alert("Malzeme, birim ve miktar zorunlu");return}const C={materialName:f.materialName,quantity:g,unit:f.unit,acceptedQty:w};u({...c,items:[...c.items,C]}),h({materialName:"",quantity:"",unit:"",acceptedQty:""})},m=g=>{u({...c,items:c.items.filter((w,C)=>C!==g)})},y=async g=>{if(g.preventDefault(),!c.grnNumber||!c.receiptDate||c.items.length===0){alert("GRN no, tarih ve kalemler zorunlu");return}const w=gt(),C={grnNumber:c.grnNumber,receiptDate:new Date(c.receiptDate),warehouse:c.warehouse||void 0,items:c.items,status:c.status,companyId:w==null?void 0:w.companyId};try{if(o)await fy(o,C),alert("GRN güncellendi");else if(await MO(C),alert("GRN eklendi"),c.createStock)for(const E of c.items){const A={arrivalDate:new Date(c.receiptDate),materialName:E.materialName,category:"",unit:E.unit,quantity:E.acceptedQty||E.quantity,unitPrice:0,supplier:C.warehouse||"Mal Kabul",warehouse:C.warehouse,companyId:w==null?void 0:w.companyId};await bf(A)}i(!1),d(),p()}catch(E){alert("Kayıt hatası: "+(E.message||""))}},_=g=>{l(g.id||null),u({grnNumber:g.grnNumber,receiptDate:g.receiptDate.toISOString().split("T")[0],warehouse:g.warehouse||"",items:g.items,status:g.status,createStock:!1}),i(!0)},k=async(g,w)=>{await fy(g,{status:w}),p()};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Cy,{size:24}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:700},children:"Mal Kabul (GRN)"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{d(),i(!0)},children:[s.jsx(Yr,{size:16})," Yeni GRN"]})]}),n&&s.jsx("div",{className:"excel-form",style:{marginBottom:"20px"},children:s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"GRN No *"}),s.jsx("input",{className:"excel-form-input",value:c.grnNumber,onChange:g=>u({...c,grnNumber:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tarih *"}),s.jsx("input",{type:"date",className:"excel-form-input",value:c.receiptDate,onChange:g=>u({...c,receiptDate:g.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Depo"}),s.jsx("input",{className:"excel-form-input",value:c.warehouse,onChange:g=>u({...c,warehouse:g.target.value}),placeholder:"Depo adı (opsiyonel)"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Durum"}),s.jsxs("select",{className:"excel-form-select",value:c.status,onChange:g=>u({...c,status:g.target.value}),children:[s.jsx("option",{value:"pending",children:"Beklemede"}),s.jsx("option",{value:"accepted",children:"Kabul"}),s.jsx("option",{value:"rejected",children:"Reddedildi"})]})]}),s.jsxs("div",{className:"excel-form-group",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("input",{type:"checkbox",checked:c.createStock,onChange:g=>u({...c,createStock:g.target.checked}),id:"createStock"}),s.jsx("label",{htmlFor:"createStock",className:"excel-form-label",style:{margin:0},children:"Mal kabulde stok girişi oluştur"})]})]}),s.jsxs("div",{style:{marginTop:"12px",border:"1px solid #e0e0e0",padding:"10px"},children:[s.jsx("h4",{style:{margin:"0 0 10px 0"},children:"Kalem Ekle"}),s.jsxs("div",{className:"grid-4",style:{gap:"8px"},children:[s.jsx("input",{className:"excel-form-input",placeholder:"Malzeme",value:f.materialName,onChange:g=>h({...f,materialName:g.target.value})}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",placeholder:"Miktar",value:f.quantity,onChange:g=>h({...f,quantity:g.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim",value:f.unit,onChange:g=>h({...f,unit:g.target.value})}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",placeholder:"Kabul Miktarı (opsiyonel)",value:f.acceptedQty,onChange:g=>h({...f,acceptedQty:g.target.value})}),s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:v,children:"Ekle"})]}),c.items.length>0&&s.jsx("div",{style:{marginTop:"8px",display:"flex",flexWrap:"wrap",gap:"8px"},children:c.items.map((g,w)=>s.jsxs("div",{style:{border:"1px solid #ccc",padding:"6px 10px",borderRadius:"4px",fontSize:"12px",display:"flex",gap:"6px",alignItems:"center"},children:[s.jsxs("span",{children:[g.materialName," - ",g.quantity," ",g.unit," ",g.acceptedQty?`(Kabul: ${g.acceptedQty})`:""]}),s.jsx("button",{type:"button",className:"btn btn-secondary",style:{padding:"2px 6px",fontSize:"11px"},onClick:()=>m(w),children:"Sil"})]},w))})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," ",o?"Güncelle":"Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),d()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"30px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#666"},children:"Henüz GRN yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"GRN No"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Depo"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Kalem"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(g=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:g.grnNumber}),s.jsx("td",{children:g.receiptDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:g.warehouse||"-"}),s.jsx("td",{children:g.status}),s.jsx("td",{children:g.items.length}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>_(g),children:[s.jsx(jn,{size:12})," Düzenle"]}),g.id&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"accepted"),children:[s.jsx(mc,{size:12})," Kabul"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>k(g.id,"rejected"),children:[s.jsx(dd,{size:12})," Reddet"]})]})]})]},g.id))})]})})]})})}function HO(){const[e,t]=ue.useState({invoiceNumber:`FAT-${Date.now()}`,issueDate:new Date().toISOString().split("T")[0],scenario:"E_FATURA",customerName:"Test Müşteri",customerVknTckn:"1234567890",currency:"TRY",lines:[{name:"Ürün A",qty:1,unitPrice:500,vatRate:18,discountPercent:0},{name:"Ürün B",qty:2,unitPrice:150,vatRate:8,discountPercent:10}]}),[r,a]=ue.useState({despatchNumber:`IRS-${Date.now()}`,issueDate:new Date().toISOString().split("T")[0],customerName:"Test Müşteri",customerVknTckn:"1234567890",items:[{name:"Ürün A",qty:1,unit:"Adet"},{name:"Ürün B",qty:3,unit:"Adet"}]}),n=(u,f)=>{const h=new Blob([u],{type:"text/xml;charset=utf-8"}),p=URL.createObjectURL(h),d=document.createElement("a");d.href=p,d.download=f,d.click(),URL.revokeObjectURL(p)},i=()=>{const u=g_({invoiceNumber:e.invoiceNumber,issueDate:e.issueDate,scenario:e.scenario,currency:e.currency,customerName:e.customerName,customerVknTckn:e.customerVknTckn,lines:e.lines.map(f=>({name:f.name,quantity:f.qty,unitPrice:f.unitPrice,vatRate:f.vatRate,discountPercent:f.discountPercent}))});n(u,`${e.invoiceNumber}.xml`)},o=()=>{x_({invoiceNumber:e.invoiceNumber,issueDate:e.issueDate,customerName:e.customerName,customerVknTckn:e.customerVknTckn,currency:e.currency,lines:e.lines})},l=()=>{const u=NO({despatchNumber:r.despatchNumber,issueDate:r.issueDate,customerName:r.customerName,customerVknTckn:r.customerVknTckn,lines:r.items.map(f=>({name:f.name,quantity:f.qty,unit:f.unit}))});n(u,`${r.despatchNumber}.xml`)},c=()=>{AO({despatchNumber:r.despatchNumber,issueDate:r.issueDate,customerName:r.customerName,customerVknTckn:r.customerVknTckn,items:r.items})};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px",display:"grid",gap:"20px"},children:[s.jsx("h1",{style:{fontSize:"32px",fontWeight:700},children:"e-Belge Çıktıları (PDF / UBL - GİB Yükleme Yok)"}),s.jsxs("div",{style:{border:"2px solid #000",padding:"20px",background:"#fff"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[s.jsx(Bs,{size:20}),s.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"e-Fatura / e-Arşiv"})]}),s.jsxs("div",{className:"grid-3",style:{gap:"10px"},children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Fatura No"}),s.jsx("input",{className:"excel-form-input",value:e.invoiceNumber,onChange:u=>t({...e,invoiceNumber:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tarih"}),s.jsx("input",{type:"date",className:"excel-form-input",value:e.issueDate,onChange:u=>t({...e,issueDate:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Senaryo"}),s.jsxs("select",{className:"excel-form-select",value:e.scenario,onChange:u=>t({...e,scenario:u.target.value}),children:[s.jsx("option",{value:"E_FATURA",children:"e-Fatura"}),s.jsx("option",{value:"E_ARSIV",children:"e-Arşiv"})]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Müşteri"}),s.jsx("input",{className:"excel-form-input",value:e.customerName,onChange:u=>t({...e,customerName:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"VKN/TCKN"}),s.jsx("input",{className:"excel-form-input",value:e.customerVknTckn,onChange:u=>t({...e,customerVknTckn:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Para Birimi"}),s.jsx("input",{className:"excel-form-input",value:e.currency,onChange:u=>t({...e,currency:u.target.value})})]})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{className:"btn btn-primary",onClick:o,children:[s.jsx(oa,{size:14})," PDF Üret"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:i,children:[s.jsx(oa,{size:14})," UBL XML"]})]})]}),s.jsxs("div",{style:{border:"2px solid #000",padding:"20px",background:"#fff"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[s.jsx(Ls,{size:20}),s.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"e-İrsaliye"})]}),s.jsxs("div",{className:"grid-3",style:{gap:"10px"},children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"İrsaliye No"}),s.jsx("input",{className:"excel-form-input",value:r.despatchNumber,onChange:u=>a({...r,despatchNumber:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tarih"}),s.jsx("input",{type:"date",className:"excel-form-input",value:r.issueDate,onChange:u=>a({...r,issueDate:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Alıcı"}),s.jsx("input",{className:"excel-form-input",value:r.customerName,onChange:u=>a({...r,customerName:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"VKN/TCKN"}),s.jsx("input",{className:"excel-form-input",value:r.customerVknTckn,onChange:u=>a({...r,customerVknTckn:u.target.value})})]})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{className:"btn btn-primary",onClick:c,children:[s.jsx(oa,{size:14})," PDF Üret"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:l,children:[s.jsx(oa,{size:14})," UBL XML"]})]})]}),s.jsxs("div",{style:{border:"2px solid #000",padding:"20px",background:"#fff"},children:[s.jsx("h2",{style:{margin:0,fontSize:"18px",marginBottom:"8px"},children:"e-Defter (PDF/UBL Yerel Çıktı)"}),s.jsx("p",{style:{fontSize:"13px",color:"#555",margin:0},children:"Bu ekranda sadece PDF/UBL çıktısı alabilirsiniz. GİB’e gönderim, mali mühür veya entegratör kullanımı yoktur."})]})]})})}const dy={sku:"",materialName:"",customerId:"",customerGroup:"",price:"",currency:"TRY",discountPercent:"",minQuantity:"",startDate:"",endDate:""};function $O(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(!1),[o,l]=ue.useState(null),[c,u]=ue.useState({...dy});ue.useEffect(()=>{f()},[]);const f=async()=>{try{a(!0);const m=gt(),y=await Wd(m==null?void 0:m.companyId);t(y)}catch(m){const y=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`Fiyat listesi yüklenirken hata: ${m.message||m}`,"PriceListManagement",y==null?void 0:y.id,y==null?void 0:y.username),alert("Veri yüklenirken hata")}finally{a(!1)}},h=()=>{u({...dy}),l(null)},p=async m=>{if(m.preventDefault(),!c.materialName||!c.price||!c.currency){alert("Malzeme adı, fiyat ve para birimi zorunlu");return}const y=parseFloat(c.price),_=c.discountPercent?parseFloat(c.discountPercent):void 0,k=c.minQuantity?parseFloat(c.minQuantity):void 0;if(isNaN(y)||y<=0){alert("Geçerli bir fiyat girin");return}const g=gt(),w={sku:c.sku||void 0,materialName:c.materialName,customerId:c.customerId||void 0,customerGroup:c.customerGroup||void 0,price:y,currency:c.currency,discountPercent:_,minQuantity:k,startDate:c.startDate?new Date(c.startDate):void 0,endDate:c.endDate?new Date(c.endDate):void 0,companyId:g==null?void 0:g.companyId};try{o?(await xL(o,w),alert("Fiyat kuralı güncellendi")):(await mL(w),alert("Fiyat kuralı eklendi")),i(!1),h(),f()}catch(C){alert("Kayıt hatası: "+(C.message||""))}},d=m=>{l(m.id||null),u({sku:m.sku||"",materialName:m.materialName,customerId:m.customerId||"",customerGroup:m.customerGroup||"",price:m.price.toString(),currency:m.currency||"TRY",discountPercent:m.discountPercent!==void 0?m.discountPercent.toString():"",minQuantity:m.minQuantity!==void 0?m.minQuantity.toString():"",startDate:m.startDate?m.startDate.toISOString().split("T")[0]:"",endDate:m.endDate?m.endDate.toISOString().split("T")[0]:""}),i(!0)},v=async m=>{confirm("Silmek istediğinize emin misiniz?")&&(await gL(m),f())};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Iy,{size:24}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:700},children:"Fiyat Listeleri / Kampanyalar"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{h(),i(!0)},children:[s.jsx(Yr,{size:16})," Yeni Kural"]})]}),n&&s.jsx("div",{className:"excel-form",style:{marginBottom:"20px"},children:s.jsxs("form",{onSubmit:p,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Malzeme *"}),s.jsx("input",{className:"excel-form-input",value:c.materialName,onChange:m=>u({...c,materialName:m.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKU"}),s.jsx("input",{className:"excel-form-input",value:c.sku,onChange:m=>u({...c,sku:m.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Müşteri ID"}),s.jsx("input",{className:"excel-form-input",value:c.customerId,onChange:m=>u({...c,customerId:m.target.value}),placeholder:"Boş: tüm müşteriler"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Müşteri Grubu"}),s.jsx("input",{className:"excel-form-input",value:c.customerGroup,onChange:m=>u({...c,customerGroup:m.target.value}),placeholder:"Örn: Gold/Silver"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Fiyat *"}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",value:c.price,onChange:m=>u({...c,price:m.target.value}),required:!0})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Para Birimi"}),s.jsx("input",{className:"excel-form-input",value:c.currency,onChange:m=>u({...c,currency:m.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"İskonto (%)"}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",value:c.discountPercent,onChange:m=>u({...c,discountPercent:m.target.value}),placeholder:"Örn: 5"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Min. Miktar"}),s.jsx("input",{className:"excel-form-input",type:"number",step:"0.01",value:c.minQuantity,onChange:m=>u({...c,minQuantity:m.target.value}),placeholder:"Örn: 10"})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Başlangıç Tarihi"}),s.jsx("input",{className:"excel-form-input",type:"date",value:c.startDate,onChange:m=>u({...c,startDate:m.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Bitiş Tarihi"}),s.jsx("input",{className:"excel-form-input",type:"date",value:c.endDate,onChange:m=>u({...c,endDate:m.target.value})})]})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," ",o?"Güncelle":"Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),h()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:r?s.jsx("div",{style:{padding:"30px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"30px",textAlign:"center",color:"#666"},children:"Henüz fiyat kuralı yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Malzeme"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Müşteri/Grup"}),s.jsx("th",{children:"Fiyat"}),s.jsx("th",{children:"İskonto"}),s.jsx("th",{children:"Min Miktar"}),s.jsx("th",{children:"Geçerlilik"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(m=>s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:600},children:m.materialName}),s.jsx("td",{children:m.sku||"-"}),s.jsx("td",{children:m.customerId?`ID: ${m.customerId}`:m.customerGroup||"Tümü"}),s.jsxs("td",{children:[m.price.toFixed(2)," ",m.currency]}),s.jsx("td",{children:m.discountPercent?`${m.discountPercent}%`:"-"}),s.jsx("td",{children:m.minQuantity||"-"}),s.jsxs("td",{children:[m.startDate?m.startDate.toLocaleDateString("tr-TR"):"-"," / ",m.endDate?m.endDate.toLocaleDateString("tr-TR"):"-"]}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px"},onClick:()=>d(m),children:[s.jsx(jn,{size:12})," Düzenle"]}),s.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:"12px",color:"#dc3545"},onClick:()=>m.id&&v(m.id),children:[s.jsx(xc,{size:12})," Sil"]})]})]},m.id))})]})})]})})}function VO(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState(""),[o,l]=ue.useState(!0);ue.useEffect(()=>{c()},[]);const c=async()=>{try{l(!0);const m=gt(),[y,_]=await Promise.all([To(m==null?void 0:m.companyId),ox({companyId:m==null?void 0:m.companyId})]);t(y),a(_)}catch(m){const y=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`CustomerInsights yüklenirken hata: ${m.message||m}`,"CustomerInsights",y==null?void 0:y.id,y==null?void 0:y.username)}finally{l(!1)}},u=e.find(m=>m.id===n),f=r.filter(m=>m.customerId===n),h=f.reduce((m,y)=>m+(y.totalAmount||0),0),p=(u==null?void 0:u.balance)||0,d=u==null?void 0:u.creditLimit,v=GO(f,5);return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Ty,{size:26}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:700},children:"Müşteri Görünümü"})]})}),s.jsxs("div",{style:{background:"#fff",border:"2px solid #000",padding:"20px",marginBottom:"20px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:"600"},children:"Müşteri Seç"}),s.jsxs("select",{value:n,onChange:m=>i(m.target.value),style:{width:"100%",padding:"10px",border:"2px solid #000",borderRadius:"0",fontSize:"14px"},children:[s.jsx("option",{value:"",children:"Seçiniz"}),e.map(m=>s.jsxs("option",{value:m.id,children:[m.name," ",m.companyName&&`(${m.companyName})`]},m.id))]})]}),o?s.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Yükleniyor..."}):u?s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"15px"},children:[s.jsx(yf,{icon:s.jsx(Pf,{size:16}),label:"Açık Bakiye",value:`${p.toFixed(2)} ₺`}),s.jsx(yf,{icon:s.jsx(Pf,{size:16}),label:"Kredi Limiti",value:d!==void 0?`${d.toFixed(2)} ₺`:"-"}),s.jsx(yf,{icon:s.jsx(A1,{size:16}),label:"Toplam Sevkiyat Tutarı",value:`${h.toFixed(2)} ₺`}),s.jsx(yf,{icon:s.jsx(Ls,{size:16}),label:"Sevkiyat Sayısı",value:`${f.length}`})]}):s.jsx("div",{style:{padding:"20px",color:"#666"},children:"Müşteri seçin."}),u&&s.jsxs("div",{style:{marginTop:"20px",background:"#fff",border:"2px solid #000",padding:"20px"},children:[s.jsx("h3",{style:{marginBottom:"12px",fontWeight:700},children:"En Çok Alınan Ürünler"}),v.length===0?s.jsx("div",{style:{color:"#666"},children:"Kayıt bulunamadı."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Ürün"}),s.jsx("th",{children:"Adet"}),s.jsx("th",{children:"Tutar"})]})}),s.jsx("tbody",{children:v.map((m,y)=>s.jsxs("tr",{children:[s.jsx("td",{children:m.name}),s.jsx("td",{children:m.qty}),s.jsxs("td",{children:[m.amount.toFixed(2)," ₺"]})]},y))})]})]})]})})}function yf({icon:e,label:t,value:r}){return s.jsxs("div",{style:{border:"1px solid #000",padding:"12px",background:"#fff",display:"flex",flexDirection:"column",gap:"6px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",color:"#555"},children:[e," ",s.jsx("span",{children:t})]}),s.jsx("div",{style:{fontSize:"18px",fontWeight:700},children:r})]})}function GO(e,t){const r={};return e.forEach(a=>{(a.items||[]).forEach(n=>{r[n.materialName]||(r[n.materialName]={qty:0,amount:0}),r[n.materialName].qty+=n.quantity||0,r[n.materialName].amount+=(n.quantity||0)*(n.unitPrice||0)})}),Object.entries(r).map(([a,n])=>({name:a,...n})).sort((a,n)=>n.amount-a.amount).slice(0,t)}const Sp={materialName:"",quantity:"",unit:"",unitPrice:"",currency:"TRY",exchangeRate:"1"};function KO(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState(!1),[c,u]=ue.useState(null),[f,h]=ue.useState({quoteNumber:"",quoteDate:new Date().toISOString().split("T")[0],customerId:"",customerName:"",status:"draft",items:[],notes:"",currency:"TRY"}),[p,d]=ue.useState({...Sp,currency:"TRY",exchangeRate:"1"});ue.useEffect(()=>{v()},[]);const v=async()=>{try{const A=gt(),[I,D,B]=await Promise.all([m_(A==null?void 0:A.companyId),To(A==null?void 0:A.companyId),Wd(A==null?void 0:A.companyId)]);t(I),a(D),i(B)}catch(A){const I=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`Teklifler yüklenirken hata: ${A.message||A}`,"QuoteManagement",I==null?void 0:I.id,I==null?void 0:I.username)}},m=()=>{h({quoteNumber:"",quoteDate:new Date().toISOString().split("T")[0],customerId:"",customerName:"",status:"draft",items:[],notes:"",currency:"TRY"}),d({...Sp,currency:"TRY",exchangeRate:"1"}),u(null)},y=()=>{if(!p.materialName||!p.quantity||!p.unit){alert("Malzeme, miktar, birim zorunlu");return}const A=parseFloat(p.quantity);let I=parseFloat(p.unitPrice);const D=p.currency||f.currency||"TRY",B=p.exchangeRate?parseFloat(p.exchangeRate):1;if(isNaN(A)||A<=0){alert("Geçerli miktar girin");return}if(isNaN(I)||I<=0){const z=r.find(q=>q.id===f.customerId),M=ix(p.materialName,f.customerId,z==null?void 0:z.group,n,A,D);I=M?M.discountPercent?M.price*(1-M.discountPercent/100):M.price:0}const L=D===f.currency?I:I*(B||1),F={materialName:p.materialName,quantity:A,unit:p.unit,unitPrice:L,totalPrice:A*L,currency:D,exchangeRate:B||1};h({...f,items:[...f.items,F]}),d({...Sp,currency:f.currency,exchangeRate:"1"})},_=A=>{h({...f,items:f.items.filter((I,D)=>D!==A)})},k=async A=>{if(A.preventDefault(),!f.customerId){alert("Müşteri seçin");return}if(f.items.length===0){alert("En az bir kalem ekleyin");return}const I=f.items.reduce((L,F)=>L+F.totalPrice,0),D=gt(),B={quoteNumber:f.quoteNumber||YO(),quoteDate:new Date(f.quoteDate),customerId:f.customerId,customerName:f.customerName,status:f.status,items:f.items,totalAmount:I,notes:f.notes,companyId:D==null?void 0:D.companyId};c?(await px(c,B),alert("Teklif güncellendi")):(await kO(B),alert("Teklif eklendi")),l(!1),m(),v()},g=A=>{u(A.id||null),h({quoteNumber:A.quoteNumber,quoteDate:A.quoteDate.toISOString().split("T")[0],customerId:A.customerId||"",customerName:A.customerName||"",status:A.status,items:A.items,notes:A.notes||"",currency:A.currency||"TRY"}),l(!0)},w=async A=>{confirm("Silmek istediğinize emin misiniz?")&&(await SO(A),v())},C=async A=>{const I=gt(),D={orderNumber:`SIP-${A.quoteNumber}`,orderDate:new Date,customerId:A.customerId,customerName:A.customerName,supplier:"",status:"pending",items:A.items.map(B=>({materialName:B.materialName,quantity:B.quantity,unit:B.unit,unitPrice:B.unitPrice,totalPrice:B.totalPrice,currency:B.currency,exchangeRate:B.exchangeRate})),totalAmount:A.totalAmount,notes:`Tekliften oluşturuldu: ${A.quoteNumber}`,companyId:I==null?void 0:I.companyId};await g4(D),alert("Sipariş oluşturuldu")},E=A=>{const I=r.find(D=>D.id===A);h({...f,customerId:A,customerName:(I==null?void 0:I.name)||""})};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[s.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[s.jsx(Xo,{size:26}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"Teklif Yönetimi"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>{m(),l(!0)},children:[s.jsx(Yr,{size:14})," Yeni Teklif"]})]}),o&&s.jsx("div",{className:"excel-form",style:{marginBottom:"16px"},children:s.jsxs("form",{onSubmit:k,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Teklif No"}),s.jsx("input",{className:"excel-form-input",value:f.quoteNumber,onChange:A=>h({...f,quoteNumber:A.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tarih"}),s.jsx("input",{type:"date",className:"excel-form-input",value:f.quoteDate,onChange:A=>h({...f,quoteDate:A.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Durum"}),s.jsxs("select",{className:"excel-form-select",value:f.status,onChange:A=>h({...f,status:A.target.value}),children:[s.jsx("option",{value:"draft",children:"Taslak"}),s.jsx("option",{value:"sent",children:"Gönderildi"}),s.jsx("option",{value:"accepted",children:"Kabul"}),s.jsx("option",{value:"rejected",children:"Red"})]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Müşteri"}),s.jsxs("select",{className:"excel-form-select",value:f.customerId,onChange:A=>E(A.target.value),required:!0,children:[s.jsx("option",{value:"",children:"Seçiniz"}),r.map(A=>s.jsxs("option",{value:A.id,children:[A.name," ",A.companyName&&`(${A.companyName})`]},A.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Para Birimi (Belge)"}),s.jsx("input",{className:"excel-form-input",value:f.currency,onChange:A=>h({...f,currency:A.target.value})})]})]}),s.jsxs("div",{style:{marginTop:"14px",padding:"12px",border:"1px dashed #999"},children:[s.jsx("h4",{style:{marginBottom:"10px"},children:"Kalem Ekle"}),s.jsxs("div",{className:"grid-4",style:{gap:"8px"},children:[s.jsx("input",{className:"excel-form-input",placeholder:"Malzeme",value:p.materialName,onChange:A=>d({...p,materialName:A.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Miktar",value:p.quantity,onChange:A=>d({...p,quantity:A.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim",value:p.unit,onChange:A=>d({...p,unit:A.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim Fiyat (boş: kural)",value:p.unitPrice,onChange:A=>d({...p,unitPrice:A.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Kalem PB (vars: belge PB)",value:p.currency,onChange:A=>d({...p,currency:A.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:`Kur -> ${f.currency}`,value:p.exchangeRate,onChange:A=>d({...p,exchangeRate:A.target.value})})]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",style:{marginTop:"10px"},onClick:y,children:[s.jsx(Yr,{size:12})," Ekle"]}),f.items.length>0&&s.jsxs("table",{className:"excel-table",style:{marginTop:"10px"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Malzeme"}),s.jsx("th",{children:"Miktar"}),s.jsx("th",{children:"Birim"}),s.jsx("th",{children:"Birim Fiyat"}),s.jsx("th",{children:"Kalem PB"}),s.jsx("th",{children:"Toplam"}),s.jsx("th",{})]})}),s.jsx("tbody",{children:f.items.map((A,I)=>s.jsxs("tr",{children:[s.jsx("td",{children:A.materialName}),s.jsx("td",{children:A.quantity}),s.jsx("td",{children:A.unit}),s.jsxs("td",{children:[A.unitPrice.toFixed(2)," ",f.currency]}),s.jsxs("td",{children:[A.currency||f.currency," ",A.currency&&A.currency!==f.currency?`(kur ${A.exchangeRate||1})`:""]}),s.jsxs("td",{children:[A.totalPrice.toFixed(2)," ",f.currency]}),s.jsx("td",{children:s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>_(I),children:s.jsx(ea,{size:12})})})]},I))})]})]}),s.jsxs("div",{style:{marginTop:"10px"},children:[s.jsx("label",{className:"excel-form-label",children:"Not"}),s.jsx("textarea",{className:"excel-form-input",rows:3,value:f.notes,onChange:A=>h({...f,notes:A.target.value})})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(!1),m()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Teklif No"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Müşteri"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Tutar"}),s.jsx("th",{children:"PB"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(A=>s.jsxs("tr",{children:[s.jsx("td",{children:A.quoteNumber}),s.jsx("td",{children:A.quoteDate.toLocaleDateString("tr-TR")}),s.jsx("td",{children:A.customerName}),s.jsx("td",{children:XO(A.status)}),s.jsxs("td",{children:[A.totalAmount.toFixed(2)," ",A.currency||"TRY"]}),s.jsx("td",{children:A.currency||"TRY"}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>g(A),children:[s.jsx(jn,{size:12})," Düzenle"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>A.id&&w(A.id),style:{color:"#dc3545"},children:[s.jsx(xc,{size:12})," Sil"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>C(A),children:[s.jsx(S1,{size:12})," Sipariş"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>hy(A,"sent"),children:[s.jsx(N3,{size:12})," Gönder"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>hy(A,"accepted"),children:[s.jsx(k1,{size:12})," Kabul"]})]})]},A.id))})]})})]})})}const YO=()=>{const e=new Date;return`TEK-${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}-${Math.floor(Math.random()*900+100)}`},XO=e=>{switch(e){case"draft":return"Taslak";case"sent":return"Gönderildi";case"accepted":return"Kabul";case"rejected":return"Red";default:return e}};async function hy(e,t){e.id&&(await px(e.id,{status:t}),alert("Durum güncellendi"))}const Kd="boms",wx="productionOrders",S_="workLogs",g1=e=>Array.isArray(e)?e.map(g1).filter(t=>t!==void 0):e&&typeof e=="object"?Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0).map(([t,r])=>[t,g1(r)])):e,A_=e=>({...g1(e),createdAt:Ye.now(),updatedAt:Ye.now()}),JO=async e=>(await Or(lt(qe,Kd),A_(e))).id,Yd=async e=>{let t=Ke(lt(qe,Kd),ua("productName","asc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o;const n=a.data();return{id:a.id,...n,createdAt:(i=n.createdAt)==null?void 0:i.toDate(),updatedAt:(o=n.updatedAt)==null?void 0:o.toDate()}})},ZO=async(e,t)=>{const r=ir(qe,Kd,e);await Xr(r,{...t,updatedAt:Ye.now()})},QO=async e=>{await os(ir(qe,Kd,e))},e9=async e=>(await Or(lt(qe,wx),A_(e))).id,t9=async(e,t)=>{const r=ir(qe,wx,e),a={...t,updatedAt:Ye.now()};t.plannedDate&&(a.plannedDate=Ye.fromDate(t.plannedDate)),t.startedAt&&(a.startedAt=Ye.fromDate(t.startedAt)),t.finishedAt&&(a.finishedAt=Ye.fromDate(t.finishedAt)),await Xr(r,a)},N_=async e=>{let t=Ke(lt(qe,wx),ua("orderNumber","desc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l,c,u;const n=a.data();return{id:a.id,...n,plannedDate:(i=n.plannedDate)==null?void 0:i.toDate(),startedAt:(o=n.startedAt)==null?void 0:o.toDate(),finishedAt:(l=n.finishedAt)==null?void 0:l.toDate(),createdAt:(c=n.createdAt)==null?void 0:c.toDate(),updatedAt:(u=n.updatedAt)==null?void 0:u.toDate()}})},r9=async e=>(await Or(lt(qe,S_),{...e,timestamp:Ye.fromDate(e.timestamp)})).id,a9=async e=>{const t=Ke(lt(qe,S_),ot("productionOrderId","==",e),ua("timestamp","desc"));return(await lr(t)).docs.map(a=>{var i;const n=a.data();return{id:a.id,...n,timestamp:(i=n.timestamp)==null?void 0:i.toDate()}})},Ap={materialName:"",quantity:"",unit:"",type:"raw",costPerUnit:""};function n9(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!1),[n,i]=ue.useState(null),[o,l]=ue.useState({productName:"",sku:"",version:"",items:[]}),[c,u]=ue.useState({...Ap}),[f,h]=ue.useState(!0);ue.useEffect(()=>{p()},[]);const p=async()=>{h(!0);const g=gt(),w=await Yd(g==null?void 0:g.companyId);t(w),h(!1)},d=()=>{if(!c.materialName||!c.quantity||!c.unit){alert("Malzeme, miktar, birim zorunlu");return}const g=parseFloat(String(c.quantity));if(isNaN(g)||g<=0){alert("Geçerli miktar girin");return}const w=c.costPerUnit?parseFloat(String(c.costPerUnit)):void 0,C={materialName:c.materialName,quantity:g,unit:c.unit,type:c.type,costPerUnit:w};l({...o,items:[...o.items,C]}),u({...Ap})},v=g=>{l({...o,items:o.items.filter((w,C)=>C!==g)})},m=async g=>{if(g.preventDefault(),!o.productName||o.items.length===0){alert("Ürün adı ve en az bir kalem girin");return}const w=gt(),C={productName:o.productName,sku:o.sku||void 0,version:o.version||void 0,items:o.items,companyId:w==null?void 0:w.companyId};n?(await ZO(n,C),alert("BOM güncellendi")):(await JO(C),alert("BOM eklendi")),a(!1),y(),p()},y=()=>{i(null),l({productName:"",sku:"",version:"",items:[]}),u({...Ap})},_=g=>{i(g.id||null),l({productName:g.productName,sku:g.sku||"",version:g.version||"",items:g.items||[]}),a(!0)},k=async g=>{g&&confirm("Silmek istediğinize emin misiniz?")&&(await QO(g),p())};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[s.jsx(w3,{size:26}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"Ürün Reçeteleri (BOM)"}),s.jsxs("button",{className:"btn btn-primary",style:{marginLeft:"auto"},onClick:()=>{y(),a(!0)},children:[s.jsx(Yr,{size:14})," Yeni BOM"]})]}),r&&s.jsx("div",{className:"excel-form",style:{marginBottom:"16px"},children:s.jsxs("form",{onSubmit:m,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Ürün Adı *"}),s.jsx("input",{className:"excel-form-input",value:o.productName,onChange:g=>l({...o,productName:g.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SKU"}),s.jsx("input",{className:"excel-form-input",value:o.sku,onChange:g=>l({...o,sku:g.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Versiyon"}),s.jsx("input",{className:"excel-form-input",value:o.version,onChange:g=>l({...o,version:g.target.value})})]})]}),s.jsxs("div",{style:{marginTop:"12px",padding:"12px",border:"1px dashed #999"},children:[s.jsx("h4",{children:"Kalem Ekle"}),s.jsxs("div",{className:"grid-4",style:{gap:"8px"},children:[s.jsx("input",{className:"excel-form-input",placeholder:"Malzeme",value:c.materialName,onChange:g=>u({...c,materialName:g.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Miktar",value:c.quantity,onChange:g=>u({...c,quantity:g.target.value})}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim",value:c.unit,onChange:g=>u({...c,unit:g.target.value})}),s.jsxs("select",{className:"excel-form-select",value:c.type,onChange:g=>u({...c,type:g.target.value}),children:[s.jsx("option",{value:"raw",children:"Hammadde"}),s.jsx("option",{value:"semi",children:"Yarı Mamul"}),s.jsx("option",{value:"labor",children:"İşçilik"})]}),s.jsx("input",{className:"excel-form-input",placeholder:"Birim Maliyeti",value:c.costPerUnit,onChange:g=>u({...c,costPerUnit:g.target.value})}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:d,children:[s.jsx(Yr,{size:12})," Ekle"]})]}),o.items.length>0&&s.jsxs("table",{className:"excel-table",style:{marginTop:"10px"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Malzeme"}),s.jsx("th",{children:"Miktar"}),s.jsx("th",{children:"Birim"}),s.jsx("th",{children:"Tür"}),s.jsx("th",{children:"Birim Maliyet"}),s.jsx("th",{})]})}),s.jsx("tbody",{children:o.items.map((g,w)=>s.jsxs("tr",{children:[s.jsx("td",{children:g.materialName}),s.jsx("td",{children:g.quantity}),s.jsx("td",{children:g.unit}),s.jsx("td",{children:g.type}),s.jsx("td",{children:g.costPerUnit??"-"}),s.jsx("td",{children:s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>v(w),children:s.jsx(ea,{size:12})})})]},w))})]})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{type:"submit",className:"btn btn-primary",children:[s.jsx(oa,{size:14})," Kaydet"]}),s.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:()=>{a(!1),y()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:f?s.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Kayıt yok."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Ürün"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Versiyon"}),s.jsx("th",{children:"Kalem"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(g=>{var w;return s.jsxs("tr",{children:[s.jsx("td",{children:g.productName}),s.jsx("td",{children:g.sku||"-"}),s.jsx("td",{children:g.version||"-"}),s.jsx("td",{children:((w=g.items)==null?void 0:w.length)||0}),s.jsxs("td",{style:{display:"flex",gap:"6px"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>_(g),children:[s.jsx(jn,{size:12})," Düzenle"]}),s.jsxs("button",{className:"btn btn-secondary",style:{color:"#dc3545"},onClick:()=>k(g.id),children:[s.jsx(xc,{size:12})," Sil"]})]})]},g.id)})})]})})]})})}function i9(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState(!0),[c,u]=ue.useState(!1),[f,h]=ue.useState(!1),[p,d]=ue.useState(!1),[v,m]=ue.useState(!1),[y,_]=ue.useState(""),[k,g]=ue.useState(7),[w,C]=ue.useState({});ue.useEffect(()=>{E()},[]);const E=async()=>{try{l(!0);const I=gt(),[D,B,L]=await Promise.all([Md({companyId:I==null?void 0:I.companyId}),Yd(I==null?void 0:I.companyId),gc(I==null?void 0:I.companyId)]);t(D),a(B),i(L)}catch(I){const D=localStorage.getItem("currentUser"),B=D?JSON.parse(D):null;await ur(`MRP yüklenirken hata: ${I.message||I}`,"MRPPlanner",B==null?void 0:B.id,B==null?void 0:B.username),alert("Veriler yüklenirken hata")}finally{l(!1)}},A=ue.useMemo(()=>{const I=[],D=new Map;return n.forEach(B=>D.set(`${B.materialName}|${B.unit}`,{qty:B.currentStock,unit:B.unit})),e.filter(B=>B.status!=="cancelled").forEach(B=>{B.items.forEach(L=>{const F=r.find(z=>z.productName===L.materialName||z.sku===L.materialName);F&&F.items.forEach(z=>{var pe;const M=z.quantity*L.quantity,q=`${z.materialName}|${z.unit}`,fe=((pe=D.get(q))==null?void 0:pe.qty)||0,he=Math.max(0,M-fe);I.push({materialName:z.materialName,needed:M,unit:z.unit,available:fe,shortage:he,product:F.productName})})})}),I.filter(B=>B.shortage>0).sort((B,L)=>L.shortage-B.shortage)},[e,r,n]);return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(If,{size:24}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"MRP (Eksik Malzeme Listesi)"})]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>{E(),u(!0)},children:[s.jsx(fd,{size:14})," MRP Çalıştır"]})]}),s.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",marginBottom:"12px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"12px",fontWeight:600},children:"Varsayılan Tedarikçi"}),s.jsx("input",{className:"excel-form-input",value:y,onChange:I=>_(I.target.value),placeholder:"Örn: ABC Tedarik",style:{width:"220px"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"12px",fontWeight:600},children:"Lead Time (gün)"}),s.jsx("input",{type:"number",className:"excel-form-input",value:k,onChange:I=>g(parseInt(I.target.value||"0",10)),style:{width:"120px"}})]})]}),o&&s.jsx("div",{style:{padding:"20px"},children:"Yükleniyor..."}),c&&A.length===0&&!o&&s.jsx("div",{style:{padding:"20px",color:"#555"},children:"Eksik malzeme yok."}),c&&A.length>0&&s.jsxs("div",{className:"table-container",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>s9(A),children:[s.jsx(Zn,{size:14})," CSV Dışa Aktar"]}),s.jsxs("button",{className:"btn btn-primary",style:{marginLeft:"8px"},disabled:f,onClick:()=>o9(A,h),children:[s.jsx(Xo,{size:14})," Satınalma Talebi"]}),s.jsxs("button",{className:"btn btn-primary",style:{marginLeft:"8px"},disabled:p,onClick:()=>l9(A,w,y,k,d),children:[s.jsx(dg,{size:14})," RFQ Oluştur"]}),s.jsxs("button",{className:"btn btn-primary",style:{marginLeft:"8px"},disabled:v,onClick:()=>c9(A,w,y,k,m),children:[s.jsx(dg,{size:14})," PO Oluştur"]})]}),s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Malzeme"}),s.jsx("th",{children:"İhtiyaç"}),s.jsx("th",{children:"Mevcut"}),s.jsx("th",{children:"Açık"}),s.jsx("th",{children:"Tedarikçi"}),s.jsx("th",{children:"Ürün"})]})}),s.jsx("tbody",{children:A.map((I,D)=>s.jsxs("tr",{children:[s.jsx("td",{children:I.materialName}),s.jsxs("td",{children:[I.needed.toFixed(2)," ",I.unit]}),s.jsxs("td",{children:[I.available.toFixed(2)," ",I.unit]}),s.jsxs("td",{style:{color:"#dc3545",fontWeight:700},children:[I.shortage.toFixed(2)," ",I.unit]}),s.jsx("td",{children:s.jsx("input",{className:"excel-form-input",value:w[I.materialName]||y,onChange:B=>C({...w,[I.materialName]:B.target.value}),placeholder:"Tedarikçi",style:{width:"140px"}})}),s.jsx("td",{children:I.product})]},D))})]})]})]})})}const s9=e=>{const t=["Malzeme","İhtiyaç","Mevcut","Açık","Birim","Ürün"],r=e.map(l=>[l.materialName,l.needed,l.available,l.shortage,l.unit,l.product].join(",")),a=[t.join(","),...r].join(`
`),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=`mrp_${new Date().toISOString().slice(0,10)}.csv`,o.click(),URL.revokeObjectURL(i)},o9=async(e,t)=>{try{t(!0);const r=gt(),a=e.map(i=>({materialName:i.materialName,quantity:i.shortage,unit:i.unit,notes:`MRP ürün: ${i.product}`})),n=`MRP-${new Date().getTime()}`;await v_({reqNumber:n,requestDate:new Date,requestedBy:"MRP",status:"draft",items:a,companyId:r==null?void 0:r.companyId}),alert("Satınalma talebi oluşturuldu")}catch(r){alert("Talep oluşturulurken hata: "+(r.message||r))}finally{t(!1)}},l9=async(e,t,r,a,n)=>{try{n(!0);const i=gt(),o=e.map(u=>({materialName:u.materialName,quantity:u.shortage,unit:u.unit,notes:`MRP ürün: ${u.product}`})),l=Array.from(new Set(o.map(u=>t[u.materialName]||r).filter(Boolean)));if(l.length===0){alert("RFQ için en az bir tedarikçi girin");return}const c=`RFQ-${new Date().getTime()}`;await y_({rfqNumber:c,suppliers:l,dueDate:new Date(Date.now()+a*24*60*60*1e3),items:o,status:"open",companyId:i==null?void 0:i.companyId}),alert("RFQ oluşturuldu")}catch(i){alert("RFQ oluşturulurken hata: "+(i.message||i))}finally{n(!1)}},c9=async(e,t,r,a,n)=>{try{n(!0);const i=gt(),o={};e.forEach(u=>{const f=t[u.materialName]||r;f&&(o[f]||(o[f]=[]),o[f].push(u))});const l=Object.keys(o);if(l.length===0){alert("PO için tedarikçi girin");return}const c=new Date;for(const u of l){const f=o[u].map(p=>({materialName:p.materialName,quantity:p.shortage,unit:p.unit,notes:`MRP ürün: ${p.product}`})),h=`PO-${u}-${new Date().getTime()}`;await w_({poNumber:h,supplier:u,orderDate:c,items:f,status:"pending",totalAmount:0,companyId:i==null?void 0:i.companyId})}alert(`PO oluşturuldu (${l.length} tedarikçi)`)}catch(i){alert("PO oluşturulurken hata: "+(i.message||i))}finally{n(!1)}};function u9(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState([]),[o,l]=ue.useState({}),[c,u]=ue.useState({}),[f,h]=ue.useState([]),[p,d]=ue.useState(!1),[v,m]=ue.useState({orderNumber:"",productName:"",quantity:"",unit:"",bomId:"",workstation:"",plannedDate:new Date().toISOString().split("T")[0]});ue.useEffect(()=>{y()},[]);const y=async()=>{try{const C=gt(),[E,A,I]=await Promise.all([N_(C==null?void 0:C.companyId),Yd(C==null?void 0:C.companyId),ud({companyId:C==null?void 0:C.companyId})]);t(E),a(A),i(I),h(h9(E))}catch(C){console.error("ShopFloor load error:",C);const E=JSON.parse(localStorage.getItem("currentUser")||"null");await ur(`ShopFloor yüklenirken hata: ${C.message||C}`,"ShopFloor",E==null?void 0:E.id,E==null?void 0:E.username),alert("Veri yüklenirken hata: "+(C.message||"Bilinmeyen hata"))}},_=async C=>{const E=await a9(C);u(A=>({...A,[C]:E}))},k=async C=>{if(C.preventDefault(),!v.orderNumber||!v.productName||!v.quantity||!v.unit){alert("Zorunlu alanları doldurun");return}const E=parseFloat(v.quantity);if(isNaN(E)||E<=0){alert("Geçerli miktar girin");return}const A=v.plannedDate?new Date(v.plannedDate):void 0,I=A&&!isNaN(A.getTime()),D=gt(),B={orderNumber:v.orderNumber,productName:v.productName,quantity:E,unit:v.unit,status:"planned",companyId:D==null?void 0:D.companyId};I&&(B.plannedDate=A),v.bomId&&(B.bomId=v.bomId),v.workstation&&(B.workstation=v.workstation);try{await e9(B),alert("İş emri eklendi"),d(!1),g(),y()}catch(L){alert("İş emri kaydedilirken hata: "+(L.message||L))}},g=()=>{m({orderNumber:"",productName:"",quantity:"",unit:"",bomId:"",workstation:"",plannedDate:new Date().toISOString().split("T")[0]})},w=async(C,E,A)=>{var B;const I=n.find(L=>L.id===A),D=new Date;await t9(C,{status:E,startedAt:E==="in_progress"?D:void 0,finishedAt:E==="completed"?D:void 0}),await r9({productionOrderId:C,action:E==="in_progress"?"start":E==="completed"?"complete":"stop",operatorId:A,operatorName:I==null?void 0:I.name,timestamp:D,companyId:(B=gt())==null?void 0:B.companyId}),y()};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[s.jsx(Xo,{size:24}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"Shop Floor / İş Emirleri"}),s.jsxs("button",{className:"btn btn-primary",style:{marginLeft:"auto"},onClick:()=>d(!0),children:[s.jsx(Yr,{size:14})," Yeni İş Emri"]})]}),p&&s.jsx("div",{className:"excel-form",style:{marginBottom:"16px"},children:s.jsxs("form",{onSubmit:k,children:[s.jsxs("div",{className:"grid-4",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"İş Emri No"}),s.jsx("input",{className:"excel-form-input",value:v.orderNumber,onChange:C=>m({...v,orderNumber:C.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Ürün"}),s.jsx("input",{className:"excel-form-input",value:v.productName,onChange:C=>m({...v,productName:C.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Miktar"}),s.jsx("input",{className:"excel-form-input",value:v.quantity,onChange:C=>m({...v,quantity:C.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Birim"}),s.jsx("input",{className:"excel-form-input",value:v.unit,onChange:C=>m({...v,unit:C.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"BOM"}),s.jsxs("select",{className:"excel-form-select",value:v.bomId,onChange:C=>m({...v,bomId:C.target.value}),children:[s.jsx("option",{value:"",children:"Seçiniz"}),r.map(C=>s.jsxs("option",{value:C.id,children:[C.productName," ",C.version&&`(${C.version})`]},C.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"İş İstasyonu"}),s.jsx("input",{className:"excel-form-input",value:v.workstation,onChange:C=>m({...v,workstation:C.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Planlanan Tarih"}),s.jsx("input",{type:"date",className:"excel-form-input",value:v.plannedDate,onChange:C=>m({...v,plannedDate:C.target.value})})]})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[s.jsxs("button",{className:"btn btn-primary",type:"submit",children:[s.jsx(oa,{size:14})," Kaydet"]}),s.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:()=>{d(!1),g()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"İş Emri"}),s.jsx("th",{children:"Ürün"}),s.jsx("th",{children:"Miktar"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"İstasyon"}),s.jsx("th",{children:"Plan Tarih"}),s.jsx("th",{children:"Operatör"}),s.jsx("th",{children:"Süre"}),s.jsx("th",{children:"Log"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(C=>s.jsxs("tr",{children:[s.jsx("td",{children:C.orderNumber}),s.jsx("td",{children:C.productName}),s.jsxs("td",{children:[C.quantity," ",C.unit]}),s.jsx("td",{children:f9(C.status)}),s.jsx("td",{children:C.workstation||"-"}),s.jsx("td",{children:C.plannedDate?C.plannedDate.toLocaleDateString("tr-TR"):"-"}),s.jsx("td",{children:s.jsxs("select",{className:"excel-form-select",value:o[C.id||""]||"",onChange:E=>l({...o,[C.id||""]:E.target.value}),children:[s.jsx("option",{value:"",children:"Seç"}),n.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})}),s.jsx("td",{children:d9(C)}),s.jsx("td",{children:s.jsxs("button",{className:"btn btn-secondary",onClick:()=>C.id&&_(C.id),children:[s.jsx(k3,{size:12})," Log"]})}),s.jsxs("td",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>C.id&&w(C.id,"in_progress",o[C.id||""]),children:[s.jsx(S3,{size:12})," Başlat"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>C.id&&w(C.id,"completed",o[C.id||""]),children:[s.jsx(k1,{size:12})," Tamamla"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>C.id&&w(C.id,"cancelled",o[C.id||""]),children:[s.jsx(j3,{size:12})," İptal"]})]})]},C.id))})]})}),Object.keys(c).length>0&&s.jsxs("div",{style:{marginTop:"16px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:700,marginBottom:"8px"},children:"İş Emri Logları"}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"6px"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>p9(c),children:[s.jsx(Zn,{size:14})," CSV"]}),s.jsxs("button",{className:"btn btn-secondary",style:{marginLeft:"8px"},onClick:()=>m9(c),children:[s.jsx(Bs,{size:14})," PDF"]})]}),Object.entries(c).map(([C,E])=>s.jsxs("div",{style:{marginBottom:"10px"},children:[s.jsxs("div",{style:{fontWeight:600,marginBottom:"4px"},children:["İş Emri: ",C]}),s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Aksiyon"}),s.jsx("th",{children:"Operatör"}),s.jsx("th",{children:"Zaman"}),s.jsx("th",{children:"Not"})]})}),s.jsx("tbody",{children:E.map(A=>s.jsxs("tr",{children:[s.jsx("td",{children:j_(A.action)}),s.jsx("td",{children:A.operatorName||A.operatorId||"-"}),s.jsx("td",{children:A.timestamp.toLocaleString("tr-TR")}),s.jsx("td",{children:A.note||"-"})]},A.id))})]})]},C))]}),f.length>0&&s.jsxs("div",{style:{marginTop:"16px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:700,marginBottom:"8px"},children:"İstasyon / Gün Süre Özeti"}),s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"İstasyon"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Toplam Süre (dk)"})]})}),s.jsx("tbody",{children:f.map((C,E)=>s.jsxs("tr",{children:[s.jsx("td",{children:C.workstation||"-"}),s.jsx("td",{children:C.date}),s.jsx("td",{children:C.minutes.toFixed(0)})]},E))})]})]})]})})}const f9=e=>{switch(e){case"planned":return"Planlandı";case"in_progress":return"Devam";case"completed":return"Tamamlandı";case"cancelled":return"İptal";default:return e}},d9=e=>e.status==="completed"&&e.startedAt&&e.finishedAt?`${Math.max(0,(e.finishedAt.getTime()-e.startedAt.getTime())/6e4).toFixed(0)} dk`:e.status==="in_progress"&&e.startedAt?`Devam (${Math.max(0,(Date.now()-e.startedAt.getTime())/6e4).toFixed(0)} dk)`:"-",j_=e=>e==="start"?"Başlat":e==="complete"?"Tamamla":e==="stop"?"Durdur":e,h9=e=>{const t={};return e.forEach(r=>{if(r.startedAt&&r.finishedAt){const a=Math.max(0,(r.finishedAt.getTime()-r.startedAt.getTime())/6e4),n=`${r.workstation||"Genel"}|${r.startedAt.toISOString().slice(0,10)}`;t[n]=(t[n]||0)+a}}),Object.entries(t).map(([r,a])=>{const[n,i]=r.split("|");return{workstation:n,date:i,minutes:a}})},p9=e=>{const t=["IsEmri","Aksiyon","Operatör","Zaman","Not"],r=[];Object.entries(e).forEach(([l,c])=>{c.forEach(u=>{r.push([l,u.action,u.operatorName||u.operatorId||"",u.timestamp.toISOString(),u.note||""].join(","))})});const a=[t.join(","),...r].join(`
`),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=`shopfloor_logs_${new Date().toISOString().slice(0,10)}.csv`,o.click(),URL.revokeObjectURL(i)},m9=e=>{const t=new ht;let r=14;t.setFontSize(14),t.text("Shop Floor Log Raporu",14,r),r+=10,t.setFontSize(10),Object.entries(e).forEach(([a,n])=>{t.text(`Is Emri: ${a}`,14,r),r+=6,n.forEach(i=>{const o=`${j_(i.action)} | ${i.operatorName||i.operatorId||"-"} | ${i.timestamp.toLocaleString("tr-TR")} | ${i.note||""}`;t.text(o,16,r),r+=5,r>280&&(t.addPage(),r=14)}),r+=4,r>280&&(t.addPage(),r=14)}),t.save(`shopfloor_logs_${new Date().toISOString().slice(0,10)}.pdf`)},Xd="leaveRequests",x9=async e=>(await Or(lt(qe,Xd),{...e,startDate:Ye.fromDate(e.startDate),endDate:Ye.fromDate(e.endDate),createdAt:Ye.now(),updatedAt:Ye.now()})).id,T_=async e=>{let t=Ke(lt(qe,Xd),ua("startDate","desc"));return e&&(t=Ke(t,ot("companyId","==",e))),(await lr(t)).docs.map(a=>{var i,o,l,c;const n=a.data();return{id:a.id,...n,startDate:(i=n.startDate)==null?void 0:i.toDate(),endDate:(o=n.endDate)==null?void 0:o.toDate(),createdAt:(l=n.createdAt)==null?void 0:l.toDate(),updatedAt:(c=n.updatedAt)==null?void 0:c.toDate()}})},py=async(e,t)=>{const r=ir(qe,Xd,e),a={...t,updatedAt:Ye.now()};t.startDate&&(a.startDate=Ye.fromDate(t.startDate)),t.endDate&&(a.endDate=Ye.fromDate(t.endDate)),await Xr(r,a)},g9=async e=>{await os(ir(qe,Xd,e))},v9=e=>{const t=e.sgkPercent??14,r=e.unemploymentPercent??1,a=e.besPercent??3,n=e.taxPercent??20,i=e.garnishment??0,o=e.gross*(t/100),l=e.gross*(r/100),c=e.gross*(a/100),f=(e.gross-o-l-c)*(n/100);return{net:e.gross-o-l-c-f-i,sgk:o,unemployment:l,bes:c,tax:f,garnishment:i,gross:e.gross}};function y9(){const[e,t]=ue.useState([]),[r,a]=ue.useState([]),[n,i]=ue.useState(!1),[o,l]=ue.useState({personnelId:"",startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],type:"annual",note:""}),[c,u]=ue.useState(null);ue.useEffect(()=>{f()},[]);const f=async()=>{const y=gt(),[_,k]=await Promise.all([ud({companyId:y==null?void 0:y.companyId}),T_(y==null?void 0:y.companyId)]);a(_),t(k)},h=async y=>{if(y.preventDefault(),!o.personnelId){alert("Personel seçin");return}const _=b9(o.startDate,o.endDate),k=gt(),g=r.find(C=>C.id===o.personnelId),w={personnelId:o.personnelId,personnelName:g==null?void 0:g.name,startDate:new Date(o.startDate),endDate:new Date(o.endDate),type:o.type,days:_,status:"pending",note:o.note,companyId:k==null?void 0:k.companyId};c?(await py(c,w),alert("İzin güncellendi")):(await x9(w),alert("İzin eklendi")),i(!1),p(),f()},p=()=>{u(null),l({personnelId:"",startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],type:"annual",note:""})},d=y=>{u(y.id||null),l({personnelId:y.personnelId,startDate:y.startDate.toISOString().split("T")[0],endDate:y.endDate.toISOString().split("T")[0],type:y.type,note:y.note||""}),i(!0)},v=async y=>{y&&confirm("Silmek istediğinize emin misiniz?")&&(await g9(y),f())},m=async(y,_)=>{await py(y,{status:_}),f()};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[s.jsx(Lf,{size:24}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"İzin Yönetimi"}),s.jsxs("button",{className:"btn btn-primary",style:{marginLeft:"auto"},onClick:()=>i(!0),children:[s.jsx(Yr,{size:14})," Yeni İzin"]})]}),n&&s.jsx("div",{className:"excel-form",style:{marginBottom:"16px"},children:s.jsxs("form",{onSubmit:h,children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Personel"}),s.jsxs("select",{className:"excel-form-select",value:o.personnelId,onChange:y=>l({...o,personnelId:y.target.value}),children:[s.jsx("option",{value:"",children:"Seçiniz"}),r.map(y=>s.jsx("option",{value:y.id,children:y.name},y.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Başlangıç"}),s.jsx("input",{type:"date",className:"excel-form-input",value:o.startDate,onChange:y=>l({...o,startDate:y.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Bitiş"}),s.jsx("input",{type:"date",className:"excel-form-input",value:o.endDate,onChange:y=>l({...o,endDate:y.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Tür"}),s.jsxs("select",{className:"excel-form-select",value:o.type,onChange:y=>l({...o,type:y.target.value}),children:[s.jsx("option",{value:"annual",children:"Yıllık"}),s.jsx("option",{value:"sick",children:"Hastalık"}),s.jsx("option",{value:"unpaid",children:"Ücretsiz"})]})]})]}),s.jsxs("div",{className:"excel-form-group",style:{marginTop:"10px"},children:[s.jsx("label",{className:"excel-form-label",children:"Not"}),s.jsx("textarea",{className:"excel-form-input",rows:2,value:o.note,onChange:y=>l({...o,note:y.target.value})})]}),s.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[s.jsxs("button",{className:"btn btn-primary",type:"submit",children:[s.jsx(oa,{size:14})," Kaydet"]}),s.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:()=>{i(!1),p()},children:[s.jsx(ea,{size:14})," İptal"]})]})]})}),s.jsxs("div",{className:"table-container",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>w9(e),children:[s.jsx(Zn,{size:14})," CSV"]}),s.jsxs("button",{className:"btn btn-secondary",style:{marginLeft:"8px"},onClick:()=>_9(e),children:[s.jsx(Bs,{size:14})," PDF"]})]}),s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Personel"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Süre"}),s.jsx("th",{children:"Tür"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Not"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(y=>s.jsxs("tr",{children:[s.jsx("td",{children:y.personnelName||y.personnelId}),s.jsxs("td",{children:[y.startDate.toLocaleDateString("tr-TR")," - ",y.endDate.toLocaleDateString("tr-TR")]}),s.jsxs("td",{children:[y.days," gün"]}),s.jsx("td",{children:E_(y.type)}),s.jsx("td",{children:C_(y.status)}),s.jsx("td",{children:y.note||"-"}),s.jsxs("td",{style:{display:"flex",gap:"6px"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>d(y),children:[s.jsx(jn,{size:12})," Düzenle"]}),s.jsxs("button",{className:"btn btn-secondary",style:{color:"#dc3545"},onClick:()=>v(y.id),children:[s.jsx(xc,{size:12})," Sil"]}),y.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>y.id&&m(y.id,"approved"),children:[s.jsx(k1,{size:12})," Onay"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>y.id&&m(y.id,"rejected"),children:[s.jsx(ea,{size:12})," Reddet"]})]})]})]},y.id))})]})]})]})})}const b9=(e,t)=>{const r=new Date(e),n=(new Date(t).getTime()-r.getTime())/(1e3*60*60*24)+1;return Math.max(0,Math.round(n))},E_=e=>e==="annual"?"Yıllık":e==="sick"?"Hastalık":"Ücretsiz",C_=e=>e==="pending"?"Beklemede":e==="approved"?"Onaylı":"Reddedildi",w9=e=>{const t=["Personel","Başlangıç","Bitiş","Süre","Tür","Durum","Not"],r=e.map(l=>[l.personnelName||l.personnelId,l.startDate.toISOString().slice(0,10),l.endDate.toISOString().slice(0,10),l.days,l.type,l.status,l.note||""].join(",")),a=[t.join(","),...r].join(`
`),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=`izinler_${new Date().toISOString().slice(0,10)}.csv`,o.click(),URL.revokeObjectURL(i)},_9=e=>{const t=new ht;let r=14;t.setFontSize(14),t.text("İzin Listesi",14,r),r+=8,t.setFontSize(10),e.forEach(a=>{const n=`${a.personnelName||a.personnelId} | ${a.startDate.toLocaleDateString("tr-TR")} - ${a.endDate.toLocaleDateString("tr-TR")} | ${a.days} gün | ${E_(a.type)} | ${C_(a.status)}`;t.text(n,14,r),a.note&&(r+=5,t.text(`Not: ${a.note}`,18,r)),r+=7,r>280&&(t.addPage(),r=14)}),t.save(`izinler_${new Date().toISOString().slice(0,10)}.pdf`)};function k9(){const[e,t]=ue.useState({gross:"",sgkPercent:"14",unemploymentPercent:"1",besPercent:"3",taxPercent:"20",garnishment:"0"}),[r,a]=ue.useState(null),n=i=>{i.preventDefault();const o=parseFloat(e.gross);if(isNaN(o)||o<=0){alert("Geçerli brüt maaş girin");return}const l=v9({gross:o,sgkPercent:parseFloat(e.sgkPercent),unemploymentPercent:parseFloat(e.unemploymentPercent),besPercent:parseFloat(e.besPercent),taxPercent:parseFloat(e.taxPercent),garnishment:parseFloat(e.garnishment)});a(l)};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px",maxWidth:"700px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[s.jsx(m3,{size:24}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"Bordro Hesaplama"})]}),s.jsxs("form",{onSubmit:n,className:"excel-form",style:{marginBottom:"16px"},children:[s.jsxs("div",{className:"grid-3",children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Brüt"}),s.jsx("input",{className:"excel-form-input",value:e.gross,onChange:i=>t({...e,gross:i.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"SGK %"}),s.jsx("input",{className:"excel-form-input",value:e.sgkPercent,onChange:i=>t({...e,sgkPercent:i.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"İşsizlik %"}),s.jsx("input",{className:"excel-form-input",value:e.unemploymentPercent,onChange:i=>t({...e,unemploymentPercent:i.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"BES %"}),s.jsx("input",{className:"excel-form-input",value:e.besPercent,onChange:i=>t({...e,besPercent:i.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Gelir Vergisi %"}),s.jsx("input",{className:"excel-form-input",value:e.taxPercent,onChange:i=>t({...e,taxPercent:i.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"İcra / Kesinti"}),s.jsx("input",{className:"excel-form-input",value:e.garnishment,onChange:i=>t({...e,garnishment:i.target.value})})]})]}),s.jsx("button",{className:"btn btn-primary",type:"submit",style:{marginTop:"10px"},children:"Hesapla"})]}),r&&s.jsxs("div",{className:"excel-table",style:{padding:"14px",background:"#fff"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"8px"},children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>S9(r),children:[s.jsx(Zn,{size:14})," CSV"]}),s.jsxs("button",{className:"btn btn-secondary",style:{marginLeft:"8px"},onClick:()=>A9(r),children:[s.jsx(Bs,{size:14})," PDF"]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",rowGap:"8px"},children:[s.jsx("strong",{children:"Brüt"}),s.jsx("span",{children:r.gross.toFixed(2)}),s.jsx("strong",{children:"SGK"}),s.jsx("span",{children:r.sgk.toFixed(2)}),s.jsx("strong",{children:"İşsizlik"}),s.jsx("span",{children:r.unemployment.toFixed(2)}),s.jsx("strong",{children:"BES"}),s.jsx("span",{children:r.bes.toFixed(2)}),s.jsx("strong",{children:"Gelir Vergisi"}),s.jsx("span",{children:r.tax.toFixed(2)}),s.jsx("strong",{children:"İcra/Kesinti"}),s.jsx("span",{children:r.garnishment.toFixed(2)}),s.jsx("strong",{children:"Net"}),s.jsx("span",{children:r.net.toFixed(2)})]})]})]})})}const S9=e=>{const r=[["Brüt",e.gross],["SGK",e.sgk],["İşsizlik",e.unemployment],["BES",e.bes],["Gelir Vergisi",e.tax],["İcra/Kesinti",e.garnishment],["Net",e.net]].map(o=>o.join(",")).join(`
`),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(a),i=document.createElement("a");i.href=n,i.download=`bordro_${new Date().toISOString().slice(0,10)}.csv`,i.click(),URL.revokeObjectURL(n)},A9=e=>{const t=new ht;let r=14;t.setFontSize(14),t.text("Bordro Hesap Özeti",14,r),r+=8,t.setFontSize(11),[["Brüt",e.gross],["SGK",e.sgk],["İşsizlik",e.unemployment],["BES",e.bes],["Gelir Vergisi",e.tax],["İcra/Kesinti",e.garnishment],["Net",e.net]].forEach(([n,i])=>{t.text(`${n}: ${Number(i).toFixed(2)}`,14,r),r+=6}),t.save(`bordro_${new Date().toISOString().slice(0,10)}.pdf`)},N9=()=>{const e=ml(),t=(e==null?void 0:e.role)==="admin",r=gt(),[a,n]=ue.useState(!1);ue.useEffect(()=>{t||(alert("Bu sayfa sadece yönetici içindir."),window.location.href="/dashboard")},[t]);const i=(c,u,f)=>{const h=f.join(","),p=u.map(_=>f.map(k=>_[k]??"").join(",")),d=[h,...p].join(`
`),v=new Blob([d],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(v),y=document.createElement("a");y.href=m,y.download=`${c}_${new Date().toISOString().slice(0,10)}.csv`,y.click(),URL.revokeObjectURL(m)},o=async()=>{try{n(!0);const c=r==null?void 0:r.companyId,[u,f,h,p,d,v,m,y,_,k,g]=await Promise.all([To(c),Md({companyId:c}),ox({companyId:c}),gc(c),bx(c),b_(c),__(c),k_(c),Yd(c),N_(c),T_(c)]);i("customers",u,["name","companyName","phone","email","city","balance","creditLimit"]),i("orders",f,["orderNumber","orderDate","customerName","status","totalAmount"]),i("shipments",h,["shipmentNumber","shipmentDate","customerName","status","totalAmount"]),i("stock",p,["materialName","warehouse","currentStock","unit","sku","variant"]),i("requisitions",d,["reqNumber","requestDate","status"]),i("rfqs",v,["rfqNumber","dueDate","status"]),i("purchase_orders",m,["poNumber","supplier","orderDate","status","totalAmount"]),i("goods_receipts",y,["grnNumber","receiptDate","status","warehouse"]),i("boms",_,["productName","sku","version"]),i("production_orders",k,["orderNumber","productName","quantity","status","workstation"]),i("leaves",g,["personnelName","startDate","endDate","days","type","status"]),alert("Tüm veriler indirildi (CSV).")}catch(c){alert("İndirme hatası: "+(c.message||c))}finally{n(!1)}},l=async()=>{if(!t)return;if(!(r!=null&&r.companyId)){alert("Şirket bilgisi bulunamadı.");return}if(confirm("Bu işlem geri alınamaz. Bu şirketin verilerini SİLMEK istediğine emin misin?"))try{n(!0);const u=r.companyId,f=["customers","orders","shipments","stockStatus","requisitions","rfqs","purchaseOrders","goodsReceipts","boms","productionOrders","leaveRequests","activityLogs","priceRules","products","bins","transactions","journalEntries"];for(const h of f){const p=Ke(lt(qe,h),ot("companyId","==",u)),v=(await lr(p)).docs.map(m=>os(m.ref));await Promise.all(v)}alert("Tüm veriler silindi.")}catch(u){alert("Silme hatası: "+(u.message||u))}finally{n(!1)}};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px",maxWidth:"700px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[s.jsx(rl,{size:22}),s.jsx("h1",{style:{fontSize:"26px",fontWeight:700},children:"Ayarlar (Yönetici)"})]}),s.jsx("p",{style:{fontSize:"13px",color:"#555",marginBottom:"16px"},children:"Bu işlemler geri alınamaz. Sadece yönetici hesabı erişebilir."}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("button",{className:"btn btn-primary",onClick:o,disabled:a,children:[s.jsx(v3,{size:14})," Tüm Verileri CSV İndir"]}),s.jsxs("button",{className:"btn btn-secondary",style:{background:"#dc3545",borderColor:"#dc3545"},onClick:l,disabled:a,children:[s.jsx(xc,{size:14})," Tüm Verileri Sil (Geri Alınamaz)"]})]})]})})};function j9(){const[e,t]=ue.useState([]),[r,a]=ue.useState(!0),[n,i]=ue.useState(null),[o,l]=ue.useState("issued");ue.useEffect(()=>{c()},[]);const c=async()=>{a(!0);const h=gt(),p=await TO(h==null?void 0:h.companyId);t(p),a(!1)},u=async(h,p)=>{await EO(h,{status:p}),c()},f=()=>{const h=["Fatura No","Tarih","Müşteri","Tutar","PB","Durum","Sevkiyat","Sipariş"],p=e.map(_=>[_.invoiceNumber,_.date.toISOString().slice(0,10),_.customerName||"",_.totalAmount,_.currency,_.status,_.shipmentNumber||"",_.orderNumber||""].join(",")),d=[h.join(","),...p].join(`
`),v=new Blob([d],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(v),y=document.createElement("a");y.href=m,y.download=`sales_invoices_${new Date().toISOString().slice(0,10)}.csv`,y.click(),URL.revokeObjectURL(m)};return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[s.jsx("h1",{style:{fontSize:"24px",fontWeight:700},children:"Satış Faturaları"}),s.jsxs("button",{className:"btn btn-secondary",onClick:f,children:[s.jsx(Zn,{size:14})," CSV"]})]}),r?s.jsx("div",{style:{padding:"20px"},children:"Yükleniyor..."}):e.length===0?s.jsx("div",{style:{padding:"20px",color:"#666"},children:"Fatura bulunamadı."}):s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Fatura No"}),s.jsx("th",{children:"Tarih"}),s.jsx("th",{children:"Müşteri"}),s.jsx("th",{children:"Tutar"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Sevkiyat"}),s.jsx("th",{children:"Sipariş"}),s.jsx("th",{children:"İşlem"})]})}),s.jsx("tbody",{children:e.map(h=>s.jsxs("tr",{children:[s.jsx("td",{children:h.invoiceNumber}),s.jsx("td",{children:h.date.toLocaleDateString("tr-TR")}),s.jsx("td",{children:h.customerName||"-"}),s.jsxs("td",{children:[h.totalAmount.toFixed(2)," ",h.currency]}),s.jsx("td",{children:h.status}),s.jsx("td",{children:h.shipmentNumber||"-"}),s.jsx("td",{children:h.orderNumber||"-"}),s.jsx("td",{style:{display:"flex",gap:"6px"},children:n===h.id?s.jsxs(s.Fragment,{children:[s.jsxs("select",{value:o,onChange:p=>l(p.target.value),className:"excel-form-select",children:[s.jsx("option",{value:"draft",children:"Taslak"}),s.jsx("option",{value:"issued",children:"Kesildi"}),s.jsx("option",{value:"paid",children:"Ödendi"})]}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>h.id&&u(h.id,o),children:[s.jsx(oa,{size:12})," Kaydet"]})]}):s.jsxs("button",{className:"btn btn-secondary",onClick:()=>{i(h.id||null),l(h.status)},children:[s.jsx(jn,{size:12})," Durum"]})})]},h.id))})]})]})})}function T9(){const[e,t]=ue.useState({fullName:"",email:"",password:"",inviteCode:""}),[r,a]=ue.useState(!1),[n,i]=ue.useState(null),[o,l]=ue.useState(null),c=async u=>{if(u.preventDefault(),i(null),l(null),!e.fullName||!e.email||!e.password||!e.inviteCode){i("Tüm alanlar zorunlu.");return}try{a(!0);const f=await _L(e.inviteCode.trim());if(!f){i("Kod geçersiz veya kullanılmış.");return}await Sy({username:e.email,password:e.password,email:e.email,fullName:e.fullName,role:f.role,companyId:f.companyId,companyName:f.companyName,isActive:!0}),f.id&&await kL(f.id,e.email),l("Kayıt başarılı. Giriş yapabilirsiniz.")}catch(f){const h=(f==null?void 0:f.message)||"Kayıt sırasında hata oluştu";i(h),await ur(`Signup error: ${h}`,"Signup")}finally{a(!1)}};return s.jsx(nr,{children:s.jsxs("div",{style:{maxWidth:"500px",margin:"40px auto",padding:"24px",border:"1px solid #ddd",background:"#fff"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[s.jsx(Dy,{size:20}),s.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:700},children:"Kayıt Ol (Davet Koduyla)"})]}),s.jsxs("form",{onSubmit:c,children:[s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Ad Soyad"}),s.jsx("input",{className:"excel-form-input",value:e.fullName,onChange:u=>t({...e,fullName:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"E-posta"}),s.jsx("input",{className:"excel-form-input",type:"email",value:e.email,onChange:u=>t({...e,email:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Şifre"}),s.jsx("input",{className:"excel-form-input",type:"password",value:e.password,onChange:u=>t({...e,password:u.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Davet Kodu"}),s.jsx("input",{className:"excel-form-input",value:e.inviteCode,onChange:u=>t({...e,inviteCode:u.target.value})})]}),n&&s.jsx("div",{style:{color:"#dc3545",marginTop:"8px"},children:n}),o&&s.jsx("div",{style:{color:"#28a745",marginTop:"8px"},children:o}),s.jsx("button",{className:"btn btn-primary",type:"submit",disabled:r,style:{marginTop:"12px"},children:r?"Kaydediliyor...":"Kayıt Ol"})]})]})})}function E9(){const e=ml(),[t,r]=ue.useState([]),[a,n]=ue.useState([]),[i,o]=ue.useState({name:"",code:""}),[l,c]=ue.useState({code:"",companyId:"",role:"manager"}),[u]=ue.useState(!1);ue.useEffect(()=>{if((e==null?void 0:e.role)!=="admin"){alert("Bu sayfa yalnızca admin içindir.");return}f()},[]);const f=async()=>{const[d,v]=await Promise.all([y1(),v4()]);r(d),n(v)},h=async()=>{if(!i.name){alert("Firma adı girin");return}await t3(i),o({name:"",code:""}),f()},p=async()=>{if(!l.code||!l.companyId){alert("Kod ve firma seçin");return}const d=t.find(v=>v.id===l.companyId);await wL({code:l.code,companyId:l.companyId,companyName:d==null?void 0:d.name,role:l.role,isActive:!0,createdBy:e==null?void 0:e.id}),c({code:"",companyId:"",role:"manager"}),f()};return(e==null?void 0:e.role)!=="admin"?s.jsx(nr,{children:s.jsx("div",{style:{padding:"30px"},children:"Yetkiniz yok."})}):s.jsx(nr,{children:s.jsxs("div",{style:{padding:"30px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[s.jsx(rl,{size:22}),s.jsx("h1",{style:{fontSize:"24px",fontWeight:700,margin:0},children:"Davet / Firma Yönetimi"})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"20px"},children:[s.jsxs("div",{style:{border:"1px solid #ddd",padding:"14px",background:"#fff"},children:[s.jsx("h3",{style:{marginTop:0},children:"Firma Ekle"}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Firma Adı"}),s.jsx("input",{className:"excel-form-input",value:i.name,onChange:d=>o({...i,name:d.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kod (opsiyonel)"}),s.jsx("input",{className:"excel-form-input",value:i.code,onChange:d=>o({...i,code:d.target.value})})]}),s.jsxs("button",{className:"btn btn-primary",onClick:h,disabled:u,children:[s.jsx(Yr,{size:14})," Kaydet"]})]}),s.jsxs("div",{style:{border:"1px solid #ddd",padding:"14px",background:"#fff"},children:[s.jsx("h3",{style:{marginTop:0},children:"Davet Kodu Oluştur"}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Kod"}),s.jsx("input",{className:"excel-form-input",value:l.code,onChange:d=>c({...l,code:d.target.value})})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Firma"}),s.jsxs("select",{className:"excel-form-select",value:l.companyId,onChange:d=>c({...l,companyId:d.target.value}),children:[s.jsx("option",{value:"",children:"Seçiniz"}),t.map(d=>s.jsx("option",{value:d.id,children:d.name},d.id))]})]}),s.jsxs("div",{className:"excel-form-group",children:[s.jsx("label",{className:"excel-form-label",children:"Rol"}),s.jsxs("select",{className:"excel-form-select",value:l.role,onChange:d=>c({...l,role:d.target.value}),children:[s.jsx("option",{value:"manager",children:"Yönetici"}),s.jsx("option",{value:"user",children:"Kullanıcı"})]})]}),s.jsxs("button",{className:"btn btn-primary",onClick:p,disabled:u,children:[s.jsx(Yr,{size:14})," Kod Oluştur"]})]})]}),s.jsxs("div",{style:{border:"1px solid #ddd",padding:"14px",background:"#fff"},children:[s.jsx("h3",{style:{marginTop:0},children:"Davet Kodları"}),s.jsxs("table",{className:"excel-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Kod"}),s.jsx("th",{children:"Firma"}),s.jsx("th",{children:"Rol"}),s.jsx("th",{children:"Durum"}),s.jsx("th",{children:"Kullanıldı"})]})}),s.jsx("tbody",{children:a.map(d=>s.jsxs("tr",{children:[s.jsx("td",{children:d.code}),s.jsx("td",{children:d.companyName||d.companyId}),s.jsx("td",{children:d.role}),s.jsx("td",{children:d.isActive?"Aktif":"Kullanıldı"}),s.jsx("td",{children:d.usedBy||"-"})]},d.id))})]})]})]})})}function C9(){return s.jsx(nr,{children:s.jsxs("div",{style:{padding:"40px",maxWidth:"900px",margin:"0 auto"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"32px"},children:[s.jsx(Fp,{size:40,color:"#000"}),s.jsx("h1",{style:{fontSize:"48px",fontWeight:"800",margin:0,letterSpacing:"-2px"},children:"Kaptan Hakkında"})]}),s.jsx("section",{style:{marginBottom:"48px"},children:s.jsx("p",{style:{fontSize:"20px",lineHeight:"1.6",color:"#333"},children:"Kaptan, karmaşık işletme süreçlerini basitleştirmek için tasarlanmış yeni nesil bir İşletme Yönetim Sistemi (BMS)'dir. Geleneksel, hantal ERP sistemlerinden uzaklaşarak, Kaptan tedarik zincirleri, müşteri ilişkileri, finans, üretim ve insan kaynakları yönetimi için modüler, yapay zeka odaklı bir yaklaşım sunar."})}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px",marginBottom:"48px"},children:[s.jsxs("div",{style:{padding:"24px",border:"2px solid #000",borderRadius:"0"},children:[s.jsx(C3,{size:24,style:{marginBottom:"12px"}}),s.jsx("h3",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},children:"Verimlilik Öncelikli"}),s.jsx("p",{style:{fontSize:"14px",color:"#666",margin:0},children:"Hızlı veri girişi ve net görselleştirme için tasarlanmış minimalist arayüz. Gereksiz karmaşa yok, sadece performans."})]}),s.jsxs("div",{style:{padding:"24px",border:"2px solid #000",borderRadius:"0"},children:[s.jsx(Dy,{size:24,style:{marginBottom:"12px"}}),s.jsx("h3",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},children:"Çoklu Kiracı Güvenliği"}),s.jsx("p",{style:{fontSize:"14px",color:"#666",margin:0},children:"Şirket verileriniz için en son teknoloji Firestore güvenlik kuralları kullanılarak kurumsal düzeyde izolasyon."})]}),s.jsxs("div",{style:{padding:"24px",border:"2px solid #000",borderRadius:"0"},children:[s.jsx(b3,{size:24,style:{marginBottom:"12px"}}),s.jsx("h3",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},children:"Küresel Uyumluluk"}),s.jsx("p",{style:{fontSize:"14px",color:"#666",margin:0},children:"Çoklu para birimi işlemleri ve Türk e-dönüşüm standartları dahil yerel düzenlemeler için destek."})]}),s.jsxs("div",{style:{padding:"24px",border:"2px solid #000",borderRadius:"0"},children:[s.jsx(Fp,{size:24,style:{marginBottom:"12px"}}),s.jsx("h3",{style:{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},children:"Yapay Zeka Entegrasyonu"}),s.jsx("p",{style:{fontSize:"14px",color:"#666",margin:0},children:"Otonom raporlama, tahminleme ve veri mutabakatı için GPT-4o Mini'nin gücünden yararlanma."})]})]}),s.jsxs("section",{style:{padding:"32px",background:"#f9f9f9",borderLeft:"4px solid #000"},children:[s.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px"},children:"Misyonumuz"}),s.jsx("p",{style:{fontSize:"16px",lineHeight:"1.5",margin:0},children:"Misyonumuz, küçük ve orta ölçekli işletmelere dijital dünyada rekabet edebilmeleri için ihtiyaç duydukları araçları sağlamaktır. Şeffaf, esnek ve akıllı bir platform sunarak, işletmelerin elektronik tablolardan tek bir doğruluk kaynağına geçişine yardımcı oluyoruz."})]}),s.jsx("footer",{style:{marginTop:"64px",textAlign:"center",fontSize:"12px",color:"#999"},children:"© 2025 Kaptan BMS. Tüm hakları saklıdır. Sürüm 2.4.0"})]})})}function F9(){const[e,t]=ue.useState(null),[r,a]=ue.useState(!0);if(ue.useEffect(()=>{const i=Ck(Is,o=>{t(o),a(!1)});return()=>i()},[]),r)return s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"Yükleniyor..."});const n=()=>{if(e)return!0;const i=localStorage.getItem("currentUser");if(i)try{return JSON.parse(i).role!=="admin"}catch{return!1}return!1};return s.jsx(_k,{children:s.jsxs(kk,{children:[s.jsx(rr,{path:"/login",element:n()?s.jsx(hr,{to:"/dashboard"}):s.jsx(F3,{})}),s.jsx(rr,{path:"/signup",element:s.jsx(T9,{})}),s.jsx(rr,{path:"/admin-login",element:s.jsx(D3,{})}),s.jsx(rr,{path:"/invite-admin",element:n()?s.jsx(E9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/about",element:n()?s.jsx(C9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/dashboard",element:n()?s.jsx(KS,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/stock-entry",element:n()?s.jsx(rL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/stock-output",element:n()?s.jsx(aL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/stock-status",element:n()?s.jsx(nL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/zimmet-signature/:outputId",element:n()?s.jsx(uL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/personnel-management",element:n()?s.jsx(fL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/order-management",element:n()?s.jsx(vL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/warehouse-management",element:n()?s.jsx(yL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/customer-management",element:n()?s.jsx(jL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/shipment-management",element:n()?s.jsx(CO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/customer-payments",element:n()?s.jsx(FO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/customer-aging",element:n()?s.jsx(DO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/journal-entries",element:n()?s.jsx(IO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/product-management",element:n()?s.jsx(BO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/requisition-management",element:n()?s.jsx(zO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/rfq-management",element:n()?s.jsx(UO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/purchase-orders",element:n()?s.jsx(WO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/goods-receipts",element:n()?s.jsx(qO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/edocs-local",element:n()?s.jsx(HO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/price-lists",element:n()?s.jsx($O,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/customer-insights",element:n()?s.jsx(VO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/bom",element:n()?s.jsx(n9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/mrp",element:n()?s.jsx(i9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/shop-floor",element:n()?s.jsx(u9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/leave-management",element:n()?s.jsx(y9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/payroll",element:n()?s.jsx(k9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/settings",element:n()?s.jsx(N9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/sales-invoices",element:n()?s.jsx(j9,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/quotes",element:n()?s.jsx(KO,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/activity-logs",element:n()?s.jsx(AL,{}):s.jsx(hr,{to:"/login"})}),s.jsx(rr,{path:"/transaction-orders",element:s.jsx(NL,{})}),s.jsx(rr,{path:"/admin-panel",element:s.jsx(SL,{})}),s.jsx(rr,{path:"/",element:s.jsx(hr,{to:n()?"/dashboard":"/login"})})]})})}Np.createRoot(document.getElementById("root")).render(s.jsx(Sk.StrictMode,{children:s.jsx(F9,{})}));export{jr as _};
